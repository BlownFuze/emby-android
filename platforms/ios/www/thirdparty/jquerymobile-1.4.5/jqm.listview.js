define(["jqmwidget"],function(){!function(e){var i=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;e.extend(e.mobile,{getAttribute:function(e,t){var s;e=e.jquery?e[0]:e,e&&e.getAttribute&&(s=e.getAttribute("data-"+t));try{s="true"===s?!0:"false"===s?!1:"null"===s?null:+s+""===s?+s:i.test(s)?JSON.parse(s):s}catch(n){}return s}})}(jQuery,this),function(e){function i(i){var s,n=i.length,a=[];for(s=0;n>s;s++)i[s].className.match(t)||a.push(i[s]);return e(a)}var t=/\bui-screen-hidden\b/;e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var s;return t?s=i(e):(s=e.filter(":visible"),0===s.length&&(s=i(e))),s},_addFirstLastClasses:function(e,i,t){e.removeClass("ui-first-child ui-last-child"),i.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),t||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(e){e.removeClass("ui-first-child ui-last-child")}}}(jQuery),function(e){var i=e.mobile.getAttribute;e.widget("mobile.listview",e.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var e=this,i="";i+=e.options.inset?" ui-listview-inset":"",e.options.inset&&(i+=e.options.corners?" ui-corner-all":"",i+=e.options.shadow?" ui-shadow":""),e.element.addClass(" ui-listview"+i),e.refresh(!0)},_findFirstElementByTagName:function(e,i,t,s){var n={};for(n[t]=n[s]=!0;e;){if(n[e.nodeName])return e;e=e[i]}return null},_addThumbClasses:function(i){var t,s,n=i.length;for(t=0;n>t;t++)s=e(this._findFirstElementByTagName(i[t].firstChild,"nextSibling","img","IMG")),s.length&&e(this._findFirstElementByTagName(s[0].parentNode,"parentNode","li","LI")).addClass(s.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(i,t,s){var n=[],a={};for(a[t]=a[s]=!0,i=i.firstChild;i;)a[i.nodeName]&&n.push(i),i=i.nextSibling;return e(n)},_beforeListviewRefresh:e.noop,_afterListviewRefresh:e.noop,refresh:function(t){var s,n,a,r,l,o,u,h,d,c,m,f,b,g,v,C,p,_,y,N,T=this.options,w=this.element,L=!!e.nodeName(w[0],"ol"),F=w.attr("start"),I={},x=w.find(".ui-li-count"),B=i(w[0],"counttheme")||this.options.countTheme,j=B?"ui-body-"+B:"ui-body-inherit";for(T.theme&&w.addClass("ui-group-theme-"+T.theme),L&&(F||0===F)&&(m=parseInt(F,10)-1,w.css("counter-reset","listnumbering "+m)),this._beforeListviewRefresh(),N=this._getChildrenByTagName(w[0],"li","LI"),n=0,a=N.length;a>n;n++)r=N.eq(n),l="",(t||r[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0)&&(d=this._getChildrenByTagName(r[0],"a","A"),c="list-divider"===i(r[0],"role"),b=r.attr("value"),o=i(r[0],"theme"),d.length&&d[0].className.search(/\bui-btn\b/)<0&&!c?(u=i(r[0],"icon"),h=u===!1?!1:u||T.icon,d.removeClass("ui-link"),s="ui-btn",o&&(s+=" ui-btn-"+o),d.length>1?(l="ui-li-has-alt",g=d.last(),v=i(g[0],"theme")||T.splitTheme||i(r[0],"theme",!0),C=v?" ui-btn-"+v:"",p=i(g[0],"icon")||i(r[0],"icon")||T.splitIcon,_="ui-btn ui-btn-icon-notext ui-icon-"+p+C,g.attr("title",e.trim(g.text())).addClass(_).empty(),d=d.first()):h&&(s+=" ui-btn-icon-right ui-icon-"+h),d.addClass(s)):c?(y=i(r[0],"theme")||T.dividerTheme||T.theme,l="ui-li-divider ui-bar-"+(y?y:"inherit"),r.attr("role","heading")):d.length<=0&&(l="ui-li-static ui-body-"+(o?o:"inherit")),L&&b&&(f=parseInt(b,10)-1,r.css("counter-reset","listnumbering "+f))),I[l]||(I[l]=[]),I[l].push(r[0]);for(l in I)e(I[l]).addClass(l);x.each(function(){e(this).closest("li").addClass("ui-li-has-count")}),j&&x.not("[class*='ui-body-']").addClass(j),this._addThumbClasses(N),this._addThumbClasses(N.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(N,this._getVisibles(N,t),t)}},e.mobile.behaviors.addFirstLastClasses))}(jQuery)});