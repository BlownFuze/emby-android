define(["jqmwidget"],function(){!function(e){function i(i){var n,o=i.length,r=[];for(n=0;o>n;n++)i[n].className.match(t)||r.push(i[n]);return e(r)}var t=/\bui-screen-hidden\b/;e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var n;return t?n=i(e):(n=e.filter(":visible"),0===n.length&&(n=i(e))),n},_addFirstLastClasses:function(e,i,t){e.removeClass("ui-first-child ui-last-child"),i.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),t||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(e){e.removeClass("ui-first-child ui-last-child")}}}(jQuery),function(e,i){function t(){var i=e.trim("[data-role='none']"),t=(e.trim(e.mobile.keepNative),e.trim("[data-role='none']")),n="",o=""===n?t:"";return(i?[i]:[]).concat(n?[n]:[]).concat(o?[o]:[]).join(", ")}e.widget("mobile.controlgroup",e.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var i=this.element,n=this.options,o=t();e.fn.buttonMarkup&&this.element.find(e.fn.buttonMarkup.initSelector).not(o).buttonMarkup(),e.each(this._childWidgets,e.proxy(function(i,t){e.mobile[t]&&this.element.find(e.mobile[t].initSelector).not(o)[t]()},this)),e.extend(this,{_ui:null,_initialRefresh:!0}),this._ui=n.enhanced?{groupLegend:i.children(".ui-controlgroup-label").children(),childWrapper:i.children(".ui-controlgroup-controls")}:this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(e){return e?"none"===e?"":"ui-group-theme-"+e:""},_enhance:function(){var i=this.element,t=this.options,n={groupLegend:i.children("legend"),childWrapper:i.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===t.type?"horizontal":"vertical")+" "+this._themeClassFromOption(t.theme)+" "+(t.corners?"ui-corner-all ":"")+(t.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(t.shadow===!0?"ui-shadow":"")+"'></div>").children()};return n.groupLegend.length>0&&e("<div role='heading' class='ui-controlgroup-label'></div>").append(n.groupLegend).prependTo(i),n},_init:function(){this.refresh()},_setOptions:function(e){var t,n,o=this.element;return e.type!==i&&(o.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===e.type?"horizontal":"vertical")),t=!0),e.theme!==i&&o.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(e.theme)),e.corners!==i&&o.toggleClass("ui-corner-all",e.corners),e.mini!==i&&o.toggleClass("ui-mini",e.mini),e.shadow!==i&&this._ui.childWrapper.toggleClass("ui-shadow",e.shadow),e.excludeInvisible!==i&&(this.options.excludeInvisible=e.excludeInvisible,t=!0),n=this._super(e),t&&this.refresh(),n},container:function(){return this._ui.childWrapper},refresh:function(){var i=this.container(),t=i.find(".ui-btn").not(".ui-slider-handle"),n=this._initialRefresh;e.mobile.checkboxradio&&i.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(t,this.options.excludeInvisible?this._getVisibles(t,n):t,n),this._initialRefresh=!1},_destroy:function(){var e,i,t=this.options;return t.enhanced?this:(e=this._ui,i=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(t.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(i),e.groupLegend.unwrap(),void e.childWrapper.children().unwrap())}},e.mobile.behaviors.addFirstLastClasses))}(jQuery)});