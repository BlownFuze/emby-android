define(["visibleinviewport","imageloader"],function(e,t){function n(t){return e(t,!0,d,f)}function i(e){var n=e.getAttribute("data-src");n&&(t.loadImage(e,n).then(o),e.setAttribute("data-src",""))}function o(e){if(browserInfo.animate&&!browserInfo.mobile&&!e.classList.contains("noFade")){var t=[{opacity:"0",offset:0},{opacity:"1",offset:1}],n={duration:300,iterations:1};e.animate(t,n)}}function r(e){for(var t=0,n=e.length;n>t;t++)e[t]=!0}function a(e){function t(t){for(var r=[],s=!1,c=!1,u=0,d=e.length;d>u;u++){if(a[t])return;var f=e[u];!c&&n(f)?(s=!0,i(f)):(s&&(c=!0),r.push(f))}e=r,e.length||(document.removeEventListener("focus",o,!0),document.removeEventListener("scroll",o,!0),document.removeEventListener(l,o,!0),window.removeEventListener("resize",o,!0))}function o(){r(a);var e=a.length;a.length++,setTimeout(function(){t(e)},1)}if(e.length){var a=[];document.addEventListener("scroll",o,!0),document.addEventListener("focus",o,!0),document.addEventListener(l,o,!0),window.addEventListener("resize",o,!0),o()}}function s(e){for(var t=0,n=e.length;n>t;t++){var o=e[0];i(o)}}function c(e){a(e.getElementsByClassName("lazy"),e)}function u(e,t){e.setAttribute("data-src",t),s([e])}var l=document.implementation.hasFeature("Event.wheel","3.0")?"wheel":"mousewheel",d=screen.availWidth,f=screen.availHeight;window.ImageLoader={fillImages:s,lazyImage:u,lazyChildren:c}});