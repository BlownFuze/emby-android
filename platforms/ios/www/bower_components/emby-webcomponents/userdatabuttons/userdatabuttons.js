define(["connectionManager","globalize","paper-icon-button-light","material-icons","emby-button","css!./userdatabuttons"],function(t,e){function a(t,e,a,n,r,s,i){"fab-mini"==i&&(i="fab",a=a?a+" mini":"mini");var o="fab"==i?"emby-button":"paper-icon-button-light",c="fab"==i?"autoSize fab":"autoSize";return a&&(c+=" "+a),n?n+=" ":n="",n+="md-icon",'<button title="'+s+'" data-itemid="'+e+'" is="'+o+'" class="'+c+'" onclick="UserDataButtons.'+t+'(this);return false;">                <i class="'+n+'">'+r+"</i>            </button>"}function n(t){var e=r(t);t.element.innerHTML=e}function r(t){var n=t.item,r=t.includePlayed,s=t.cssClass,i=t.style,o="",c=n.UserData||{},l=n.Id,u="btnUserData";s&&(u+=" "+s);var d=t.iconCssClass;if(r!==!1){var b=e.translate("sharedcomponents#MarkPlayed");("Video"==n.MediaType||"Series"==n.Type||"Season"==n.Type||"BoxSet"==n.Type||"Playlist"==n.Type)&&"TvChannel"!=n.Type&&(o+=c.Played?a("markPlayed",l,u+" btnUserDataOn",d,"check",b,i):a("markPlayed",l,u,d,"check",b,i))}var m=e.translate("sharedcomponents#Favorite");return o+=c.IsFavorite?a("markFavorite",l,u+" btnUserData btnUserDataOn",d,"favorite",m,i):a("markFavorite",l,u+" btnUserData",d,"favorite",m,i)}function s(t){var e=t.getAttribute("data-itemid"),a=!t.classList.contains("btnUserDataOn");d(e,a),a?t.classList.add("btnUserDataOn"):t.classList.remove("btnUserDataOn")}function i(t){var e=t.getAttribute("data-itemid");t.classList.contains("btnUserDataOn")?(b(e),t.classList.remove("btnUserDataOn")):(l(e,!0),t.classList.add("btnUserDataOn")),t.parentNode.querySelector(".btnDislike").classList.remove("btnUserDataOn")}function o(t){var e=t.getAttribute("data-itemid");t.classList.contains("btnUserDataOn")?(b(e),t.classList.remove("btnUserDataOn")):(l(e,!1),t.classList.add("btnUserDataOn")),t.parentNode.querySelector(".btnLike").classList.remove("btnUserDataOn")}function c(t){var e=t.getAttribute("data-itemid");t.classList.contains("btnUserDataOn")?(u(e,!1),t.classList.remove("btnUserDataOn")):(u(e,!0),t.classList.add("btnUserDataOn"))}function l(e,a){var n=t.currentApiClient();return n.updateUserItemRating(n.getCurrentUserId(),e,a)}function u(e,a){var n=t.currentApiClient(),r=a?"markPlayed":"markUnplayed";return n[r](n.getCurrentUserId(),e,new Date)}function d(e,a){var n=t.currentApiClient();return n.updateFavoriteStatus(n.getCurrentUserId(),e,a)}function b(e){var a=t.currentApiClient();return a.clearUserItemRating(a.getCurrentUserId(),e)}return window.UserDataButtons={markPlayed:c,markDislike:o,markLike:i,markFavorite:s},{fill:n,getIconsHtml:r}});