define(["browser"],function(e){function o(){var e=document.createElement("video");return!(!e.canPlayType||!e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,""))}function i(){return!1}function n(){return null==m&&(m=null!=document.createElement("video").textTracks),m}function a(){return null==C&&(C=r()||t()),C}function r(){var e=document.createElement("video");return e.canPlayType("application/x-mpegURL").replace(/no/,"")||e.canPlayType("application/vnd.apple.mpegURL").replace(/no/,"")?!0:!1}function t(){return null==window.MediaSource||e.firefox?!1:!0}function s(o){var i;if("flac"==o){if(e.tizen)return!0;if(c())return!0}else if("wma"==o){if(e.tizen)return!0;if(c())return!0}else if("opus"==o)return i='audio/ogg; codecs="opus"',document.createElement("audio").canPlayType(i).replace(/no/,"")?!0:!1;return i="webma"==o?"audio/webm":"audio/"+o,document.createElement("audio").canPlayType(i).replace(/no/,"")?!0:!1}function c(){if(e.edge){var o=navigator.userAgent.toLowerCase();if(-1!=o.indexOf("msapphost"))return!0}return!1}function d(o){if(o.canPlayType("video/x-matroska")||o.canPlayType("video/mkv"))return!0;var i=navigator.userAgent.toLowerCase();return e.chrome?e.operaTv?!1:-1!=i.indexOf("vivaldi")||-1!=i.indexOf("opera")?!1:!0:e.tizen?!0:c()?!0:!1}function u(){return e.tizen||e.web0s}function p(o,i){var n=!1,a=o;switch(o){case"asf":n=e.tizen||c(),i=[];break;case"avi":n=c();break;case"mpg":case"mpeg":n=c();break;case"3gp":case"flv":case"mts":case"trp":case"vob":case"vro":n=e.tizen;break;case"mov":n=e.chrome||c();break;case"m2ts":n=e.tizen||e.web0s||c();break;case"wmv":n=e.tizen||e.web0s||c(),i=[];break;case"ts":n=e.tizen||e.web0s||c(),a="ts,mpegts"}return n?{Container:a,Type:"Video",AudioCodec:i.join(",")}:null}function l(){if(e.xboxOne)return 1e7;if(e.ps4)return 8e6;var o=navigator.userAgent.toLowerCase();return e.tizen?-1!=o.indexOf("tizen 2.3")?2e7:4e7:1e8}var m,C;return function(r){r=r||{};var t=r.audioChannels||2,m=l(),C=document.createElement("video"),f=C.canPlayType("video/webm").replace(/no/,""),h=d(C),y=u(),P={};P.MaxStreamingBitrate=m,P.MaxStaticBitrate=1e8,P.MusicStreamingTranscodingBitrate=Math.min(m,192e3),P.DirectPlayProfiles=[];var v=[],T=[],g=C.canPlayType('video/mp4; codecs="avc1.640029, mp4a.69"').replace(/no/,"")||C.canPlayType('video/mp4; codecs="avc1.640029, mp4a.6B"').replace(/no/,"");(C.canPlayType('audio/mp4; codecs="ac-3"').replace(/no/,"")||c()||e.tizen)&&(e.safari||(v.push("ac3"),e.edge&&e.touch||T.push("ac3")));var V=!1;(h||y)&&g&&(V=!0,v.push("mp3"),T.push("mp3")),C.canPlayType('video/mp4; codecs="avc1.640029, mp4a.40.2"').replace(/no/,"")&&(v.push("aac"),T.push("aac")),!V&&g&&(v.push("mp3"),T.push("mp3")),c();var A=[];o()&&A.push("h264"),i()&&(A.push("h265"),A.push("hevc")),A.length&&P.DirectPlayProfiles.push({Container:"mp4,m4v",Type:"Video",VideoCodec:A.join(","),AudioCodec:v.join(",")}),h&&A.length&&(P.DirectPlayProfiles.push({Container:"mkv",Type:"Video",VideoCodec:A.join(","),AudioCodec:v.join(",")}),c()&&P.DirectPlayProfiles.push({Container:"mkv",Type:"Video",VideoCodec:"vc1",AudioCodec:v.join(",")})),["m2ts","mov","wmv","ts","asf","avi","mpg","mpeg"].map(function(e){return p(e,v)}).filter(function(e){return null!=e}).forEach(function(e){P.DirectPlayProfiles.push(e)}),["opus","mp3","aac","flac","webma","wma","wav"].filter(s).forEach(function(e){P.DirectPlayProfiles.push({Container:"webma"==e?"webma,webm":e,Type:"Audio"}),"aac"==e&&P.DirectPlayProfiles.push({Container:"m4a",AudioCodec:e,Type:"Audio"})}),f&&P.DirectPlayProfiles.push({Container:"webm",Type:"Video"}),P.TranscodingProfiles=[],["opus","mp3","aac"].filter(s).forEach(function(e){P.TranscodingProfiles.push({Container:e,Type:"Audio",AudioCodec:e,Context:"Streaming",Protocol:"http"}),P.TranscodingProfiles.push({Container:e,Type:"Audio",AudioCodec:e,Context:"Static",Protocol:"http"})});var b=!1;e.chrome&&(b=!0),h&&r.supportsCustomSeeking&&!e.tizen&&P.TranscodingProfiles.push({Container:"mkv",Type:"Video",AudioCodec:v.join(","),VideoCodec:"h264",Context:"Streaming",CopyTimestamps:b}),y&&r.supportsCustomSeeking&&!e.tizen&&!e.web0s&&P.TranscodingProfiles.push({Container:"ts",Type:"Video",AudioCodec:v.join(","),VideoCodec:"h264",Context:"Streaming",CopyTimestamps:b,MaxAudioChannels:t.toString()}),a()&&P.TranscodingProfiles.push({Container:"ts",Type:"Video",AudioCodec:T.join(","),VideoCodec:"h264",Context:"Streaming",Protocol:"hls"}),e.firefox&&P.TranscodingProfiles.push({Container:"mp4",Type:"Video",AudioCodec:v.join(","),VideoCodec:"h264",Context:"Streaming",Protocol:"http"}),f&&P.TranscodingProfiles.push({Container:"webm",Type:"Video",AudioCodec:"vorbis",VideoCodec:"vpx",Context:"Streaming",Protocol:"http",MaxAudioChannels:t.toString()}),P.TranscodingProfiles.push({Container:"mp4",Type:"Video",AudioCodec:v.join(","),VideoCodec:"h264",Context:"Streaming",Protocol:"http",MaxAudioChannels:t.toString()}),P.TranscodingProfiles.push({Container:"mp4",Type:"Video",AudioCodec:v.join(","),VideoCodec:"h264",Context:"Static",Protocol:"http"}),P.ContainerProfiles=[],P.CodecProfiles=[],P.CodecProfiles.push({Type:"Audio",Conditions:[{Condition:"LessThanEqual",Property:"AudioChannels",Value:"2"}]});var x="6";C.canPlayType('video/mp4; codecs="avc1.640029, mp4a.40.5"').replace(/no/,"")||P.CodecProfiles.push({Type:"VideoAudio",Codec:"aac",Conditions:[{Condition:"NotEquals",Property:"AudioProfile",Value:"HE-AAC"},{Condition:"LessThanEqual",Property:"AudioChannels",Value:x},{Condition:"LessThanEqual",Property:"AudioBitrate",Value:"128000"},{Condition:"Equals",Property:"IsSecondaryAudio",Value:"false",IsRequired:"false"}]}),P.CodecProfiles.push({Type:"VideoAudio",Conditions:[{Condition:"LessThanEqual",Property:"AudioChannels",Value:x},{Condition:"Equals",Property:"IsSecondaryAudio",Value:"false",IsRequired:"false"}]});var w="41";return e.chrome&&!e.mobile&&(w="51"),P.CodecProfiles.push({Type:"Video",Codec:"h264",Conditions:[{Condition:"NotEquals",Property:"IsAnamorphic",Value:"true",IsRequired:!1},{Condition:"EqualsAny",Property:"VideoProfile",Value:"high|main|baseline|constrained baseline"},{Condition:"LessThanEqual",Property:"VideoLevel",Value:w}]}),P.CodecProfiles.push({Type:"Video",Codec:"vpx",Conditions:[{Condition:"NotEquals",Property:"IsAnamorphic",Value:"true",IsRequired:!1}]}),P.SubtitleProfiles=[],n()&&P.SubtitleProfiles.push({Format:"vtt",Method:"External"}),P.ResponseProfiles=[],P.ResponseProfiles.push({Type:"Video",Container:"m4v",MimeType:"video/mp4"}),e.chrome&&P.ResponseProfiles.push({Type:"Video",Container:"mov",MimeType:"video/webm"}),P}});