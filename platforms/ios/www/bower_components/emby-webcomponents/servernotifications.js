define(["connectionManager","events"],function(e,r){function t(e,t){var a=this;if("LibraryChanged"===t.MessageType);else if("ServerShuttingDown"===t.MessageType)r.trigger(s,"ServerShuttingDown",[a]);else if("ServerRestarting"===t.MessageType)r.trigger(s,"ServerRestarting",[a]);else if("RestartRequired"===t.MessageType)r.trigger(s,"RestartRequired",[a]);else if("UserDataChanged"===t.MessageType&&t.Data.UserId==a.getCurrentUserId())for(var n=0,i=t.Data.UserDataList.length;i>n;n++)r.trigger(s,"UserDataChanged",[a,t.Data.UserDataList[n]])}function a(e){r.off(e,"websocketmessage",t),r.on(e,"websocketmessage",t)}var s={};return r.on(e,"apiclientcreated",function(e,r){a(r)}),s});