define(["connectionManager","events"],function(e,a){function t(e,t){var n=this;if("UserDataChanged"===t.MessageType){if(t.Data.UserId==n.getCurrentUserId())for(var s=0,i=t.Data.UserDataList.length;i>s;s++)a.trigger(r,"UserDataChanged",[n,t.Data.UserDataList[s]])}else a.trigger(r,t.MessageType,[n,t.Data])}function n(e){a.off(e,"websocketmessage",t),a.on(e,"websocketmessage",t)}var r={},s=e.currentApiClient();return s&&n(s),a.on(e,"apiclientcreated",function(e,a){n(a)}),r});