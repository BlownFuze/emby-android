define(["imageLoader","itemShortcuts","connectionManager","layoutManager"],function(a,r,e,d){function t(a,r){var d="card "+(r.shape||"portrait")+"Card personCard";(r.block||r.rows)&&(d+=" block");for(var t="",i=0,o=r.serverId,s=e.getApiClient(o),c=0,l=a.length;l>c;c++){r.rows&&0==i&&(t+='<div class="cardColumn">');var v=a[c];t+=n(v,s,o,r,d),i++,r.rows&&i>=r.rows&&(i=0,t+="</div>")}return t}function i(a,r,e){return a.PrimaryImageTag?e.getScaledImageUrl(a.Id,{maxWidth:r,tag:a.PrimaryImageTag,type:"Primary"}):null}function n(a,r,e,t,n){n+=" itemAction scalableCard";var o=i(a,t.width,r),s="cardImageContainer";t.coverImage&&(s+=" coveredImage");var c=o?'<div class="'+s+' lazy" data-src="'+o+'">':'<div class="'+s+'">';o||(c+='<i class="md-icon cardImageIcon">person</i>');var l="";l+='<div class="cardText">'+a.Name+"</div>",l+=a.Role?'<div class="cardText cardText-secondary">as '+a.Role+"</div>":a.Type?'<div class="cardText cardText-secondary">'+Globalize.translate("core#"+a.Type)+"</div>":'<div class="cardText cardText-secondary">&nbsp;</div>';var v="visualCardBox cardBox";d.tv&&(v+=" cardBox-focustransform");var m='<button type="button" data-isfolder="'+a.IsFolder+'" data-type="'+a.Type+'" data-action="link" data-id="'+a.Id+'" data-serverid="'+e+'" raised class="'+n+'"> <div class="'+v+'"><div class="cardScalable visualCardBox-cardScalable"><div class="cardPadder-portrait"></div><div class="cardContent">'+c+'</div></div></div><div class="cardFooter visualCardBox-cardFooter">'+l+"</div></div></button>";return m}function o(e,d){if(d.parentContainer){if(!document.body.contains(d.parentContainer))return;if(!e.length)return void d.parentContainer.classList.add("hide");d.parentContainer.classList.remove("hide")}var i=t(e,d);d.itemsContainer.innerHTML=i,a.lazyChildren(d.itemsContainer),r.off(d.itemsContainer),r.on(d.itemsContainer)}return{buildPeopleCards:o}});