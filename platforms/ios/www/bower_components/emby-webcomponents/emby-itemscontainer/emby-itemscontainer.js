define(["itemShortcuts","connectionManager","layoutManager","browser","dom","loading","serverNotifications","events","registerElement"],function(e,t,n,i,r,a,o,l){function s(t){var n=this,i=(t.target,n.multiSelect);i&&i.onContainerClick.call(n,t)===!1||e.onClick.call(n,t)}function u(e){return e.preventDefault(),e.stopPropagation(),!1}function c(t){var n=this,i=t.target,a=r.parentWithAttribute(i,"data-id");return a?(e.showContextMenu(a,{positionTo:i,itemsContainer:n}),t.preventDefault(),t.stopPropagation(),!1):void 0}function d(){return{click:!1}}function h(e,n){a.show();var i=e.item,r=e.newIndex,o=i.getAttribute("data-playlistitemid"),l=i.getAttribute("data-playlistid"),s=i.getAttribute("data-serverid"),u=t.getApiClient(s);u.ajax({url:u.getUrl("Playlists/"+l+"/Items/"+o+"/Move/"+r),type:"POST"}).then(function(){i.setAttribute("data-index",r),a.hide()},function(){a.hide(),n.dispatchEvent(new CustomEvent("needsrefresh",{detail:{},cancelable:!1,bubbles:!0}))})}function v(e,t,n){var i=this;require(["cardBuilder"],function(e){e.onUserDataChanged(n,i)})}var f=Object.create(HTMLDivElement.prototype);f.enableHoverMenu=function(e){var t=this.hoverMenu;if(!e)return void(t&&(t.destroy(),this.hoverMenu=null));if(!t){var n=this;require(["itemHoverMenu"],function(e){n.hoverMenu=new e(n)})}},f.enableMultiSelect=function(e){var t=this.multiSelect;if(!e)return void(t&&(t.destroy(),this.multiSelect=null));if(!t){var n=this;require(["multiSelect"],function(e){n.multiSelect=new e({container:n,bindOnClick:!1})})}},f.enableDragReordering=function(e){var t=this.sortable;if(!e)return void(t&&(t.destroy(),this.sortable=null));if(!t){var n=this;require(["sortable"],function(e){n.sortable=new e(n,{draggable:".listItem",handle:".listViewDragHandle",onEnd:function(e){h(e,n)}})})}},f.attachedCallback=function(){this.addEventListener("click",s),i.touch?this.addEventListener("contextmenu",u):this.addEventListener("contextmenu",c),n.desktop&&this.enableHoverMenu(!0),(n.desktop||n.mobile)&&this.enableMultiSelect(!0),e.on(this,d());var t=v.bind(this);l.on(o,"UserDataChanged",t),this.userDataHandler=t},f.detachedCallback=function(){this.enableHoverMenu(!1),this.enableMultiSelect(!1),this.enableDragReordering(!1),this.removeEventListener("click",s),this.removeEventListener("contextmenu",c),this.removeEventListener("contextmenu",u),e.off(this,d());var t=this.userDataHandler;t&&(l.off(o,"UserDataChanged",t),this.userDataHandler=null)},document.registerElement("emby-itemscontainer",{prototype:f,"extends":"div"})});