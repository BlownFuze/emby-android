define(["playbackManager","focusManager","embyRouter","dom"],function(e,a,r,s){function c(){l=(new Date).getTime(),k("unknown")}function n(){l=(new Date).getTime()}function t(){return(new Date).getTime()-l}function o(e){e.click()}function i(e,a){m++,e.addEventListener("command",a)}function b(e,a){m&&m--,e.removeEventListener("command",a)}function u(e){var a=d[e]||0,r=(new Date).getTime();return 1e3>r-a?!1:(d[e]=r,!0)}function k(s,c){l=(new Date).getTime();var n=c?c.sourceElement:null;if(n&&(n=a.focusableParent(n)),n=n||document.activeElement||window,m){var t=new CustomEvent("command",{detail:{command:s},bubbles:!0,cancelable:!0}),i=n.dispatchEvent(t);if(!i)return}switch(s){case"up":a.moveUp(n);break;case"down":a.moveDown(n);break;case"left":a.moveLeft(n);break;case"right":a.moveRight(n);break;case"home":r.goHome();break;case"settings":r.showSettings();break;case"back":r.back();break;case"forward":break;case"select":o(n);break;case"pageup":break;case"pagedown":break;case"end":break;case"menu":case"info":break;case"next":e.isPlaying()&&e.nextTrack();break;case"previous":e.isPlaying()&&e.previousTrack();break;case"guide":r.showGuide();break;case"recordedtv":r.showRecordedTV();break;case"record":break;case"livetv":r.showLiveTV();break;case"mute":e.mute();break;case"unmute":e.unMute();break;case"togglemute":e.toggleMute();break;case"volumedown":e.volumeDown();break;case"volumeup":e.volumeUp();break;case"play":e.unpause();break;case"pause":e.pause();break;case"playpause":e.playPause();break;case"stop":u("stop")&&e.stop();break;case"changezoom":break;case"changeaudiotrack":break;case"changesubtitletrack":break;case"search":r.showSearch();break;case"favorites":r.showFavorites();break;case"fastforward":e.fastForward();break;case"rewind":e.rewind();break;case"togglefullscreen":break;case"disabledisplaymirror":e.enableDisplayMirroring(!1);break;case"enabledisplaymirror":e.enableDisplayMirroring(!0);break;case"toggledisplaymirror":e.toggleDisplayMirroring();break;case"movies":break;case"music":break;case"tv":break;case"latestepisodes":break;case"nowplaying":break;case"upcomingtv":break;case"nextup":}}var l=(new Date).getTime(),m=0,d={};return s.addEventListener(document,"click",c,{passive:!0}),{trigger:k,handle:k,notify:c,notifyMouseMove:n,idleTime:t,on:i,off:b}});