define(["dialogHelper","globalize","layoutManager","mediaInfo","apphost","connectionManager","require","loading","scrollHelper","scrollStyles","emby-button","emby-collapse","emby-input","paper-icon-button-light","css!./../formdialog","css!./recordingcreator","material-icons"],function(e,t,n,r,i,o,a,c,s){function l(e,t){var n=t.ProgramInfo||{};e.querySelector(".itemName").innerHTML=t.Name,e.querySelector(".itemGenres").innerHTML=(n.Genres||[]).join(" / "),e.querySelector(".itemOverview").innerHTML=n.Overview||"",e.querySelector(".itemMiscInfoPrimary").innerHTML=r.getPrimaryMediaInfoHtml(n),e.querySelector(".itemMiscInfoSecondary").innerHTML=r.getSecondaryMediaInfoHtml(n),e.querySelector("#txtPrePaddingMinutes").value=t.PrePaddingSeconds/60,e.querySelector("#txtPostPaddingMinutes").value=t.PostPaddingSeconds/60;var i=e.querySelector(".timerStatus");"New"==t.Status?i.classList.add("hide"):(i.classList.remove("hide"),i.innerHTML="Status:&nbsp;&nbsp;&nbsp;"+t.Status),c.hide()}function d(t){p=t,e.close(f)}function u(e){c.show();var t=this,n=o.getApiClient(y);return n.getLiveTvTimer(S).then(function(e){e.PrePaddingSeconds=60*t.querySelector("#txtPrePaddingMinutes").value,e.PostPaddingSeconds=60*t.querySelector("#txtPostPaddingMinutes").value,n.updateLiveTvTimer(e).then(function(){c.hide(),a(["toast"],function(e){e(Globalize.translate("MessageRecordingSaved")),d(!0)})})}),e.preventDefault(),!1}function m(e){e.querySelector(".btnCancel").addEventListener("click",function(){d(!1)}),e.querySelector("form").addEventListener("submit",u),e.querySelector(".btnHeaderSave").addEventListener("click",function(){e.querySelector(".btnSubmit").click()})}function v(e,t){c.show(),S=t;var n=o.getApiClient(y);n.getLiveTvTimer(t).then(function(t){l(e,t),c.hide()})}function g(r,i){return new Promise(function(o,l){p=!1,y=i,c.show(),a(["text!./recordingeditor.template.html"],function(i){var a={removeOnClose:!0,scrollY:!1};a.size=n.tv?"fullscreen":"small";var c=e.createDialog(a);c.classList.add("formDialog"),c.classList.add("recordingDialog");var d="";d+=t.translateDocument(i,"sharedcomponents"),c.innerHTML=d,document.body.appendChild(c),f=c,c.addEventListener("close",function(){p?o({updated:!0,deleted:!1}):l()}),n.tv&&s.centerFocus.on(c.querySelector(".formDialogContent"),!1),m(c),v(c,r),e.open(c)})})}var f,S,y,p=!1;return{show:g}});