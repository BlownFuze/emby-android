!function(e){function n(e){function n(n,t){t=t||{};var i=t.uploadPhotos!==!1;return t.cameraUploadServers&&-1==t.cameraUploadServers.indexOf(n.Id)&&(i=!1),i?new Promise(function(i,o){require(["contentuploader"],function(){new MediaBrowser.ContentUploader(e).uploadImages(n).then(function(){r(n,t).then(i,o)},function(){r(n,t).then(i,o)})})}):r(n,t)}function r(n,r){return r.syncOfflineUsers===!1?t(n,r):new Promise(function(i,o){require(["offlineusersync"],function(){var c=e.getApiClient(n.Id);(new MediaBrowser.OfflineUserSync).sync(c,n).then(function(){t(n,r).then(i,o)},function(){o()})})})}function t(n,r){return new Promise(function(t,i){require(["mediasync"],function(){var o=e.getApiClient(n.Id);(new MediaBrowser.MediaSync).sync(o,n,r).then(function(){t()},function(){i()})})})}var i=this;i.sync=function(r,t){if(!r.AccessToken&&!r.ExchangeToken)return new Promise(function(e){e()});var i={updateDateLastAccessed:!1,enableWebSocket:!1,reportCapabilities:!1};return e.connectToServer(r,i).then(function(e){return e.State==MediaBrowser.ConnectionState.SignedIn?n(r,t):Promise.reject()},function(e){throw e})}}e.MediaBrowser||(e.MediaBrowser={}),e.MediaBrowser.ServerSync=n}(this);