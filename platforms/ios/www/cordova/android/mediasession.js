!function(){function e(e){return!window.VlcAudio&&!e}function a(a,t){if(!a.NowPlayingItem)return void l();"init"==t&&(t="positionchange");var n=MediaController.getPlayerInfo().isLocalPlayer||!1,i="Video"==a.NowPlayingItem.MediaType;if(!n||e(i)){var o=a.PlayState||{},r=MediaController.getNowPlayingNameHtml(a.NowPlayingItem)||"",g=r.split("<br/>"),c=1==g.length?"":g[0],y=g[g.length-1];if(i&&g.length>1){var m=c;c=y,y=m}var p=a.NowPlayingItem.Album||"",d=a.NowPlayingItem.Id,I=a.NowPlayingItem.RunTimeTicks?a.NowPlayingItem.RunTimeTicks/1e4:0,P=o.PositionTicks?o.PositionTicks/1e4:0,u=o.IsPaused||!1,h=o.CanSeek||!1,f="",v=400,T=a.NowPlayingItem;T.PrimaryImageTag?f=ApiClient.getScaledImageUrl(T.PrimaryImageItemId,{type:"Primary",height:v,tag:T.PrimaryImageTag}):T.ThumbImageTag?f=ApiClient.getScaledImageUrl(T.ThumbImageItemId,{type:"Thumb",height:v,tag:T.ThumbImageTag}):T.BackdropImageTag&&(f=ApiClient.getScaledImageUrl(T.BackdropItemId,{type:"Backdrop",height:v,tag:T.BackdropImageTag,index:0}));var k=(new Date).getTime();"positionchange"==t&&5e3>k-s||(MainActivity.updateMediaSession(t,n,d,y,c,p,parseInt(I),parseInt(P),f,h,u),s=k)}}function t(e,t){a(t,e.type)}function n(e,a){var n=this;n.beginPlayerUpdates(),t.call(n,e,a)}function i(e){var a=this;a.endPlayerUpdates(),l()}function o(){g&&(Events.off(g,"playbackstart",n),Events.off(g,"playbackstop",i),Events.off(g,"playstatechange",t),Events.off(g,"positionchange",t),g.endPlayerUpdates(),g=null,l())}function l(){MainActivity.hideMediaSession(),s=0}function r(a){o(),(!a.isLocalPlayer||e())&&(g=a,a.getPlayerState().then(function(e){e.NowPlayingItem&&a.beginPlayerUpdates(),t.call(a,{type:"init"},e)}),Events.on(g,"playbackstart",n),Events.on(g,"playbackstop",i),Events.on(g,"playstatechange",t),Events.on(g,"positionchange",t))}var g,s=0;Events.on(MediaController,"playerchange",function(){r(MediaController.getCurrentPlayer())}),r(MediaController.getCurrentPlayer())}();