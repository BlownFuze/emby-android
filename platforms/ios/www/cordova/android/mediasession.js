!function(){function e(e){return!window.VlcAudio&&!e}function t(t,a){if(!t.NowPlayingItem)return void l();"init"==a&&(a="positionchange");var n=MediaController.getPlayerInfo().isLocalPlayer||!1,i="Video"==t.NowPlayingItem.MediaType;if(!n||e(i)){var o=t.PlayState||{},g=MediaController.getNowPlayingNameHtml(t.NowPlayingItem)||"",r=g.split("<br/>"),y=1==r.length?"":r[0],c=r[r.length-1];if(i&&r.length>1){var m=y;y=c,c=m}var p=t.NowPlayingItem.Album||"",d=t.NowPlayingItem.Id,I=t.NowPlayingItem.RunTimeTicks?t.NowPlayingItem.RunTimeTicks/1e4:0,P=o.PositionTicks?o.PositionTicks/1e4:0,u=o.IsPaused||!1,h=o.CanSeek||!1,f="",v=400,T=t.NowPlayingItem;T.PrimaryImageTag?f=ApiClient.getScaledImageUrl(T.PrimaryImageItemId,{type:"Primary",height:v,tag:T.PrimaryImageTag}):T.ThumbImageTag?f=ApiClient.getScaledImageUrl(T.ThumbImageItemId,{type:"Thumb",height:v,tag:T.ThumbImageTag}):T.BackdropImageTag&&(f=ApiClient.getScaledImageUrl(T.BackdropItemId,{type:"Backdrop",height:v,tag:T.BackdropImageTag,index:0}));var w=(new Date).getTime();"positionchange"==a&&5e3>w-s||(MainActivity.updateMediaSession(a,n,d,c,y,p,parseInt(I),parseInt(P),f,h,u),s=w)}}function a(e,a){t(a,e.type)}function n(e,t){Logger.log("nowplaying event: "+e.type);var n=this;n.beginPlayerUpdates(),a.call(n,e,t)}function i(e){Logger.log("nowplaying event: "+e.type);var t=this;t.endPlayerUpdates(),l()}function o(){r&&(Events.off(r,"playbackstart",n),Events.off(r,"playbackstop",i),Events.off(r,"playstatechange",a),Events.off(r,"positionchange",a),r.endPlayerUpdates(),r=null,l())}function l(){MainActivity.hideMediaSession(),s=0}function g(t){o(),(!t.isLocalPlayer||e())&&(r=t,Logger.log("binding remotecontrols to "+t.name),t.getPlayerState().then(function(e){e.NowPlayingItem&&t.beginPlayerUpdates(),a.call(t,{type:"init"},e)}),Events.on(r,"playbackstart",n),Events.on(r,"playbackstop",i),Events.on(r,"playstatechange",a),Events.on(r,"positionchange",a))}var r,s=0;Logger.log("binding remotecontrols to MediaController"),Events.on(MediaController,"playerchange",function(){g(MediaController.getCurrentPlayer())}),g(MediaController.getCurrentPlayer())}();