!function(e,n){e.MediaBrowser||(e.MediaBrowser={}),e.MediaBrowser.CredentialProvider=function(e){function r(){if(!o){var r=appStorage.getItem(e)||"{}";Logger.log("credentials initialized with: "+r),o=n.parse(r),o.Servers=o.Servers||[]}}function s(){return r(),o}function a(r){r?(o=r,appStorage.setItem(e,n.stringify(r))):t.clear(),Events.trigger(t,"credentialsupdated")}var t=this,o=null;e=e||"servercredentials3",t.clear=function(){o=null,appStorage.removeItem(e)},t.credentials=function(e){return e&&a(e),s()},t.addOrUpdateServer=function(e,n){if(!n.Id)throw new Error("Server.Id cannot be null or empty");var r=e.filter(function(e){return e.Id==n.Id})[0];return r?(r.DateLastAccessed=Math.max(r.DateLastAccessed||0,n.DateLastAccessed||0),r.UserLinkType=n.UserLinkType,n.AccessToken&&(r.AccessToken=n.AccessToken,r.UserId=n.UserId),n.ExchangeToken&&(r.ExchangeToken=n.ExchangeToken),n.RemoteAddress&&(r.RemoteAddress=n.RemoteAddress),n.ManualAddress&&(r.ManualAddress=n.ManualAddress),n.LocalAddress&&(r.LocalAddress=n.LocalAddress),n.Name&&(r.Name=n.Name),n.WakeOnLanInfos&&n.WakeOnLanInfos.length&&(r.WakeOnLanInfos=n.WakeOnLanInfos),null!=n.LastConnectionMode&&(r.LastConnectionMode=n.LastConnectionMode),n.ConnectServerId&&(r.ConnectServerId=n.ConnectServerId),r.DateLastLocalConnection=Math.max(r.DateLastLocalConnection||0,n.DateLastLocalConnection||0),r):(e.push(n),n)},t.addOrUpdateUser=function(e,n){e.Users=e.Users||[];var r=e.Users.filter(function(e){return e.Id==n.Id})[0];r?r.IsSignedInOffline=!0:e.Users.push(n)}}}(window,window.JSON);