!function(e,t){function a(t,a,n){e("#chkSubtitlesMovies",t).checked(a.DownloadMovieSubtitles).checkboxradio("refresh"),e("#chkSubtitlesEpisodes",t).checked(a.DownloadEpisodeSubtitles).checkboxradio("refresh"),e("#chkSkipIfGraphicalSubsPresent",t).checked(a.SkipIfGraphicalSubtitlesPresent).checkboxradio("refresh"),e("#chkSkipIfAudioTrackPresent",t).checked(a.SkipIfAudioTrackMatches).checkboxradio("refresh"),e("#txtOpenSubtitleUsername",t).val(a.OpenSubtitlesUsername),e("#txtOpenSubtitlePassword",t).val(""),i(t,a,n),Dashboard.hideLoadingMsg()}function i(t,a,i){for(var n='<div data-role="controlgroup" style="margin:0;">',s=0,o=i.length;o>s;s++){var r=i[s],c="chkSubtitleLanguage"+s;n+='<label style="font-size:13px;" for="'+c+'">'+r.DisplayName+"</label>",n+='<input class="chkLang" data-lang="'+r.ThreeLetterISOLanguageName.toLowerCase()+'" type="checkbox" id="'+c+'" />'}n+="</div>",e(".downloadLanguages",t).html(n).trigger("create");var u=a.DownloadLanguages||[];e(".chkLang",t).each(function(){this.checked=-1!=u.indexOf(this.getAttribute("data-lang"))}).checkboxradio("refresh")}function n(){Dashboard.showLoadingMsg();var t=this;return ApiClient.getNamedConfiguration("subtitles").then(function(a){a.DownloadMovieSubtitles=e("#chkSubtitlesMovies",t).checked(),a.DownloadEpisodeSubtitles=e("#chkSubtitlesEpisodes",t).checked(),a.SkipIfGraphicalSubtitlesPresent=e("#chkSkipIfGraphicalSubsPresent",t).checked(),a.SkipIfAudioTrackMatches=e("#chkSkipIfAudioTrackPresent",t).checked(),a.OpenSubtitlesUsername=e("#txtOpenSubtitleUsername",t).val();var i=e("#txtOpenSubtitlePassword",t).val();i&&(a.OpenSubtitlesPasswordHash=i),a.DownloadLanguages=e(".chkLang:checked",t).get().map(function(e){return e.getAttribute("data-lang")}),ApiClient.updateNamedConfiguration("subtitles",a).then(Dashboard.processServerConfigurationUpdateResult)}),!1}e(t).on("pageinit","#metadataSubtitlesPage",function(){e(".metadataSubtitlesForm").off("submit",n).on("submit",n)}).on("pageshow","#metadataSubtitlesPage",function(){Dashboard.showLoadingMsg();var e=this,t=ApiClient.getNamedConfiguration("subtitles"),i=ApiClient.getCultures();Promise.all([t,i]).then(function(t){a(e,t[0],t[1])})})}(jQuery,document,window);