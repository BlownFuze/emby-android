define(["jQuery"],function(e){function i(e,i){require(["confirm"],function(e){e(Globalize.translate("MessageConfirmRecordingCancellation"),Globalize.translate("HeaderConfirmRecordingCancellation")).then(function(){Dashboard.showLoadingMsg(),ApiClient.cancelLiveTvTimer(i).then(function(){require(["toast"],function(e){e(Globalize.translate("MessageRecordingCancelled"))}),Dashboard.navigate("livetv.html")})})})}function t(i,t){r=t;var n=t.ProgramInfo||{};if(e(".itemName",i).html(t.Name),e(".itemEpisodeName",i).html(n.EpisodeTitle||""),e(".itemCommunityRating",i).html(LibraryBrowser.getRatingHtml(n)),LibraryBrowser.renderGenres(e(".itemGenres",i),n),LibraryBrowser.renderOverview(i.querySelectorAll(".itemOverview"),n),n.ImageTags&&n.ImageTags.Primary){var a=ApiClient.getScaledImageUrl(n.Id,{maxWidth:200,maxHeight:200,tag:n.ImageTags.Primary,type:"Primary"});e(".timerPageImageContainer",i).css("display","inline-block").html('<img src="'+a+'" style="max-width:200px;max-height:200px;" />')}else e(".timerPageImageContainer",i).hide();e(".itemMiscInfo",i).html(LibraryBrowser.getMiscInfoHtml(n)),e("#txtPrePaddingMinutes",i).val(t.PrePaddingSeconds/60),e("#txtPostPaddingMinutes",i).val(t.PostPaddingSeconds/60),"New"==t.Status?e(".timerStatus",i).hide():e(".timerStatus",i).show().html("Status:&nbsp;&nbsp;&nbsp;"+t.Status),Dashboard.hideLoadingMsg()}function n(){Dashboard.showLoadingMsg();var i=this;return ApiClient.getLiveTvTimer(r.Id).then(function(t){t.PrePaddingSeconds=60*e("#txtPrePaddingMinutes",i).val(),t.PostPaddingSeconds=60*e("#txtPostPaddingMinutes",i).val(),ApiClient.updateLiveTvTimer(t).then(function(){Dashboard.hideLoadingMsg(),require(["toast"],function(e){e(Globalize.translate("MessageRecordingSaved"))})})}),!1}function a(e){Dashboard.showLoadingMsg();var i=getParameterByName("id");ApiClient.getLiveTvTimer(i).then(function(i){t(e,i)})}var r;e(document).on("pageinit","#liveTvTimerPage",function(){var t=this;e("#btnCancelTimer",t).on("click",function(){i(t,r.Id)}),e(".liveTvTimerForm").off("submit",n).on("submit",n)}).on("pagebeforeshow","#liveTvTimerPage",function(){var e=this;a(e)}).on("pagebeforehide","#liveTvTimerPage",function(){r=null})});