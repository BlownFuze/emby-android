!function(e,i,a){function t(e,i){Dashboard.confirm(Globalize.translate("MessageConfirmRecordingCancellation"),Globalize.translate("HeaderConfirmRecordingCancellation"),function(e){e&&(Dashboard.showLoadingMsg(),ApiClient.cancelLiveTvTimer(i).then(function(){Dashboard.alert(Globalize.translate("MessageRecordingCancelled")),Dashboard.navigate("livetv.html")}))})}function n(e,a){s=a;var t=a.ProgramInfo||{};if(i(".itemName",e).html(a.Name),i(".itemEpisodeName",e).html(t.EpisodeTitle||""),i(".itemCommunityRating",e).html(LibraryBrowser.getRatingHtml(t)),LibraryBrowser.renderGenres(i(".itemGenres",e),t),LibraryBrowser.renderOverview(e.querySelectorAll(".itemOverview"),t),t.ImageTags&&t.ImageTags.Primary){var n=ApiClient.getScaledImageUrl(t.Id,{maxWidth:200,maxHeight:200,tag:t.ImageTags.Primary,type:"Primary"});i(".timerPageImageContainer",e).css("display","inline-block").html('<img src="'+n+'" style="max-width:200px;max-height:200px;" />')}else i(".timerPageImageContainer",e).hide();i(".itemMiscInfo",e).html(LibraryBrowser.getMiscInfoHtml(t)),i("#txtPrePaddingMinutes",e).val(a.PrePaddingSeconds/60),i("#txtPostPaddingMinutes",e).val(a.PostPaddingSeconds/60),"New"==a.Status?i(".timerStatus",e).hide():i(".timerStatus",e).show().html("Status:&nbsp;&nbsp;&nbsp;"+a.Status),Dashboard.hideLoadingMsg()}function r(){Dashboard.showLoadingMsg();var e=this;return ApiClient.getLiveTvTimer(s.Id).then(function(a){a.PrePaddingSeconds=60*i("#txtPrePaddingMinutes",e).val(),a.PostPaddingSeconds=60*i("#txtPostPaddingMinutes",e).val(),ApiClient.updateLiveTvTimer(a).then(function(){Dashboard.hideLoadingMsg(),Dashboard.alert(Globalize.translate("MessageRecordingSaved"))})}),!1}function o(e){Dashboard.showLoadingMsg();var i=getParameterByName("id");ApiClient.getLiveTvTimer(i).then(function(i){n(e,i)})}var s;i(a).on("pageinit","#liveTvTimerPage",function(){var e=this;i("#btnCancelTimer",e).on("click",function(){t(e,s.Id)}),i(".liveTvTimerForm").off("submit",r).on("submit",r)}).on("pagebeforeshow","#liveTvTimerPage",function(){var e=this;o(e)}).on("pagebeforehide","#liveTvTimerPage",function(){s=null})}(window,jQuery,document);