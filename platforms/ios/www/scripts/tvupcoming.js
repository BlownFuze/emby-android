define(["datetime","libraryBrowser","cardBuilder","scrollStyles","emby-itemscontainer"],function(e,t,r){function a(e,t){Dashboard.showLoadingMsg();var r={Limit:40,Fields:"AirTime,UserData",UserId:Dashboard.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",EnableTotalRecordCount:!1};return r.ParentId=t.topParentId,ApiClient.getJSON(ApiClient.getUrl("Shows/Upcoming",r))}function n(e,t,r){r.then(function(t){var r=t.Items;e.querySelector(".noItemsMessage").style.display=r.length?"none":"block";var a=e.querySelector("#upcomingItems");s(a,r),Dashboard.hideLoadingMsg()})}function i(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function o(){return i()?"overflowBackdrop":"backdrop"}function s(a,n){var s,l,d=[],c="",m=[];for(s=0,l=n.length;l>s;s++){var u=n[s],h="";if(u.PremiereDate)try{var p=e.parseISO8601Date(u.PremiereDate,!0);h=e.isRelativeDay(p,-1)?Globalize.translate("Yesterday"):t.getFutureDateText(p,!0)}catch(g){}h!=c?(m.length&&d.push({name:c,items:m}),c=h,m=[u]):m.push(u)}var y="";for(s=0,l=d.length;l>s;s++){var v=d[s];y+='<div class="homePageSection">',y+='<h1 class="listHeader">'+v.name+"</h1>";var b=!0;i()?(b=!1,y+='<div is="emby-itemscontainer" class="itemsContainer hiddenScrollX">'):y+='<div is="emby-itemscontainer" class="itemsContainer vertical-wrap">',y+=r.getCardsHtml({items:v.items,showLocationTypeIndicator:!1,shape:o(),showTitle:!0,preferThumb:!0,lazy:!0,showDetailsMenu:!0,centerText:!0,overlayMoreButton:!0,showParentTitle:!0,allowBottomPadding:b}),y+="</div>",y+="</div>"}a.innerHTML=y,ImageLoader.lazyChildren(a)}return function(e,t,r){var i,o=this;o.preRender=function(){i=a(e,t)},o.renderTab=function(){n(r,t,i)}}});