!function(e,t,n){function a(e,t){var n=Globalize.translate("DeleteUserConfirmation");require(["confirm"],function(a){a(n,Globalize.translate("DeleteUser")).then(function(){Dashboard.showLoadingMsg(),ApiClient.deleteUser(t).then(function(){p(e)})})})}function i(e){var t=n(e).parents(".card")[0],i=n(t).parents(".page")[0],r=t.getAttribute("data-userid"),o=[];o.push({name:Globalize.translate("ButtonOpen"),id:"open",ironIcon:"mode-edit"}),o.push({name:Globalize.translate("ButtonLibraryAccess"),id:"access",ironIcon:"lock"}),o.push({name:Globalize.translate("ButtonParentalControl"),id:"parentalcontrol",ironIcon:"person"}),o.push({name:Globalize.translate("ButtonDelete"),id:"delete",ironIcon:"delete"}),require(["actionsheet"],function(e){e.show({items:o,positionTo:t,callback:function(e){switch(e){case"open":Dashboard.navigate("useredit.html?userid="+r);break;case"access":Dashboard.navigate("userlibraryaccess.html?userid="+r);break;case"parentalcontrol":Dashboard.navigate("userparentalcontrol.html?userid="+r);break;case"delete":a(i,r)}}})})}function r(e,t){var n="",a="card squareCard bottomPaddedCard";e.Policy.IsDisabled&&(a+=" grayscale"),n+="<div data-userid='"+e.Id+"' class='"+a+"'>",n+='<div class="cardBox visualCardBox">',n+='<div class="cardScalable">',n+='<div class="cardPadder"></div>';var i="useredit.html?userId="+e.Id;n+='<a class="cardContent" href="'+i+'">';var r;r=e.PrimaryImageTag?ApiClient.getUserImageUrl(e.Id,{width:300,tag:e.PrimaryImageTag,type:"Primary"}):"css/images/userflyoutdefault.png";var o="cardImage";return e.Policy.IsDisabled&&(o+=" disabledUser"),n+='<div class="'+o+'" style="background-image:url(\''+r+"');\">",e.ConnectUserId&&t&&(n+='<div class="playedIndicator" title="'+Globalize.translate("TooltipLinkedToEmbyConnect")+'"><iron-icon icon="cloud"></iron-icon></div>'),n+="</div>",n+="</a>",n+="</div>",n+='<div class="cardFooter">',n+='<div class="cardText" style="text-align:right; float:right;padding:0;">',n+='<paper-icon-button icon="'+AppInfo.moreIcon+'" class="btnUserMenu"></paper-icon-button>',n+="</div>",n+='<div class="cardText" style="padding-top:10px;padding-bottom:10px;">',n+=e.Name,n+="</div>",n+="</div>",n+="</div>",n+="</div>"}function o(e,t){var n="";return n+=e.map(function(e){return r(e,t)}).join("")}function s(e,t,a){var r=o(t,a);e.html(r).trigger("create"),n(".btnUserMenu",e).on("click",function(){i(this)})}function d(e,t){s(n(".localUsers",e),t.filter(function(e){return"Guest"!=e.ConnectLinkType}),!0),s(n(".connectUsers",e),t.filter(function(e){return"Guest"==e.ConnectLinkType}))}function c(e){var t=[];t.push({name:Globalize.translate("ButtonCancel"),id:"delete",ironIcon:"delete"}),require(["actionsheet"],function(a){var i=n(e).parents(".card"),r=n(e).parents(".page"),o=i.attr("data-id");a.show({items:t,positionTo:i,callback:function(e){switch(e){case"delete":g(r,o)}}})})}function l(e){var t="",n="card squareCard bottomPaddedCard";t+="<div data-id='"+e.Id+"' class='"+n+"'>",t+='<div class="cardBox visualCardBox">',t+='<div class="cardScalable">',t+='<div class="cardPadder"></div>';var a="#";t+='<a class="cardContent" href="'+a+'">';var i=e.ImageUrl||"css/images/userflyoutdefault.png";return t+='<div class="cardImage" style="background-image:url(\''+i+"');\">",t+="</div>",t+="</a>",t+="</div>",t+='<div class="cardFooter">',t+='<div class="cardText" style="text-align:right; float:right;padding:0;">',t+='<paper-icon-button icon="'+AppInfo.moreIcon+'" class="btnUserMenu"></paper-icon-button>',t+="</div>",t+='<div class="cardText" style="padding-top:10px;padding-bottom:10px;">',t+=e.UserName,t+="</div>",t+="</div>",t+="</div>",t+="</div>"}function u(e,t){t.length?n(".sectionPendingGuests",e).show():n(".sectionPendingGuests",e).hide();var a=t.map(l).join(""),i=n(".pending",e).html(a).trigger("create");n(".btnUserMenu",i).on("click",function(){c(this)})}function g(e,t){Dashboard.showLoadingMsg(),ApiClient.ajax({type:"DELETE",url:ApiClient.getUrl("Connect/Pending",{Id:t})}).then(function(){p(e)})}function p(e){Dashboard.showLoadingMsg(),ApiClient.getUsers().then(function(t){d(e,t),Dashboard.hideLoadingMsg()}),ApiClient.getJSON(ApiClient.getUrl("Connect/Pending")).then(function(t){u(e,t)})}function v(e){Dashboard.getCurrentUser().then(function(t){if(!t.ConnectUserId){var n=Globalize.translate("MessageConnectAccountRequiredToInviteGuest");return n+="<br/>",n+="<br/>",n+='<a href="useredit.html?userId='+t.Id+'">'+Globalize.translate("ButtonLinkMyEmbyAccount")+"</a>",n+="<br/>",void Dashboard.alert({message:n,title:Globalize.translate("HeaderInviteGuest")})}require(["components/guestinviter/guestinviter"],function(t){t.show().then(function(){p(e)})})})}n(e).on("pageinit","#userProfilesPage",function(){var e=this;n(".btnInvite",e).on("click",function(){v(e)}),n(".btnAddUser",e).on("click",function(){Dashboard.navigate("usernew.html")})}).on("pagebeforeshow","#userProfilesPage",function(){var e=this;p(e)})}(document,window,jQuery);