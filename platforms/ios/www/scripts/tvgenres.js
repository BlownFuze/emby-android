define(["libraryBrowser"],function(e){return function(t,r,n){function o(){var t=i(),n=c[t];return n||(n=c[t]={query:{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Series",Recursive:!0,Fields:"DateCreated,SyncInfo,ItemCounts",StartIndex:0},view:e.getSavedView(t)||e.getDefaultItemsView("Thumb","Thumb")},n.query.ParentId=r.topParentId,e.loadSavedQueryValues(t,n.query)),n}function a(){return o().query}function i(){return e.getSavedQueryKey("genres")}function u(){Dashboard.showLoadingMsg();var e=a();return ApiClient.getGenres(Dashboard.getCurrentUserId(),e)}function s(t,r){var n=a();r.then(function(r){var o="",a=l.getCurrentViewStyle();"Thumb"==a?o=e.getPosterViewHtml({items:r.Items,shape:"backdrop",preferThumb:!0,context:"tv",showItemCounts:!0,centerText:!0,lazy:!0,overlayMoreButton:!0}):"ThumbCard"==a?o=e.getPosterViewHtml({items:r.Items,shape:"backdrop",preferThumb:!0,context:"tv",showItemCounts:!0,cardLayout:!0,showTitle:!0,lazy:!0}):"PosterCard"==a?o=e.getPosterViewHtml({items:r.Items,shape:"portrait",context:"tv",showItemCounts:!0,lazy:!0,cardLayout:!0,showTitle:!0}):"Poster"==a&&(o=e.getPosterViewHtml({items:r.Items,shape:"portrait",context:"tv",centerText:!0,showItemCounts:!0,lazy:!0,overlayMoreButton:!0}));var u=t.querySelector("#items");u.innerHTML=o,ImageLoader.lazyChildren(u),e.saveQueryValues(i(),n),Dashboard.hideLoadingMsg()})}function d(){l.preRender(),l.renderTab()}var l=this,c={};l.getViewStyles=function(){return"Poster,PosterCard,Thumb,ThumbCard".split(",")},l.getCurrentViewStyle=function(){return o(n).view},l.setCurrentViewStyle=function(t){o(n).view=t,e.saveViewSetting(i(n),t),d()},l.enableViewSelection=!0;var y;l.preRender=function(){y=u()},l.renderTab=function(){s(n,y)};var m=n.querySelector(".btnSelectView");m.addEventListener("click",function(t){e.showLayoutMenu(t.target,l.getCurrentViewStyle(),l.getViewStyles())}),m.addEventListener("layoutchange",function(e){l.setCurrentViewStyle(e.detail.viewStyle)})}});