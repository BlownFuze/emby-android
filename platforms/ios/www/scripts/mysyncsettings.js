define(["appSettings","jQuery"],function(e,t){function r(t){t.querySelector("#txtSyncPath").value=e.syncPath(),t.querySelector("#chkWifi").checked=e.syncOnlyOnWifi();var r=e.cameraUploadServers();t.querySelector(".uploadServerList").innerHTML=ConnectionManager.getSavedServers().map(function(e){var t=-1==r.indexOf(e.Id)?"":" checked",n="<paper-checkbox"+t+' class="chkUploadServer" data-id="'+e.Id+'">'+e.Name+"</paper-checkbox>";return n}).join(""),Dashboard.hideLoadingMsg()}function n(r){var n=r.querySelector("#txtSyncPath").value;e.syncPath(n),e.syncOnlyOnWifi(r.querySelector("#chkWifi").checked);var a=t(".chkUploadServer",r).get().filter(function(e){return e.checked}).map(function(e){return e.getAttribute("data-id")});e.cameraUploadServers(a),Dashboard.hideLoadingMsg(),require(["toast"],function(e){e(Globalize.translate("SettingsSaved"))}),(a.length||n)&&window.MainActivity&&MainActivity.authorizeStorage()}function a(){var e=t(this).parents(".page")[0];Dashboard.showLoadingMsg();var r=getParameterByName("userId")||Dashboard.getCurrentUserId();return ApiClient.getUser(r).then(function(t){n(e,t)}),!1}t(document).on("pageinit","#syncPreferencesPage",function(){var e=this;t("form",e).off("submit",a).on("submit",a),t(".btnSelectSyncPath",e).on("click",function(){require(["nativedirectorychooser"],function(){NativeDirectoryChooser.chooseDirectory().then(function(r){t("#txtSyncPath",e).val(r)})})})}).on("pageshow","#syncPreferencesPage",function(){var e=this;Dashboard.showLoadingMsg();var t=getParameterByName("userId")||Dashboard.getCurrentUserId();ApiClient.getUser(t).then(function(t){r(e,t)}),AppInfo.supportsSyncPathSetting?e.querySelector(".fldSyncPath").classList.remove("hide"):e.querySelector(".fldSyncPath").classList.add("hide")})});