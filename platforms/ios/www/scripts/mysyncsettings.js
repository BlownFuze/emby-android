define(["appSettings","jQuery"],function(e,t){function n(t){t.querySelector("#txtSyncPath").value=e.syncPath()||"",t.querySelector("#chkWifi").checked=e.syncOnlyOnWifi();var n=e.cameraUploadServers();t.querySelector(".uploadServerList").innerHTML=ConnectionManager.getSavedServers().map(function(e){var t=-1==n.indexOf(e.Id)?"":" checked",r='<label><input type="checkbox" is="emby-checkbox"'+t+' class="chkUploadServer" data-id="'+e.Id+'"/><span>'+e.Name+"</span></label>";return r}).join(""),Dashboard.hideLoadingMsg()}function r(n){var r=n.querySelector("#txtSyncPath").value;e.syncPath(r),e.syncOnlyOnWifi(n.querySelector("#chkWifi").checked);var a=t(".chkUploadServer",n).get().filter(function(e){return e.checked}).map(function(e){return e.getAttribute("data-id")});e.cameraUploadServers(a),Dashboard.hideLoadingMsg(),require(["toast"],function(e){e(Globalize.translate("SettingsSaved"))}),(a.length||r)&&window.MainActivity&&MainActivity.authorizeStorage()}function a(){var e=t(this).parents(".page")[0];Dashboard.showLoadingMsg();var n=getParameterByName("userId")||Dashboard.getCurrentUserId();return ApiClient.getUser(n).then(function(t){r(e,t)}),!1}t(document).on("pageinit","#syncPreferencesPage",function(){var e=this;t("form",e).off("submit",a).on("submit",a),t("#btnSelectSyncPath",e).on("click",function(){require(["nativedirectorychooser"],function(){NativeDirectoryChooser.chooseDirectory().then(function(n){n&&t("#txtSyncPath",e).val(n)})})})}).on("pageshow","#syncPreferencesPage",function(){var e=this;Dashboard.showLoadingMsg();var t=getParameterByName("userId")||Dashboard.getCurrentUserId();ApiClient.getUser(t).then(function(t){n(e,t)}),AppInfo.supportsSyncPathSetting?e.querySelector(".fldSyncPath").classList.remove("hide"):e.querySelector(".fldSyncPath").classList.add("hide")})});