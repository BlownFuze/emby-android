define(["scrollHelper","viewManager","appSettings","appStorage","apphost","datetime","itemHelper","mediaInfo","scrollStyles"],function(e,a,t,r,i,n,s,o){function l(e,a){for(;!e.classList||!e.classList.contains(a);)if(e=e.parentNode,!e)return null;return e}function d(e){var a=browserInfo.mobile?"2.5%":"0.5%",t=[{opacity:"0",transform:"translate3d("+a+", 0, 0)",offset:0},{opacity:"1",transform:"none",offset:1}];e.animate(t,{duration:160,iterations:1,easing:"ease-out"})}function u(e){var a=e.querySelector(".pageTabButtonSelectionBar");if(a){var t=[{transform:"translate3d(-100%, 0, 0)",offset:0},{transform:"none",offset:1}];a.animate&&a.animate(t,{duration:120,iterations:1,easing:"ease-out"})}}var m=function(e,m,c){function p(e){return e.replace(/&/g,"&amp;").replace(h,function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return"&#"+(1024*(a-55296)+(t-56320)+65536)+";"}).replace(b,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function g(e){if(e){if(e=e.toLowerCase(),-1!=e.indexOf("portrait"))return 2/3;if(-1!=e.indexOf("backdrop"))return 16/9;if(-1!=e.indexOf("square"))return 1}return null}var h=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b=/([^\#-~| |!])/g,y="pagesize_v4",I={getDefaultPageSize:function(e,a){return 100},getDefaultItemsView:function(e,a){return browserInfo.mobile?a:e},getSavedQueryKey:function(a){return e.location.href.split("#")[0]+(a||"")},loadSavedQueryValues:function(e,a){var t=r.getItem(e+"_"+Dashboard.getCurrentUserId());return t?(t=JSON.parse(t),Object.assign(a,t)):a},saveQueryValues:function(e,a){var t={};a.SortBy&&(t.SortBy=a.SortBy),a.SortOrder&&(t.SortOrder=a.SortOrder);try{r.setItem(e+"_"+Dashboard.getCurrentUserId(),JSON.stringify(t))}catch(i){}},saveViewSetting:function(e,a){try{r.setItem(e+"_"+Dashboard.getCurrentUserId()+"_view",a)}catch(t){}},getSavedView:function(e){var a=r.getItem(e+"_"+Dashboard.getCurrentUserId()+"_view");return a},getSavedViewSetting:function(e){return new Promise(function(a){var t=LibraryBrowser.getSavedView(e);a(t)})},allowSwipe:function(e){function a(e){return e.classList?!e.classList.contains("hiddenScrollX")&&!e.classList.contains("smoothScrollX")&&!e.classList.contains("libraryViewNav"):!0}for(var t=e;null!=t;){if(!a(t))return!1;t=t.parentNode}return!0},selectedTab:function(e,a){if(null==a)return e.selectedTabIndex||0;var t=LibraryBrowser.selectedTab(e);if(e.selectedTabIndex=a,t==a)e.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:a}}));else{var r=e.querySelectorAll(".pageTabButton");r[a].click()}},configureSwipeTabs:function(e,a){var t=e.querySelectorAll(".pageTabContent").length;require(["hammer"],function(r){var i=new r(e);i.get("swipe").set({direction:r.DIRECTION_HORIZONTAL}),i.on("swipeleft",function(e){if(LibraryBrowser.allowSwipe(e.target)){var r=parseInt(LibraryBrowser.selectedTab(a)||"0");t-1>r&&LibraryBrowser.selectedTab(a,r+1)}}),i.on("swiperight",function(e){if(LibraryBrowser.allowSwipe(e.target)){var t=parseInt(LibraryBrowser.selectedTab(a)||"0");t>0&&LibraryBrowser.selectedTab(a,t-1)}})})},configurePaperLibraryTabs:function(e,a,t,r){if(browserInfo.safari||LibraryBrowser.configureSwipeTabs(e,a),!browserInfo.safari||!AppInfo.isNativeApp)for(var i=a.querySelectorAll(".pageTabButton"),n=0,s=i.length;s>n;n++){var o=m.createElement("div");o.classList.add("pageTabButtonSelectionBar"),i[n].appendChild(o)}a.classList.add("hiddenScrollX"),a.addEventListener("click",function(e){var i=a.querySelector(".is-active"),n=l(e.target,"pageTabButton");if(n&&n!=i){i&&(i.classList.remove("is-active"),t[parseInt(i.getAttribute("data-index"))].classList.remove("is-active")),n.classList.add("is-active"),u(n);var s=parseInt(n.getAttribute("data-index")),o=t[s];setTimeout(function(){r&&-1!=r.indexOf(s)&&o.animate&&d(o),a.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:s}})),o.classList.add("is-active")},120)}}),e.addEventListener("viewbeforeshow",LibraryBrowser.onTabbedpagebeforeshow)},onTabbedpagebeforeshow:function(e){var a=e.target,t=0,r=!1;a.getAttribute("data-firstload")||(t=300,r=!0,a.setAttribute("data-firstload","1")),t?setTimeout(function(){LibraryBrowser.onTabbedpagebeforeshowInternal(a,e,r)},t):LibraryBrowser.onTabbedpagebeforeshowInternal(a,e,r)},onTabbedpagebeforeshowInternal:function(e,a,t){var r=e.querySelector(".libraryViewNav");if(t){var i=null!=e.firstTabIndex?e.firstTabIndex:parseInt(getParameterByName("tab")||"0");LibraryBrowser.selectedTab(r,i)}else{if(!a.detail.isRestored)return void LibraryBrowser.selectedTab(r,0);r.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:LibraryBrowser.selectedTab(r)}}))}},showTab:function(t,r){var i=function(){m.removeEventListener("pagebeforeshow",i),-1!=e.location.href.toLowerCase().indexOf(t.toLowerCase())&&(this.firstTabIndex=r)};-1!=e.location.href.toLowerCase().indexOf(t.toLowerCase())?i.call(a.currentView()):(pageClassOn("pagebeforeshow","page",i),Dashboard.navigate(t))},canShare:function(e,a){return"Timer"==e.Type?!1:a.Policy.EnablePublicSharing},getDateParamValue:function(e){function a(e){return 10>e?"0"+e:e}var t=e;return""+t.getFullYear()+a(t.getMonth()+1)+a(t.getDate())+a(t.getHours())+a(t.getMinutes())+a(t.getSeconds())},playAllFromHere:function(e,a){e(a,100,"MediaSources,Chapters").then(function(e){MediaController.play({items:e.Items})})},queueAllFromHere:function(e,a){fn(a,100,"MediaSources,Chapters").then(function(e){MediaController.queue({items:e.Items})})},getItemCountsHtml:function(e,a){var t,r=[];if("Playlist"==a.Type){if(t="",a.CumulativeRunTimeTicks){var i=a.CumulativeRunTimeTicks/6e8;i=i||1,t+=Globalize.translate("ValueMinutes",Math.round(i))}else t+=Globalize.translate("ValueMinutes",0);r.push(t)}else"movies"==e.context?(a.MovieCount&&(t=1==a.MovieCount?Globalize.translate("ValueOneMovie"):Globalize.translate("ValueMovieCount",a.MovieCount),r.push(t)),a.TrailerCount&&(t=1==a.TrailerCount?Globalize.translate("ValueOneTrailer"):Globalize.translate("ValueTrailerCount",a.TrailerCount),r.push(t))):"tv"==e.context?(a.SeriesCount&&(t=1==a.SeriesCount?Globalize.translate("ValueOneSeries"):Globalize.translate("ValueSeriesCount",a.SeriesCount),r.push(t)),a.EpisodeCount&&(t=1==a.EpisodeCount?Globalize.translate("ValueOneEpisode"):Globalize.translate("ValueEpisodeCount",a.EpisodeCount),r.push(t))):"games"==e.context?a.GameCount&&(t=1==a.GameCount?Globalize.translate("ValueOneGame"):Globalize.translate("ValueGameCount",a.GameCount),r.push(t)):"music"==e.context&&(a.AlbumCount&&(t=1==a.AlbumCount?Globalize.translate("ValueOneAlbum"):Globalize.translate("ValueAlbumCount",a.AlbumCount),r.push(t)),a.SongCount&&(t=1==a.SongCount?Globalize.translate("ValueOneSong"):Globalize.translate("ValueSongCount",a.SongCount),r.push(t)),a.MusicVideoCount&&(t=1==a.MusicVideoCount?Globalize.translate("ValueOneMusicVideo"):Globalize.translate("ValueMusicVideoCount",a.MusicVideoCount),r.push(t)));return r.join(" â€¢ ")},getArtistLinksHtml:function(e,a){for(var t=[],r=0,i=e.length;i>r;r++){var n=e[r],s=a?' class="'+a+'"':"";t.push("<a"+s+' href="itemdetails.html?id='+n.Id+'">'+n.Name+"</a>")}return t=t.join(" / ")},playInExternalPlayer:function(e){Dashboard.loadExternalPlayer().then(function(){ExternalPlayer.showMenu(e)})},showPlayMenu:function(e,a,r,i,n,s){var o=AppInfo.supportsExternalPlayers&&t.enableExternalPlayers();if(!(s||"Audio"==n||i||o&&"Video"==n))return void MediaController.play(a);var l=[];s&&l.push({name:Globalize.translate("ButtonResume"),id:"resume",ironIcon:"play-arrow"}),l.push({name:Globalize.translate("ButtonPlay"),id:"play",ironIcon:"play-arrow"}),!i&&o&&"Audio"!=n&&l.push({name:Globalize.translate("ButtonPlayExternalPlayer"),id:"externalplayer",ironIcon:"airplay"}),MediaController.canQueueMediaType(n,r)&&l.push({name:Globalize.translate("ButtonQueue"),id:"queue",ironIcon:"playlist-add"}),("Audio"==r||"MusicAlbum"==r||"MusicArtist"==r||"MusicGenre"==r)&&l.push({name:Globalize.translate("ButtonInstantMix"),id:"instantmix",ironIcon:"shuffle"}),(i||"MusicArtist"==r||"MusicGenre"==r)&&l.push({name:Globalize.translate("ButtonShuffle"),id:"shuffle",ironIcon:"shuffle"}),require(["actionsheet"],function(t){t.show({items:l,positionTo:e,callback:function(e){switch(e){case"play":MediaController.play(a);break;case"externalplayer":LibraryBrowser.playInExternalPlayer(a);break;case"resume":MediaController.play({ids:[a],startPositionTicks:s});break;case"queue":MediaController.queue(a);break;case"instantmix":MediaController.instantMix(a);break;case"shuffle":MediaController.shuffle(a)}}})})},supportsEditing:function(e){return"UserRootFolder"==e||"UserView"==e||"Timer"==e?!1:!0},getMoreCommands:function(e,a){var t=[];return s.supportsAddingToCollection(e)&&t.push("addtocollection"),s.supportsAddingToPlaylist(e)&&t.push("playlist"),"BoxSet"==e.Type||"Playlist"==e.Type?t.push("delete"):e.CanDelete&&t.push("delete"),a.Policy.IsAdministrator&&(LibraryBrowser.supportsEditing(e.Type)&&t.push("edit"),"Video"==e.MediaType&&"TvChannel"!=e.Type&&"Program"!=e.Type&&"Virtual"!=e.LocationType&&t.push("editsubtitles"),"Timer"!=e.Type&&t.push("editimages")),a.Policy.IsAdministrator&&t.push("refresh"),LibraryBrowser.enableSync(e,a)&&t.push("sync"),e.CanDownload&&i.supports("filedownload")&&t.push("download"),LibraryBrowser.canShare(e,a)&&t.push("share"),LibraryBrowser.canIdentify(a,e.Type)&&t.push("identify"),t},canIdentify:function(e,a){return"Movie"!=a&&"Trailer"!=a&&"Series"!=a&&"Game"!=a&&"BoxSet"!=a&&"Person"!=a&&"Book"!=a&&"MusicAlbum"!=a&&"MusicArtist"!=a||!e.Policy.IsAdministrator?!1:!0},deleteItems:function(e){return new Promise(function(a,t){var r=Globalize.translate("ConfirmDeleteItem"),i=Globalize.translate("HeaderDeleteItem");e.length>1&&(r=Globalize.translate("ConfirmDeleteItems"),i=Globalize.translate("HeaderDeleteItems")),require(["confirm"],function(n){n(r,i).then(function(){e.map(function(e){ApiClient.deleteItem(e),Events.trigger(LibraryBrowser,"itemdeleting",[e])});a()},t)})})},editImages:function(e){require(["components/imageeditor/imageeditor"],function(a){a.show(e)})},editSubtitles:function(e){require(["subtitleEditor"],function(a){var t=ApiClient.serverInfo().Id;a.show(e,t)})},editMetadata:function(e){require(["components/metadataeditor/metadataeditor"],function(a){a.show(e)})},editTimer:function(e){require(["recordingEditor"],function(a){var t=ApiClient.serverInfo().Id;a.show(e,t)})},showMoreCommands:function(e,a,t,r){var i=[];-1!=r.indexOf("addtocollection")&&i.push({name:Globalize.translate("ButtonAddToCollection"),id:"addtocollection",ironIcon:"add"}),-1!=r.indexOf("playlist")&&i.push({name:Globalize.translate("ButtonAddToPlaylist"),id:"playlist",ironIcon:"playlist-add"}),-1!=r.indexOf("delete")&&i.push({name:Globalize.translate("ButtonDelete"),id:"delete",ironIcon:"delete"}),-1!=r.indexOf("download")&&i.push({name:Globalize.translate("ButtonDownload"),id:"download",ironIcon:"file-download"}),-1!=r.indexOf("edit")&&i.push({name:Globalize.translate("ButtonEdit"),id:"edit",ironIcon:"mode-edit"}),-1!=r.indexOf("editimages")&&i.push({name:Globalize.translate("ButtonEditImages"),id:"editimages",ironIcon:"photo"}),-1!=r.indexOf("editsubtitles")&&i.push({name:Globalize.translate("ButtonEditSubtitles"),id:"editsubtitles",ironIcon:"closed-caption"}),-1!=r.indexOf("identify")&&i.push({name:Globalize.translate("ButtonIdentify"),id:"identify",ironIcon:"info"}),-1!=r.indexOf("refresh")&&i.push({name:Globalize.translate("ButtonRefresh"),id:"refresh",ironIcon:"refresh"}),-1!=r.indexOf("share")&&i.push({name:Globalize.translate("ButtonShare"),id:"share",ironIcon:"share"});var n=ApiClient.serverInfo().Id;require(["actionsheet"],function(r){r.show({items:i,positionTo:e,callback:function(e){switch(e){case"share":require(["sharingmanager"],function(e){e.showMenu({serverId:n,itemId:a})});break;case"addtocollection":require(["collectionEditor"],function(e){(new e).show({items:[a],serverId:n})});break;case"playlist":require(["playlistEditor"],function(e){(new e).show({items:[a],serverId:n})});break;case"delete":LibraryBrowser.deleteItems([a]);break;case"download":require(["fileDownloader"],function(e){var t=ApiClient.getUrl("Items/"+a+"/Download",{api_key:ApiClient.accessToken()});e.download([{url:t,itemId:a,serverId:n}])});break;case"edit":"Timer"==t?LibraryBrowser.editTimer(a):LibraryBrowser.editMetadata(a);break;case"editsubtitles":LibraryBrowser.editSubtitles(a);break;case"editimages":LibraryBrowser.editImages(a);break;case"identify":LibraryBrowser.identifyItem(a);break;case"refresh":require(["refreshDialog"],function(e){new e({itemIds:[a],serverId:n}).show()})}}})})},identifyItem:function(e){return new Promise(function(a,t){require(["components/itemidentifier/itemidentifier"],function(r){r.show(e).then(a,t)})})},getHref:function(e,a,t){var r=LibraryBrowser.getHrefInternal(e,a);return"tv"==a&&(t||(t=LibraryMenu.getTopParentId()),t&&(r+=-1==r.indexOf("?")?"?topParentId=":"&topParentId=",r+=t)),r},getHrefInternal:function(e,a){if(!e)throw new Error("item cannot be null");if(e.url)return e.url;var t=e.Id||e.ItemId;if("livetv"==e.CollectionType)return"livetv.html";if("channels"==e.CollectionType)return"channels.html";if("folders"!=a){if("movies"==e.CollectionType)return"movies.html?topParentId="+e.Id;if("boxsets"==e.CollectionType)return"itemlist.html?topParentId="+e.Id+"&parentId="+e.Id;if("tvshows"==e.CollectionType)return"tv.html?topParentId="+e.Id;if("music"==e.CollectionType)return"music.html?topParentId="+e.Id;if("games"==e.CollectionType)return t?"itemlist.html?parentId="+t:"#";if("playlists"==e.CollectionType)return"playlists.html?topParentId="+e.Id;if("photos"==e.CollectionType)return"photos.html?topParentId="+e.Id}else if(e.IsFolder)return t?"itemlist.html?parentId="+t:"#";if("CollectionFolder"==e.Type)return"itemlist.html?topParentId="+e.Id+"&parentId="+e.Id;if("PhotoAlbum"==e.Type)return"itemlist.html?context=photos&parentId="+t;if("Playlist"==e.Type)return"itemdetails.html?id="+t;if("TvChannel"==e.Type)return"itemdetails.html?id="+t;if("Channel"==e.Type)return"channelitems.html?id="+t;if(e.IsFolder&&"Channel"==e.SourceType||"ChannelFolderItem"==e.Type)return"channelitems.html?id="+e.ChannelId+"&folderId="+e.Id;if("Program"==e.Type)return"itemdetails.html?id="+t;if("BoxSet"==e.Type)return"itemdetails.html?id="+t;if("MusicAlbum"==e.Type)return"itemdetails.html?id="+t;if("GameSystem"==e.Type)return"itemdetails.html?id="+t;if("Genre"==e.Type)return"itemdetails.html?id="+t;if("MusicGenre"==e.Type)return"itemdetails.html?id="+t;if("GameGenre"==e.Type)return"itemdetails.html?id="+t;if("Studio"==e.Type)return"itemdetails.html?id="+t;if("Person"==e.Type)return"itemdetails.html?id="+t;if("Recording"==e.Type)return"itemdetails.html?id="+t;if("MusicArtist"==e.Type)return"itemdetails.html?id="+t;var r=a?"&context="+a:"";return"Series"==e.Type||"Season"==e.Type||"Episode"==e.Type?"itemdetails.html?id="+t+r:e.IsFolder?t?"itemlist.html?parentId="+t:"#":"itemdetails.html?id="+t},getImageUrl:function(e,a,t,r){return r=r||{},r.type=a,r.index=t,r.tag="Backdrop"==a?e.BackdropImageTags[t]:"Screenshot"==a?e.ScreenshotImageTags[t]:"Primary"==a?e.PrimaryImageTag||e.ImageTags[a]:e.ImageTags[a],ApiClient.getScaledImageUrl(e.Id||e.ItemId,r)},getListViewIndex:function(e,a){if("disc"==a.index)return null==e.ParentIndexNumber?"":Globalize.translate("ValueDiscNumber",e.ParentIndexNumber);var t,r,i=(a.sortBy||"").toLowerCase();return 0==i.indexOf("sortname")?"Episode"==e.Type?"":(r=(e.SortName||e.Name||"?")[0].toUpperCase(),t=r.charCodeAt(0),65>t||t>90?"#":r.toUpperCase()):0==i.indexOf("officialrating")?e.OfficialRating||Globalize.translate("HeaderUnrated"):0==i.indexOf("communityrating")?null==e.CommunityRating?Globalize.translate("HeaderUnrated"):Math.floor(e.CommunityRating):0==i.indexOf("criticrating")?null==e.CriticRating?Globalize.translate("HeaderUnrated"):Math.floor(e.CriticRating):0==i.indexOf("metascore")?null==e.Metascore?Globalize.translate("HeaderUnrated"):Math.floor(e.Metascore):0==i.indexOf("albumartist")&&e.AlbumArtist?(r=e.AlbumArtist[0].toUpperCase(),t=r.charCodeAt(0),65>t||t>90?"#":r.toUpperCase()):""},getUserDataCssClass:function(e){return e?"libraryItemUserData"+e.replace(new RegExp(" ","g"),""):""},getListViewHtml:function(e){require(["paper-icon-item","paper-item-body","material-icons"]);var a="";e.title&&(a+="<h1>",a+=e.title,a+="</h1>"),a+='<div class="paperList itemsListview">';var t=0,r="";return a+=e.items.map(function(i){var n="";if(e.showIndex!==!1){var l=LibraryBrowser.getListViewIndex(i,e);l!=r&&(a+="</div>",n+=0==t?"<h1>":'<h1 style="margin-top:2em;">',n+=l,n+="</h1>",n+='<div class="paperList itemsListview">',r=l)}var d=LibraryBrowser.getItemDataAttributes(i,e,t),u="listItem",m=LibraryBrowser.getHref(i,e.context);n+='<paper-icon-item class="'+u+'"'+d+' data-itemid="'+i.Id+'" data-playlistitemid="'+(i.PlaylistItemId||"")+'" data-href="'+m+'" data-icon="false">';var c,p=e.smallIcon?70:80,g="Episode"==i.Type||"Game"==i.Type||e.smallIcon?2:1.5;i.ImageTags.Primary?c=ApiClient.getScaledImageUrl(i.Id,{maxWidth:p,tag:i.ImageTags.Primary,type:"Primary",index:0,minScale:g}):i.AlbumId&&i.AlbumPrimaryImageTag?c=ApiClient.getScaledImageUrl(i.AlbumId,{type:"Primary",maxWidth:p,tag:i.AlbumPrimaryImageTag,minScale:g}):i.AlbumId&&i.SeriesPrimaryImageTag?c=ApiClient.getScaledImageUrl(i.SeriesId,{type:"Primary",maxWidth:p,tag:i.SeriesPrimaryImageTag,minScale:g}):i.ParentPrimaryImageTag&&(c=ApiClient.getImageUrl(i.ParentPrimaryImageItemId,{type:"Primary",maxWidth:p,tag:i.ParentPrimaryImageTag,minScale:g})),n+=c?e.smallIcon?'<div class="listviewImage lazy small" data-src="'+c+'" item-icon></div>':'<div class="listviewImage lazy" data-src="'+c+'" item-icon></div>':e.smallIcon?'<div class="listviewImage small" item-icon></div>':'<div class="listviewImage" item-icon></div>';var h=[];"Episode"==i.Type?h.push(i.SeriesName||"&nbsp;"):"MusicAlbum"==i.Type&&h.push(i.AlbumArtist||"&nbsp;");var b=s.getDisplayName(i);e.showIndexNumber&&null!=i.IndexNumber&&(b=i.IndexNumber+". "+b),h.push(b),"Audio"==i.Type&&h.push(i.ArtistItems.map(function(e){return e.Name}).join(", ")||"&nbsp;"),"Game"==i.Type?h.push(i.GameSystem||"&nbsp;"):"MusicGenre"==i.Type?h.push("&nbsp;"):"MusicArtist"==i.Type?h.push("&nbsp;"):"TvChannel"==i.Type?i.CurrentProgram&&h.push(s.getDisplayName(i.CurrentProgram)):h.push('<div class="itemMiscInfo">'+o.getPrimaryMediaInfoHtml(i,{endsAt:!1})+"</div>"),n+=h.length>2?"<paper-item-body three-line>":"<paper-item-body two-line>";var y=e.defaultAction;("play"==y||"playallfromhere"==y)&&"Full"!=i.PlayAccess&&(y=null);var I=y?' data-action="'+y+'" class="itemWithAction mediaItem clearLink"':' class="mediaItem clearLink"';n+="<a"+I+' href="'+m+'">';for(var f=0,v=h.length;v>f;f++)n+=0==f?"<div>":"<div secondary>",n+=h[f]||"&nbsp;",n+="</div>";return n+="</a>",n+="</paper-item-body>",n+='<button is="paper-icon-button-light" class="listviewMenuButton autoSize"><i class="md-icon">'+AppInfo.moreIcon.replace("-","_")+"</i></button>",n+='<span class="listViewUserDataButtons">',n+=LibraryBrowser.getUserDataIconsHtml(i),n+="</span>",n+="</paper-icon-item>",t++,n}).join(""),a+="</div>"},getItemDataAttributesList:function(e,a,t){var r=[],i=LibraryBrowser.getItemCommands(e,a);return r.push({name:"itemid",value:e.Id}),r.push({name:"commands",value:i.join(",")}),a.context&&r.push({name:"context",value:a.context||""}),e.IsFolder&&r.push({name:"isfolder",value:e.IsFolder}),r.push({name:"itemtype",value:e.Type}),e.MediaType&&r.push({name:"mediatype",value:e.MediaType||""}),e.UserData&&e.UserData.PlaybackPositionTicks&&r.push({name:"positionticks",value:e.UserData.PlaybackPositionTicks||0}),r.push({name:"playaccess",value:e.PlayAccess||""}),r.push({name:"locationtype",value:e.LocationType||""}),r.push({name:"index",value:t}),e.AlbumId&&r.push({name:"albumid",value:e.AlbumId}),e.ChannelId&&r.push({name:"channelid",value:e.ChannelId}),e.ArtistItems&&e.ArtistItems.length&&r.push({name:"artistid",value:e.ArtistItems[0].Id}),r},getItemDataAttributes:function(e,a,t){var r=LibraryBrowser.getItemDataAttributesList(e,a,t).map(function(e){return"data-"+e.name+'="'+e.value+'"'}),i=r.join(" ");return i&&(i=" "+i),i},enableSync:function(e,a){return AppInfo.isNativeApp&&!Dashboard.capabilities().SupportsSync?!1:a&&!a.Policy.EnableSync?!1:e.SupportsSync},getItemCommands:function(e,a){var t=[];return LibraryBrowser.supportsEditing(e.Type)&&t.push("edit"),e.LocalTrailerCount&&t.push("trailer"),("Audio"==e.MediaType||"MusicAlbum"==e.Type||"MusicArtist"==e.Type||"MusicGenre"==e.Type||"music"==e.CollectionType)&&t.push("instantmix"),(e.IsFolder||"MusicArtist"==e.Type||"MusicGenre"==e.Type)&&t.push("shuffle"),s.supportsAddingToPlaylist(e)&&t.push(a.showRemoveFromPlaylist?"removefromplaylist":"playlist"),a.showAddToCollection!==!1&&s.supportsAddingToCollection(e)&&t.push("addtocollection"),a.showRemoveFromCollection&&t.push("removefromcollection"),a.playFromHere&&(t.push("playfromhere"),t.push("queuefromhere")),e.CanDelete&&t.push("delete"),LibraryBrowser.enableSync(e)&&t.push("sync"),"Program"!=e.Type||e.TimerId||e.SeriesTimerId||t.push("record"),"Video"==e.MediaType&&"TvChannel"!=e.Type&&"Program"!=e.Type&&"Virtual"!=e.LocationType&&t.push("editsubtitles"),"Timer"!=e.Type&&t.push("editimages"),t},shapes:["square","portrait","banner","smallBackdrop","homePageSmallBackdrop","backdrop","overflowBackdrop","overflowPortrait","overflowSquare"],getPostersPerRow:function(e){function a(a){switch(a){case"portrait":return e>=2200?10:e>=2100?9:e>=1600?8:e>=1400?7:e>=1200?6:e>=800?5:e>=640?4:3;case"square":return e>=2100?9:e>=1800?8:e>=1400?7:e>=1200?6:e>=900?5:e>=700?4:e>=500?3:2;case"banner":return e>=2200?4:e>=1200?3:e>=800?2:1;case"backdrop":return e>=2500?6:e>=2100?5:e>=1200?4:e>=770?3:e>=420?2:1}var r=m.createElement("div");r.classList.add("card"),r.classList.add(a+"Card"),r.innerHTML='<div class="cardBox"><div class="cardImage"></div></div>',m.body.appendChild(r);var i=r.querySelector(".cardImage").clientWidth;(!i||isNaN(i))&&(t=!1,i=Math.min(400,e/2));var n=e/i;return r.parentNode.removeChild(r),Math.floor(n)}for(var t=!0,r={},i=0,n=LibraryBrowser.shapes.length;n>i;i++){var s=LibraryBrowser.shapes[i];r[s]=a(s)}return r.cache=t,r},posterSizes:[],getPosterViewInfo:function(){for(var a=e.innerWidth,t=LibraryBrowser.posterSizes,r=0,i=t.length;i>r;r++)if(t[r].screenWidth==a)return t[r];var n=LibraryBrowser.getPosterViewInfoInternal(a);return n.screenWidth=a,n.cache&&t.push(n),n},getPosterViewInfoInternal:function(e){var a=LibraryBrowser.getPostersPerRow(e),t={};t.screenWidth=e,AppInfo.hasLowImageBandwidth?AppInfo.isNativeApp||(e*=.75):e*=1.2;for(var r=100,i=0,n=LibraryBrowser.shapes.length;n>i;i++){var s=LibraryBrowser.shapes[i],o=e/a[s];browserInfo.mobile||(o=Math.round(o/r)*r),t[s+"Width"]=Math.round(o)}return t.cache=a.cache,t},setPosterViewData:function(e){var a=e.items;e.shape=e.shape||"portrait";var t=LibraryBrowser.getAveragePrimaryImageAspectRatio(a),r=t&&Math.abs(t-1.777777778)<.3,i=t&&Math.abs(t-1)<.33||t&&Math.abs(t-1.3333334)<.01;("auto"==e.shape||"autohome"==e.shape||"autooverflow"==e.shape)&&(r?e.shape="autooverflow"==e.shape?"overflowBackdrop":"backdrop":i?(e.coverImage=!0,e.shape="autooverflow"==e.shape?"overflowSquare":"square"):t&&t>1.9?(e.shape="banner",e.coverImage=!0):e.shape=t&&Math.abs(t-.6666667)<.2?"autooverflow"==e.shape?"overflowPortrait":"portrait":e.defaultShape||("autooverflow"==e.shape?"overflowSquare":"square"));var n=LibraryBrowser.getPosterViewInfo(),s=n.backdropWidth,o=n.portraitWidth,l=n.squareWidth,d=n.bannerWidth;r?o=s:i&&(o=l),"overflowBackdrop"==e.shape?s=n.overflowBackdropWidth:"overflowPortrait"==e.shape?o=n.overflowPortraitWidth:"overflowSquare"==e.shape?l=n.overflowSquareWidth:"smallBackdrop"==e.shape?s=n.smallBackdropWidth:"homePageSmallBackdrop"==e.shape?(s=n.homePageSmallBackdropWidth,o=n.homePageSmallBackdropWidth):"detailPagePortrait"==e.shape?o=200:"detailPageSquare"==e.shape?(o=240,l=240):"detailPage169"==e.shape&&(o=320,s=320),e.uiAspect=g(e.shape),e.primaryImageAspectRatio=t,e.posterWidth=o,e.thumbWidth=s,e.bannerWidth=d,e.squareSize=l},getPosterViewHtml:function(e){LibraryBrowser.setPosterViewData(e);var a,t=e.items;e.shape=e.shape||"portrait";for(var r,i,s="",o=e.thumbWidth,l=e.posterWidth,d=e.squareSize,u=e.bannerWidth,m=e.uiAspect,c=0,p=t.length;p>c;c++){var g=t[c];if(i=null,r=LibraryBrowser.getAveragePrimaryImageAspectRatio([g]),e.showStartDateIndex){if(g.StartDate)try{i=LibraryBrowser.getFutureDateText(n.parseISO8601Date(g.StartDate,!0),!0)}catch(h){}var b=i||Globalize.translate("HeaderUnknownDate");b!=a&&(s+='<h1 class="timelineHeader" style="text-align:center;">'+b+"</h1>",a=b)}else if(e.timeline){var y=g.ProductionYear||Globalize.translate("HeaderUnknownYear");y!=a&&(s+='<h1 class="timelineHeader">'+y+"</h1>",a=y)}s+=LibraryBrowser.getPosterViewItemHtml(g,c,e,r,o,l,d,u,m)}return s},getPosterViewItemHtml:function(e,a,t,r,i,n,s,o,l){var d,u="",m=null,c=null,p=null,g=!1,h=t.enableImageEnhancers!==!1,b="card";t.fullWidthOnMobile&&(b+=" fullWidthCardOnMobile");var y="auto"==t.showTitle?!0:t.showTitle;("PhotoAlbum"==e.Type||"Folder"==e.Type)&&(y=!0);var I=t.coverImage,f="Timer"==e.Type?e.ProgramInfo||e:e;t.autoThumb&&f.ImageTags&&f.ImageTags.Primary&&f.PrimaryImageAspectRatio&&f.PrimaryImageAspectRatio>=1.34?(c=n,p=r?Math.round(n/r):null,m=ApiClient.getImageUrl(f.Id,{type:"Primary",maxHeight:p,maxWidth:c,tag:f.ImageTags.Primary,enableImageEnhancers:h}),r&&l&&Math.abs(r-l)<=.2&&(I=!0)):t.autoThumb&&f.ImageTags&&f.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(f.Id,{type:"Thumb",maxWidth:i,tag:f.ImageTags.Thumb,enableImageEnhancers:h}):t.preferBackdrop&&f.BackdropImageTags&&f.BackdropImageTags.length?m=ApiClient.getScaledImageUrl(f.Id,{type:"Backdrop",maxWidth:i,tag:f.BackdropImageTags[0],enableImageEnhancers:h}):t.preferThumb&&f.ImageTags&&f.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(f.Id,{type:"Thumb",maxWidth:i,tag:f.ImageTags.Thumb,enableImageEnhancers:h}):t.preferBanner&&f.ImageTags&&f.ImageTags.Banner?m=ApiClient.getScaledImageUrl(f.Id,{type:"Banner",maxWidth:o,tag:f.ImageTags.Banner,enableImageEnhancers:h}):t.preferThumb&&f.SeriesThumbImageTag&&t.inheritThumb!==!1?m=ApiClient.getScaledImageUrl(f.SeriesId,{type:"Thumb",maxWidth:i,tag:f.SeriesThumbImageTag,enableImageEnhancers:h}):t.preferThumb&&f.ParentThumbItemId&&t.inheritThumb!==!1?m=ApiClient.getThumbImageUrl(f.ParentThumbItemId,{type:"Thumb",maxWidth:i,enableImageEnhancers:h}):t.preferThumb&&f.BackdropImageTags&&f.BackdropImageTags.length?(m=ApiClient.getScaledImageUrl(f.Id,{type:"Backdrop",maxWidth:i,tag:f.BackdropImageTags[0],enableImageEnhancers:h}),g=!0):f.ImageTags&&f.ImageTags.Primary?(c=n,p=r?Math.round(n/r):null,m=ApiClient.getImageUrl(f.Id,{type:"Primary",maxHeight:p,maxWidth:c,tag:f.ImageTags.Primary,enableImageEnhancers:h}),r&&l&&Math.abs(r-l)<=.2&&(I=!0)):f.ParentPrimaryImageTag?m=ApiClient.getImageUrl(f.ParentPrimaryImageItemId,{type:"Primary",maxWidth:n,tag:e.ParentPrimaryImageTag,enableImageEnhancers:h}):f.AlbumId&&f.AlbumPrimaryImageTag?(p=s,c=r?Math.round(p*r):null,m=ApiClient.getScaledImageUrl(f.AlbumId,{type:"Primary",maxHeight:p,maxWidth:c,tag:f.AlbumPrimaryImageTag,enableImageEnhancers:h}),r&&l&&Math.abs(r-l)<=.2&&(I=!0)):"Season"==f.Type&&f.ImageTags&&f.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(f.Id,{type:"Thumb",maxWidth:i,tag:f.ImageTags.Thumb,enableImageEnhancers:h}):f.BackdropImageTags&&f.BackdropImageTags.length?m=ApiClient.getScaledImageUrl(f.Id,{type:"Backdrop",maxWidth:i,tag:f.BackdropImageTags[0],enableImageEnhancers:h}):f.ImageTags&&f.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(f.Id,{type:"Thumb",maxWidth:i,tag:f.ImageTags.Thumb,enableImageEnhancers:h}):f.SeriesThumbImageTag?m=ApiClient.getScaledImageUrl(f.SeriesId,{type:"Thumb",maxWidth:i,tag:f.SeriesThumbImageTag,enableImageEnhancers:h}):f.ParentThumbItemId?m=ApiClient.getThumbImageUrl(f,{type:"Thumb",maxWidth:i,enableImageEnhancers:h}):"Audio"==e.MediaType||"MusicAlbum"==e.Type||"MusicArtist"==e.Type?(e.Name&&y&&(d="library_music"),b+=" defaultBackground"):"Recording"==e.Type||"Program"==e.Type||"TvChannel"==e.Type?(e.Name&&y&&(d="folder_open"),b+=" defaultBackground"):"Video"==e.MediaType||"Season"==e.Type||"Series"==e.Type?(e.Name&&y&&(d="videocam"),b+=" defaultBackground"):"Person"==e.Type?(e.Name&&y&&(d="person"),b+=" defaultBackground"):(e.Name&&y&&(d="folder_open"),b+=" defaultBackground"),d=e.icon||d,b+=" "+t.shape+"Card";var v=e.MediaSourceCount||1,T=t.linkItem===!1?"#":LibraryBrowser.getHref(e,t.context);t.showChildCountIndicator&&e.ChildCount&&t.showLatestItemsPopup!==!1&&(b+=" groupedCard"),!y&&!t.showItemCounts||t.overlayText||(b+=" bottomPaddedCard");var S=LibraryBrowser.getItemDataAttributes(e,t,a),w=t.defaultAction;("play"==w||"playallfromhere"==w)&&"Full"!=e.PlayAccess&&(w=null);var P=w?' data-action="'+w+'"':"";u+="<div"+S+' class="'+b+'">';var C="";m&&!t.lazy&&(C+="background-image:url('"+m+"');");var B="cardImage";d&&(B+=" iconCardImage"),I&&(B+=" coveredCardImage",("Photo"==e.MediaType||"PhotoAlbum"==e.Type||"Folder"==e.Type||"Program"==e.Type||"Recording"==e.Type)&&(B+=" noScale")),t.centerImage&&(B+=" centeredCardImage");var A="";t.lazy&&m&&(B+=" lazy",A=' data-src="'+m+'"');var L="cardBox";t.cardLayout&&(L+=" visualCardBox"),u+='<div class="'+L+'">',u+='<div class="cardScalable">',u+='<div class="cardPadder"></div>';var x="cardContent";x+=" mediaItem",t.defaultAction&&(x+=" itemWithAction");var k=t.transition!==!1&&AppInfo.enableSectionTransitions?' data-transition="slide"':"",M=e.onclick?' onclick="'+e.onclick+'"':"";u+="<a"+M+k+' class="'+x+'" href="'+T+'"'+P+">",u+='<div class="'+B+'" style="'+C+'"'+A+">",d&&(u+='<i class="md-icon">'+d+"</i>"),u+="</div>","Virtual"==e.LocationType||"Offline"==e.LocationType?t.showLocationTypeIndicator!==!1&&(u+=LibraryBrowser.getOfflineIndicatorHtml(e)):t.showUnplayedIndicator!==!1?u+=LibraryBrowser.getPlayedIndicatorHtml(e):t.showChildCountIndicator&&(u+=LibraryBrowser.getGroupCountIndicator(e)),e.SeriesTimerId&&(u+='<i class="md-icon seriesTimerIndicator">fiber_smart_record</i>'),u+=LibraryBrowser.getSyncIndicator(e),v>1&&(u+='<div class="mediaSourceIndicator">'+v+"</div>");var D=t.showProgress===!1||e.IsFolder?"":LibraryBrowser.getItemProgressBarHtml("Recording"==e.Type?e:e.UserData||{}),z=!1;if(t.overlayText||g&&!y){var G=D?"cardFooter fullCardFooter":"cardFooter";u+=LibraryBrowser.getCardFooterText(e,t,y,m,g,G,D),z=!0}else D&&(u+='<div class="cardFooter fullCardFooter lightCardFooter">',u+="<div class='cardProgress cardText'>",u+=D,u+="</div>",u+="</div>",D="");return u+="</a>",!t.overlayPlayButton||e.IsPlaceHolder||"Virtual"==e.LocationType&&e.MediaType&&"Program"!=e.Type||"Person"==e.Type||(u+='<div class="cardOverlayButtonContainer"><button is="paper-icon-button-light" class="cardOverlayPlayButton autoSize" onclick="return false;"><i class="md-icon">play_arrow</i></button></div>'),t.overlayMoreButton&&(u+='<div class="cardOverlayButtonContainer"><button is="paper-icon-button-light" class="cardOverlayMoreButton autoSize" onclick="return false;"><i class="md-icon">'+AppInfo.moreIcon.replace("-","_")+"</i></button></div>"),u+="</div>",t.overlayText||z||(u+=LibraryBrowser.getCardFooterText(e,t,y,m,g,"cardFooter outerCardFooter",D)),u+="</div>",u+="</div>"},getCardFooterText:function(e,a,t,r,i,o,l){var d="";a.cardLayout&&(d+='<div class="cardButtonContainer">',d+='<button is="paper-icon-button-light" class="listviewMenuButton btnCardOptions autoSize"><i class="md-icon">'+AppInfo.moreIcon.replace("-","_")+"</i></button>",d+="</div>");var u="auto"!=a.showTitle||e.IsFolder||"Photo"!=e.MediaType?s.getDisplayName(e):"";r||t||(d+="<div class='cardDefaultText'>",d+=p(u),d+="</div>");var m=a.centerText?"cardText cardTextCentered":"cardText",c=[];if(a.showParentTitle&&c.push(e.EpisodeTitle?e.Name:e.SeriesName||e.Album||e.AlbumArtist||e.GameSystem||""),(t||i)&&c.push(p(u)),a.showItemCounts){var g=LibraryBrowser.getItemCountsHtml(a,e);c.push(g)}if(a.textLines)for(var h=a.textLines(e),b=0,y=h.length;y>b;b++)c.push(h[b]);if(a.showSongCount){var I="";
e.SongCount&&(I=1==e.SongCount?Globalize.translate("ValueOneSong"):Globalize.translate("ValueSongCount",e.SongCount)),c.push(I)}if(a.showPremiereDate)if(e.PremiereDate)try{c.push(LibraryBrowser.getPremiereDateText(e))}catch(f){c.push("")}else c.push("");if(a.showYear&&c.push(e.ProductionYear||""),a.showChannelName&&c.push(e.ChannelName||""),a.showAirTime){var v;if(e.StartDate)try{var T=n.parseISO8601Date(e.StartDate);v=T.toLocaleDateString(),v+=", "+n.getDisplayTime(T),e.EndDate&&(T=n.parseISO8601Date(e.EndDate),v+=" - "+n.getDisplayTime(T))}catch(S){}c.push(v||"")}if("TvChannel"==e.Type&&c.push(e.CurrentProgram?s.getDisplayName(e.CurrentProgram):""),a.showSeriesYear&&c.push("Continuing"==e.Status?Globalize.translate("ValueSeriesYearToPresent",e.ProductionYear||""):e.ProductionYear||""),a.showProgramAirInfo){var T=n.parseISO8601Date(e.StartDate,!0),w=e.StartDate?T.toLocaleString():"";c.push(w||"&nbsp;"),c.push(e.ChannelName||"&nbsp;")}return d+=LibraryBrowser.getCardTextLines(c,m,!a.overlayText),a.overlayText&&l&&(d+="<div class='cardText cardProgress'>",d+=l,d+="</div>"),d&&(d='<div class="'+o+'">'+d,d+="</div>"),d},getListItemInfo:function(e){for(var a=e;!a.getAttribute("data-itemid");)a=a.parentNode;var t=a.getAttribute("data-itemid"),r=a.getAttribute("data-index"),i=a.getAttribute("data-mediatype");return{id:t,index:r,mediaType:i,context:a.getAttribute("data-context")}},getCardTextLines:function(e,a,t){var r,i,n="",s=0;for(r=0,i=e.length;i>r;r++){var o=e[r];o&&(n+="<div class='"+a+"'>",n+=o,n+="</div>",s++)}if(t)for(;i>s;)n+="<div class='"+a+"'>&nbsp;</div>",s++;return n},getFutureDateText:function(e){var a=[];a[0]=Globalize.translate("OptionSunday"),a[1]=Globalize.translate("OptionMonday"),a[2]=Globalize.translate("OptionTuesday"),a[3]=Globalize.translate("OptionWednesday"),a[4]=Globalize.translate("OptionThursday"),a[5]=Globalize.translate("OptionFriday"),a[6]=Globalize.translate("OptionSaturday");var t=a[e.getDay()];return e=e.toLocaleDateString(),-1==e.toLowerCase().indexOf(t.toLowerCase())?t+" "+e:e},getPremiereDateText:function(e,a){if(!a){var t="";return e.AirTime&&(t+=e.AirTime),e.SeriesStudio&&(t+=t?" on "+e.SeriesStudio:e.SeriesStudio),t}var r=LibraryBrowser.getFutureDateText(a);return e.AirTime&&(r+=" at "+e.AirTime),e.SeriesStudio&&(r+=" on "+e.SeriesStudio),r},getOfflineIndicatorHtml:function(e){if("Offline"==e.LocationType)return'<div class="posterRibbon offlinePosterRibbon">'+Globalize.translate("HeaderOffline")+"</div>";if("Episode"==e.Type){try{var a=n.parseISO8601Date(e.PremiereDate,!0);if(e.PremiereDate&&(new Date).getTime()<a.getTime())return'<div class="posterRibbon unairedPosterRibbon">'+Globalize.translate("HeaderUnaired")+"</div>"}catch(t){}return'<div class="posterRibbon missingPosterRibbon">'+Globalize.translate("HeaderMissing")+"</div>"}return""},getPlayedIndicatorHtml:function(e){if("Series"==e.Type||"Season"==e.Type||"BoxSet"==e.Type||"Video"==e.MediaType||"Game"==e.MediaType||"Book"==e.MediaType){if(e.UserData.UnplayedItemCount)return'<div class="playedIndicator">'+e.UserData.UnplayedItemCount+"</div>";if("TvChannel"!=e.Type&&(e.UserData.PlayedPercentage&&e.UserData.PlayedPercentage>=100||e.UserData&&e.UserData.Played))return'<div class="playedIndicator"><i class="md-icon">check</i></div>'}return""},getGroupCountIndicator:function(e){return e.ChildCount?'<div class="playedIndicator">'+e.ChildCount+"</div>":""},getSyncIndicator:function(e){if("Synced"==e.SyncStatus)return'<div class="syncIndicator"><i class="md-icon">sync</i></div>';var a=e.SyncPercent;return a?'<div class="syncIndicator"><i class="md-icon">sync</i></div>':"Queued"==e.SyncStatus||"Converting"==e.SyncStatus||"ReadyToTransfer"==e.SyncStatus||"Transferring"==e.SyncStatus?'<div class="syncIndicator"><i class="md-icon">sync</i></div>':""},getAveragePrimaryImageAspectRatio:function(e){for(var a=[],t=0,r=e.length;r>t;t++){var i=e[t].PrimaryImageAspectRatio||0;i&&(a[a.length]=i)}if(!a.length)return null;a.sort(function(e,a){return e-a});var n,s=Math.floor(a.length/2);return n=a.length%2?a[s]:(a[s-1]+a[s])/2,Math.abs(.66666666667-n)<=.15?.66666666667:Math.abs(1.777777778-n)<=.2?1.777777778:Math.abs(1-n)<=.15?1:Math.abs(1.33333333333-n)<=.15?1.33333333333:n},metroColors:["#6FBD45","#4BB3DD","#4164A5","#E12026","#800080","#E1B222","#008040","#0094FF","#FF00C7","#FF870F","#7F0037"],getRandomMetroColor:function(){var e=Math.floor(Math.random()*(LibraryBrowser.metroColors.length-1));return LibraryBrowser.metroColors[e]},getMetroColor:function(e){if(e){for(var a=String(e.substr(0,1).charCodeAt()),t=0,r=0;r<a.length;r++)t+=parseInt(a.charAt(r));var i=String(t).substr(-1);return LibraryBrowser.metroColors[i]}return LibraryBrowser.getRandomMetroColor()},renderName:function(e,a,t,r){var i=s.getDisplayName(e,{includeParentInfo:!1});Dashboard.setPageTitle(i),a.innerHTML=t?'<a class="detailPageParentLink" href="'+LibraryBrowser.getHref(e,r)+'">'+i+"</a>":i},renderParentName:function(e,a,t){var r=[],i=t?"&context="+t:"";e.AlbumArtists?r.push(LibraryBrowser.getArtistLinksHtml(e.AlbumArtists,"detailPageParentLink")):e.ArtistItems&&e.ArtistItems.length&&"MusicVideo"==e.Type?r.push(LibraryBrowser.getArtistLinksHtml(e.ArtistItems,"detailPageParentLink")):e.SeriesName&&"Episode"==e.Type&&r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.SeriesId+i+'">'+e.SeriesName+"</a>"),e.SeriesName&&"Season"==e.Type?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.SeriesId+i+'">'+e.SeriesName+"</a>"):null!=e.ParentIndexNumber&&"Episode"==e.Type?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.SeasonId+i+'">'+e.SeasonName+"</a>"):e.Album&&"Audio"==e.Type&&(e.AlbumId||e.ParentId)?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+(e.AlbumId||e.ParentId)+i+'">'+e.Album+"</a>"):e.Album&&"MusicVideo"==e.Type&&e.AlbumId?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.AlbumId+i+'">'+e.Album+"</a>"):e.Album?r.push(e.Album):"Program"==e.Type&&e.EpisodeTitle&&r.push(e.Name),r.length?(a.classList.remove("hide"),a.innerHTML=r.join(" - ")):a.classList.add("hide")},renderLinks:function(e,a){var t=[];if(a.HomePageUrl&&t.push('<a class="textlink" href="'+a.HomePageUrl+'" target="_blank">'+Globalize.translate("ButtonWebsite")+"</a>"),a.ExternalUrls)for(var r=0,i=a.ExternalUrls.length;i>r;r++){var n=a.ExternalUrls[r];t.push('<a class="textlink" href="'+n.Url+'" target="_blank">'+n.Name+"</a>")}if(t.length){var s=t.join("&nbsp;&nbsp;/&nbsp;&nbsp;");s=Globalize.translate("ValueLinks",s),e.innerHTML=s,e.classList.remove("hide")}else e.classList.add("hide")},showLayoutMenu:function(a,t,r){var i=!0;r||(i=!1,r=a.getAttribute("data-layouts"),r=r?r.split(","):["List","Poster","PosterCard","Thumb","ThumbCard"]);var n=r.map(function(e){return{name:Globalize.translate("Option"+e),id:e,selected:t==e}});require(["actionsheet"],function(t){t.show({items:n,positionTo:a,callback:function(t){a.dispatchEvent(new CustomEvent("layoutchange",{detail:{viewStyle:t},bubbles:!0,cancelable:!1})),i||e.$&&$(a).trigger("layoutchange",[t])}})})},getQueryPagingHtml:function(e){var a=e.startIndex,t=e.limit,i=e.totalRecordCount;if(t&&e.updatePageSizeSetting!==!1)try{r.setItem(e.pageSizeKey||y,t)}catch(n){}var s="",o=Math.min(a+t,i),l=i>20||i>t;if(s+='<div class="listPaging">',l){s+='<span style="vertical-align:middle;">';var d=i?a+1:0;s+=d+"-"+o+" of "+i,s+="</span>"}if((l||e.viewButton||e.filterButton||e.sortButton||e.addLayoutButton)&&(s+='<div style="display:inline-block;">',l&&(s+='<button is="paper-icon-button-light" class="btnPreviousPage autoSize" '+(a?"":"disabled")+'><i class="md-icon">arrow_back</i></button>',s+='<button is="paper-icon-button-light" class="btnNextPage autoSize" '+(a+t>=i?"disabled":"")+'><i class="md-icon">arrow_forward</i></button>'),e.addLayoutButton&&(s+='<button is="paper-icon-button-light" title="'+Globalize.translate("ButtonSelectView")+'" class="btnChangeLayout autoSize" data-layouts="'+(e.layouts||"")+'" onclick="LibraryBrowser.showLayoutMenu(this, \''+(e.currentLayout||"")+'\');"><i class="md-icon">view_comfy</i></button>'),e.sortButton&&(s+='<button is="paper-icon-button-light" class="btnSort autoSize" title="'+Globalize.translate("ButtonSort")+'"><i class="md-icon">sort_by_alpha</i></button>'),e.filterButton&&(s+='<button is="paper-icon-button-light" class="btnFilter autoSize" title="'+Globalize.translate("ButtonFilter")+'"><i class="md-icon">filter_list</i></button>'),s+="</div>",l&&e.showLimit)){var u="selectPageSize",m=e.pageSizes||[20,50,100,200,300,400,500],c=m.map(function(e){return t==e?'<option value="'+e+'" selected="selected">'+e+"</option>":'<option value="'+e+'">'+e+"</option>"}).join("");s+='<div class="pageSizeContainer"><label class="labelPageSize" for="'+u+'">'+Globalize.translate("LabelLimit")+'</label><select style="width:auto;" class="selectPageSize" id="'+u+'" data-inline="true" data-mini="true">'+c+"</select></div>"}return s+="</div>"},showSortMenu:function(e){require(["dialogHelper","paper-radio-button","paper-radio-group"],function(a){var t=a.createDialog({removeOnClose:!0,modal:!1,entryAnimationDuration:160,exitAnimationDuration:200});t.classList.add("ui-body-a"),t.classList.add("background-theme-a"),t.classList.add("formDialog");var r="";r+='<div style="margin:0;padding:1.25em 1.5em 1.5em;">',r+='<h2 style="margin:0 0 .5em;">',r+=Globalize.translate("HeaderSortBy"),r+="</h2>",r+='<paper-radio-group class="groupSortBy" selected="'+(e.query.SortBy||"").replace(",","_")+'">';for(var i=0,n=e.items.length;n>i;i++){var s=e.items[i];r+='<paper-radio-button class="menuSortBy" style="display:block;" data-id="'+s.id+'" name="'+s.id.replace(",","_")+'">'+s.name+"</paper-radio-button>"}r+="</paper-radio-group>",r+='<h2 style="margin: 1em 0 .5em;">',r+=Globalize.translate("HeaderSortOrder"),r+="</h2>",r+='<paper-radio-group class="groupSortOrder" selected="'+(e.query.SortOrder||"Ascending")+'">',r+='<paper-radio-button name="Ascending" style="display:block;"  class="menuSortOrder block">'+Globalize.translate("OptionAscending")+"</paper-radio-button>",r+='<paper-radio-button name="Descending" style="display:block;"  class="menuSortOrder block">'+Globalize.translate("OptionDescending")+"</paper-radio-button>",r+="</paper-radio-group>",r+="</div>",t.innerHTML=r,m.body.appendChild(t);var o=browserInfo.animate?0:100;setTimeout(function(){a.open(t)},o),t.querySelector(".groupSortBy").addEventListener("iron-select",function(){var a=this.selected.replace("_",","),t=e.query.SortBy!=a;e.query.SortBy=a,e.query.StartIndex=0,e.callback&&t&&e.callback()}),t.querySelector(".groupSortOrder").addEventListener("iron-select",function(){var a=this.selected,t=e.query.SortOrder!=a;e.query.SortOrder=a,e.query.StartIndex=0,e.callback&&t&&e.callback()})})},getItemProgressBarHtml:function(e){if("Recording"==e.Type&&e.CompletionPercentage)return'<progress class="itemProgressBar recordingProgressBar" min="0" max="100" value="'+e.CompletionPercentage+'"></progress>';var a=e.PlayedPercentage;return a&&100>a?'<progress class="itemProgressBar" min="0" max="100" value="'+a+'"></progress>':null},getUserDataButtonHtml:function(e,a,t,r,i,n){if("fab"==n){var s="paper-fab";return"<"+s+' title="'+i+'" data-itemid="'+a+'" icon="'+r+'" class="'+t+'" onclick="LibraryBrowser.'+e+'(this);return false;"></'+s+">"}return'<button is="paper-icon-button-light" title="'+i+'" data-itemid="'+a+'"  class="autoSize '+t+'" onclick="LibraryBrowser.'+e+'(this);return false;"><i class="md-icon">'+r+"</i></button>"},getUserDataIconsHtml:function(e,a,t){var r="",i=e.UserData||{},n=e.Id;if(a!==!1){var s=Globalize.translate("TooltipPlayed");("Video"==e.MediaType||"Series"==e.Type||"Season"==e.Type||"BoxSet"==e.Type||"Playlist"==e.Type)&&"TvChannel"!=e.Type&&(r+=i.Played?LibraryBrowser.getUserDataButtonHtml("markPlayed",n,"btnUserItemRating btnUserItemRatingOn","check",s,t):LibraryBrowser.getUserDataButtonHtml("markPlayed",n,"btnUserItemRating","check",s,t))}var o=Globalize.translate("TooltipFavorite");return r+=i.IsFavorite?LibraryBrowser.getUserDataButtonHtml("markFavorite",n,"btnUserItemRating btnUserItemRatingOn","favorite",o,t):LibraryBrowser.getUserDataButtonHtml("markFavorite",n,"btnUserItemRating","favorite",o,t)},markPlayed:function(e){var a=e.getAttribute("data-itemid"),t=!e.classList.contains("btnUserItemRatingOn");t?(ApiClient.markPlayed(Dashboard.getCurrentUserId(),a),e.classList.add("btnUserItemRatingOn")):(ApiClient.markUnplayed(Dashboard.getCurrentUserId(),a),e.classList.remove("btnUserItemRatingOn"))},markFavorite:function(e){var a=e.getAttribute("data-itemid"),t=!e.classList.contains("btnUserItemRatingOn");ApiClient.updateFavoriteStatus(Dashboard.getCurrentUserId(),a,t),t?e.classList.add("btnUserItemRatingOn"):e.classList.remove("btnUserItemRatingOn")},renderDetailImage:function(e,a,t,r){var i=a.ImageTags||{};a.PrimaryImageTag&&(i.Primary=a.PrimaryImageTag);var n,s="",o="portrait",l=360,d=!1;r&&i.Thumb?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Thumb",maxHeight:l,tag:a.ImageTags.Thumb}),o="thumb"):i.Primary?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Primary",maxHeight:l,tag:a.ImageTags.Primary}),d=!0):a.BackdropImageTags&&a.BackdropImageTags.length?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Backdrop",maxHeight:l,tag:a.BackdropImageTags[0]}),o="thumb"):i.Thumb?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Thumb",maxHeight:l,tag:a.ImageTags.Thumb}),o="thumb"):i.Disc?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Disc",maxHeight:l,tag:a.ImageTags.Disc}),o="square"):a.AlbumId&&a.AlbumPrimaryImageTag?(n=ApiClient.getScaledImageUrl(a.AlbumId,{type:"Primary",maxHeight:l,tag:a.AlbumPrimaryImageTag}),o="square"):"Audio"==a.MediaType||"MusicAlbum"==a.Type||"MusicGenre"==a.Type?(n="css/images/items/detail/audio.png",o="square"):"Game"==a.MediaType||"GameGenre"==a.Type?(n="css/images/items/detail/game.png",o="square"):"Person"==a.Type?(n="css/images/items/detail/person.png",o="square"):"Genre"==a.Type||"Studio"==a.Type?(n="css/images/items/detail/video.png",o="square"):"TvChannel"==a.Type?(n="css/images/items/detail/tv.png",o="square"):(n="css/images/items/detail/video.png",o="square"),s+='<div style="position:relative;">',t&&(s+="<a onclick='LibraryBrowser.editImages(\""+a.Id+"\");' class='itemDetailGalleryLink' href='#'>"),d&&a.PrimaryImageAspectRatio&&(a.PrimaryImageAspectRatio>=1.48?o="thumb":a.PrimaryImageAspectRatio>=.85&&a.PrimaryImageAspectRatio<=1.34&&(o="square")),s+="<img class='itemDetailImage lazy' src='css/images/empty.png' />",t&&(s+="</a>");var u=a.IsFolder||!a.UserData?"":LibraryBrowser.getItemProgressBarHtml("Recording"==a.Type?a:a.UserData);s+='<div class="detailImageProgressContainer">',u&&(s+=u),s+="</div>",s+="</div>",e.innerHTML=s,"thumb"==o?(e.classList.add("thumbDetailImageContainer"),e.classList.remove("portraitDetailImageContainer"),e.classList.remove("squareDetailImageContainer")):"square"==o?(e.classList.remove("thumbDetailImageContainer"),e.classList.remove("portraitDetailImageContainer"),e.classList.add("squareDetailImageContainer")):(e.classList.remove("thumbDetailImageContainer"),e.classList.add("portraitDetailImageContainer"),e.classList.remove("squareDetailImageContainer"));var m=e.querySelector("img");m.onload=function(){-1==m.src.indexOf("empty.png")&&m.classList.add("loaded")},ImageLoader.lazyImage(m,n)},refreshDetailImageUserData:function(e,a){var t=a.IsFolder||!a.UserData?"":LibraryBrowser.getItemProgressBarHtml("Recording"==a.Type?a:a.UserData),r=e.querySelector(".detailImageProgressContainer");r.innerHTML=t||""},renderOverview:function(e,a){for(var t=0,r=e.length;r>t;t++){var i=e[t],n=a.Overview||"";if(n){i.innerHTML=n,i.classList.remove("empty");for(var s=i.querySelectorAll("a"),o=0,l=s.length;l>o;o++)s[o].setAttribute("target","_blank")}else i.innerHTML="",i.classList.add("empty")}},renderStudios:function(e,a,t){if(a.Studios&&a.Studios.length&&"Series"!=a.Type){for(var r="",i=0,n=a.Studios.length;n>i;i++)i>0&&(r+="&nbsp;&nbsp;/&nbsp;&nbsp;"),r+=t?a.Studios[i].Name:'<a class="textlink" href="itemdetails.html?id='+a.Studios[i].Id+'">'+a.Studios[i].Name+"</a>";var s=a.Studios.length>1?"ValueStudios":"ValueStudio";r=Globalize.translate(s,r),e.innerHTML=r,e.classList.remove("hide")}else e.classList.add("hide")},renderGenres:function(e,a,t,r){for(var i="",n=a.Genres||[],s=0,o=n.length;o>s&&!(t&&s>=t);s++){s>0&&(i+="<span>&nbsp;&nbsp;/&nbsp;&nbsp;</span>");var l="Audio"==a.Type||"MusicArtist"==a.Type||"MusicAlbum"==a.Type?"musicgenre":"genre";"Game"==a.MediaType&&(l="gamegenre"),i+=r?n[s]:'<a class="textlink" href="itemdetails.html?'+l+"="+ApiClient.encodeName(n[s])+'">'+n[s]+"</a>"}e.innerHTML=i},renderPremiereDate:function(e,a){if(a.PremiereDate)try{var t=n.parseISO8601Date(a.PremiereDate,!0),r=(new Date).getTime()>t.getTime()?"ValuePremiered":"ValuePremieres";e.show().html(Globalize.translate(r,t.toLocaleDateString()))}catch(i){e.hide()}else e.hide()},renderAwardSummary:function(e,a){a.AwardSummary?(e.classList.remove("hide"),e.innerHTML=Globalize.translate("ValueAwards",a.AwardSummary)):e.classList.add("hide")},renderDetailPageBackdrop:function(e,a){var t,r=c.availWidth,i=!1,n=e.querySelector("#itemBackdrop");return a.BackdropImageTags&&a.BackdropImageTags.length?(t=ApiClient.getScaledImageUrl(a.Id,{type:"Backdrop",index:0,maxWidth:r,tag:a.BackdropImageTags[0]}),n.classList.remove("noBackdrop"),ImageLoader.lazyImage(n,t,!1),i=!0):a.ParentBackdropItemId&&a.ParentBackdropImageTags&&a.ParentBackdropImageTags.length?(t=ApiClient.getScaledImageUrl(a.ParentBackdropItemId,{type:"Backdrop",index:0,tag:a.ParentBackdropImageTags[0],maxWidth:r}),n.classList.remove("noBackdrop"),ImageLoader.lazyImage(n,t,!1),i=!0):(n.classList.add("noBackdrop"),n.style.backgroundImage=""),i}};return I}(window,document,screen);return window.LibraryBrowser=m,m});