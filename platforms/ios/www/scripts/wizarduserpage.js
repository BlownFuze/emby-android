define(["jQuery"],function(e){function a(){return ApiClient}function t(e){if(Dashboard.hideLoadingMsg(),e.UserLinkResult){var a=e.UserLinkResult.IsPending?"MessagePendingEmbyAccountAdded":"MessageEmbyAccountAdded";Dashboard.alert({message:Globalize.translate(a),title:Globalize.translate("HeaderEmbyAccountAdded"),callback:function(){Dashboard.navigate("wizardlibrary.html")}})}else Dashboard.navigate("wizardlibrary.html")}function n(e){Dashboard.showLoadingMsg();var n=a();n.ajax({type:"POST",data:{Name:e.querySelector("#txtUsername").value,ConnectUserName:e.querySelector("#txtConnectUserName").value},url:n.getUrl("Startup/User"),dataType:"json"}).then(t,function(){r(e.querySelector("#txtConnectUserName").value)})}function r(e){var a;e?(a=Globalize.translate("ErrorAddingEmbyConnectAccount1",'<a href="https://emby.media/connect" target="_blank">https://emby.media/connect</a>'),a+="<br/><br/>"+Globalize.translate("ErrorAddingEmbyConnectAccount2","apps@emby.media")):a=Globalize.translate("DefaultErrorMessage"),Dashboard.alert({message:a})}function o(){var e=this;return n(e),!1}e(document).on("pageinit","#wizardUserPage",function(){e(".wizardUserForm").off("submit",o).on("submit",o)}).on("pageshow","#wizardUserPage",function(){Dashboard.showLoadingMsg();var e=this,t=a();t.getJSON(t.getUrl("Startup/User")).then(function(a){e.querySelector("#txtUsername").value=a.Name||"",e.querySelector("#txtConnectUserName").value=a.ConnectUserName||"",Dashboard.hideLoadingMsg()})})});