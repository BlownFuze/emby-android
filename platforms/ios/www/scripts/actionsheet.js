define(["paperdialoghelper","paper-menu","paper-dialog","scale-up-animation","fade-out-animation"],function(t){function e(t,e){for(;!t.classList||!t.classList.contains(e);)if(t=t.parentNode,!t)return null;return t}function n(n){var i="";i+='<div style="margin:0;padding:.8em 1em;">';var o,a=$(window).height();n.positionTo&&a>=540&&(o=$(n.positionTo).offset(),o.top+=$(n.positionTo).innerHeight()/2,o.left+=$(n.positionTo).innerWidth()/2,o.top-=24,o.left-=24,o.top-=55*n.items.length/2,o.left-=80,o.top-=$(window).scrollTop(),o.left-=$(window).scrollLeft(),o.top=Math.min(o.top,$(window).height()-300),o.left=Math.min(o.left,$(window).width()-300),o.top=Math.max(o.top,0),o.left=Math.max(o.left,0)),n.title&&(i+="<h3>",i+=n.title,i+="</h3>");var r=n.items.filter(function(t){return t.ironIcon}),l=r.length,s=n.title&&(!r.length||r.length!=n.items.length);i+=s?'<paper-menu style="text-align:center;">':"<paper-menu>";for(var p=0,c=n.items.length;c>p;p++){var d=n.items[p];i+='<paper-menu-item class="actionSheetMenuItem" data-id="'+d.id+'" style="display:block;">',d.ironIcon?i+=s?'<iron-icon style="margin-right:.5em;" icon="'+d.ironIcon+'"></iron-icon>':'<iron-icon icon="'+d.ironIcon+'"></iron-icon>':l&&!s&&(i+="<iron-icon></iron-icon>"),i+="<span>"+d.name+"</span>",i+="</paper-menu-item>"}i+="</paper-menu>",i+="</div>",n.showCancel&&(i+='<div class="buttons">',i+="<paper-button dialog-dismiss>"+Globalize.translate("ButtonCancel")+"</paper-button>",i+="</div>");var m=t.createDialog({modal:!1,entryAnimationDuration:160,exitAnimationDuration:200,enableHistory:n.enableHistory});m.innerHTML=i,o&&(m.style.position="fixed",m.style.left=o.left+"px",m.style.top=o.top+"px"),document.body.appendChild(m),t.open(m),m.addEventListener("iron-overlay-closed",function(){m.parentNode.removeChild(m)});var u=browserInfo.firefox?"mousedown":"click";m.addEventListener(u,function(i){var o=e(i.target,"actionSheetMenuItem");if(o){var a=o.getAttribute("data-id");t.close(m),setTimeout(function(){n.callback&&n.callback(a)},100)}})}return{show:n}});