!function(e){function a(a,n){a.querySelector(".chkDisplayMissingEpisodes").checked=n.Configuration.DisplayMissingEpisodes||!1,a.querySelector(".chkDisplayUnairedEpisodes").checked=n.Configuration.DisplayUnairedEpisodes||!1,a.querySelector(".chkGroupMoviesIntoCollections").checked=n.Configuration.GroupMoviesIntoBoxSets||!1,e("#selectThemeSong",a).val(appStorage.getItem("enableThemeSongs-"+n.Id)||""),e("#selectBackdrop",a).val(appStorage.getItem("enableBackdrops-"+n.Id)||""),e("#selectLanguage",a).val(AppSettings.displayLanguage()),Dashboard.hideLoadingMsg()}function n(a,n){return n.Configuration.DisplayMissingEpisodes=a.querySelector(".chkDisplayMissingEpisodes").checked,n.Configuration.DisplayUnairedEpisodes=a.querySelector(".chkDisplayUnairedEpisodes").checked,n.Configuration.GroupMoviesIntoBoxSets=a.querySelector(".chkGroupMoviesIntoCollections").checked,AppSettings.displayLanguage(a.querySelector("#selectLanguage").value),appStorage.setItem("enableThemeSongs-"+n.Id,e("#selectThemeSong",a).val()),appStorage.setItem("enableBackdrops-"+n.Id,e("#selectBackdrop",a).val()),ApiClient.updateUserConfiguration(n.Id,n.Configuration)}function s(e){var a=getParameterByName("userId")||Dashboard.getCurrentUserId();AppInfo.enableAutoSave||Dashboard.showLoadingMsg(),ApiClient.getUser(a).then(function(a){n(e,a).then(function(){Dashboard.hideLoadingMsg(),AppInfo.enableAutoSave||Dashboard.alert(Globalize.translate("SettingsSaved"))},function(){Dashboard.hideLoadingMsg()})})}function o(){var a=e(this).parents(".page")[0];return s(a),!1}pageIdOn("pageinit","displayPreferencesPage",function(){var a=this;e(".displayPreferencesForm").off("submit",o).on("submit",o),AppInfo.enableAutoSave?a.querySelector(".btnSave").classList.add("hide"):a.querySelector(".btnSave").classList.remove("hide")}),pageIdOn("pageshow","displayPreferencesPage",function(){var n=this;Dashboard.showLoadingMsg();var s=getParameterByName("userId")||Dashboard.getCurrentUserId();ApiClient.getUser(s).then(function(s){a(n,s),s.Policy.EnableUserPreferenceAccess?e(".requiresUserPreferences",n).show():e(".requiresUserPreferences",n).hide()}),e(".fldEnableBackdrops",n).show(),AppInfo.supportsUserDisplayLanguageSetting?e(".languageSection",n).show():e(".languageSection",n).hide()}),pageIdOn("pagebeforehide","displayPreferencesPage",function(){var e=this;AppInfo.enableAutoSave&&s(e)})}(jQuery,window,document);