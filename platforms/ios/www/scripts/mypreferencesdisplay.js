!function(e,s,a){function o(s,a){s.querySelector(".chkDisplayMissingEpisodes").checked=a.Configuration.DisplayMissingEpisodes||!1,s.querySelector(".chkDisplayUnairedEpisodes").checked=a.Configuration.DisplayUnairedEpisodes||!1,s.querySelector(".chkGroupMoviesIntoCollections").checked=a.Configuration.GroupMoviesIntoBoxSets||!1,e("#selectThemeSong",s).val(appStorage.getItem("enableThemeSongs-"+a.Id)||""),e("#selectBackdrop",s).val(appStorage.getItem("enableBackdrops-"+a.Id)||""),e("#selectLanguage",s).val(AppSettings.displayLanguage()),Dashboard.hideLoadingMsg()}function n(s,a){a.Configuration.DisplayMissingEpisodes=s.querySelector(".chkDisplayMissingEpisodes").checked,a.Configuration.DisplayUnairedEpisodes=s.querySelector(".chkDisplayUnairedEpisodes").checked,a.Configuration.GroupMoviesIntoBoxSets=s.querySelector(".chkGroupMoviesIntoCollections").checked,AppSettings.displayLanguage(s.querySelector("#selectLanguage").value),appStorage.setItem("enableThemeSongs-"+a.Id,e("#selectThemeSong",s).val()),appStorage.setItem("enableBackdrops-"+a.Id,e("#selectBackdrop",s).val()),ApiClient.updateUserConfiguration(a.Id,a.Configuration).then(function(){Dashboard.alert(Globalize.translate("SettingsSaved")),o(s,a)})}function i(){var s=e(this).parents(".page")[0];Dashboard.showLoadingMsg();var a=getParameterByName("userId")||Dashboard.getCurrentUserId();return ApiClient.getUser(a).then(function(e){n(s,e)}),!1}e(a).on("pageinit","#displayPreferencesPage",function(){e(".displayPreferencesForm").off("submit",i).on("submit",i)}).on("pageshow","#displayPreferencesPage",function(){var s=this;Dashboard.showLoadingMsg();var a=getParameterByName("userId")||Dashboard.getCurrentUserId();ApiClient.getUser(a).then(function(a){o(s,a),a.Policy.EnableUserPreferenceAccess?e(".requiresUserPreferences",s).show():e(".requiresUserPreferences",s).hide()}),e(".fldEnableBackdrops",s).show(),AppInfo.supportsUserDisplayLanguageSetting?e(".languageSection",s).show():e(".languageSection",s).hide()})}(jQuery,window,document);