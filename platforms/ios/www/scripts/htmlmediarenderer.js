!function(){function e(e){function o(){A(),Events.trigger(S,"ended")}function d(){Events.trigger(S,"timeupdate")}function s(){Events.trigger(S,"volumechange")}function u(e){var n=e.target;n.removeEventListener("playing",u),$(".mediaPlayerAudioContainer").hide()}function l(){Events.trigger(S,"playing")}function c(){Events.trigger(S,"play")}function v(){Events.trigger(S,"pause")}function f(){Events.trigger(S,"click")}function m(){Events.trigger(S,"dblclick")}function p(e){A();{var n=e.target;n.error?n.error.code:""}Events.trigger(S,"error")}function g(e){var n=e.target;n.removeEventListener("loadedmetadata",g),t||n.play()}function y(e){require(["hlsjs"],function(n){window.Hls=n,e()})}function E(e){var n=e,t=n.split("#");return t.length>1&&(t=t[t.length-1].split("="),2==t.length)?parseFloat(t[1]):0}function L(e){var n=e.target;n.removeEventListener("playing",L),S.setCurrentTrackElement(i);var t=!S.enableCustomVideoControls();if(t&&$(n).attr("controls","controls"),r){var a=(S.currentSrc()||"").toLowerCase(),o=E(a);if(o&&-1!=a.indexOf(".m3u8")){var d=browserInfo.safari?2500:0;d?setTimeout(function(){n.currentTime=o},d):n.currentTime=o}}}function T(){var e=$(".mediaPlayerAudio");if(!e.length){var n="",t=!MediaPlayer.canAutoPlayAudio();n+=t?'<div class="mediaPlayerAudioContainer" style="position: fixed;top: 40%;text-align: center;left: 0;right: 0;z-index:999999;"><div class="mediaPlayerAudioContainerInner">':'<div class="mediaPlayerAudioContainer" style="display:none;padding: 1em;background: #222;"><div class="mediaPlayerAudioContainerInner">',n+='<audio class="mediaPlayerAudio" controls>',n+="</audio></div></div>",$(document.body).append(n),e=$(".mediaPlayerAudio")}return e=e[0],e.addEventListener("playing",u),e.addEventListener("timeupdate",d),e.addEventListener("ended",o),e.addEventListener("volumechange",s),e.addEventListener("error",p),e.addEventListener("pause",v),e.addEventListener("play",c),e.addEventListener("playing",l),e}function k(e){return e&&-1==e.indexOf(".m3u8")?!1:MediaPlayer.canPlayHls()&&!MediaPlayer.canPlayNativeHls()}function w(){return"anonymous"}function b(){var n="",t=!S.enableCustomVideoControls(),r=!browserInfo.safari&&e.poster?' poster="'+e.poster+'"':"";n+=t&&AppInfo.isNativeApp&&browserInfo.android?'<video class="itemVideo" id="itemVideo" preload="metadata" autoplay="autoplay"'+r+" webkit-playsinline>":t?'<video class="itemVideo" id="itemVideo" preload="metadata" autoplay="autoplay"'+r+' controls="controls" webkit-playsinline>':'<video class="itemVideo" id="itemVideo" preload="metadata" autoplay="autoplay"'+r+" webkit-playsinline>",n+="</video>";var i=$("#videoElement","#videoPlayer").prepend(n),a=$(".itemVideo",i)[0];return a.addEventListener("loadedmetadata",g),a.addEventListener("timeupdate",d),a.addEventListener("ended",o),a.addEventListener("volumechange",s),a.addEventListener("play",c),a.addEventListener("pause",v),a.addEventListener("playing",l),a.addEventListener("click",f),a.addEventListener("dblclick",m),a.addEventListener("error",p),a}function h(e,n){var t=n.map(function(e){var n=e.isDefault?" default":"",t=e.language||"und";return'<track id="textTrack'+e.index+'" label="'+t+'" kind="subtitles" src="'+e.url+'" srclang="'+e.language+'"'+n+"></track>"}).join("");e.innerHTML=t}function x(){return browserInfo.safari&&browserInfo.mobile?!1:browserInfo.firefox&&-1!=(O||"").toLowerCase().indexOf(".m3u8")?!1:!0}function A(e){if(e)for(var n=V.textTracks,t=0;t<n.length;t++){var r=n[t];-1!=r.label.indexOf("manualTrack")&&(r.mode="disabled")}H=-1}function C(e){return ApiClient.ajax({url:e.url.replace(".vtt",".js"),type:"GET",dataType:"json"})}function P(e){return e?void(H!=e.index&&(A(!0),H=e.index,I(e))):void A(!0)}function I(e){for(var n=null,t="manualTrack"+e.index,r=V.textTracks,i=0;i<r.length;i++){var a=r[i];if(a.label==t){n=a;break}a.mode="disabled"}n?n.mode="showing":(n=V.addTextTrack("subtitles","manualTrack"+e.index,e.language||"und"),n.label="manualTrack"+e.index,C(e).then(function(e){e.TrackEvents.forEach(function(e){n.addCue(new VTTCue(e.StartPositionTicks/1e7,e.EndPositionTicks/1e7,e.Text.replace(/\\N/gi,"\n")))}),n.mode="showing"}))}var V,N,S=this;S.currentTime=function(e){return V?null!=e?void(V.currentTime=e/1e3):N?1e3*N:1e3*(V.currentTime||0):void 0},S.duration=function(){return V?V.duration:null},S.stop=function(){if(A(),V&&(V.pause(),t)){N=V.currentTime;try{t.destroy()}catch(e){}t=null}},S.pause=function(){V&&V.pause()},S.unpause=function(){V&&V.play()},S.volume=function(e){return V?null!=e?void(V.volume=e):V.volume:void 0};var O;S.setCurrentSrc=function(e,n,o,d){var s=V;if(!s)return void(O=null);if(!e)return O=null,s.src=null,s.src="",void(browserInfo.safari&&(s.src="files/dummy.mp4",s.play()));s.crossOrigin=w(o);var u=e.url;AppInfo.isNativeApp&&browserInfo.safari&&(u=u.replace("file://","")),r=!1;var l=E(u),c=!1;if("audio"==s.tagName.toLowerCase())s.src=u,c=!0;else{s.removeEventListener("playing",L),s.addEventListener("playing",L),t&&(t.destroy(),t=null),l&&(r=!0),d=d||[],a=d;for(var v=-1,f=0,m=d.length;m>f;f++)if(d[f].isDefault){v=d[f].index;break}if(i=v,k(u)){h(s,d);var p=new Hls;p.loadSource(u),p.attachMedia(s),p.on(Hls.Events.MANIFEST_PARSED,function(){s.play()}),t=p}else s.src=u,s.autoplay=!0,h(s,d),s.addEventListener("loadedmetadata",g),c=!0;O=u,S.setCurrentTrackElement(v)}O=u,c&&s.play()},S.currentSrc=function(){return V?O:void 0},S.paused=function(){return V?V.paused:!1},S.cleanup=function(){S.setCurrentSrc(null),N=null;var e=V;e&&("AUDIO"==e.tagName?(e.removeEventListener("timeupdate",d),e.removeEventListener("ended",o),e.removeEventListener("volumechange",s),e.removeEventListener("playing",u),e.removeEventListener("play",c),e.removeEventListener("pause",v),e.removeEventListener("playing",l),e.removeEventListener("error",p)):(e.removeEventListener("loadedmetadata",g),e.removeEventListener("playing",L),e.removeEventListener("timeupdate",d),e.removeEventListener("ended",o),e.removeEventListener("volumechange",s),e.removeEventListener("play",c),e.removeEventListener("pause",v),e.removeEventListener("playing",l),e.removeEventListener("click",f),e.removeEventListener("dblclick",m),e.removeEventListener("error",p)),"audio"!=e.tagName.toLowerCase()&&$(e).remove())},S.supportsTextTracks=function(){return null==n&&(n=null!=document.createElement("video").textTracks),n};var H=-1;S.setCurrentTrackElement=function(e){var n=-1==e?null:a.filter(function(n){return n.index==e})[0];x(n)?P(null):(P(n),e=-1,n=null);for(var t="textTrack"+e,r=-1!=e&&n?a.indexOf(n):-1,i=["disabled","showing","hidden"],o=V.textTracks,d=0;d<o.length;d++){var s,u=o[d];if(browserInfo.msie||browserInfo.edge)s=r==d?1:0;else{if(-1!=u.label.indexOf("manualTrack"))continue;s=u.id==t?1:0}var l=!1;!isNaN(u.mode),u.mode=l?s:i[s]}},S.updateTextStreamUrls=function(e){if(S.supportsTextTracks()){for(var n=V.textTracks,t=0;t<n.length;t++){var r=n[t];try{for(;r.cues.length;)r.removeCue(r.cues[0])}catch(i){}}$("track",V).each(function(){this.src=replaceQueryString(this.src,"startPositionTicks",e)})}},S.enableCustomVideoControls=function(){return AppInfo.isNativeApp&&browserInfo.safari?-1!=navigator.userAgent.toLowerCase().indexOf("iphone")?!0:!1:S.canAutoPlayVideo()},S.canAutoPlayVideo=function(){return AppInfo.isNativeApp?!0:browserInfo.mobile?!1:!0},S.init=function(){return new Promise(function(n){"video"==e.type&&k()?y(n):n()})},V="audio"==e.type?T():b()}var n,t,r,i,a;window.AudioRenderer||(window.AudioRenderer=function(n){return n=n||{},n.type="audio",new e(n)}),window.VideoRenderer||(window.VideoRenderer=function(n){return n=n||{},n.type="video",new e(n)})}();