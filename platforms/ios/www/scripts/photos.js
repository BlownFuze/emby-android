define(["jQuery"],function(e){function t(){var e=r(),t=u[e];return t||(t=u[e]={query:{SortBy:"IsFolder,SortName",SortOrder:"Ascending",Fields:"PrimaryImageAspectRatio,SortName,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()}},t.query.Recursive=!1,t.query.MediaTypes=null,t.query.ParentId=getParameterByName("parentId")||LibraryMenu.getTopParentId(),LibraryBrowser.loadSavedQueryValues(e,t.query)),t.query}function r(){return LibraryBrowser.getSavedQueryKey("v1")}function i(a){Dashboard.showLoadingMsg();var n=t();ApiClient.getItems(Dashboard.getCurrentUserId(),n).then(function(t){window.scrollTo(0,0);var o="",u=LibraryBrowser.getQueryPagingHtml({startIndex:n.StartIndex,limit:n.Limit,totalRecordCount:t.TotalRecordCount,viewButton:!1,showLimit:!1});a.querySelector(".listTopPaging").innerHTML=u,"Poster"==s&&(o=LibraryBrowser.getPosterViewHtml({items:t.Items,shape:"square",context:getParameterByName("context")||"photos",overlayText:!0,lazy:!0,coverImage:!0,showTitle:!1,centerText:!0}));var d=a.querySelector(".itemsContainer");d.innerHTML=o+u,ImageLoader.lazyChildren(d),e(".btnNextPage",a).on("click",function(){n.StartIndex+=n.Limit,i(a)}),e(".btnPreviousPage",a).on("click",function(){n.StartIndex-=n.Limit,i(a)}),LibraryBrowser.saveQueryValues(r(),n),Dashboard.hideLoadingMsg()})}function a(t,r,i){var a=Dashboard.getCurrentUserId(),o=e.extend({},r);o.StartIndex=0,o.Limit=null,o.MediaTypes="Photo",o.Recursive=!0,o.Filters="IsNotFolder",ApiClient.getItems(a,o).then(function(e){n(t,e.Items,i)})}function n(e,t,r){var i=t.map(function(e){return e.Id}).indexOf(r);-1==i&&(i=0),require(["slideshow"],function(e){var r=new e({showTitle:!1,cover:!1,items:t,startIndex:i,interval:7e3,interactive:!0});r.show()})}function o(){var r=e(this).parents(".page")[0],i=LibraryBrowser.getListItemInfo(this);if("Photo"==i.mediaType){var a=t();return Photos.startSlideshow(r,a,i.id),!1}}var s="Poster",u={};pageIdOn("pageinit","photosPage",function(){var t=this;i(t,0),e(t).on("click",".mediaItem",o)}),window.Photos={startSlideshow:a}});