define(["jQuery"],function(e){function n(e,n){require(["confirm"],function(i){i(Globalize.translate("MessageConfirmRecordingCancellation"),Globalize.translate("HeaderConfirmRecordingCancellation")).then(function(){Dashboard.showLoadingMsg(),ApiClient.cancelLiveTvTimer(n).then(function(){Dashboard.hideLoadingMsg(),require(["toast"],function(e){e(Globalize.translate("MessageRecordingCancelled"))}),d(e)})})})}function i(n,i){l=i,e(".itemName",n).html(i.Name),e("#txtPrePaddingMinutes",n).val(i.PrePaddingSeconds/60),e("#txtPostPaddingMinutes",n).val(i.PostPaddingSeconds/60),e("#chkNewOnly",n).checked(i.RecordNewOnly),e("#chkAllChannels",n).checked(i.RecordAnyChannel),e("#chkAnyTime",n).checked(i.RecordAnyTime);var t="";i.RecordAnyChannel?t+=Globalize.translate("LabelAllChannels"):i.ChannelId&&(t+='<a href="itemdetails.html?id='+i.ChannelId+'">'+i.ChannelName+"</a>"),e(".channel",n).html(t).trigger("create"),a(n,i.Days),i.RecordAnyTime?e(".time",n).html(Globalize.translate("LabelAnytime")).trigger("create"):i.ChannelId&&e(".time",n).html(LibraryBrowser.getDisplayTime(i.StartDate)).trigger("create"),Dashboard.hideLoadingMsg()}function t(){return LiveTvHelpers.getDaysOfWeek().map(function(e){return e.value})}function a(n,i){for(var a=t(),r=0,o=a.length;o>r;r++){var c=a[r];e("#chk"+c,n).checked(-1!=i.indexOf(c))}}function r(n){for(var i=t(),a=[],r=0,o=i.length;o>r;r++){var c=i[r];e("#chk"+c,n).checked()&&a.push(c)}return a}function o(){Dashboard.showLoadingMsg();var n=this;return ApiClient.getLiveTvSeriesTimer(l.Id).then(function(i){i.PrePaddingSeconds=60*e("#txtPrePaddingMinutes",n).val(),i.PostPaddingSeconds=60*e("#txtPostPaddingMinutes",n).val(),i.RecordNewOnly=e("#chkNewOnly",n).checked(),i.RecordAnyChannel=e("#chkAllChannels",n).checked(),i.RecordAnyTime=e("#chkAnyTime",n).checked(),i.Days=r(n),ApiClient.updateLiveTvSeriesTimer(i).then(function(){Dashboard.hideLoadingMsg(),require(["toast"],function(e){e(Globalize.translate("MessageRecordingSaved"))})})}),!1}function c(n,i){e(".recordingsTab",n).html(LibraryBrowser.getPosterViewHtml({items:i.Items,shape:"detailPageSquare",showTitle:!0,centerText:!0,coverImage:!0}))}function s(i,t){var a=t.Items;LiveTvHelpers.getTimersHtml(a).then(function(t){var a=e(".scheduleTab",i).html(t)[0];ImageLoader.lazyChildren(a),e(".btnDeleteTimer",a).on("click",function(){var e=this.getAttribute("data-timerid");n(i,e)})})}function d(e){Dashboard.showLoadingMsg();var n=getParameterByName("id");ApiClient.getLiveTvSeriesTimer(n).then(function(n){i(e,n)}),ApiClient.getLiveTvRecordings({userId:Dashboard.getCurrentUserId(),seriesTimerId:n}).then(function(n){c(e,n)}),ApiClient.getLiveTvTimers({seriesTimerId:n}).then(function(n){s(e,n)})}var l;e(document).on("pageinit","#liveTvSeriesTimerPage",function(){var n=this;e(".radioSeriesTimerTab",n).on("change",function(){e(".tab",n).hide(),e("."+this.value+"Tab",n).show()}),e(".liveTvSeriesTimerForm").off("submit",o).on("submit",o)}).on("pagebeforeshow","#liveTvSeriesTimerPage",function(){var n=this;e(".radioProfileTab",n).checked(!1).checkboxradio("refresh"),e("#radioSettings",n).checked(!0).checkboxradio("refresh").trigger("change"),d(n)}).on("pagebeforehide","#liveTvSeriesTimerPage",function(){l=null})});