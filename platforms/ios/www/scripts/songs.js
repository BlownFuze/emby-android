define(["jQuery"],function(e){function t(e){var t=a(e),r=l[t];return r||(r=l[t]={query:{SortBy:o,SortOrder:"Ascending",IncludeItemTypes:"Audio",Recursive:!0,Fields:"AudioInfo,ParentId,SyncInfo",Limit:100,StartIndex:0,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"}},r.query.ParentId=LibraryMenu.getTopParentId(),LibraryBrowser.loadSavedQueryValues(t,r.query)),r}function r(e){return t(e).query}function a(e){return e.savedQueryKey||(e.savedQueryKey=LibraryBrowser.getSavedQueryKey("songs")),e.savedQueryKey}function n(t){Dashboard.showLoadingMsg();var o=r(t);ApiClient.getItems(Dashboard.getCurrentUserId(),o).then(function(r){window.scrollTo(0,0);var l="",u=LibraryBrowser.getQueryPagingHtml({startIndex:o.StartIndex,limit:o.Limit,totalRecordCount:r.TotalRecordCount,showLimit:!1,sortButton:!0,updatePageSizeSetting:!1,filterButton:!0});t.querySelector(".listTopPaging").innerHTML=u,l+=LibraryBrowser.getListViewHtml({items:r.Items,showIndex:!0,defaultAction:"play",smallIcon:!0});var s=t.querySelector("#items");s.innerHTML=l+u,ImageLoader.lazyChildren(s),e(".btnNextPage",t).on("click",function(){o.StartIndex+=o.Limit,n(t)}),e(".btnPreviousPage",t).on("click",function(){o.StartIndex-=o.Limit,n(t)}),e(".btnFilter",t).on("click",function(){i(t)}),e(".btnSort",t).on("click",function(){LibraryBrowser.showSortMenu({items:[{name:Globalize.translate("OptionTrackName"),id:"Name"},{name:Globalize.translate("OptionAlbum"),id:"Album,SortName"},{name:Globalize.translate("OptionAlbumArtist"),id:"AlbumArtist,Album,SortName"},{name:Globalize.translate("OptionArtist"),id:"Artist,Album,SortName"},{name:Globalize.translate("OptionDateAdded"),id:"DateCreated,SortName"},{name:Globalize.translate("OptionDatePlayed"),id:"DatePlayed,SortName"},{name:Globalize.translate("OptionPlayCount"),id:"PlayCount,SortName"},{name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate,AlbumArtist,Album,SortName"},{name:Globalize.translate("OptionRuntime"),id:"Runtime,AlbumArtist,Album,SortName"}],callback:function(){n(t)},query:o})}),LibraryBrowser.saveQueryValues(a(t),o),Dashboard.hideLoadingMsg()})}function i(e){require(["components/filterdialog/filterdialog"],function(t){var a=new t({query:r(e),mode:"songs"});Events.on(a,"filterchange",function(){n(e)}),a.show()})}var o="Album,SortName",l={};window.MusicPage.renderSongsTab=function(e,t){LibraryBrowser.needsRefresh(t)&&n(t)}});