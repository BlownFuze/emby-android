define(["jQuery"],function(){function e(e,t){e.querySelector(".txtDevicePath").value="",t&&ApiClient.getNamedConfiguration("livetv").then(function(r){var n=r.TunerHosts.filter(function(e){return e.Id==t})[0];e.querySelector(".txtDevicePath").value=n.Url||"",e.querySelector(".txtM3uUrl").value=n.M3UUrl||"",e.querySelector(".chkEnabled").checked=n.IsEnabled})}function t(e,t){t.Url=e.querySelector(".txtDevicePath").value,t.M3UUrl=e.querySelector(".txtM3uUrl").value,t.IsEnabled=e.querySelector(".chkEnabled").checked}function r(e,t){ApiClient.ajax({type:"POST",url:ApiClient.getUrl("LiveTv/TunerHosts"),data:JSON.stringify(t),contentType:"application/json"}).then(function(){Dashboard.processServerConfigurationUpdateResult(),Dashboard.navigate("livetvstatus.html")},function(){Dashboard.hideLoadingMsg(),Dashboard.alert({message:Globalize.translate("ErrorSavingTvProvider")})})}function n(e){ApiClient.getJSON(ApiClient.getUrl("LiveTv/TunerHosts/Satip/IniMappings")).then(function(t){var r=t.map(function(e){return'<option value="'+e.Value+'">'+e.Name+"</option>"}).join("");r='<option value="">'+Globalize.translate("OptionNone")+"</option>"+r,e.querySelector(".selectSourceA").innerHTML=r,e.querySelector(".selectSourceB").innerHTML=r,e.querySelector(".selectSourceC").innerHTML=r,e.querySelector(".selectSourceD").innerHTML=r})}return function(i,o){function l(){Dashboard.showLoadingMsg();var e=o.id;if(e)ApiClient.getNamedConfiguration("livetv").then(function(n){var o=n.TunerHosts.filter(function(t){return t.Id==e})[0];t(i,o),r(i,o)});else{var n={Type:"satip"};t(i,n),r(i,n)}}function a(e){var t=e.target,r=t.value;r?i.querySelector(".fldSourceB").classList.remove("hide"):i.querySelector(".fldSourceB").classList.add("hide"),"diseqc1"==r?(i.querySelector(".fldSourceC").classList.remove("hide"),i.querySelector(".fldSourceD").classList.remove("hide")):(i.querySelector(".fldSourceC").classList.add("hide"),i.querySelector(".fldSourceD").classList.add("hide"))}i.querySelector("form").addEventListener("submit",function(e){return l(),e.preventDefault(),!1}),i.querySelector(".selectDiseqC").addEventListener("change",a),n(i),i.addEventListener("viewshow",function(){var t=o.id;e(i,t)})}});