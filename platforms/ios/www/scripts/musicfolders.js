define(["events","libraryBrowser","imageLoader"],function(e,t,r){return function(e,n,a){function i(e){var r=u(e),a=l[r];return a||(a=l[r]={query:{SortBy:"SortName",SortOrder:"Ascending",Fields:"PrimaryImageAspectRatio,SortName,SyncInfo",StartIndex:0,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",Limit:LibraryBrowser.getDefaultPageSize()},view:t.getSavedView(r)||t.getDefaultItemsView("Poster","Poster")},a.query.ParentId=n.topParentId,t.loadSavedQueryValues(r,a.query)),a}function o(e){return i(e).query}function u(e){return e.savedQueryKey||(e.savedQueryKey=t.getSavedQueryKey("folders")),e.savedQueryKey}function s(e){Dashboard.showLoadingMsg();var n=o(e);ApiClient.getItems(Dashboard.getCurrentUserId(),n).then(function(i){function o(){n.StartIndex+=n.Limit,s(a)}function d(){n.StartIndex-=n.Limit,s(a)}window.scrollTo(0,0);var l,y,g=LibraryBrowser.getQueryPagingHtml({startIndex:n.StartIndex,limit:n.Limit,totalRecordCount:i.TotalRecordCount,showLimit:!1,updatePageSizeSetting:!1,addLayoutButton:!1,sortButton:!1,filterButton:!1}),c=LibraryBrowser.getPosterViewHtml({items:i.Items,shape:"square",context:"folders",showTitle:!0,showParentTitle:!0,lazy:!0,centerText:!0,overlayPlayButton:!0}),m=a.querySelectorAll(".paging");for(l=0,y=m.length;y>l;l++)m[l].innerHTML=g;for(m=a.querySelectorAll(".btnNextPage"),l=0,y=m.length;y>l;l++)m[l].addEventListener("click",o);for(m=a.querySelectorAll(".btnPreviousPage"),l=0,y=m.length;y>l;l++)m[l].addEventListener("click",d);var f=a.querySelector(".itemsContainer");f.innerHTML=c,r.lazyChildren(f),t.saveQueryValues(u(e),n),Dashboard.hideLoadingMsg()})}var d=this,l={};d.getCurrentViewStyle=function(){return i(a).view},d.renderTab=function(){s(a)},d.destroy=function(){}}});