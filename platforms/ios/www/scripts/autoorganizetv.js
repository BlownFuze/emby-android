!function(e,t){function a(t,a){var r=a.replace("%s","1").replace("%0s","01").replace("%00s","001"),i=Globalize.translate("OrganizePatternResult").replace("{0}",r);e(".seasonFolderFieldDescription",t).html(i)}function r(e,t){var a="Series Name",r="Episode Four",i=e.replace("%sn",a).replace("%s.n",a.replace(" ",".")).replace("%s_n",a.replace(" ","_")).replace("%s","1").replace("%0s","01").replace("%00s","001").replace("%ext","mkv").replace("%en",r).replace("%e.n",r.replace(" ",".")).replace("%e_n",r.replace(" ","_"));return t&&(i=i.replace("%ed","5").replace("%0ed","05").replace("%00ed","005")),i.replace("%e","4").replace("%0e","04").replace("%00e","004")}function i(t,a){a=r(a,!1);var i=Globalize.translate("OrganizePatternResult").replace("{0}",a);e(".episodePatternDescription",t).html(i)}function n(t,a){a=r(a,!0);var i=Globalize.translate("OrganizePatternResult").replace("{0}",a);e(".multiEpisodePatternDescription",t).html(i)}function l(t,a){var r=a.TvOptions;e("#chkEnableTvSorting",t).checked(r.IsEnabled).checkboxradio("refresh"),e("#chkOverwriteExistingEpisodes",t).checked(r.OverwriteExistingEpisodes).checkboxradio("refresh"),e("#chkDeleteEmptyFolders",t).checked(r.DeleteEmptyFolders).checkboxradio("refresh"),e("#txtMinFileSize",t).val(r.MinFileSizeMb),e("#txtSeasonFolderPattern",t).val(r.SeasonFolderPattern).trigger("change"),e("#txtSeasonZeroName",t).val(r.SeasonZeroFolderName),e("#txtWatchFolder",t).val(r.WatchLocations[0]||""),e("#txtEpisodePattern",t).val(r.EpisodeNamePattern).trigger("change"),e("#txtMultiEpisodePattern",t).val(r.MultiEpisodeNamePattern).trigger("change"),e("#txtDeleteLeftOverFiles",t).val(r.LeftOverFileExtensionsToDelete.join(";")),e("#copyOrMoveFile",t).val(r.CopyOriginalFile.toString())}function o(){var t=this;return ApiClient.getNamedConfiguration("autoorganize").then(function(a){var r=a.TvOptions;r.IsEnabled=e("#chkEnableTvSorting",t).checked(),r.OverwriteExistingEpisodes=e("#chkOverwriteExistingEpisodes",t).checked(),r.DeleteEmptyFolders=e("#chkDeleteEmptyFolders",t).checked(),r.MinFileSizeMb=e("#txtMinFileSize",t).val(),r.SeasonFolderPattern=e("#txtSeasonFolderPattern",t).val(),r.SeasonZeroFolderName=e("#txtSeasonZeroName",t).val(),r.EpisodeNamePattern=e("#txtEpisodePattern",t).val(),r.MultiEpisodeNamePattern=e("#txtMultiEpisodePattern",t).val(),r.LeftOverFileExtensionsToDelete=e("#txtDeleteLeftOverFiles",t).val().split(";");var i=e("#txtWatchFolder",t).val();r.WatchLocations=i?[i]:[],r.CopyOriginalFile=e("#copyOrMoveFile",t).val(),ApiClient.updateNamedConfiguration("autoorganize",a).then(Dashboard.processServerConfigurationUpdateResult)}),!1}e(t).on("pageinit","#libraryFileOrganizerPage",function(){var t=this;e("#txtSeasonFolderPattern",t).on("change keyup",function(){a(t,this.value)}),e("#txtEpisodePattern",t).on("change keyup",function(){i(t,this.value)}),e("#txtMultiEpisodePattern",t).on("change keyup",function(){n(t,this.value)}),e("#btnSelectWatchFolder",t).on("click.selectDirectory",function(){require(["directorybrowser"],function(a){var r=new a;r.show({callback:function(a){a&&e("#txtWatchFolder",t).val(a),r.close()},header:Globalize.translate("HeaderSelectWatchFolder"),instruction:Globalize.translate("HeaderSelectWatchFolderHelp")})})}),e(".libraryFileOrganizerForm").off("submit",o).on("submit",o)}).on("pageshow","#libraryFileOrganizerPage",function(){var e=this;ApiClient.getNamedConfiguration("autoorganize").then(function(t){l(e,t)})})}(jQuery,document,window);