!function(e){function t(){var e=r(),t=s[e];return t||(t=s[e]={query:{SortBy:"",SortOrder:"Ascending",Fields:"PrimaryImageAspectRatio,SyncInfo",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()}},LibraryBrowser.loadSavedQueryValues(e,t.query)),t}function a(){return t().query}function r(){return LibraryBrowser.getSavedQueryKey("movies")}function i(r){var i=getParameterByName("id");ApiClient.getJSON(ApiClient.getUrl("Channels/"+i+"/Features")).then(function(i){i.CanFilter?e(".filterControls",r).show():e(".filterControls",r).hide(),i.SupportsSortOrderToggle?e(".sortOrderToggle",r).show():e(".sortOrderToggle",r).hide();var o=i.MaxPageSize,l=a();o&&(l.Limit=Math.min(o,l.Limit||o)),t().sortFields=i.DefaultSortFields,n(r)})}function n(t){Dashboard.showLoadingMsg();var r=getParameterByName("id"),i=getParameterByName("folderId"),s=a();s.UserId=Dashboard.getCurrentUserId(),i?ApiClient.getItem(s.UserId,i).then(function(e){LibraryMenu.setTitle(e.Name)}):ApiClient.getItem(s.UserId,r).then(function(e){LibraryMenu.setTitle(e.Name)}),s.folderId=i,ApiClient.getJSON(ApiClient.getUrl("Channels/"+r+"/Items",s)).then(function(a){window.scrollTo(0,0);var r="",i=LibraryBrowser.getQueryPagingHtml({startIndex:s.StartIndex,limit:s.Limit,totalRecordCount:a.TotalRecordCount,viewButton:!0,showLimit:!1,updatePageSizeSetting:!1,viewIcon:"filter-list",sortButton:!0});t.querySelector(".listTopPaging").innerHTML=i,l(t),r=LibraryBrowser.getPosterViewHtml({items:a.Items,shape:"auto",defaultShape:"square",context:"channels",showTitle:!0,coverImage:!0,showYear:!0,lazy:!0,centerText:!0});var d=t.querySelector("#items");d.innerHTML=r+i,ImageLoader.lazyChildren(d),e(".btnNextPage",t).on("click",function(){s.StartIndex+=s.Limit,n(t)}),e(".btnPreviousPage",t).on("click",function(){s.StartIndex-=s.Limit,n(t)}),e(".btnSort",t).on("click",function(){o(t)}),Dashboard.hideLoadingMsg()},function(){Dashboard.hideLoadingMsg()})}function o(e){var r=t().sortFields,i=[];i.push({name:Globalize.translate("OptionDefaultSort"),id:""}),-1!=r.indexOf("Name")&&i.push({name:Globalize.translate("OptionNameSort"),id:"SortName"}),-1!=r.indexOf("CommunityRating")&&i.push({name:Globalize.translate("OptionCommunityRating"),id:"CommunityRating"}),-1!=r.indexOf("DateCreated")&&i.push({name:Globalize.translate("OptionDateAdded"),id:"DateCreated"}),-1!=r.indexOf("PlayCount")&&i.push({name:Globalize.translate("OptionPlayCount"),id:"PlayCount"}),-1!=r.indexOf("PremiereDate")&&i.push({name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate"}),-1!=r.indexOf("Runtime")&&i.push({name:Globalize.translate("OptionRuntime"),id:"Runtime"}),LibraryBrowser.showSortMenu({items:i,callback:function(){n(e)},query:a()})}function l(t){var r=a();e(".chkStandardFilter",t).each(function(){var e=","+(r.Filters||""),t=this.getAttribute("data-filter");this.checked=-1!=e.indexOf(","+t)}),e(".alphabetPicker",t).alphaValue(r.NameStartsWith)}var s={};pageIdOn("pageinit","channelItemsPage",function(){var t=this;e(".chkStandardFilter",this).on("change",function(){var e=a(),r=this.getAttribute("data-filter"),i=e.Filters||"";i=(","+i).replace(","+r,"").substring(1),this.checked&&(i=i?i+","+r:r),e.StartIndex=0,e.Filters=i,n(t)}),e(".alphabetPicker",this).on("alphaselect",function(e,r){var i=a();i.NameStartsWithOrGreater=r,i.StartIndex=0,n(t)}).on("alphaclear",function(){var e=a();e.NameStartsWithOrGreater="",n(t)})}),pageIdOn("pagebeforeshow","channelItemsPage",function(){var e=this;i(e),l(e)})}(jQuery,document);