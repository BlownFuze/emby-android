!function(e){function t(e){var t=n(e),a=d[t];return a||(a=d[t]={query:{SortBy:"",SortOrder:"Ascending",Fields:"PrimaryImageAspectRatio,SyncInfo",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()}},LibraryBrowser.loadSavedQueryValues(t,a.query)),a}function a(e){return t(e).query}function n(e){return e.savedQueryKey||(e.savedQueryKey=LibraryBrowser.getSavedQueryKey("channelitems")),e.savedQueryKey}function r(e,t){return e.pageParams||(e.pageParams={}),e.pageParams[t]||(e.pageParams[t]=getParameterByName(t)),e.pageParams[t]}function i(n){var i=r(n,"id");ApiClient.getJSON(ApiClient.getUrl("Channels/"+i+"/Features")).then(function(r){r.CanFilter?e(".filterControls",n).show():e(".filterControls",n).hide(),r.SupportsSortOrderToggle?e(".sortOrderToggle",n).show():e(".sortOrderToggle",n).hide();var i=r.MaxPageSize,l=a(n);i&&(l.Limit=Math.min(i,l.Limit||i)),t(n).sortFields=r.DefaultSortFields,o(n)})}function o(t){Dashboard.showLoadingMsg();var n=r(t,"id"),i=r(t,"folderId"),d=a(t);d.UserId=Dashboard.getCurrentUserId(),i?ApiClient.getItem(d.UserId,i).then(function(e){LibraryMenu.setTitle(e.Name)}):ApiClient.getItem(d.UserId,n).then(function(e){LibraryMenu.setTitle(e.Name)}),d.folderId=i,ApiClient.getJSON(ApiClient.getUrl("Channels/"+n+"/Items",d)).then(function(a){window.scrollTo(0,0);var n="",r=LibraryBrowser.getQueryPagingHtml({startIndex:d.StartIndex,limit:d.Limit,totalRecordCount:a.TotalRecordCount,showLimit:!1,updatePageSizeSetting:!1,sortButton:!0,filterButton:!0});t.querySelector(".listTopPaging").innerHTML=r,u(t),n=LibraryBrowser.getPosterViewHtml({items:a.Items,shape:"auto",defaultShape:"square",context:"channels",showTitle:!0,coverImage:!0,showYear:!0,lazy:!0,centerText:!0});var i=t.querySelector("#items");i.innerHTML=n+r,ImageLoader.lazyChildren(i),e(".btnNextPage",t).on("click",function(){d.StartIndex+=d.Limit,o(t)}),e(".btnPreviousPage",t).on("click",function(){d.StartIndex-=d.Limit,o(t)}),e(".btnFilter",t).on("click",function(){l(t)}),e(".btnSort",t).on("click",function(){s(t)}),Dashboard.hideLoadingMsg()},function(){Dashboard.hideLoadingMsg()})}function l(e){require(["components/filterdialog/filterdialog"],function(t){var n=new t({query:a(e)});Events.on(n,"filterchange",function(){o(e)}),n.show()})}function s(e){var n=t(e).sortFields,r=[];r.push({name:Globalize.translate("OptionDefaultSort"),id:""}),-1!=n.indexOf("Name")&&r.push({name:Globalize.translate("OptionNameSort"),id:"SortName"}),-1!=n.indexOf("CommunityRating")&&r.push({name:Globalize.translate("OptionCommunityRating"),id:"CommunityRating"}),-1!=n.indexOf("DateCreated")&&r.push({name:Globalize.translate("OptionDateAdded"),id:"DateCreated"}),-1!=n.indexOf("PlayCount")&&r.push({name:Globalize.translate("OptionPlayCount"),id:"PlayCount"}),-1!=n.indexOf("PremiereDate")&&r.push({name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate"}),-1!=n.indexOf("Runtime")&&r.push({name:Globalize.translate("OptionRuntime"),id:"Runtime"}),LibraryBrowser.showSortMenu({items:r,callback:function(){o(e)},query:a(e)})}function u(t){var n=a(t);e(".alphabetPicker",t).alphaValue(n.NameStartsWith)}var d={};pageIdOn("pageinit","channelItemsPage",function(){var t=this;e(".alphabetPicker",this).on("alphaselect",function(e,n){var r=a(t);r.NameStartsWithOrGreater=n,r.StartIndex=0,o(t)}).on("alphaclear",function(){var e=a(t);e.NameStartsWithOrGreater="",o(t)})}),pageIdOn("pagebeforeshow","channelItemsPage",function(){var e=this;i(e),u(e)})}(jQuery,document);