define(["jQuery"],function(t){window.RatingDialog=function(e){var a=this;a.show=function(t){require(["jqmpopup"],function(){a.showInternal(t)})},a.showInternal=function(a){a=a||{},a.header=a.header||Globalize.translate("HeaderRateAndReview");var i='<div data-role="popup" id="popupRatingDialog" class="popup" style="min-width:400px;">';i+='<div class="ui-bar-a" style="text-align: center; padding: 0 20px;">',i+="<h3>"+a.header+"</h3>",i+="</div>",i+='<div style="padding: 1em;">',i+="<form>",i+='<div style="margin:0;">',i+='<label for="txtRatingDialogRating" >'+Globalize.translate("LabelYourRating")+"</label>",i+='<input id="txtRatingDialogRating" name="rating" type="number" required="required" min=0 max=5 step=1 value='+a.rating+" />",i+='<label for="txtRatingDialogTitle" >'+Globalize.translate("LabelShortRatingDescription")+"</label>",i+='<input id="txtRatingDialogTitle" name="title" type="text" maxlength=160 />',i+='<label for="txtRatingDialogRecommend" >'+Globalize.translate("OptionIRecommendThisItem")+"</label>",i+='<input id="txtRatingDialogRecommend" name="recommend" type="checkbox" checked />',i+='<label for="txtRatingDialogReview" >'+Globalize.translate("LabelFullReview")+"</label>",i+='<textarea id="txtRatingDialogReview" name="review" rows=8 style="height:inherit" ></textarea>',i+="</div>",i+="<p>",i+='<button type="submit" data-theme="b" data-icon="check">'+Globalize.translate("ButtonOk")+"</button>",i+='<button type="button" data-icon="delete" onclick="$(this).parents(\'.popup\').popup(\'close\');">'+Globalize.translate("ButtonCancel")+"</button>",i+="</p>",i+='<p id="errorMsg" style="display:none; color:red; font-weight:bold">',i+="</p>",i+="</form>",i+="</div>",i+="</div>",t(e).append(i);var n=t("#popupRatingDialog").popup().trigger("create").on("popupafteropen",function(){t("#txtRatingDialogTitle",this).focus()}).popup("open").on("popupafterclose",function(){t("form",this).off("submit"),t(this).off("popupafterclose").remove()});t("form",n).on("submit",function(){if(a.callback){var e={id:a.id,rating:t("#txtRatingDialogRating",this).val(),title:t("#txtRatingDialogTitle",this).val(),recommend:t("#txtRatingDialogRecommend",this).checked(),review:t("#txtRatingDialogReview",this).val()};a.callback(e)}return!1})},a.close=function(){t("#popupRatingDialog",e).popup("close")}},window.RatingHelpers={ratePackage:function(e){var a=e.getAttribute("data-id"),i=e.getAttribute("data-rating"),n=new RatingDialog(t.mobile.activePage);n.show({header:Globalize.translate("HeaderRateAndReview"),id:a,rating:i,callback:function(t){n.close(),ApiClient.createPackageReview(t).then(function(){Dashboard.alert({message:Globalize.translate("MessageThankYouForYourReview"),title:Globalize.translate("HeaderThankYou")})})}})}}});