define(["jQuery"],function(e){function t(t,n){t.querySelector("#chkEnableThrottle").checked=n.EnableThrottling,e("#selectVideoDecoder",t).val(n.HardwareAccelerationType),e("#selectThreadCount",t).val(n.EncodingThreadCount),e("#txtDownMixAudioBoost",t).val(n.DownMixAudioBoost),t.querySelector(".txtEncoderPath").value=n.EncoderAppPath||"",e("#txtTranscodingTempPath",t).val(n.TranscodingTempPath||""),Dashboard.hideLoadingMsg()}function n(){Dashboard.hideLoadingMsg();var e="";e=Globalize.translate("FFmpegSavePathNotFound"),require(["alert"],function(t){t(e)})}function a(){var t=this,a=function(){Dashboard.showLoadingMsg(),ApiClient.getNamedConfiguration("encoding").then(function(a){a.DownMixAudioBoost=e("#txtDownMixAudioBoost",t).val(),a.TranscodingTempPath=e("#txtTranscodingTempPath",t).val(),a.EncodingThreadCount=e("#selectThreadCount",t).val(),a.HardwareAccelerationType=e("#selectVideoDecoder",t).val(),a.EnableThrottling=t.querySelector("#chkEnableThrottle").checked,ApiClient.updateNamedConfiguration("encoding",a).then(function(){ApiClient.ajax({url:ApiClient.getUrl("System/MediaEncoder/Path"),type:"POST",data:{Path:t.querySelector(".txtEncoderPath").value}}).then(Dashboard.processServerConfigurationUpdateResult,n)})})};return e("#selectVideoDecoder",t).val()?require(["alert"],function(e){e({title:Globalize.translate("TitleHardwareAcceleration"),text:Globalize.translate("HardwareAccelerationWarning")}).then(a)}):a(),!1}function o(){return[{href:"cinemamodeconfiguration.html",name:Globalize.translate("TabCinemaMode")},{href:"playbackconfiguration.html",name:Globalize.translate("TabResumeSettings")},{href:"streamingsettings.html",name:Globalize.translate("TabStreaming")},{href:"encodingsettings.html",name:Globalize.translate("TabTranscoding")}]}e(document).on("pageinit","#encodingSettingsPage",function(){var t=this;e("#btnSelectEncoderPath",t).on("click.selectDirectory",function(){require(["directorybrowser"],function(n){var a=new n;a.show({includeFiles:!0,callback:function(n){n&&e(".txtEncoderPath",t).val(n),a.close()}})})}),e("#btnSelectTranscodingTempPath",t).on("click.selectDirectory",function(){require(["directorybrowser"],function(n){var a=new n;a.show({callback:function(n){n&&e("#txtTranscodingTempPath",t).val(n),a.close()},header:Globalize.translate("HeaderSelectTranscodingPath"),instruction:Globalize.translate("HeaderSelectTranscodingPathHelp")})})}),e(".encodingSettingsForm").off("submit",a).on("submit",a)}).on("pageshow","#encodingSettingsPage",function(){Dashboard.showLoadingMsg(),LibraryMenu.setTabs("playback",3,o);var e=this;ApiClient.getNamedConfiguration("encoding").then(function(n){t(e,n)}),ApiClient.getSystemInfo().then(function(t){t.HasExternalEncoder?e.querySelector(".fldEncoderPath").classList.add("hide"):e.querySelector(".fldEncoderPath").classList.remove("hide")})})});