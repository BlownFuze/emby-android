define(["jQuery"],function(e){function t(){var e=a(),t=n[e];return t||(t=n[e]={query:{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist",Recursive:!0,Fields:"PrimaryImageAspectRatio,SortName,CumulativeRunTimeTicks,CanDelete,SyncInfo",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()},view:LibraryBrowser.getSavedView(e)||LibraryBrowser.getDefaultItemsView("Poster","Poster")},t.query.ParentId=LibraryMenu.getTopParentId(),LibraryBrowser.loadSavedQueryValues(e,t.query)),t}function r(){return t().query}function a(){return LibraryBrowser.getSavedQueryKey()}function o(){Dashboard.showLoadingMsg()}function i(){Dashboard.hideLoadingMsg()}function s(n){o(n);var u=r(),l=ApiClient.getItems(Dashboard.getCurrentUserId(),u),m=Dashboard.getCurrentUser();Promise.all([l,m]).then(function(r){{var o=r[0];r[1]}window.scrollTo(0,0);var l="",m=t().view;e(".listTopPaging",n).html(LibraryBrowser.getQueryPagingHtml({startIndex:u.StartIndex,limit:u.Limit,totalRecordCount:o.TotalRecordCount,viewButton:!1,showLimit:!1,updatePageSizeSetting:!1,addLayoutButton:!0,currentLayout:m})),o.TotalRecordCount?("List"==m?l=LibraryBrowser.getListViewHtml({items:o.Items,sortBy:u.SortBy}):"PosterCard"==m?l=LibraryBrowser.getPosterViewHtml({items:o.Items,shape:"square",showTitle:!0,lazy:!0,coverImage:!0,showItemCounts:!0,cardLayout:!0}):"Poster"==m?l=LibraryBrowser.getPosterViewHtml({items:o.Items,shape:"square",showTitle:!0,lazy:!0,coverImage:!0,showItemCounts:!0,centerText:!0,overlayPlayButton:!0}):"Thumb"==m?l=LibraryBrowser.getPosterViewHtml({items:o.Items,shape:"backdrop",showTitle:!0,centerText:!0,lazy:!0,preferThumb:!0}):"ThumbCard"==m&&(l=LibraryBrowser.getPosterViewHtml({items:o.Items,shape:"backdrop",showTitle:!0,lazy:!0,preferThumb:!0,cardLayout:!0,showItemCounts:!0})),e(".noItemsMessage",n).hide()):e(".noItemsMessage",n).show();var y=n.querySelector(".itemsContainer");y.innerHTML=l,ImageLoader.lazyChildren(y),e(".btnNextPage",n).on("click",function(){u.StartIndex+=u.Limit,s(n)}),e(".btnPreviousPage",n).on("click",function(){u.StartIndex-=u.Limit,s(n)}),e(".btnChangeLayout",n).on("layoutchange",function(e,r){t().view=r,LibraryBrowser.saveViewSetting(a(),r),s(n)}),LibraryBrowser.saveQueryValues(a(),u),i(n)})}var n={};pageIdOn("pagebeforeshow","playlistsPage",function(){var e=this;s(e)})});