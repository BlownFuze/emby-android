!function(e){function t(){var t=e(window).width();return t>=1920?9:t>=1200?12:t>=1e3?10:8}function r(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function a(){return r()?"overflowSquare":"square"}function i(e,r){Dashboard.showLoadingMsg();var i=Dashboard.getCurrentUserId(),s={IncludeItemTypes:"Audio",Limit:t(),Fields:"PrimaryImageAspectRatio,SyncInfo",ParentId:r,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};ApiClient.getJSON(ApiClient.getUrl("Users/"+i+"/Items/Latest",s)).then(function(t){var r=e.querySelector("#recentlyAddedSongs");r.innerHTML=LibraryBrowser.getPosterViewHtml({items:t,showUnplayedIndicator:!1,showLatestItemsPopup:!1,shape:a(),showTitle:!0,showParentTitle:!0,lazy:!0,centerText:!0,overlayPlayButton:!0}),ImageLoader.lazyChildren(r),Dashboard.hideLoadingMsg(),LibraryBrowser.setLastRefreshed(e)})}function s(r,i){var s={SortBy:"DatePlayed",SortOrder:"Descending",IncludeItemTypes:"Audio",Limit:t(),Recursive:!0,Fields:"PrimaryImageAspectRatio,AudioInfo,SyncInfo",Filters:"IsPlayed",ParentId:i,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};ApiClient.getItems(Dashboard.getCurrentUserId(),s).then(function(t){var i;i=t.Items.length?e("#recentlyPlayed",r).show()[0]:e("#recentlyPlayed",r).hide()[0];var s=i.querySelector(".itemsContainer");s.innerHTML=LibraryBrowser.getPosterViewHtml({items:t.Items,showUnplayedIndicator:!1,shape:a(),showTitle:!0,showParentTitle:!0,defaultAction:"instantmix",lazy:!0,centerText:!0,overlayMoreButton:!0}),ImageLoader.lazyChildren(s)})}function n(r,i){var s={SortBy:"PlayCount",SortOrder:"Descending",IncludeItemTypes:"Audio",Limit:t(),Recursive:!0,Fields:"PrimaryImageAspectRatio,AudioInfo,SyncInfo",Filters:"IsPlayed",ParentId:i,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};ApiClient.getItems(Dashboard.getCurrentUserId(),s).then(function(t){var i;i=t.Items.length?e("#topPlayed",r).show()[0]:e("#topPlayed",r).hide()[0];var s=i.querySelector(".itemsContainer");s.innerHTML=LibraryBrowser.getPosterViewHtml({items:t.Items,showUnplayedIndicator:!1,shape:a(),showTitle:!0,showParentTitle:!0,defaultAction:"instantmix",lazy:!0,centerText:!0,overlayMoreButton:!0}),ImageLoader.lazyChildren(s)})}function o(r,i){var s={SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist",Recursive:!0,ParentId:i,Fields:"PrimaryImageAspectRatio,SortName,CumulativeRunTimeTicks,CanDelete,SyncInfo",StartIndex:0,Limit:t()};ApiClient.getItems(Dashboard.getCurrentUserId(),s).then(function(t){var i;i=t.Items.length?e("#playlists",r).show()[0]:e("#playlists",r).hide()[0];var s=i.querySelector(".itemsContainer");s.innerHTML=LibraryBrowser.getPosterViewHtml({items:t.Items,shape:a(),showTitle:!0,lazy:!0,coverImage:!0,showItemCounts:!0,centerText:!0,overlayPlayButton:!0}),ImageLoader.lazyChildren(s)})}function d(t,a){var i=a.querySelectorAll(".itemsContainer");r()?e(i).addClass("hiddenScrollX"):e(i).removeClass("hiddenScrollX"),e(i).createCardMenus()}function l(e,t){var r=LibraryMenu.getTopParentId();LibraryBrowser.needsRefresh(t)&&(i(t,r),o(t,r),s(t,r),n(t,r),require(["scripts/favorites"],function(){FavoriteItems.render(t,Dashboard.getCurrentUserId(),r,["favoriteArtists","favoriteAlbums","favoriteSongs"])}))}function u(e,t){var r=e.querySelector(".pageTabContent[data-index='"+t+"']"),a=[],i="MusicPage",s="",n="";switch(t){case 0:n="initSuggestedTab",s="renderSuggestedTab";break;case 1:a.push("scripts/musicalbums"),s="renderAlbumsTab",n="initAlbumsTab",a.push("scripts/queryfilters");break;case 2:a.push("scripts/musicalbumartists"),s="renderAlbumArtistsTab",n="initAlbumArtistsTab",a.push("scripts/queryfilters");break;case 3:a.push("scripts/musicartists"),s="renderArtistsTab",n="initArtistsTab",a.push("scripts/queryfilters");break;case 4:a.push("scripts/songs"),s="renderSongsTab",n="initSongsTab",a.push("scripts/queryfilters");break;case 5:a.push("scripts/musicgenres"),s="renderGenresTab";break;case 6:a.push("scripts/musicfolders"),s="renderFoldersTab",n="initFoldersTab"}require(a,function(){n&&!r.initComplete&&(window[i][n](e,r),r.initComplete=!0),window[i][s](e,r)})}window.MusicPage=window.MusicPage||{},window.MusicPage.renderSuggestedTab=l,window.MusicPage.initSuggestedTab=d,pageIdOn("pageinit","musicRecommendedPage",function(){var t=this;e(".recommendations",t).createCardMenus();var r=t.querySelector("paper-tabs"),a=t.querySelector("neon-animated-pages"),i="music.html",s=LibraryMenu.getTopParentId();s&&(i+="?topParentId="+s),LibraryBrowser.configurePaperLibraryTabs(t,r,a,i),a.addEventListener("tabchange",function(e){u(t,parseInt(e.target.selected))})}),pageIdOn("pagebeforeshow","musicRecommendedPage",function(){var e=this;if(!e.getAttribute("data-title")){var t=LibraryMenu.getTopParentId();t?ApiClient.getItem(Dashboard.getCurrentUserId(),t).then(function(t){e.setAttribute("data-title",t.Name),LibraryMenu.setTitle(t.Name)}):(e.setAttribute("data-title",Globalize.translate("TabMusic")),LibraryMenu.setTitle(Globalize.translate("TabMusic")))}})}(jQuery,document);