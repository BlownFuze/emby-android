!function(e,a,n,t){function r(){var e="",n=browserInfo.safari?"chevron-left":"arrow-back";e+='<paper-icon-button icon="'+n+'" class="headerButton headerButtonLeft headerBackButton hide"></paper-icon-button>',AppInfo.enableNavDrawer&&(e+='<paper-icon-button icon="menu" class="headerButton mainDrawerButton barsMenuButton headerButtonLeft"></paper-icon-button>'),e+='<div class="libraryMenuButtonText headerButton">'+Globalize.translate("ButtonHome")+"</div>",e+='<div class="viewMenuSecondary">',e+='<span class="headerSelectedPlayer"></span>',e+='<paper-icon-button icon="cast" class="btnCast headerButton headerButtonRight hide"></paper-icon-button>',AppInfo.enableSearchInTopMenu&&(e+='<paper-icon-button icon="search" class="headerButton headerButtonRight headerSearchButton hide" onclick="Search.showSearchPanel();"></paper-icon-button>',e+='<div class="viewMenuSearch hide">',e+='<form class="viewMenuSearchForm">',e+='<input type="text" data-role="none" data-type="search" class="headerSearchInput" autocomplete="off" spellcheck="off" />',e+='<paper-icon-button icon="close" class="btnCloseSearch"></paper-icon-button>',e+="</form>",e+="</div>"),e+='<paper-icon-button icon="mic" class="headerButton headerButtonRight headerVoiceButton hide" onclick="VoiceInputManager.startListening();"></paper-icon-button>',e+='<paper-button class="headerButton headerButtonRight btnNotifications subdued" type="button" title="Notifications"><div class="btnNotificationsInner">0</div></paper-button>',w()||(e+='<paper-icon-button icon="person" class="headerButton headerButtonRight headerUserButton" onclick="return Dashboard.showUserFlyout(this);"></paper-icon-button>'),browserInfo.mobile||Dashboard.isConnectMode()||(e+='<paper-icon-button icon="settings" class="headerButton headerButtonRight dashboardEntryHeaderButton" onclick="return LibraryMenu.onSettingsClicked(event);"></paper-icon-button>'),e+="</div>";var i=a.createElement("div");i.classList.add("viewMenuBar"),i.classList.add("ui-body-b"),i.innerHTML=e,a.body.appendChild(i),ImageLoader.lazyChildren(a.querySelector(".viewMenuBar")),a.dispatchEvent(new CustomEvent("headercreated",{})),c()}function s(){Dashboard.exitOnBack()?Dashboard.exit():history.back()}function o(e){var n=a.querySelector(".viewMenuBar"),i=n.querySelector(".headerSearchButton"),r=n.querySelector(".btnCast");e.localUser?(r.classList.remove("hide"),i&&i.classList.remove("hide"),requirejs(["voice/voice"],function(){VoiceInputManager.isSupported()?n.querySelector(".headerVoiceButton").classList.remove("hide"):n.querySelector(".headerVoiceButton").classList.add("hide")})):(r.classList.add("hide"),n.querySelector(".headerVoiceButton").classList.add("hide"),i&&i.classList.add("hide"));var s=n.querySelector(".dashboardEntryHeaderButton");if(s&&(e.canManageServer?s.classList.remove("hide"):s.classList.add("hide")),e.name&&e.imageUrl&&AppInfo.enableUserImage){var o=26,l=e.imageUrl;e.supportsImageParams&&(l+="&height="+o*Math.max(t||1,2));var c=n.querySelector(".headerUserButton");c&&(c.icon=null,c.src=l,c.classList.add("headerUserButtonRound"))}F=!1}function l(){var e=a.querySelector(".viewMenuBar");e.querySelector(".headerVoiceButton").classList.add("hide");var n=e.querySelector(".btnCast");n&&n.classList.add("hide");var i=e.querySelector(".headerSearchButton");i&&i.classList.add("hide");var t=e.querySelector(".dashboardEntryHeaderButton");t&&t.classList.add("hide")}function c(){var e=a.querySelector(".mainDrawerButton");e&&e.addEventListener("click",u);var n=a.querySelector(".headerBackButton");n&&n.addEventListener("click",s);var i=a.querySelector(".viewMenuBar");E(i),i.querySelector(".btnNotifications").addEventListener("click",function(){Dashboard.navigate("notificationlist.html")})}function d(e,a){return LibraryBrowser.getHref(e,a)}function u(){var e=a.querySelector(".mainDrawerPanel");e.openDrawer(),z=(new Date).getTime()}function v(){browserInfo.mobile&&a.body.classList.add("bodyWithPopupOpen");var i=n(n.mobile.activePage)[0];(H||U)&&ConnectionManager.user(e.ApiClient).then(function(e){var n=a.querySelector(".mainDrawerPanel .mainDrawer");H&&(m(n),p(e,n),y(e,n),g(e,n),Events.trigger(a,"libraryMenuCreated"),M(e.localUser)),(H||U)&&(L(i,e,n),U=!1),H=!1}),T(i),a.querySelector(".mainDrawerPanel #drawer").classList.add("verticalScrollingDrawer")}function h(){a.querySelector(".mainDrawerPanel").closeDrawer()}function b(e){var n=e.target;"drawer"!=n.selected?(a.body.classList.remove("bodyWithPopupOpen"),a.querySelector(".mainDrawerPanel #drawer").classList.remove("verticalScrollingDrawer")):v()}function m(e){if(!e.querySelector(".mainDrawerContent")){var a='<div class="mainDrawerContent">';a+='<div class="userheader">',a+="</div>",a+='<div class="libraryDrawerContent">',a+="</div>",a+='<div class="dashboardDrawerContent">',a+="</div>",a+='<div class="userFooter">',a+="</div>",a+="</div>",e.innerHTML=a}}function p(a,n){var i="",r=w(),s=e.ApiClient?"index.html":"selectserver.html",o=a.imageUrl&&AppInfo.enableUserImage;if(r){i+='<div class="drawerUserPanel">',i+='<div class="drawerUserPanelInner">',i+='<div class="drawerUserPanelContent">';var l=60;if(o){var c=a.imageUrl;a.supportsImageParams&&(c+="&width="+l*Math.max(t||1,2),i+='<div class="lazy drawerUserPanelUserImage" data-src="'+c+'" style="width:'+l+"px;height:"+l+'px;"></div>')}else i+='<div class="drawerUserPanelUserImage"><iron-icon icon="person" style="width:'+l+"px;height:"+l+'px;"></iron-icon></div>';i+='<div class="drawerUserPanelUserName">',i+=a.name,i+="</div>",i+="</div>",i+="</div>",i+="</div>",i+='<a class="sidebarLink lnkMediaFolder" data-itemid="remote" href="index.html" onclick="return LibraryMenu.onLinkClicked(event, this);"><iron-icon icon="home" class="sidebarLinkIcon" style="color:#2196F3;"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonHome")+"</span></a>"}else i+='<div style="margin-top:5px;"></div>',i+='<a class="lnkMediaFolder sidebarLink" href="'+s+'" onclick="return LibraryMenu.onLinkClicked(event, this);">',i+="<div style=\"background-image:url('css/images/mblogoicon.png');width:28px;height:28px;background-size:contain;background-repeat:no-repeat;background-position:center center;border-radius:1000px;vertical-align:middle;margin:0 1.6em 0 1.5em;display:inline-block;\"></div>",i+=Globalize.translate("ButtonHome"),i+="</a>";i+='<a class="sidebarLink lnkMediaFolder" data-itemid="remote" href="nowplaying.html" onclick="return LibraryMenu.onLinkClicked(event, this);"><iron-icon icon="tablet-android" class="sidebarLinkIcon" style="color:#673AB7;"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonRemote")+"</span></a>";var d=n.querySelector(".userheader");d.innerHTML=i,ImageLoader.fillImages(d.getElementsByClassName("lazy"))}function y(e,a){var n="";n+='<div class="sidebarDivider"></div>',n+='<div class="libraryMenuOptions">',n+="</div>",a.querySelector(".libraryDrawerContent").innerHTML=n}function L(e,a,n){var i="";i+='<div class="sidebarDivider"></div>',i+=Dashboard.getToolsMenuHtml(e),i=i.split("href=").join('onclick="return LibraryMenu.onLinkClicked(event, this);" href='),n.querySelector(".dashboardDrawerContent").innerHTML=i}function g(e,a){var n="";n+='<div class="adminMenuOptions">',n+='<div class="sidebarDivider"></div>',n+='<div class="sidebarHeader">',n+=Globalize.translate("HeaderAdmin"),n+="</div>",n+='<a class="sidebarLink lnkMediaFolder lnkManageServer" data-itemid="dashboard" href="#"><iron-icon icon="dashboard" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonManageServer")+"</span></a>",n+='<a class="sidebarLink lnkMediaFolder editorViewMenu" data-itemid="editor" onclick="return LibraryMenu.onLinkClicked(event, this);" href="edititemmetadata.html"><iron-icon icon="mode-edit" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonMetadataManager")+"</span></a>",browserInfo.mobile||(n+='<a class="sidebarLink lnkMediaFolder" data-itemid="reports" onclick="return LibraryMenu.onLinkClicked(event, this);" href="reports.html"><iron-icon icon="insert-chart" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonReports")+"</span></a>"),n+="</div>",n+='<div class="userMenuOptions">',n+='<div class="sidebarDivider"></div>',e.localUser&&w()&&(n+='<a class="sidebarLink lnkMediaFolder lnkMySettings" onclick="return LibraryMenu.onLinkClicked(event, this);" href="mypreferencesmenu.html?userId='+e.localUser.Id+'"><iron-icon icon="settings" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonSettings")+"</span></a>"),n+='<a class="sidebarLink lnkMediaFolder lnkMySync" data-itemid="mysync" onclick="return LibraryMenu.onLinkClicked(event, this);" href="mysync.html"><iron-icon icon="sync" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonSync")+"</span></a>",Dashboard.isConnectMode()&&(n+='<a class="sidebarLink lnkMediaFolder" data-itemid="selectserver" onclick="return LibraryMenu.onLinkClicked(event, this);" href="selectserver.html"><iron-icon icon="wifi" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonSelectServer")+"</span></a>"),w()&&(n+='<a class="sidebarLink lnkMediaFolder" data-itemid="logout" onclick="return LibraryMenu.onLogoutClicked(this);" href="#"><iron-icon icon="lock" class="sidebarLinkIcon"></iron-icon><span class="sidebarLinkText">'+Globalize.translate("ButtonSignOut")+"</span></a>"),n+="</div>",a.querySelector(".userFooter").innerHTML=n,a.querySelector(".lnkManageServer").addEventListener("click",C)}function f(){var e=this.getElementsByClassName("sectionName")[0],a=e?e.innerHTML:this.innerHTML;LibraryMenu.setTitle(a)}function k(e,a){var i=n.Deferred();return e.getUserViews({},a).then(function(e){for(var a=e.Items,t=[],r=0,s=a.length;s>r;r++){var o=a[r];if(t.push(o),"livetv"==o.CollectionType){o.ImageTags={},o.icon="live-tv",o.onclick="LibraryBrowser.showTab('livetv.html', 0);";var l=n.extend({},o);l.Name=Globalize.translate("ButtonGuide"),l.ImageTags={},l.icon="dvr",l.url="livetv.html?tab=1",l.onclick="LibraryBrowser.showTab('livetv.html', 1);",t.push(l);var c=n.extend({},o);c.Name=Globalize.translate("ButtonRecordedTv"),c.ImageTags={},c.icon="video-library",c.url="livetv.html?tab=3",c.onclick="LibraryBrowser.showTab('livetv.html', 3);",t.push(c)}}i.resolveWith(null,[t])}),i.promise()}function M(i){if(!i)return n(".adminMenuOptions").addClass("hide"),n(".lnkMySync").addClass("hide"),void n(".userMenuOptions").addClass("hide");var t=Dashboard.getCurrentUserId(),r=e.ApiClient;k(r,t).then(function(e){var i=e,t="";t+='<div class="sidebarHeader">',t+=Globalize.translate("HeaderMedia"),t+="</div>",t+=i.map(function(e){var a="folder",n="inherit",i=e.Id;"channels"==e.CollectionType?i="channels":"livetv"==e.CollectionType&&(i="livetv"),"photos"==e.CollectionType?(a="photo-library",n="#009688"):"music"==e.CollectionType||"musicvideos"==e.CollectionType?(a="library-music",n="#FB8521"):"books"==e.CollectionType?(a="library-books",n="#1AA1E1"):"playlists"==e.CollectionType?(a="view-list",n="#795548"):"games"==e.CollectionType?(a="games",n="#F44336"):"movies"==e.CollectionType?(a="video-library",n="#CE5043"):"channels"==e.CollectionType||"Channel"==e.Type?(a="videocam",n="#E91E63"):"tvshows"==e.CollectionType?(a="tv",n="#4CAF50"):"livetv"==e.CollectionType&&(a="live-tv",n="#293AAE"),a=e.icon||a;var t=e.onclick?" function(){"+e.onclick+"}":"null";return'<a data-itemid="'+i+'" class="lnkMediaFolder sidebarLink" onclick="return LibraryMenu.onLinkClicked(event, this, '+t+');" href="'+d(e,e.CollectionType)+'"><iron-icon icon="'+a+'" class="sidebarLinkIcon" style="color:'+n+'"></iron-icon><span class="sectionName">'+e.Name+"</span></a>"}).join("");var r=a.querySelector(".libraryMenuOptions");r.innerHTML=t;var s=r;n(".sidebarLink",s).off("click",f).on("click",f)}),i.Policy.IsAdministrator?n(".adminMenuOptions").removeClass("hide"):n(".adminMenuOptions").addClass("hide"),i.Policy.EnableSync?n(".lnkMySync").removeClass("hide"):n(".lnkMySync").addClass("hide")}function w(){return Dashboard.isConnectMode()||browserInfo.mobile}function C(){h(),Dashboard.navigate("dashboard.html")}function B(){return getParameterByName("topParentId")||null}function S(){var e=MediaController.getPlayerInfo();e.isLocalPlayer?(n(".btnCast").removeClass("btnActiveCast").each(function(){this.icon="cast"}),n(".headerSelectedPlayer").html("")):(n(".btnCast").addClass("btnActiveCast").each(function(){this.icon="cast-connected"}),n(".headerSelectedPlayer").html(e.deviceName||e.name))}function T(e){var n,i,t=e.classList.contains("liveTvPage"),r=e.classList.contains("channelsPage"),s=e.classList.contains("metadataEditorPage"),o=e.classList.contains("reportsPage"),l=e.classList.contains("mySyncPage"),c=t||r||s||o||l||e.classList.contains("allLibraryPage")?"":B()||"",d=a.getElementsByClassName("lnkMediaFolder");for(n=0,i=d.length;i>n;n++){var u=d[n],v=u.getAttribute("data-itemid");r&&"channels"==v?u.classList.add("selectedMediaFolder"):t&&"livetv"==v?u.classList.add("selectedMediaFolder"):s&&"editor"==v?u.classList.add("selectedMediaFolder"):o&&"reports"==v?u.classList.add("selectedMediaFolder"):l&&"mysync"==v?u.classList.add("selectedMediaFolder"):c&&v==c?u.classList.add("selectedMediaFolder"):u.classList.remove("selectedMediaFolder")}}function D(e){var a=e.querySelectorAll(".scopedLibraryViewNav a"),n=e.classList.contains("liveTvPage")||e.classList.contains("channelsPage")||e.classList.contains("metadataEditorPage")||e.classList.contains("reportsPage")||e.classList.contains("mySyncPage")||e.classList.contains("allLibraryPage")?"":B()||"";if(n)for(i=0,length=a.length;length>i;i++){var t=a[i],r=t.href;-1==r.indexOf("#")&&(r=replaceQueryString(r,"topParentId",n),t.href=r)}}function I(e,a){var n=a;"UserConfigurationUpdated"===n.MessageType&&n.Data.Id==Dashboard.getCurrentUserId()&&(N=!0)}function P(n){var i=a.querySelector(".viewMenuBar");n.classList.contains("standalonePage")?i.classList.add("hide"):i.classList.remove("hide"),F&&ConnectionManager.user(e.ApiClient).then(o)}function q(e){var a=e.getAttribute("data-title")||e.getAttribute("data-contextname");if(!a){var n=getParameterByName("titlekey");n&&(a=Globalize.translate(n))}a||e.classList.contains("type-interior")&&(a=Globalize.translate("ButtonHome")),a&&LibraryMenu.setTitle(a)}function x(e){var n=!e.classList.contains("homePage")&&history.length>0,i=a.querySelector(".headerBackButton"),t=AppInfo.enableBackButton;t||(t="true"==e.getAttribute("data-backbutton")),i&&(n&&t?i.classList.remove("hide"):i.classList.add("hide"))}function E(e){AppInfo.enableHeadRoom&&requirejs(["headroom"],function(){var a=new Headroom(e,{tolerance:{down:40,up:0}});a.init(),e.classList.add("headroomEnabled")})}function A(e){N=!0,Events.off(e,"websocketmessage",I),Events.on(e,"websocketmessage",I)}var H=!0,U=!0,F=!0,z=(new Date).getTime(),N=!1;e.LibraryMenu={getTopParentId:B,onLinkClicked:function(e,a,n){return 1!=e.which?!0:((new Date).getTime()-z>200&&setTimeout(function(){h();var e=browserInfo.mobile?350:0;setTimeout(function(){n?n():Dashboard.navigate(a.href)},e)},50),e.stopPropagation(),e.preventDefault(),!1)},onLogoutClicked:function(){if((new Date).getTime()-z>200){h();var e=browserInfo.mobile?350:0;setTimeout(function(){Dashboard.logout()},e)}return!1},onHardwareMenuButtonClick:function(){u()},onSettingsClicked:function(e){return 1!=e.which?!0:(Dashboard.navigate("dashboard.html"),!1)},setTitle:function(e){a.querySelector(".libraryMenuButtonText").innerHTML=e},setBackButtonVisible:function(e){var n=a.querySelector(".headerBackButton");n&&(e?n.classList.remove("hide"):n.classList.add("hide"))},setMenuButtonVisible:function(e){var n=a.querySelector(".mainDrawerButton");n&&n.classList.remove(!e&&browserInfo.mobile?"hide":"hide")},setTransparentMenu:function(e){var n=a.querySelector(".viewMenuBar");n&&(e?n.classList.add("semiTransparent"):n.classList.remove("semiTransparent"))}},pageClassOn("pageinit","page",function(){var e=this;e.classList.contains("type-interior")&&(U=!0),P(e),D(e)}),pageClassOn("pageshow","page",function(){var n=this;NavHelper.isBack()||e.scrollTo(0,0),q(n),x(n);var i=n.classList.contains("libraryPage");if(i){a.body.classList.add("libraryDocument"),a.body.classList.remove("dashboardDocument"),a.body.classList.remove("hideMainDrawer");for(var t=n.querySelectorAll(".libraryViewNav"),r=0,s=t.length;s>r;r++)E(t[r])}else n.classList.contains("type-interior")?(a.body.classList.remove("libraryDocument"),a.body.classList.add("dashboardDocument"),a.body.classList.remove("hideMainDrawer")):(a.body.classList.remove("libraryDocument"),a.body.classList.remove("dashboardDocument"),a.body.classList.add("hideMainDrawer"));var o=!1;Dashboard.isConnectMode()||browserInfo.mobile||(o=!0);var l=a.querySelector(".mainDrawerPanel #drawer");l&&(o?l.classList.add("darkDrawer"):l.classList.remove("darkDrawer"))}),e.ApiClient&&A(e.ApiClient),Events.on(ConnectionManager,"apiclientcreated",function(e,a){A(a)}),Events.on(ConnectionManager,"localusersignedin",function(){N=!0,H=!0,ConnectionManager.user(e.ApiClient).then(o)}),Events.on(ConnectionManager,"localusersignedout",function(){N=!0,H=!0,l()}),Events.on(MediaController,"playerchange",function(){S()});var G=a.querySelector(".mainDrawerPanel");G.addEventListener("iron-select",b),r()}(window,document,jQuery,window.devicePixelRatio),function(){function e(){return a}var a=!1;window.addEventListener("navigate",function(e){var n=e.detail.state||{},i=n.direction;a="back"==i}),window.NavHelper={isBack:e}}();