define(["jQuery"],function(t){function e(){var e=this,a=e.querySelector("#txtLocalAddress").value,n=t("#chkEnableUpnp",e).checked();return r(a,n,function(){Dashboard.showLoadingMsg(),ApiClient.getServerConfiguration().then(function(r){r.HttpServerPortNumber=t("#txtPortNumber",e).val(),r.PublicPort=t("#txtPublicPort",e).val(),r.PublicHttpsPort=t("#txtPublicHttpsPort",e).val(),r.EnableHttps=t("#chkEnableHttps",e).checked(),r.HttpsPortNumber=t("#txtHttpsPort",e).val(),r.EnableUPnP=n,r.WanDdns=t("#txtDdns",e).val(),r.CertificatePath=t("#txtCertificatePath",e).val(),r.LocalNetworkAddresses=a?[a]:[],ApiClient.updateServerConfiguration(r).then(Dashboard.processServerConfigurationUpdateResult,Dashboard.processErrorResponse)})}),!1}function r(t,e,r){t||!e?require(["alert"],function(t){t({title:Globalize.translate("TitleHostingSettings"),text:Globalize.translate("SettingsWarning")}).then(r)}):r()}function a(){return[{href:"dashboardhosting.html",name:Globalize.translate("TabHosting")},{href:"serversecurity.html",name:Globalize.translate("TabSecurity")}]}return function(r){function n(e,r){t("#txtPortNumber",e).val(r.HttpServerPortNumber),t("#txtPublicPort",e).val(r.PublicPort),t("#txtPublicHttpsPort",e).val(r.PublicHttpsPort),e.querySelector("#txtLocalAddress").value=r.LocalNetworkAddresses[0]||"";var a=e.querySelector("#chkEnableHttps");a.checked=r.EnableHttps,t("#txtHttpsPort",e).val(r.HttpsPortNumber),t("#txtDdns",e).val(r.WanDdns||"");var n=e.querySelector("#txtCertificatePath");n.value=r.CertificatePath||"",t("#chkEnableUpnp",e).checked(r.EnableUPnP),i.call(n),Dashboard.hideLoadingMsg()}function i(){this.value?r.querySelector("#txtDdns").setAttribute("required","required"):r.querySelector("#txtDdns").removeAttribute("required")}t("#btnSelectCertPath",r).on("click.selectDirectory",function(){require(["directorybrowser"],function(e){var a=new e;a.show({includeFiles:!0,includeDirectories:!0,callback:function(e){e&&t("#txtCertificatePath",r).val(e),a.close()},header:Globalize.translate("HeaderSelectCertificatePath")})})}),t(".dashboardHostingForm").off("submit",e).on("submit",e),r.querySelector("#txtCertificatePath").addEventListener("change",i),r.addEventListener("viewshow",function(){LibraryMenu.setTabs("adminadvanced",0,a),Dashboard.showLoadingMsg(),ApiClient.getServerConfiguration().then(function(t){n(r,t)})})}});