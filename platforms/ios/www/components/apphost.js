define(["appStorage","browser"],function(e,n){function t(){return null}function o(){var e={PlayableMediaTypes:["Audio","Video"],SupportsPersistentIdentifier:!1,DeviceProfile:t()};return e}function r(){return new Promise(function(e){require(["cryptojs-sha1"],function(){var n=[];n.push(navigator.userAgent),n.push((new Date).getTime()),e(CryptoJS.SHA1(n.join("|")).toString())})})}function i(){var n="_deviceId2",t=e.getItem(n);return t?Promise.resolve(t):r().then(function(t){return e.setItem(n,t),t})}function u(){var e;return e=n.tizen?"Samsung Smart TV":n.web0S?"LG Smart TV":n.operaTv?"Opera TV":n.xboxOne?"Xbox One":n.ps4?"Sony PS4":n.chrome?"Chrome":n.edge?"Edge":n.firefox?"Firefox":n.msie?"Internet Explorer":"Web Browser",n.version&&(e+=" "+n.version),n.ipad?e+=" Ipad":n.iphone?e+=" Iphone":n.android&&(e+=" Android"),e}function a(){return n.tv?!1:window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.oSpeechRecognition||window.msSpeechRecognition}function s(){if(n.tv)return!1;var e=document.documentElement;return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}var c,p=function(){var e=["filedownload","sharing","externalpremium"];e.push(n.operaTv||n.tizen||n.web0s?"exit":"exitmenu"),n.operaTv||e.push("externallinks"),a()&&e.push("voiceinput");var t=navigator.userAgent.toLowerCase();return n.mobile&&-1==t.indexOf("msapphost")||(e.push("htmlaudioautoplay"),e.push("htmlvideoautoplay")),window.SyncRegistered,s()&&e.push("fullscreen"),e}(),d=window.dashboardVersion||"3.0";return{getWindowState:function(){return document.windowState||"Normal"},setWindowState:function(){alert("setWindowState is not supported and should not be called")},exit:function(){if(n.tizen)try{tizen.application.getCurrentApplication().exit()}catch(e){}else window.close()},supports:function(e){return-1!=p.indexOf(e.toLowerCase())},unlockedFeatures:function(){var e=[];return e.push("playback"),e},appInfo:function(){return c?Promise.resolve(c):i().then(function(e){return c={deviceId:e,deviceName:u(),appName:"Emby Mobile",appVersion:d}})},capabilities:o,moreIcon:n.safari||n.edge?"dots-horiz":"dots-vert"}});