define(["appStorage","browser"],function(e,n){function o(){return null}function t(){var e={PlayableMediaTypes:["Audio","Video"],SupportsPersistentIdentifier:!1,DeviceProfile:o()};return e}function i(){return new Promise(function(e){require(["cryptojs-sha1"],function(){var n=[];n.push(navigator.userAgent),n.push((new Date).getTime()),e(CryptoJS.SHA1(n.join("|")).toString())})})}function r(){var n="_deviceId2",o=e.getItem(n);return o?Promise.resolve(o):i().then(function(o){return e.setItem(n,o),o})}function a(){var e;return e=n.tizen?"Samsung Smart TV":n.web0S?"LG Smart TV":n.operaTv?"Opera TV":n.xboxOne?"Xbox One":n.ps4?"Sony PS4":n.chrome?"Chrome":n.edge?"Edge":n.firefox?"Firefox":n.msie?"Internet Explorer":"Web Browser",n.version&&(e+=" "+n.version),n.ipad?e+=" Ipad":n.iphone?e+=" Iphone":n.android&&(e+=" Android"),e}function u(){return n.tv?!1:window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.oSpeechRecognition||window.msSpeechRecognition}var s,p=window.dashboardVersion||"3.0";return{getWindowState:function(){return document.windowState||"Normal"},setWindowState:function(){alert("setWindowState is not supported and should not be called")},exit:function(){if(n.tizen)try{tizen.application.getCurrentApplication().exit()}catch(e){}else window.close()},supports:function(e){var o=["filedownload","sharing","externalpremium"];o.push(n.operaTv||n.tizen||n.web0s?"exit":"exitmenu"),n.operaTv||o.push("externallinks"),u()&&o.push("voiceinput");var t=navigator.userAgent.toLowerCase();return n.mobile&&-1==t.indexOf("msapphost")||(o.push("htmlaudioautoplay"),o.push("htmlvideoautoplay")),-1!=o.indexOf(e.toLowerCase())},unlockedFeatures:function(){var e=[];return e.push("playback"),e},appInfo:function(){return s?Promise.resolve(s):r().then(function(e){return s={deviceId:e,deviceName:a(),appName:"Emby Mobile",appVersion:p}})},capabilities:t,moreIcon:n.safari||n.edge?"dots-horiz":"dots-vert"}});