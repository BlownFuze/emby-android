define(["apphost","connectionManager","events","globalize","browser","require","dom","emby-tabs"],function(t,e,a,n,o,s,d){function i(t){var e=p.filter(function(e){return e.Id==t})[0];e&&Emby.Page.showItem(e)}function b(t){switch(t){case"settings":Emby.Page.showSettings();break;case"signout":Dashboard.logout();break;case"selectserver":Emby.Page.showSelectServer();break;case"reports":Dashboard.navigate("reports.html");break;case"metadatamanager":Dashboard.navigate("edititemmetadata.html");break;case"manageserver":Dashboard.navigate("dashboard.html");break;case"sync":Dashboard.navigate("mysync.html");break;default:i(t)}}function r(t,e,a){var n=o.safari?"actionsheet":"webActionSheet";s([n],function(n){n.show({items:t,positionTo:e,entryAnimation:"slideup",exitAnimation:"fadeout",entryAnimationDuration:160,exitAnimationDuration:100,offsetTop:-35,positionY:"top",dialogClass:"dockedtabs-dlg",menuItemClass:"dockedtabs-dlg-menuitem"}).then(function(t){if(b(t),t){var n=d.parentWithClass(e,"dockedtabs-tabs");n.selectedIndex(a,!1)}})})}function c(t){var e=p.map(function(t){return{name:t.Name,id:t.Id}});r(e,t,1)}function u(t){var e=[];k.Policy.IsAdministrator&&(e.push({name:n.translate("ButtonManageServer"),id:"manageserver"}),d.getWindowSize().innerWidth>=800&&e.push({name:n.translate("MetadataManager"),id:"metadatamanager"}),e.push({name:n.translate("ButtonReports"),id:"reports"})),Dashboard.isConnectMode()&&e.push({name:n.translate("HeaderSelectServer"),id:"selectserver"}),e.push({name:n.translate("TabSettings"),id:"settings"}),k.Policy.EnableSync&&e.push({name:n.translate("SyncToOtherDevices"),id:"sync"}),e.push({name:n.translate("ButtonSignOut"),id:"signout"}),r(e,t,5)}function l(t){var e=parseInt(this.getAttribute("data-index"));switch(e){case 0:Emby.Page.goHome();break;case 1:c(this),t.preventDefault(),t.stopPropagation();break;case 2:Emby.Page.showLiveTV();break;case 3:Emby.Page.showFavorites();break;case 4:Dashboard.navigate("mysync.html?mode=offline");break;case 5:u(this),t.preventDefault(),t.stopPropagation();break;case 6:Dashboard.navigate("dashboard.html")}}function m(t){setTimeout(function(){for(var e=0,a=t.length;a>e;e++){var n=t[e];n.classList.contains("emby-button-noflex")&&n.classList.add("dockedtabs-tab-button-noflex")}},300)}function v(e){var a=document.createElement("div");a.classList.add("hide"),a.classList.add("dockedtabs"),a.classList.add("dockedtabs-bottom");var o="",s=t.supports("sync")?" dockedtab-midsize":"";o+='    <div is="emby-tabs" class="dockedtabs-tabs" data-selectionbar="false">            <button is="emby-button" class="dockedtabs-tab-button emby-tab-button emby-tab-button-active" data-index="0">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">home</i><div>'+n.translate("TabHome")+'</div></div>            </button>            <button is="emby-button" class="dockedtabs-tab-button emby-tab-button" data-index="1">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">dvr</i><div>'+n.translate("HeaderLibraries")+'</div></div>            </button>            <button is="emby-button" class="dockedtabs-tab-button emby-tab-button docked-tab-livetv hide'+s+'" data-index="2">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">live_tv</i><div>'+n.translate("HeaderLiveTV")+'</div></div>            </button>            <button is="emby-button" class="dockedtabs-tab-button emby-tab-button homeFavoritesTab" data-index="3">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">favorite</i><div>'+n.translate("TabFavorites")+"</div></div>            </button>",t.supports("sync")&&(o+='<button is="emby-button" class="dockedtabs-tab-button emby-tab-button" data-index="4">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">file_download</i><div>'+n.translate("Downloads")+"</div></div>            </button>            "),o+='<button is="emby-button" class="dockedtabs-tab-button emby-tab-button docked-tab-manageserver hide dockedtab-midsize" data-index="6">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">dashboard</i><div>'+n.translate("ButtonManageServer")+"</div></div>            </button>            ",o+='<button is="emby-button" class="dockedtabs-tab-button emby-tab-button" data-index="5">                <div class="dockedtabs-tab-button-foreground emby-button-foreground"><i class="dockedtabs-tab-button-icon md-icon">menu</i><div>'+n.translate("ButtonMore")+"</div></div>            </button>    </div>",a.innerHTML=o;for(var d=a.querySelectorAll(".emby-tab-button"),i=0,b=d.length;b>i;i++){var r=d[i];r.addEventListener("click",l)}return m(d),e.appFooter.add(a),a}function g(t,e,a){e.filter(function(t){return"livetv"==t.CollectionType}).length?a.querySelector(".docked-tab-livetv").classList.remove("hide"):a.querySelector(".docked-tab-livetv").classList.add("hide"),t.Policy.IsAdministrator?a.querySelector(".docked-tab-manageserver").classList.remove("hide"):a.querySelector(".docked-tab-manageserver").classList.add("hide")}function h(t,e){k=t;var a=ConnectionManager.getApiClient(t.ServerId);a.getUserViews({},t.Id).then(function(a){p=a.Items,g(t,a.Items,e)},function(){p=[],g(t,[],e)})}function f(t){Dashboard.getCurrentUserId()&&Dashboard.getCurrentUser().then(function(e){h(e,t)})}function y(t){var n=this;n.element=v(t),a.on(e,"localusersignedin",function(t,e){n.element.classList.remove("hide"),h(e,n.element)}),a.on(e,"localusersignedout",function(){n.element.classList.add("hide")}),f(n.element)}s(["css!./dockedtabs"]);var k={},p=[];return y.prototype.destroy=function(){{var t=this;t.element}t.element=null},y});