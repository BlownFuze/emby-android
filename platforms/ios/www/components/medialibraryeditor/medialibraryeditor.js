define(["components/paperdialoghelper","paper-fab","paper-item-body","paper-icon-item"],function(){function e(e,a){var r=p.library,n=p.refresh;ApiClient.addMediaPath(r.Name,a,n).then(function(){s=!0,i(e)},function(){Dashboard.alert(Globalize.translate("ErrorAddingMediaPathToVirtualFolder"))})}function a(){var e=this,a=parseInt(e.getAttribute("data-index")),r=p.library,n=r.Locations[a];Dashboard.confirm(Globalize.translate("MessageConfirmRemoveMediaLocation"),Globalize.translate("HeaderRemoveMediaLocation"),function(a){if(a){var t=p.refresh;ApiClient.removeMediaPath(r.Name,n,t).then(function(){s=!0,i($(e).parents(".editorContent")[0])},function(){Dashboard.alert(Globalize.translate("DefaultErrorMessage"))})}})}function r(e,a){var r="";return r+='<paper-icon-item role="menuitem" class="lnkPath">',r+='<paper-fab mini style="background:#52B54B;" icon="folder" item-icon></paper-fab>',r+="<paper-item-body>",r+=e,r+="</paper-item-body>",r+='<paper-icon-button icon="remove-circle" class="btnRemovePath" data-index="'+a+'"></paper-icon-button>',r+="</paper-icon-item>"}function i(e){ApiClient.getVirtualFolders().then(function(a){var r=a.filter(function(e){return e.Name==p.library.Name})[0];r&&(p.library=r,n(e,p))})}function n(e,i){var n=i.library.Locations.map(r).join("");e.querySelector(".folderList").innerHTML=n,$(e.querySelectorAll(".btnRemovePath")).on("click",a)}function t(){var a=$(this).parents(".editorContent")[0];require(["directorybrowser"],function(r){var i=new r;i.show({callback:function(r){r&&e(a,r),i.close()}})})}function o(e,a){n(e,a),$(".btnAddFolder",e).on("click",t)}function l(){$(this).remove(),Dashboard.hideLoadingMsg(),d.resolveWith(null,[s])}function c(){var e=this;e.show=function(e){var a=DeferredBuilder.Deferred();p=e,d=a,s=!1;var r=new XMLHttpRequest;return r.open("GET","components/medialibraryeditor/medialibraryeditor.template.html",!0),r.onload=function(){var a=this.response,r=PaperDialogHelper.createDialog({size:"small",theme:"a",modal:!1}),n="";n+='<h2 class="dialogHeader">',n+='<paper-fab icon="arrow-back" mini class="btnCloseDialog"></paper-fab>',n+='<div style="display:inline-block;margin-left:.6em;vertical-align:middle;">'+e.library.Name+"</div>",n+="</h2>",n+='<div class="editorContent" style="max-width:800px;margin:auto;">',n+=Globalize.translateDocument(a),n+="</div>",r.innerHTML=n,document.body.appendChild(r);var t=r.querySelector(".editorContent");o(t,e),$(r).on("iron-overlay-closed",l),PaperDialogHelper.openWithHash(r,"medialibraryeditor"),$(".btnCloseDialog",r).on("click",function(){PaperDialogHelper.close(r)}),i(t)},r.send(),a.promise()}}var d,s,p;return c});