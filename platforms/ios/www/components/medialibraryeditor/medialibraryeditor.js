define(["components/paperdialoghelper","paper-fab","paper-item-body","paper-icon-item"],function(e){function a(e,a){var n=u.library,r=u.refresh;ApiClient.addMediaPath(n.Name,a,r).then(function(){p=!0,i(e)},function(){Dashboard.alert(Globalize.translate("ErrorAddingMediaPathToVirtualFolder"))})}function n(){var e=this,a=parseInt(e.getAttribute("data-index")),n=u.library,r=n.Locations[a];Dashboard.confirm(Globalize.translate("MessageConfirmRemoveMediaLocation"),Globalize.translate("HeaderRemoveMediaLocation"),function(a){if(a){var t=u.refresh;ApiClient.removeMediaPath(n.Name,r,t).then(function(){p=!0,i($(e).parents(".editorContent")[0])},function(){Dashboard.alert(Globalize.translate("DefaultErrorMessage"))})}})}function r(e,a){var n="";return n+='<paper-icon-item role="menuitem" class="lnkPath">',n+='<paper-fab mini style="background:#52B54B;" icon="folder" item-icon></paper-fab>',n+="<paper-item-body>",n+=e,n+="</paper-item-body>",n+='<paper-icon-button icon="remove-circle" class="btnRemovePath" data-index="'+a+'"></paper-icon-button>',n+="</paper-icon-item>"}function i(e){ApiClient.getVirtualFolders().then(function(a){var n=a.filter(function(e){return e.Name==u.library.Name})[0];n&&(u.library=n,t(e,u))})}function t(e,a){var i=a.library.Locations.map(r).join("");e.querySelector(".folderList").innerHTML=i,$(e.querySelectorAll(".btnRemovePath")).on("click",n)}function o(){var e=$(this).parents(".editorContent")[0];require(["directorybrowser"],function(n){var r=new n;r.show({callback:function(n){n&&a(e,n),r.close()}})})}function l(e,a){t(e,a),$(".btnAddFolder",e).on("click",o)}function c(){$(this).remove(),Dashboard.hideLoadingMsg(),s.resolveWith(null,[p])}function d(){var a=this;a.show=function(a){var n=DeferredBuilder.Deferred();u=a,s=n,p=!1;var r=new XMLHttpRequest;return r.open("GET","components/medialibraryeditor/medialibraryeditor.template.html",!0),r.onload=function(){var n=this.response,r=e.createDialog({size:"small",theme:"a",modal:!1}),t="";t+='<h2 class="dialogHeader">',t+='<paper-fab icon="arrow-back" mini class="btnCloseDialog"></paper-fab>',t+='<div style="display:inline-block;margin-left:.6em;vertical-align:middle;">'+a.library.Name+"</div>",t+="</h2>",t+='<div class="editorContent" style="max-width:800px;margin:auto;">',t+=Globalize.translateDocument(n),t+="</div>",r.innerHTML=t,document.body.appendChild(r);var o=r.querySelector(".editorContent");l(o,a),$(r).on("iron-overlay-closed",c),e.open(r),$(".btnCloseDialog",r).on("click",function(){e.close(r)}),i(o)},r.send(),n.promise()}}var s,p,u;return d});