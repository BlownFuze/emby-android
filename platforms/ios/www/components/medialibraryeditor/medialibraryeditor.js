define(["dialogHelper","jQuery","emby-button","paper-item-body","paper-icon-item","paper-icon-button-light"],function(e,t){function n(e,t){var n=m.library,i=m.refresh;ApiClient.addMediaPath(n.Name,t,i).then(function(){b=!0,r(e)},function(){require(["toast"],function(e){e(Globalize.translate("ErrorAddingMediaPathToVirtualFolder"))})})}function i(){var e=this,n=parseInt(e.getAttribute("data-index")),i=m.library,o=i.Locations[n];require(["confirm"],function(n){n(Globalize.translate("MessageConfirmRemoveMediaLocation"),Globalize.translate("HeaderRemoveMediaLocation")).then(function(){var n=m.refresh;ApiClient.removeMediaPath(i.Name,o,n).then(function(){b=!0,r(t(e).parents(".editorContent")[0])},function(){require(["toast"],function(e){e(Globalize.translate("DefaultErrorMessage"))})})})})}function o(e,t){var n="";return n+='<paper-icon-item role="menuitem" class="lnkPath">',n+='<button type="button" is="emby-button" style="background:#52B54B;" class="fab mini" item-icon><iron-icon icon="folder"></iron-icon></button>',n+="<paper-item-body>",n+=e,n+="</paper-item-body>",n+='<button is="paper-icon-button-light" class="btnRemovePath" data-index="'+t+'"><iron-icon icon="remove-circle"></iron-icon></button>',n+="</paper-icon-item>"}function r(e){ApiClient.getVirtualFolders().then(function(t){var n=t.filter(function(e){return e.Name==m.library.Name})[0];n&&(m.library=n,a(e,m))})}function a(e,n){var r=n.library.Locations.map(o).join("");e.querySelector(".folderList").innerHTML=r,t(e.querySelectorAll(".btnRemovePath")).on("click",i)}function l(){var e=t(this).parents(".editorContent")[0];require(["directorybrowser"],function(t){var i=new t;i.show({callback:function(t){t&&n(e,t),i.close()}})})}function c(e,n){a(e,n),t(".btnAddFolder",e).on("click",l)}function s(){t(this).remove(),Dashboard.hideLoadingMsg(),u.resolveWith(null,[b])}function d(){var n=this;n.show=function(n){var i=jQuery.Deferred();m=n,u=i,b=!1;var o=new XMLHttpRequest;return o.open("GET","components/medialibraryeditor/medialibraryeditor.template.html",!0),o.onload=function(){var i=this.response,o=e.createDialog({size:"small",modal:!1});o.classList.add("ui-body-a"),o.classList.add("background-theme-a"),o.classList.add("popupEditor");var a="";a+='<h2 class="dialogHeader">',a+='<button type="button" is="emby-button" icon="arrow-back" class="fab mini btnCloseDialog" tabindex="-1"><iron-icon icon="arrow-back"></iron-icon></button>',a+='<div style="display:inline-block;margin-left:.6em;vertical-align:middle;">'+n.library.Name+"</div>",a+="</h2>",a+='<div class="editorContent" style="max-width:800px;margin:auto;">',a+=Globalize.translateDocument(i),a+="</div>",o.innerHTML=a,document.body.appendChild(o);var l=o.querySelector(".editorContent");c(l,n),t(o).on("close",s),e.open(o),t(".btnCloseDialog",o).on("click",function(){e.close(o)}),r(l)},o.send(),i.promise()}}var u,b,m;return d});