!function(e,n,i){function a(e,n){Dashboard.confirm(Globalize.translate("MessageConfirmRecordingCancellation"),Globalize.translate("HeaderConfirmRecordingCancellation"),function(i){i&&(Dashboard.showLoadingMsg(),ApiClient.cancelLiveTvTimer(n).then(function(){Dashboard.hideLoadingMsg(),Dashboard.alert(Globalize.translate("MessageRecordingCancelled")),h(e)}))})}function t(e,i){g=i,n(".itemName",e).html(i.Name),n("#txtPrePaddingMinutes",e).val(i.PrePaddingSeconds/60),n("#txtPostPaddingMinutes",e).val(i.PostPaddingSeconds/60),n("#chkNewOnly",e).checked(i.RecordNewOnly),n("#chkAllChannels",e).checked(i.RecordAnyChannel),n("#chkAnyTime",e).checked(i.RecordAnyTime);var a="";i.RecordAnyChannel?a+=Globalize.translate("LabelAllChannels"):i.ChannelId&&(a+='<a href="itemdetails.html?id='+i.ChannelId+'">'+i.ChannelName+"</a>"),n(".channel",e).html(a).trigger("create"),o(e,i.Days),i.RecordAnyTime?n(".time",e).html(Globalize.translate("LabelAnytime")).trigger("create"):i.ChannelId&&n(".time",e).html(LibraryBrowser.getDisplayTime(i.StartDate)).trigger("create"),Dashboard.hideLoadingMsg()}function r(){return LiveTvHelpers.getDaysOfWeek().map(function(e){return e.value})}function o(e,i){for(var a=r(),t=0,o=a.length;o>t;t++){var d=a[t];n("#chk"+d,e).checked(-1!=i.indexOf(d))}}function d(e){for(var i=r(),a=[],t=0,o=i.length;o>t;t++){var d=i[t];n("#chk"+d,e).checked()&&a.push(d)}return a}function s(){Dashboard.showLoadingMsg();var e=this;return ApiClient.getLiveTvSeriesTimer(g.Id).then(function(i){i.PrePaddingSeconds=60*n("#txtPrePaddingMinutes",e).val(),i.PostPaddingSeconds=60*n("#txtPostPaddingMinutes",e).val(),i.RecordNewOnly=n("#chkNewOnly",e).checked(),i.RecordAnyChannel=n("#chkAllChannels",e).checked(),i.RecordAnyTime=n("#chkAnyTime",e).checked(),i.Days=d(e),ApiClient.updateLiveTvSeriesTimer(i).then(function(){Dashboard.hideLoadingMsg(),Dashboard.alert(Globalize.translate("MessageRecordingSaved"))})}),!1}function c(e,i){n(".recordingsTab",e).html(LibraryBrowser.getPosterViewHtml({items:i.Items,shape:"detailPageSquare",showTitle:!0,centerText:!0,coverImage:!0}))}function l(e,i){var t=i.Items;LiveTvHelpers.getTimersHtml(t).then(function(i){var t=n(".scheduleTab",e).html(i)[0];ImageLoader.lazyChildren(t),n(".btnDeleteTimer",t).on("click",function(){var n=this.getAttribute("data-timerid");a(e,n)})})}function h(e){Dashboard.showLoadingMsg();var n=getParameterByName("id");ApiClient.getLiveTvSeriesTimer(n).then(function(n){t(e,n)}),ApiClient.getLiveTvRecordings({userId:Dashboard.getCurrentUserId(),seriesTimerId:n}).then(function(n){c(e,n)}),ApiClient.getLiveTvTimers({seriesTimerId:n}).then(function(n){l(e,n)})}var g;n(i).on("pageinit","#liveTvSeriesTimerPage",function(){var e=this;n(".radioSeriesTimerTab",e).on("change",function(){n(".tab",e).hide(),n("."+this.value+"Tab",e).show()}),n(".liveTvSeriesTimerForm").off("submit",s).on("submit",s)}).on("pagebeforeshow","#liveTvSeriesTimerPage",function(){var e=this;n(".radioProfileTab",e).checked(!1).checkboxradio("refresh"),n("#radioSettings",e).checked(!0).checkboxradio("refresh").trigger("change"),h(e)}).on("pagebeforehide","#liveTvSeriesTimerPage",function(){g=null})}(window,jQuery,document);