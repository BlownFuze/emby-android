define(["datetime","libraryBrowser","scrollStyles","emby-itemscontainer"],function(e,t){function r(e,t){Dashboard.showLoadingMsg();var r={Limit:40,Fields:"AirTime,UserData,SyncInfo",UserId:Dashboard.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",EnableTotalRecordCount:!1};return r.ParentId=t.topParentId,ApiClient.getJSON(ApiClient.getUrl("Shows/Upcoming",r))}function n(e,t,r){r.then(function(t){var r=t.Items;e.querySelector(".noItemsMessage").style.display=r.length?"none":"block";var n=e.querySelector("#upcomingItems");o(n,r),Dashboard.hideLoadingMsg()})}function a(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function i(){return a()?"overflowBackdrop":"backdrop"}function o(r,n){var o,s,l=[],c="",m=[];for(o=0,s=n.length;s>o;o++){var d=n[o],u="";if(d.PremiereDate)try{var h=e.parseISO8601Date(d.PremiereDate,!0);u=h.getDate()==(new Date).getDate()-1?Globalize.translate("Yesterday"):t.getFutureDateText(h,!0)}catch(g){}u!=c?(m.length&&l.push({name:c,items:m}),c=u,m=[d]):m.push(d)}var p="";for(o=0,s=l.length;s>o;o++){var y=l[o];p+='<div class="homePageSection">',p+='<h1 class="listHeader">'+y.name+"</h1>",p+=a()?'<div is="emby-itemscontainer" class="itemsContainer hiddenScrollX">':'<div is="emby-itemscontainer" class="itemsContainer">',p+=t.getPosterViewHtml({items:y.items,showLocationTypeIndicator:!1,shape:i(),showTitle:!0,preferThumb:!0,lazy:!0,showDetailsMenu:!0,centerText:!0,overlayMoreButton:!0,showParentTitle:!0}),p+="</div>",p+="</div>"}r.innerHTML=p,ImageLoader.lazyChildren(r)}return function(e,t,a){var i,o=this;o.preRender=function(){i=r(e,t)},o.renderTab=function(){n(a,t,i)}}});