define(["libraryBrowser","focusManager","embyRouter","emby-input","paper-icon-button-light","material-icons"],function(e,t,i){function a(e){var t={SortBy:"IsFavoriteOrLiked,Random",IncludeItemTypes:"Movie,Series,MusicArtist",Limit:20,Recursive:!0,ImageTypeLimit:0,EnableImages:!1};ApiClient.getItems(Dashboard.getCurrentUserId(),t).then(function(t){var i=t.Items.map(function(e){var t=LibraryBrowser.getHref(e),i='<div><a style="display:inline-block;padding:.55em 1em;" href="'+t+'">';return i+=e.Name,i+="</a></div>"}).join("");e.querySelector(".searchSuggestions").innerHTML=i})}return function(t){function n(){c&&(clearTimeout(c),c=null)}function r(){AppInfo.enableAppLayouts&&d.classList.remove("hide")}function s(e){return"Audio"==e.Type?[[e.AlbumArtist,e.Album].join(" - ")]:"MusicAlbum"==e.Type?[e.AlbumArtist]:"MusicArtist"==e.Type?[Globalize.translate("LabelArtist")]:"Movie"==e.Type?[Globalize.translate("LabelMovie")]:"MusicVideo"==e.Type?[Globalize.translate("LabelMusicVideo")]:"Episode"==e.Type?[Globalize.translate("LabelEpisode")]:"Series"==e.Type?[Globalize.translate("Series")]:"BoxSet"==e.Type?[Globalize.translate("LabelCollection")]:e.ChannelName?[e.ChannelName]:[e.Type]}function o(t){t=t.map(function(e){return e.Id=e.ItemId,e.ImageTags={},e.UserData={},e.PrimaryImageTag&&(e.ImageTags.Primary=e.PrimaryImageTag),e});var i=e.getPosterViewHtml({items:t,shape:"auto",lazy:!0,overlayText:!1,showTitle:!0,centerImage:!0,centerText:!0,textLines:s,overlayPlayButton:!0}),a=m;a.innerHTML=i,m.classList.remove("hide"),d.classList.add("hide"),ImageLoader.lazyChildren(a)}function l(e){var t=c;Dashboard.showLoadingMsg(),ApiClient.getSearchHints({userId:Dashboard.getCurrentUserId(),searchTerm:(e||"").trim(),limit:30}).then(function(e){t==c&&o(e.SearchHints),Dashboard.hideLoadingMsg()},function(){Dashboard.hideLoadingMsg()})}function u(e){return e?(n(),void(c=setTimeout(function(){l(e)},300))):(n(),m.classList.add("hide"),m.innerHTML="",void r())}var c,d=t.querySelector(".textSuggestions"),m=t.querySelector(".searchResults");AppInfo.enableAppLayouts&&(r(),a(t)),t.querySelector(".txtSearch").addEventListener("input",function(){u(this.value)}),t.querySelector(".btnBack").addEventListener("click",function(){i.back()}),t.addEventListener("viewbeforeshow",function(){LibraryMenu.setMenuButtonVisible(!1)}),t.addEventListener("viewbeforehide",function(){LibraryMenu.setMenuButtonVisible(!0)})}});