define(["jQuery"],function(e){function a(a,i,n){i.length?(e(".noDevices",a).hide(),e(".devicesUploadForm",a).show()):(e(".noDevices",a).show(),e(".devicesUploadForm",a).hide()),e("#txtUploadPath",a).val(n.CameraUploadPath||""),e("#chkSubfolder",a).checked(n.EnableCameraUploadSubfolders),t(a,i,n)}function t(a,t,i){var n="";n+='<div class="paperListLabel">',n+=Globalize.translate("LabelEnableCameraUploadFor"),n+="</div>",n+='<div class="paperCheckboxList paperList">';var o=0;n+=t.map(function(e){var a="",t=-1!=i.EnabledCameraUploadDevices.indexOf(e.Id),n=t?' checked="checked"':"",l=e.Name;return e.AppName&&(l+=" - "+e.AppName),a+='<paper-checkbox class="chkDevice" data-id="'+e.Id+'"'+n+">"+l+"</paper-checkbox>",o++,a}).join(""),n+="</div>",n+='<div class="fieldDescription">',n+=Globalize.translate("LabelEnableCameraUploadForHelp"),n+="</div>",e(".devicesList",a).html(n).trigger("create")}function i(e){Dashboard.showLoadingMsg();var t=ApiClient.getNamedConfiguration("devices"),i=ApiClient.getJSON(ApiClient.getUrl("Devices",{SupportsContentUploading:!0}));Promise.all([t,i]).then(function(t){a(e,t[1].Items,t[0]),Dashboard.hideLoadingMsg()})}function n(a){ApiClient.getNamedConfiguration("devices").then(function(t){t.CameraUploadPath=e("#txtUploadPath",a).val(),t.EnabledCameraUploadDevices=e(".chkDevice",a).get().filter(function(e){return e.checked}).map(function(e){return e.getAttribute("data-id")}),t.EnableCameraUploadSubfolders=e("#chkSubfolder",a).checked(),ApiClient.updateNamedConfiguration("devices",t).then(Dashboard.processServerConfigurationUpdateResult)})}function o(){var a=this,t=e(a).parents(".page");return n(t),!1}function l(){return[{href:"syncactivity.html",name:Globalize.translate("TabSyncJobs")},{href:"devicesupload.html",name:Globalize.translate("TabCameraUpload")},{href:"syncsettings.html",name:Globalize.translate("TabSettings")}]}e(document).on("pageinit","#devicesUploadPage",function(){var a=this;e("#btnSelectUploadPath",a).on("click.selectDirectory",function(){require(["directorybrowser"],function(t){var i=new t;i.show({callback:function(t){t&&e("#txtUploadPath",a).val(t),i.close()},header:Globalize.translate("HeaderSelectUploadPath")})})}),e(".devicesUploadForm").off("submit",o).on("submit",o)}).on("pageshow","#devicesUploadPage",function(){LibraryMenu.setTabs("syncadmin",1,l);var e=this;i(e)})});