!function(e,n,t){function i(e,n){var t=MediaController.getPlayerInfo().id,i=e.ids||e.items.map(function(e){return e.Id}),o={ItemIds:i.join(","),PlayCommand:n};e.startPositionTicks&&(o.startPositionTicks=e.startPositionTicks),ApiClient.sendPlayCommand(t,o)}function o(e,n){var t=MediaController.getPlayerInfo().id;ApiClient.sendPlayStateCommand(t,e,n)}function a(){function n(e,n){var t={Name:e};n&&(t.Arguments=n),l.sendCommand(t)}function a(){if(!ApiClient.isWebSocketOpen()){var n=e.ApiClient;n&&n.getSessions().then(u)}}function s(){l.isUpdating=!0,ApiClient.isWebSocketOpen()&&ApiClient.sendWebSocketMessage("SessionsStop"),c&&(clearInterval(c),c=null)}var l=this;l.name="Remote Control",l.sendCommand=function(e){var n=MediaController.getPlayerInfo().id;ApiClient.sendCommand(n,e)},l.play=function(e){i(e,"PlayNow")},l.shuffle=function(e){i({ids:[e]},"PlayShuffle")},l.instantMix=function(e){i({ids:[e]},"PlayInstantMix")},l.queue=function(e){i(e,"PlayNext")},l.queueNext=function(e){i(e,"PlayLast")},l.canQueueMediaType=function(e){return"Audio"==e||"Video"==e},l.stop=function(){o("stop")},l.nextTrack=function(){o("nextTrack")},l.previousTrack=function(){o("previousTrack")},l.seek=function(e){o("seek",{SeekPositionTicks:e})},l.pause=function(){o("Pause")},l.unpause=function(){o("Unpause")},l.mute=function(){n("Mute")},l.unMute=function(){n("Unmute")},l.toggleMute=function(){n("ToggleMute")},l.setVolume=function(e){n("SetVolume",{Volume:e})},l.volumeUp=function(){n("VolumeUp")},l.volumeDown=function(){n("VolumeDown")},l.toggleFullscreen=function(){n("ToggleFullscreen")},l.setAudioStreamIndex=function(e){n("SetAudioStreamIndex",{Index:e})},l.setSubtitleStreamIndex=function(e){n("SetSubtitleStreamIndex",{Index:e})},l.setRepeatMode=function(e){n("SetRepeatMode",{RepeatMode:e})},l.displayContent=function(e){n("DisplayContent",e)},l.getPlayerState=function(){var n=t.Deferred(),i=e.ApiClient;return i?i.getSessions().then(function(e){var t=MediaController.getPlayerInfo().id,i=e.filter(function(e){return e.Id==t})[0];i&&(i=r(i)),n.resolveWith(null,[i])}):n.resolveWith(null,[{}]),n.promise()};var c;l.subscribeToPlayerUpdates=function(){l.isUpdating=!0,ApiClient.isWebSocketOpen()&&ApiClient.sendWebSocketMessage("SessionsStart","100,800"),c&&(clearInterval(c),c=null),c=setInterval(a,5e3)};var d=0;l.beginPlayerUpdates=function(){0>=d&&(d=0,l.subscribeToPlayerUpdates()),d++},l.endPlayerUpdates=function(){d--,0>=d&&(s(),d=0)},l.getTargets=function(){var n=t.Deferred(),i={ControllableByUserId:Dashboard.getCurrentUserId()},o=e.ApiClient;return o?o.getSessions(i).then(function(e){var t=e.filter(function(e){return e.DeviceId!=o.deviceId()}).map(function(e){return{name:e.DeviceName,deviceName:e.DeviceName,id:e.Id,playerName:l.name,appName:e.Client,playableMediaTypes:e.PlayableMediaTypes,isLocalPlayer:!1,supportedCommands:e.SupportedCommands}});n.resolveWith(null,[t])},function(){n.reject()}):n.resolveWith(null,[]),n.promise()},l.tryPair=function(){var e=t.Deferred();return e.resolve(),e.promise()}}function r(e){return e}function s(e,n){Events.trigger(f,e,[r(n)])}function l(){f.isUpdating&&f.subscribeToPlayerUpdates()}function u(e){var n=MediaController.getPlayerInfo().id,t=e.filter(function(e){return e.Id==n})[0];t&&s("playstatechange",t)}function c(e,n){var t=this;"Sessions"===n.MessageType?u(n.Data):"SessionEnded"===n.MessageType?MediaController.getPlayerInfo().id==n.Data.Id&&MediaController.setDefaultPlayerActive():"PlaybackStart"===n.MessageType?n.Data.DeviceId!=t.deviceId()&&MediaController.getPlayerInfo().id==n.Data.Id&&s("playbackstart",n.Data):"PlaybackStopped"===n.MessageType&&n.Data.DeviceId!=t.deviceId()&&MediaController.getPlayerInfo().id==n.Data.Id&&s("playbackstop",n.Data)}function d(e){Events.on(e,"websocketmessage",c),Events.on(e,"websocketopen",l)}var f=new a;MediaController.registerPlayer(f),e.ApiClient&&d(e.ApiClient),Events.on(ConnectionManager,"apiclientcreated",function(e,n){d(n)})}(window,document,jQuery);