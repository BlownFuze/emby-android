define(["jQuery"],function(e){function n(n,a,l){n.querySelector("#chkEnablePlayTo").checked=a.EnablePlayTo,n.querySelector("#chkEnableDlnaDebugLogging").checked=a.EnableDebugLog,e("#txtClientDiscoveryInterval",n).val(a.ClientDiscoveryIntervalSeconds),e("#chkEnableServer",n).checked(a.EnableServer),e("#chkBlastAliveMessages",n).checked(a.BlastAliveMessages),e("#txtBlastInterval",n).val(a.BlastAliveMessageIntervalSeconds),e("#chkEnableMovieFolders",n).checked(a.EnableMovieFolders);var t=l.map(function(e){return'<option value="'+e.Id+'">'+e.Name+"</option>"}).join("");e("#selectUser",n).html(t).val(a.DefaultUserId||""),Dashboard.hideLoadingMsg()}function a(){Dashboard.showLoadingMsg();var n=this;return ApiClient.getNamedConfiguration("dlna").then(function(a){a.EnablePlayTo=n.querySelector("#chkEnablePlayTo").checked,a.EnableDebugLog=n.querySelector("#chkEnableDlnaDebugLogging").checked,a.ClientDiscoveryIntervalSeconds=e("#txtClientDiscoveryInterval",n).val(),a.EnableServer=e("#chkEnableServer",n).checked(),a.BlastAliveMessages=e("#chkBlastAliveMessages",n).checked(),a.BlastAliveMessageIntervalSeconds=e("#txtBlastInterval",n).val(),a.DefaultUserId=e("#selectUser",n).val(),a.EnableMovieFolders=e("#chkEnableMovieFolders",n).checked(),ApiClient.updateNamedConfiguration("dlna",a).then(Dashboard.processServerConfigurationUpdateResult)}),!1}e(document).on("pageinit","#dlnaSettingsPage",function(){e(".dlnaSettingsForm").off("submit",a).on("submit",a)}).on("pageshow","#dlnaSettingsPage",function(){Dashboard.showLoadingMsg();var e=this,a=ApiClient.getNamedConfiguration("dlna"),l=ApiClient.getUsers();Promise.all([a,l]).then(function(a){n(e,a[0],a[1])})})});