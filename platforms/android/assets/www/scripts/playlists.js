define(["listView"],function(e){function t(){var e=a(),t=n[e];return t||(t=n[e]={query:{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist",Recursive:!0,Fields:"PrimaryImageAspectRatio,SortName,CumulativeRunTimeTicks,CanDelete,SyncInfo",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()},view:LibraryBrowser.getSavedView(e)||LibraryBrowser.getDefaultItemsView("PosterCard","PosterCard")},t.query.ParentId=LibraryMenu.getTopParentId(),LibraryBrowser.loadSavedQueryValues(e,t.query)),t}function r(){return t().query}function a(){return LibraryBrowser.getSavedQueryKey()}function i(){Dashboard.showLoadingMsg()}function o(){Dashboard.hideLoadingMsg()}function s(n){i(n);var u=r(),d=ApiClient.getItems(Dashboard.getCurrentUserId(),u),l=Dashboard.getCurrentUser();Promise.all([d,l]).then(function(r){{var i=r[0];r[1]}window.scrollTo(0,0);var d="",l=t().view;n.querySelector(".listTopPaging").innerHTML=LibraryBrowser.getQueryPagingHtml({startIndex:u.StartIndex,limit:u.Limit,totalRecordCount:i.TotalRecordCount,viewButton:!1,showLimit:!1,updatePageSizeSetting:!1,addLayoutButton:!0,layouts:"List,Poster,PosterCard,Thumb,ThumbCard",currentLayout:l}),i.TotalRecordCount?(d="List"==l?e.getListViewHtml({items:i.Items,sortBy:u.SortBy}):LibraryBrowser.getPosterViewHtml("PosterCard"==l?{items:i.Items,shape:"square",showTitle:!0,lazy:!0,coverImage:!0,showItemCounts:!0,cardLayout:!0}:"Thumb"==l?{items:i.Items,shape:"backdrop",showTitle:!0,centerText:!0,lazy:!0,preferThumb:!0}:"ThumbCard"==l?{items:i.Items,shape:"backdrop",showTitle:!0,lazy:!0,preferThumb:!0,cardLayout:!0,showItemCounts:!0}:{items:i.Items,shape:"square",showTitle:!0,lazy:!0,coverImage:!0,showItemCounts:!0,centerText:!0,overlayPlayButton:!0}),n.querySelector(".noItemsMessage").classList.add("hide")):n.querySelector(".noItemsMessage").classList.remove("hide");var y=n.querySelector(".itemsContainer");y.innerHTML=d,ImageLoader.lazyChildren(y);var c=n.querySelector(".btnNextPage");c&&c.addEventListener("click",function(){u.StartIndex+=u.Limit,s(n)});var m=n.querySelector(".btnPreviousPage");m&&m.addEventListener("click",function(){u.StartIndex-=u.Limit,s(n)});var g=n.querySelector(".btnChangeLayout");g&&g.addEventListener("layoutchange",function(e){var r=e.detail.viewStyle;t().view=r,LibraryBrowser.saveViewSetting(a(),r),s(n)}),LibraryBrowser.saveQueryValues(a(),u),o(n)})}var n={};pageIdOn("pagebeforeshow","playlistsPage",function(){var e=this;s(e)})});