!function(e){function t(){return"Thumb"}function r(){return"Poster"}function a(t){Dashboard.showLoadingMsg(),LibraryMenu.getTopParentId()?(e(".scopedContent",t).show(),o(t)):e(".scopedContent",t).hide(),s(t)}function s(r){var a=AppInfo.hasLowImageBandwidth?16:24,s={Limit:a,Fields:"PrimaryImageAspectRatio,SeriesInfo,DateCreated,SyncInfo",UserId:Dashboard.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};s.ParentId=LibraryMenu.getTopParentId(),ApiClient.getNextUpEpisodes(s).then(function(a){a.Items.length?e(".noNextUpItems",r).hide():e(".noNextUpItems",r).show();var s=t(),n="";"ThumbCard"==s?n+=LibraryBrowser.getPosterViewHtml({items:a.Items,shape:"backdrop",showTitle:!0,preferThumb:!0,showParentTitle:!0,lazy:!0,cardLayout:!0,showDetailsMenu:!0}):"Thumb"==s&&(n+=LibraryBrowser.getPosterViewHtml({items:a.Items,shape:"backdrop",showTitle:!0,showParentTitle:!0,overlayText:!1,lazy:!0,preferThumb:!0,showDetailsMenu:!0,centerText:!0,overlayPlayButton:AppInfo.enableAppLayouts}));var i=r.querySelector("#nextUpItems");i.innerHTML=n,ImageLoader.lazyChildren(i),Dashboard.hideLoadingMsg(),LibraryBrowser.setLastRefreshed(r)})}function n(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function i(){return n()?"overflowBackdrop":"backdrop"}function o(t){var a=LibraryMenu.getTopParentId(),s=6,n={SortBy:"DatePlayed",SortOrder:"Descending",IncludeItemTypes:"Episode",Filters:"IsResumable",Limit:s,Recursive:!0,Fields:"PrimaryImageAspectRatio,SeriesInfo,UserData,SyncInfo",ExcludeLocationTypes:"Virtual",ParentId:a,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};ApiClient.getItems(Dashboard.getCurrentUserId(),n).then(function(a){a.Items.length?e("#resumableSection",t).show():e("#resumableSection",t).hide();var s=r(),n="";"PosterCard"==s?n+=LibraryBrowser.getPosterViewHtml({items:a.Items,shape:i(),showTitle:!0,showParentTitle:!0,lazy:!0,cardLayout:!0,showDetailsMenu:!0,preferThumb:!0}):"Poster"==s&&(n+=LibraryBrowser.getPosterViewHtml({items:a.Items,shape:i(),showTitle:!0,showParentTitle:!0,lazy:!0,showDetailsMenu:!0,overlayPlayButton:!0,preferThumb:!0,centerText:!0}));var o=t.querySelector("#resumableItems");o.innerHTML=n,ImageLoader.lazyChildren(o)})}function d(t,r){n()?r.querySelector("#resumableItems").classList.add("hiddenScrollX"):r.querySelector("#resumableItems").classList.remove("hiddenScrollX"),e(r.querySelector("#resumableItems")).createCardMenus()}function l(e,t){LibraryBrowser.needsRefresh(t)&&a(t)}function u(e,t){var r=e.querySelector(".pageTabContent[data-index='"+t+"']"),a=[],s="TvPage",n="",i="";switch(t){case 0:i="initSuggestedTab",n="renderSuggestedTab";break;case 1:a.push("scripts/tvlatest"),n="renderLatestTab";break;case 2:a.push("scripts/tvupcoming"),n="renderUpcomingTab";break;case 3:a.push("scripts/tvshows"),n="renderSeriesTab",i="initSeriesTab";break;case 4:a.push("scripts/episodes"),n="renderEpisodesTab",i="initEpisodesTab";break;case 5:a.push("scripts/tvgenres"),n="renderGenresTab";break;case 6:a.push("scripts/tvstudios"),n="renderStudiosTab"}require(a,function(){i&&!r.initComplete&&(window[s][i](e,r),r.initComplete=!0),window[s][n](e,r)})}function c(t,r){if(r.NowPlayingItem&&"Video"==r.NowPlayingItem.MediaType){var a=e(e.mobile.activePage)[0],s=a.querySelector("neon-animated-pages");s.dispatchEvent(new CustomEvent("tabchange",{}))}}window.TvPage=window.TvPage||{},window.TvPage.renderSuggestedTab=l,window.TvPage.initSuggestedTab=d,pageIdOn("pageinit","tvRecommendedPage",function(){var t=this;e(".recommendations",t).createCardMenus();var r=t.querySelector("paper-tabs"),a=t.querySelector("neon-animated-pages"),s="tv.html",i=LibraryMenu.getTopParentId();i&&(s+="?topParentId="+i),n()?t.querySelector("#resumableItems").classList.add("hiddenScrollX"):t.querySelector("#resumableItems").classList.remove("hiddenScrollX"),e(t.querySelector("#resumableItems")).createCardMenus(),LibraryBrowser.configurePaperLibraryTabs(t,r,a,s),a.addEventListener("tabchange",function(){u(t,parseInt(this.selected))})}),pageIdOn("pagebeforeshow","tvRecommendedPage",function(){var e=this;if(!e.getAttribute("data-title")){var t=LibraryMenu.getTopParentId();t?ApiClient.getItem(Dashboard.getCurrentUserId(),t).then(function(t){e.setAttribute("data-title",t.Name),LibraryMenu.setTitle(t.Name)}):(e.setAttribute("data-title",Globalize.translate("TabShows")),LibraryMenu.setTitle(Globalize.translate("TabShows")))}Events.on(MediaController,"playbackstop",c)}),pageIdOn("pagebeforehide","tvRecommendedPage",function(){Events.off(MediaController,"playbackstop",c)})}(jQuery,document);