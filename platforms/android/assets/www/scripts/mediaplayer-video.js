define(["appSettings","datetime","mediaInfo","scrollStyles","paper-icon-button-light"],function(e,t,n){function i(i){function a(e,t,n){for(var i=0,a=e.length;a>i;i++)e[i].classList[t](n)}function o(e,t){for(;!e.classList||!e.classList.contains(t);)if(e=e.parentNode,!e)return null;return e}function r(e){var i="";i+='<div class="nowPlayingTabButtons">',i+='<a href="#" class="nowPlayingTabButton selectedNowPlayingTabButton" data-tab="tabInfo">'+Globalize.translate("TabInfo")+"</a>",e.Chapters&&e.Chapters.length&&(i+='<a href="#" class="nowPlayingTabButton" data-tab="tabScenes">'+Globalize.translate("TabScenes")+"</a>"),e.People&&e.People.length&&(i+='<a href="#" class="nowPlayingTabButton" data-tab="tabCast">'+Globalize.translate("TabCast")+"</a>"),i+="</div>",i+='<div class="tabInfo nowPlayingTab">';var a=MediaController.getNowPlayingNameHtml(e,!1);a='<div class="videoNowPlayingName">'+a+"</div>";var o=n.getPrimaryMediaInfoHtml(e);if(o&&(a+='<div class="videoNowPlayingRating">'+o+"</div>"),e.Overview&&(a+='<div class="videoNowPlayingOverview">'+e.Overview+"</div>"),i+=a,i+="</div>",e.Chapters&&e.Chapters.length){i+='<div class="tabScenes nowPlayingTab smoothScrollX hide" style="white-space:nowrap;margin-bottom:2em;">';var r=0;i+=e.Chapters.map(function(n){var i=240,a='<a class="card backdropCard chapterCard" href="#" style="margin-right:1em;width:'+i+'px;" data-position="'+n.StartPositionTicks+'">';if(a+='<div class="cardBox">',a+='<div class="cardScalable">',a+='<div class="cardPadder"></div>',a+='<div class="cardContent">',n.ImageTag){var o=ApiClient.getScaledImageUrl(e.Id,{width:i,tag:n.ImageTag,type:"Chapter",index:r});a+='<div class="cardImage lazy" data-src="'+o+'"></div>'}else a+='<div class="cardImage" style="background:#444;"></div>';return a+='<div class="cardFooter">',n.Name&&(a+='<div class="cardText">'+n.Name+"</div>"),a+='<div class="cardText">'+t.getDisplayRunningTime(n.StartPositionTicks)+"</div>",a+="</div>",a+="</div>",a+="</div>",a+="</div>",a+="</a>",r++,a}).join(""),i+="</div>"}return e.People&&e.People.length&&(i+='<div class="tabCast nowPlayingTab smoothScrollX hide" style="white-space:nowrap;">',i+=e.People.map(function(e){var t,n='<div class="tileItem smallPosterTileItem" style="width:300px;">',i=150;e.PrimaryImageTag?(t=ApiClient.getScaledImageUrl(e.Id,{height:i,tag:e.PrimaryImageTag,type:"primary",minScale:2}),n+='<div class="tileImage lazy" data-src="'+t+'" style="height:'+i+'px;"></div>'):(t="css/images/items/list/person.png",n+='<div class="tileImage" style="background-image:url(\''+t+"');height:"+i+'px;"></div>'),n+='<div class="tileContent">',n+="<p>"+e.Name+"</p>";var a=e.Role?Globalize.translate("ValueAsRole",e.Role):e.Type;"GuestStar"==a&&(a=Globalize.translate("ValueGuestStar")),a=a||"";var o=40;return a.length>o&&(a=a.substring(0,o-3)+"..."),n+="<p>"+a+"</p>",n+="</div>",n+="</div>"}).join(""),i+="</div>"),i}function l(){return i.currentMediaSource&&i.currentMediaSource.RunTimeTicks?i.currentMediaSource.RunTimeTicks:i.currentMediaRenderer?i.getCurrentTicks(i.currentMediaRenderer):null}function s(){var e=parseInt(this.value),t=e/100*l();i.changeStream(Math.floor(t))}function d(e){var t=[{transform:"translate3d(0, 100%, 0)",offset:0},{transform:"translate3d(0, 0, 0)",offset:1}],n={duration:300,iterations:1};e.animate&&e.animate(t,n)}function c(e){var t=[{transform:"translate3d(0, 0, 0)",offset:0},{transform:"translate3d(0, 100%, 0)",offset:1}],n={duration:300,iterations:1},i=function(){e.classList.add("hide")};e.animate?e.animate(t,n).onfinish=i:i()}function u(){var e="";e+='<div id="videoPlayer" class="hide">',e+='<div id="videoElement">',e+='<div id="play" class="status"></div>',e+='<div id="pause" class="status"></div>',e+="</div>";var t=AppInfo.isNativeApp&&browserInfo.android?"hiddenOnIdle hide":"hiddenOnIdle";e+='<div class="videoTopControls '+t+'">',e+='<div class="videoTopControlsLogo"></div>',e+='<div class="videoAdvancedControls">',e+='<button is="paper-icon-button-light" class="previousTrackButton mediaButton videoTrackControl hide autoSize" onclick="MediaPlayer.previousTrack();"><i class="md-icon">skip_previous</i></button>',e+='<button is="paper-icon-button-light" class="nextTrackButton mediaButton videoTrackControl hide autoSize" onclick="MediaPlayer.nextTrack();"><i class="md-icon">skip_next</i></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoAudioButton autoSize" onclick="MediaPlayer.showAudioTracksFlyout();"><i class="md-icon">audiotrack</i></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoSubtitleButton autoSize" onclick="MediaPlayer.showSubtitleMenu();"><i class="md-icon">closed_caption</i></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoQualityButton autoSize" onclick="MediaPlayer.showQualityFlyout();"><i class="md-icon">settings</i></button>',e+='<button is="paper-icon-button-light" class="mediaButton autoSize" onclick="MediaPlayer.stop();"><i class="md-icon">close</i></button>',e+="</div>",e+="</div>",e+='<div class="videoControls '+t+'">',e+='<div class="nowPlayingInfo hide">',e+='<div class="nowPlayingImage"></div>',e+='<div class="nowPlayingTabs"></div>',e+="</div>",e+='<div class="guide hide">',e+="</div>",e+='<div class="videoControlButtons">',e+='<button is="paper-icon-button-light" class="previousTrackButton mediaButton videoTrackControl hide autoSize" onclick="MediaPlayer.previousTrack();"><i class="md-icon">skip_previous</i></button>',e+='<button is="paper-icon-button-light" id="video-playButton" class="mediaButton unpauseButton autoSize" onclick="MediaPlayer.unpause();"><i class="md-icon">play_arrow</i></button>',e+='<button is="paper-icon-button-light" id="video-pauseButton" class="mediaButton pauseButton autoSize" onclick="MediaPlayer.pause();"><i class="md-icon">pause</i></button>',e+='<button is="paper-icon-button-light" class="nextTrackButton mediaButton videoTrackControl hide autoSize" onclick="MediaPlayer.nextTrack();"><i class="md-icon">skip_next</i></button>',e+='<div class="sliderContainer videoPositionSliderContainer" style="display:inline-flex;margin-right:2em;">',e+='<input type="range" is="emby-slider" pin step=".1" min="0" max="100" value="0" class="videoPositionSlider" />',e+="</div>",e+='<div class="currentTime">--:--</div>',e+='<button is="paper-icon-button-light" class="muteButton mediaButton autoSize" onclick="MediaPlayer.mute();"><i class="md-icon">volume_up</i></button>',e+='<button is="paper-icon-button-light" class="unmuteButton mediaButton autoSize" onclick="MediaPlayer.unMute();"><i class="md-icon">volume_off</i></button>',e+='<div class="sliderContainer" style="width:100px;vertical-align:middle;;margin-right:2em;display:inline-flex;">',e+='<input type="range" is="emby-slider" pin step="1" min="0" max="100" value="0" class="videoVolumeSlider"/>',e+="</div>",e+='<button is="paper-icon-button-light" class="mediaButton castButton autoSize" onclick="MediaController.showPlayerSelection(this, false);" style="height:32px;width:32px;"><i class="md-icon">cast</i></button>',e+='<button is="paper-icon-button-light" class="mediaButton fullscreenButton autoSize" onclick="MediaPlayer.toggleFullscreen();" id="video-fullscreenButton"><i class="md-icon">fullscreen</i></button>',e+='<button is="paper-icon-button-light" class="mediaButton infoButton autoSize" onclick="MediaPlayer.toggleInfo();"><i class="md-icon">info</i></button>',e+="</div>",e+="</div>",e+="</div>";var n=document.createElement("div");n.innerHTML=e,document.body.appendChild(n)}function m(){if(!D){D=!0,u();var e=document.querySelector("#videoPlayer");O=e.querySelector(".muteButton"),R=e.querySelector(".unmuteButton"),z=e.querySelector(".currentTime"),N=e.querySelector(".videoPositionSlider",e),N.addEventListener("change",s),N.getBubbleText=function(e){var n=l();if(!i.currentMediaSource||!n)return"--:--";var a=n;return a/=100,a*=e,t.getDisplayRunningTime(a)},V=e.querySelector(".videoVolumeSlider"),V.addEventListener("change",function(){var e=this.value;g(e),i.setVolume(e)})}}function v(){G&&window.clearTimeout(G),1==F&&(a(document.querySelectorAll(".hiddenOnIdle"),"remove","inactive"),document.querySelector("#videoPlayer").classList.remove("idlePlayer")),F=!1,G=window.setTimeout(function(){F=!0,a(document.querySelectorAll(".hiddenOnIdle"),"add","inactive"),document.querySelector("#videoPlayer").classList.add("idlePlayer")},3500)}function g(e){e?(O.classList.remove("hide"),R.classList.add("hide")):(O.classList.add("hide"),R.classList.remove("hide"))}function y(e){var t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t?t.call(e):p()}function p(){document.querySelector("#videoPlayer").classList.add("fullscreenVideo")}function f(){document.querySelector("#videoPlayer").classList.remove("fullscreenVideo")}function S(){window.removeEventListener("popstate",S),i.stop()}function h(){i.isFullScreen()?(p(),F=!0):f()}function b(e){(e.clientX!=U.x||e.clientY!=U.y)&&(U.x=e.clientX,U.y=e.clientY,v())}function I(e){Events.on(e,"playing",w),Events.on(e,"playing",C),Events.on(e,"volumechange",k),Events.on(e,"pause",B),Events.on(e,"timeupdate",q),Events.on(e,"error",x),Events.on(e,"click",E),Events.on(e,"dblclick",M);var t=!0;if(t){var n=document.querySelector(".itemVideo");n&&(n.addEventListener("keydown",v),n.addEventListener("scroll",v),n.addEventListener("mousedown",v),v())}document.addEventListener("webkitfullscreenchange",h),document.addEventListener("mozfullscreenchange",h),document.addEventListener("msfullscreenchange",h),document.addEventListener("fullscreenchange",h),window.addEventListener("popstate",S),t&&document.body.addEventListener("mousemove",b)}function T(e){Events.off(e,"playing",w),Events.off(e,"playing",C),Events.off(e,"volumechange",k),Events.off(e,"pause",B),Events.off(e,"timeupdate",q),Events.off(e,"error",x),Events.off(e,"click",E),Events.off(e,"dblclick",M),document.removeEventListener("webkitfullscreenchange",h),document.removeEventListener("mozfullscreenchange",h),document.removeEventListener("msfullscreenchange",h),document.removeEventListener("fullscreenchange",h),window.removeEventListener("popstate",S),document.body.removeEventListener("mousemove",b);var t=document.querySelector(".itemVideo");t&&(t.removeEventListener("keydown",v),t.removeEventListener("scroll",v),t.removeEventListener("mousedown",v))}function L(e){if(!e.classList.contains("hide")){var t=function(){e.classList.add("hide")};t()}}function P(e){e.classList.contains("hide")&&(e.classList.remove("hide"),browserInfo.animate&&!browserInfo.mobile&&requestAnimationFrame(function(){var t=[{transform:"scale3d(.2, .2, .2)  ",opacity:".6",offset:0},{transform:"none",opacity:"1",offset:1}],n={duration:200,iterations:1,easing:"ease-out"};e.animate(t,n)}))}function w(){Events.off(this,"playing",w),Events.on(this,"ended",i.onPlaybackStopped),Events.on(this,"ended",i.playNextAfterEnded),i.onPlaybackStart(this,i.currentItem,i.currentMediaSource)}function C(){var e=document.querySelector("#videoPlayer .videoControls"),t=document.querySelector("#videoPlayer #videoElement");e.querySelector("#video-playButton").classList.add("hide"),e.querySelector("#video-pauseButton").classList.remove("hide");var n=t.querySelector("#play");n.classList.remove("hide"),n.classList.add("fadeOut"),setTimeout(function(){n.classList.add("hide"),n.classList.remove("fadeOut")},300)}function k(){g(this.volume())}function B(){var e=document.querySelector("#videoPlayer .videoControls"),t=document.querySelector("#videoPlayer #videoElement");e.querySelector("#video-playButton").classList.remove("hide"),e.querySelector("#video-pauseButton").classList.add("hide");var n=t.querySelector("#pause");n.classList.remove("hide"),n.classList.add("fadeOut"),setTimeout(function(){n.classList.add("hide"),n.classList.remove("fadeOut")},300)}function q(){N.dragging||i.setCurrentTime(i.getCurrentTicks(this),N,z)}function x(){var e=Globalize.translate("MessageErrorPlayingVideo"),t=i.currentItem;t&&"TvChannel"==t.Type&&(e+="<p>",e+=Globalize.translate("MessageEnsureOpenTuner"),e+="</p>"),Dashboard.alert({title:Globalize.translate("HeaderVideoError"),message:e});var n=i.currentMediaRenderer;n&&i.onPlaybackStopped.call(n),i.nextTrack()}function E(){browserInfo.mobile||(this.paused()?i.unpause():i.pause())}function M(){browserInfo.mobile||i.toggleFullscreen()}var A,N,z,F=!0,O=null,R=null,V=null;i.currentSubtitleStreamIndex=null,i.getCurrentSubtitleStream=function(){return i.getSubtitleStream(i.currentSubtitleStreamIndex)},i.getSubtitleStream=function(e){return i.currentMediaSource.MediaStreams.filter(function(t){return"Subtitle"==t.Type&&t.Index==e})[0]},i.toggleFullscreen=function(){i.isFullScreen()?i.exitFullScreen():y(document.body)},i.resetEnhancements=function(){if(D){i.isFullScreen()&&i.exitFullScreen();var e=document.querySelector("#videoPlayer");L(e),e.classList.remove("fullscreenVideo"),e.classList.remove("idlePlayer"),a(document.querySelectorAll(".hiddenOnIdle"),"remove","inactive");var t=e.querySelector("video");t&&t.parentNode.removeChild(t),document.querySelector(".mediaButton.infoButton").classList.remove("active"),document.querySelector(".videoControls .nowPlayingInfo").classList.add("hide"),document.querySelector(".videoControls").classList.add("hiddenOnIdle")}},i.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),document.querySelector("#videoPlayer").classList.remove("fullscreenVideo")},i.isFullScreen=function(){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1},i.showSubtitleMenu=function(){var e=i.currentMediaSource.MediaStreams.filter(function(e){return"Subtitle"==e.Type}),t=i.currentSubtitleStreamIndex;null==t&&(t=-1),e.unshift({Index:-1,Language:Globalize.translate("ButtonOff")});var n=e.map(function(e){var n=[];n.push(e.Language||Globalize.translate("LabelUnknownLanguage")),e.Codec&&n.push(e.Codec);var i=n.join(" - ");e.IsDefault&&(i+=" (D)"),e.IsForced&&(i+=" (F)"),e.External&&(i+=" (EXT)");var a={name:e.DisplayTitle||i,id:e.Index};return e.Index==t&&(a.selected=!0),a});require(["actionsheet"],function(e){e.show({items:n,enableHistory:!1,positionTo:document.querySelector(".videoSubtitleButton"),callback:function(e){var n=parseInt(e);n!=t&&i.onSubtitleOptionSelected(n)}})})},i.showQualityFlyout=function(){require(["qualityoptions","actionsheet"],function(t,n){var a=i.getCurrentSrc(i.currentMediaRenderer).toLowerCase(),o=-1!=a.indexOf("static=true"),r=i.currentMediaSource.MediaStreams.filter(function(e){return"Video"==e.Type})[0],l=r?r.Width:null,s=t.getVideoQualityOptions(e.maxStreamingBitrate(),l);o&&(s[0].name="Direct");var d=s.map(function(e){var t={name:e.name,id:e.bitrate};return e.selected&&(t.selected=!0),t}),c=s.filter(function(e){return e.selected});c=c.length?c[0].bitrate:null,n.show({items:d,enableHistory:!1,positionTo:document.querySelector(".videoQualityButton"),callback:function(e){var t=parseInt(e);t!=c&&i.onQualityOptionSelected(t)}})})},i.showAudioTracksFlyout=function(){var e=i.currentMediaSource.MediaStreams.filter(function(e){return"Audio"==e.Type}),t=getParameterByName("AudioStreamIndex",i.getCurrentSrc(i.currentMediaRenderer)),n=e.map(function(e){var n=[];n.push(e.Language||Globalize.translate("LabelUnknownLanguage")),e.Codec&&n.push(e.Codec),e.Profile&&n.push(e.Profile),e.BitRate&&n.push(Math.floor(e.BitRate/1e3)+" kbps"),e.Channels&&n.push(e.Channels+" ch");var i=n.join(" - ");e.IsDefault&&(i+=" (D)");var a={name:e.DisplayTitle||i,id:e.Index};return e.Index==t&&(a.selected=!0),a});require(["actionsheet"],function(e){e.show({items:n,enableHistory:!1,positionTo:document.querySelector(".videoAudioButton"),callback:function(e){var n=parseInt(e);n!=t&&i.onAudioOptionSelected(n)}})})},i.setAudioStreamIndex=function(e){i.changeStream(i.getCurrentTicks(),{AudioStreamIndex:e})},i.setSubtitleStreamIndex=function(e){if(!i.currentMediaRenderer.supportsTextTracks())return i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:e}),void(i.currentSubtitleStreamIndex=e);var t=i.getCurrentSubtitleStream(),n=i.getSubtitleStream(e);if(t||n){var a=-1;t&&!n?"External"!=t.DeliveryMethod&&i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:-1}):!t&&n?"External"==n.DeliveryMethod?a=e:i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:e}):t&&n&&("External"==n.DeliveryMethod?(a=e,"External"!=t.DeliveryMethod&&i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:-1})):i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:e})),i.setCurrentTrackElement(a),i.currentSubtitleStreamIndex=e}},i.setCurrentTrackElement=function(e){i.currentMediaRenderer.setCurrentTrackElement(e)},i.updateTextStreamUrls=function(e){i.currentMediaRenderer.updateTextStreamUrls(e)},i.updateNowPlayingInfo=function(e){function t(){if(!this.classList.contains("selectedNowPlayingTabButton")){var e=document.querySelector(".selectedNowPlayingTabButton");e&&e.classList.remove("selectedNowPlayingTabButton"),this.classList.add("selectedNowPlayingTabButton"),a(document.querySelectorAll(".nowPlayingTab"),"add","hide"),document.querySelector("."+this.getAttribute("data-tab")).classList.remove("hide")}}if(!e)throw new Error("item cannot be null");var n=document.querySelector("#videoPlayer"),l=i.getPlayerStateInternal(i.currentMediaRenderer,e.CurrentProgram||e,i.currentMediaSource),s="",d=400,c=300;l.NowPlayingItem.PrimaryImageTag?s=ApiClient.getScaledImageUrl(l.NowPlayingItem.PrimaryImageItemId,{type:"Primary",width:d,tag:l.NowPlayingItem.PrimaryImageTag}):l.NowPlayingItem.PrimaryImageTag?s=ApiClient.getScaledImageUrl(l.NowPlayingItem.PrimaryImageItemId,{type:"Primary",width:d,tag:l.NowPlayingItem.PrimaryImageTag}):l.NowPlayingItem.BackdropImageTag?s=ApiClient.getScaledImageUrl(l.NowPlayingItem.BackdropItemId,{type:"Backdrop",height:c,tag:l.NowPlayingItem.BackdropImageTag,index:0}):l.NowPlayingItem.ThumbImageTag&&(s=ApiClient.getScaledImageUrl(l.NowPlayingItem.ThumbImageItemId,{type:"Thumb",height:c,tag:l.NowPlayingItem.ThumbImageTag})),n.querySelector(".nowPlayingImage").innerHTML=s?'<img src="'+s+'" />':"",l.NowPlayingItem.LogoItemId?(s=ApiClient.getScaledImageUrl(l.NowPlayingItem.LogoItemId,{type:"Logo",height:42,tag:l.NowPlayingItem.LogoImageTag}),n.querySelector(".videoTopControlsLogo").innerHTML='<img src="'+s+'" />'):n.querySelector(".videoTopControlsLogo").innerHTML="";var u=n.querySelector(".nowPlayingTabs");u.innerHTML=r(e.CurrentProgram||e),ImageLoader.lazyChildren(u);for(var m=u.querySelectorAll(".nowPlayingTabButton"),v=0,g=m.length;g>v;v++)m[v].addEventListener("click",t);u.addEventListener("click",function(e){var t=o(e.target,"chapterCard");t&&i.seek(parseInt(t.getAttribute("data-position")))})},i.onAudioOptionSelected=function(e){i.setAudioStreamIndex(e)},i.onSubtitleOptionSelected=function(e){i.setSubtitleStreamIndex(e)},i.onQualityOptionSelected=function(t){e.maxStreamingBitrate(t),e.enableAutomaticBitrateDetection(!1),i.changeStream(i.getCurrentTicks(),{Bitrate:t})},i.toggleInfo=function(){var e=document.querySelector(".mediaButton.infoButton"),t=document.querySelector(".videoControls .nowPlayingInfo");e.classList.contains("active")?(e.classList.remove("active"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"),c(t)):(e.classList.add("active"),document.querySelector(".videoControls").classList.remove("hiddenOnIdle"),t.classList.remove("hide"),d(t))},i.toggleGuide=function(){var e=document.querySelector(".mediaButton.guideButton"),t=document.querySelector(".videoControls .guide");e.classList.contains("active")?(e.classList.remove("active"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"),c(t)):(e.classList.add("active"),document.querySelector(".videoControls").classList.remove("hiddenOnIdle"),t.classList.remove("hide"),d(t),i.guideInstance||require(["tvguide"],function(e){i.guideInstance=new e({element:t,enablePaging:!1})}))};var D,G,U={};i.cleanup=function(e){z&&(z.innerHTML="--:--"),T(e)},i.playVideo=function(e,t,n,a){requirejs(["videorenderer","css!css/nowplayingbar.css","css!css/mediaplayer-video.css","emby-slider"],function(){m(),i.createStreamInfo("Video",e,t,n).then(function(o){var r=-1!=o.url.toLowerCase().indexOf(".m3u8");if(!t.RunTimeTicks&&r){Dashboard.showLoadingMsg();var l=o.url.replace("master.m3u8","live.m3u8");ApiClient.ajax({type:"GET",url:l}).then(function(){Dashboard.hideLoadingMsg(),o.url=l,setTimeout(function(){i.playVideoInternal(e,t,n,o,a)},2e3)},function(){Dashboard.hideLoadingMsg()})}else i.playVideoInternal(e,t,n,o,a)})})},i.playVideoInternal=function(e,t,n,a,o){i.startTimeTicksOffset=a.startTimeTicksOffset;var r=t.MediaStreams||[],l=r.filter(function(e){return"Subtitle"==e.Type}),s=document.querySelector("#videoPlayer");P(s);var d=s.querySelector(".videoControls");document.querySelector("#video-playButton").classList.add("hide"),document.querySelector("#video-pauseButton").classList.remove("hide"),document.querySelector(".videoTrackControl").classList.add("hide"),document.querySelector(".videoQualityButton").classList.remove("hide"),r.filter(function(e){return"Audio"==e.Type}).length?document.querySelector(".videoAudioButton").classList.remove("hide"):document.querySelector(".videoAudioButton").classList.add("hide"),l.length?document.querySelector(".videoSubtitleButton").classList.remove("hide"):document.querySelector(".videoSubtitleButton").classList.add("hide");var c=new VideoRenderer({poster:i.getPosterUrl(e)}),u=!c.enableCustomVideoControls();u||AppInfo.isNativeApp?d.querySelector("#video-fullscreenButton").classList.add("hide"):d.querySelector("#video-fullscreenButton").classList.remove("hide"),AppInfo.hasPhysicalVolumeButtons?(V.classList.add("hide"),d.querySelector(".muteButton").classList.add("hide"),d.querySelector(".unmuteButton").classList.add("hide")):(V.classList.remove("hide"),d.querySelector(".muteButton").classList.remove("hide"),d.querySelector(".unmuteButton").classList.remove("hide")),u?d.classList.add("hide"):d.classList.remove("hide"),A=i.getSavedVolume(),c.volume(A),V.value=100*A,g(A),I(c),i.currentSubtitleStreamIndex=t.DefaultSubtitleStreamIndex,document.body.classList.add("bodyWithPopupOpen"),i.currentMediaRenderer=c,i.currentDurationTicks=i.currentMediaSource.RunTimeTicks,i.updateNowPlayingInfo(e),c.init().then(function(){i.onBeforePlaybackStart(c,e,t),i.setSrcIntoRenderer(c,a,e,i.currentMediaSource),i.streamInfo=a,o&&o()})},i.updatePlaylistUi=function(){if(D){var e=i.currentPlaylistIndex(null),t=i.playlist.length,n=!1;if(i.currentMediaRenderer&&i.currentMediaRenderer.enableCustomVideoControls&&(n=i.currentMediaRenderer.enableCustomVideoControls()),2>t)return void document.querySelector(".videoTrackControl").classList.add("hide");var a=n?".videoAdvancedControls":".videoControls";a=document.querySelector(a);var o=a.getElementsByClassName("previousTrackButton")[0],r=a.getElementsByClassName("nextTrackButton")[0];0===e?o.setAttribute("disabled","disabled"):o.removeAttribute("disabled"),e+1>=t?r.setAttribute("disabled","disabled"):r.removeAttribute("disabled"),o.classList.remove("hide"),r.classList.remove("hide")}}}i(MediaPlayer)});