define(["appSettings","datetime","jQuery","mediaInfo","scrollStyles","paper-icon-button-light"],function(e,t,n,i){function o(o){function a(e){var n="";n+='<div class="nowPlayingTabButtons">',n+='<a href="#" class="nowPlayingTabButton selectedNowPlayingTabButton" data-tab="tabInfo">'+Globalize.translate("TabInfo")+"</a>",e.Chapters&&e.Chapters.length&&(n+='<a href="#" class="nowPlayingTabButton" data-tab="tabScenes">'+Globalize.translate("TabScenes")+"</a>"),e.People&&e.People.length&&(n+='<a href="#" class="nowPlayingTabButton" data-tab="tabCast">'+Globalize.translate("TabCast")+"</a>"),n+="</div>",n+='<div class="tabInfo nowPlayingTab">';var o=MediaController.getNowPlayingNameHtml(e,!1);o='<div class="videoNowPlayingName">'+o+"</div>";var a=i.getPrimaryMediaInfoHtml(e);if(a&&(o+='<div class="videoNowPlayingRating">'+a+"</div>"),e.Overview&&(o+='<div class="videoNowPlayingOverview">'+e.Overview+"</div>"),n+=o,n+="</div>",e.Chapters&&e.Chapters.length){n+='<div class="tabScenes nowPlayingTab smoothScrollX" style="display:none;white-space:nowrap;margin-bottom:2em;">';var r=0;n+=e.Chapters.map(function(n){var i=240,o='<a class="card backdropCard chapterCard" href="#" style="margin-right:1em;width:'+i+'px;" data-position="'+n.StartPositionTicks+'">';if(o+='<div class="cardBox">',o+='<div class="cardScalable">',o+='<div class="cardPadder"></div>',o+='<div class="cardContent">',n.ImageTag){var a=ApiClient.getScaledImageUrl(e.Id,{width:i,tag:n.ImageTag,type:"Chapter",index:r});o+='<div class="cardImage lazy" data-src="'+a+'"></div>'}else o+='<div class="cardImage" style="background:#444;"></div>';return o+='<div class="cardFooter">',n.Name&&(o+='<div class="cardText">'+n.Name+"</div>"),o+='<div class="cardText">'+t.getDisplayRunningTime(n.StartPositionTicks)+"</div>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+="</a>",r++,o}).join(""),n+="</div>"}return e.People&&e.People.length&&(n+='<div class="tabCast nowPlayingTab smoothScrollX" style="display:none;white-space:nowrap;">',n+=e.People.map(function(e){var t,n='<div class="tileItem smallPosterTileItem" style="width:300px;">',i=150;e.PrimaryImageTag?(t=ApiClient.getScaledImageUrl(e.Id,{height:i,tag:e.PrimaryImageTag,type:"primary",minScale:2}),n+='<div class="tileImage lazy" data-src="'+t+'" style="height:'+i+'px;"></div>'):(t="css/images/items/list/person.png",n+='<div class="tileImage" style="background-image:url(\''+t+"');height:"+i+'px;"></div>'),n+='<div class="tileContent">',n+="<p>"+e.Name+"</p>";var o=e.Role?Globalize.translate("ValueAsRole",e.Role):e.Type;"GuestStar"==o&&(o=Globalize.translate("ValueGuestStar")),o=o||"";var a=40;return o.length>a&&(o=o.substring(0,a-3)+"..."),n+="<p>"+o+"</p>",n+="</div>",n+="</div>"}).join(""),n+="</div>"),n}function r(){return o.currentMediaSource&&o.currentMediaSource.RunTimeTicks?o.currentMediaSource.RunTimeTicks:o.currentMediaRenderer?o.getCurrentTicks(o.currentMediaRenderer):null}function l(){var e=parseInt(this.value),t=e/100*r();o.changeStream(Math.floor(t))}function s(e){var t=[{transform:"translate3d(0, 100%, 0)",offset:0},{transform:"translate3d(0, 0, 0)",offset:1}],n={duration:300,iterations:1};e.animate&&e.animate(t,n)}function d(e){var t=[{transform:"translate3d(0, 0, 0)",offset:0},{transform:"translate3d(0, 100%, 0)",offset:1}],n={duration:300,iterations:1},i=function(){e.classList.add("hide")};e.animate?e.animate(t,n).onfinish=i:i()}function u(){var e="";e+='<div id="videoPlayer" class="hide">',e+='<div id="videoElement">',e+='<div id="play" class="status"></div>',e+='<div id="pause" class="status"></div>',e+="</div>";var t=AppInfo.isNativeApp&&browserInfo.android?"hiddenOnIdle hide":"hiddenOnIdle";e+='<div class="videoTopControls '+t+'">',e+='<div class="videoTopControlsLogo"></div>',e+='<div class="videoAdvancedControls">',e+='<button is="paper-icon-button-light" class="previousTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.previousTrack();"><iron-icon icon="skip-previous"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="nextTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.nextTrack();"><iron-icon icon="skip-next"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoAudioButton" onclick="MediaPlayer.showAudioTracksFlyout();"><iron-icon icon="audiotrack"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoSubtitleButton" onclick="MediaPlayer.showSubtitleMenu();"><iron-icon icon="closed-caption"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoQualityButton" onclick="MediaPlayer.showQualityFlyout();"><iron-icon icon="settings"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton" onclick="MediaPlayer.stop();"><iron-icon icon="close"></iron-icon></button>',e+="</div>",e+="</div>",e+='<div class="videoControls '+t+'">',e+='<div class="nowPlayingInfo hide">',e+='<div class="nowPlayingImage"></div>',e+='<div class="nowPlayingTabs"></div>',e+="</div>",e+='<div class="guide hide">',e+="</div>",e+='<div class="videoControlButtons">',e+='<button is="paper-icon-button-light" class="previousTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.previousTrack();"></iron-icon></button>',e+='<button is="paper-icon-button-light" id="video-playButton" class="mediaButton unpauseButton" onclick="MediaPlayer.unpause();"><iron-icon icon="play-arrow"></iron-icon></button>',e+='<button is="paper-icon-button-light" id="video-pauseButton" class="mediaButton pauseButton" onclick="MediaPlayer.pause();"><iron-icon icon="pause"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="nextTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.nextTrack();"><iron-icon icon="skip-next"></iron-icon></button>',e+='<paper-slider pin step=".1" min="0" max="100" value="0" class="videoPositionSlider" style="display:inline-block;margin-right:2em;"></paper-slider>',e+='<div class="currentTime">--:--</div>',e+='<button is="paper-icon-button-light" class="muteButton mediaButton" onclick="MediaPlayer.mute();"><iron-icon icon="volume-up"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="unmuteButton mediaButton" onclick="MediaPlayer.unMute();"><iron-icon icon="volume-off"></iron-icon></button>',e+='<paper-slider pin step="1" min="0" max="100" value="0" class="videoVolumeSlider" style="width:100px;vertical-align:middle;margin-left:-1em;margin-right:2em;display:inline-block;"></paper-slider>',e+='<button is="paper-icon-button-light" class="mediaButton castButton" onclick="MediaController.showPlayerSelection(this, false);" style="height:32px;width:32px;"><iron-icon icon="cast"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton fullscreenButton" onclick="MediaPlayer.toggleFullscreen();" id="video-fullscreenButton"><iron-icon icon="fullscreen"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton infoButton" onclick="MediaPlayer.toggleInfo();"><iron-icon icon="info"></iron-icon></button>',e+="</div>",e+="</div>",e+="</div>";var n=document.createElement("div");n.innerHTML=e,document.body.appendChild(n)}function c(){if(!z){z=!0,u();var e=n("#videoPlayer");O=n(".muteButton",e),R=n(".unmuteButton",e),F=n(".currentTime",e),N=n(".videoPositionSlider",e).on("change",l)[0],N._setPinValue=function(e){var n=r();if(!o.currentMediaSource||!n)return void(this.pinValue="--:--");var i=n;i/=100,i*=e,this.pinValue=t.getDisplayRunningTime(i)},V=n(".videoVolumeSlider",e).on("change",function(){var e=this.value;v(e),o.setVolume(e)})[0]}}function m(){D&&window.clearTimeout(D),1==q&&(n(".hiddenOnIdle").removeClass("inactive"),n("#videoPlayer").removeClass("idlePlayer")),q=!1,D=window.setTimeout(function(){q=!0,n(".hiddenOnIdle").addClass("inactive"),n("#videoPlayer").addClass("idlePlayer")},3500)}function v(e){e?(O.show(),R.hide()):(O.hide(),R.show())}function g(e){var t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t?t.call(e):p()}function p(){var e=n("#videoPlayer");e.addClass("fullscreenVideo")}function f(){var e=n("#videoPlayer");e.removeClass("fullscreenVideo")}function h(){o.stop()}function y(){o.isFullScreen()?(p(),q=!0):f()}function b(e){(e.clientX!=G.x||e.clientY!=G.y)&&(G.x=e.clientX,G.y=e.clientY,m())}function S(e){Events.on(e,"playing",P),Events.on(e,"playing",w),Events.on(e,"volumechange",k),Events.on(e,"pause",B),Events.on(e,"timeupdate",x),Events.on(e,"error",M),Events.on(e,"click",E),Events.on(e,"dblclick",L);var t=!0;if(t){var i=document.querySelector(".itemVideo");i&&(i.addEventListener("keydown",m),i.addEventListener("scroll",m),i.addEventListener("mousedown",m),m())}n(document).on("webkitfullscreenchange",y),n(document).on("mozfullscreenchange",y),n(document).on("msfullscreenchange",y),n(document).on("fullscreenchange",y),n(window).one("popstate",h),t&&n(document.body).on("mousemove",b)}function I(e){Events.off(e,"playing",P),Events.off(e,"playing",w),Events.off(e,"volumechange",k),Events.off(e,"pause",B),Events.off(e,"timeupdate",x),Events.off(e,"error",M),Events.off(e,"click",E),Events.off(e,"dblclick",L),n(document).off("webkitfullscreenchange",y),n(document).off("mozfullscreenchange",y),n(document).off("msfullscreenchange",y),n(document).off("fullscreenchange",y),n(window).off("popstate",h),n(document.body).off("mousemove",b);var t=document.querySelector(".itemVideo");t&&(t.removeEventListener("keydown",m),t.removeEventListener("scroll",m),t.removeEventListener("mousedown",m))}function C(e){if(!e.classList.contains("hide")){var t=function(){e.classList.add("hide")};t()}}function T(e){e.classList.contains("hide")&&(e.classList.remove("hide"),browserInfo.animate&&!browserInfo.mobile&&requestAnimationFrame(function(){var t=[{transform:"scale3d(.2, .2, .2)  ",opacity:".6",offset:0},{transform:"none",opacity:"1",offset:1}],n={duration:200,iterations:1,easing:"ease-out"};e.animate(t,n)}))}function P(){Events.off(this,"playing",P),Events.on(this,"ended",o.onPlaybackStopped),Events.on(this,"ended",o.playNextAfterEnded),o.onPlaybackStart(this,o.currentItem,o.currentMediaSource)}function w(){var e=document.querySelector("#videoPlayer .videoControls"),t=document.querySelector("#videoPlayer #videoElement");n("#video-playButton",e).hide(),n("#video-pauseButton",e).show(),n("#play",t).show().addClass("fadeOut"),setTimeout(function(){n("#play",t).hide().removeClass("fadeOut")},300)}function k(){v(this.volume())}function B(){var e=document.querySelector("#videoPlayer .videoControls"),t=document.querySelector("#videoPlayer #videoElement");n("#video-playButton",e).show(),n("#video-pauseButton",e).hide(),n("#pause",t).show().addClass("fadeOut"),setTimeout(function(){n("#pause",t).hide().removeClass("fadeOut")},300)}function x(){N.dragging||o.setCurrentTime(o.getCurrentTicks(this),N,F)}function M(){var e=Globalize.translate("MessageErrorPlayingVideo"),t=o.currentItem;t&&"TvChannel"==t.Type&&(e+="<p>",e+=Globalize.translate("MessageEnsureOpenTuner"),e+="</p>"),Dashboard.alert({title:Globalize.translate("HeaderVideoError"),message:e});var n=o.currentMediaRenderer;n&&o.onPlaybackStopped.call(n),o.nextTrack()}function E(){browserInfo.mobile||(this.paused()?o.unpause():o.pause())}function L(){browserInfo.mobile||o.toggleFullscreen()}var A,N,F,q=!0,O=null,R=null,V=null;o.currentSubtitleStreamIndex=null,o.getCurrentSubtitleStream=function(){return o.getSubtitleStream(o.currentSubtitleStreamIndex)},o.getSubtitleStream=function(e){return o.currentMediaSource.MediaStreams.filter(function(t){return"Subtitle"==t.Type&&t.Index==e})[0]},o.toggleFullscreen=function(){o.isFullScreen()?o.exitFullScreen():g(document.body)},o.resetEnhancements=function(){z&&(o.isFullScreen()&&o.exitFullScreen(),C(document.querySelector("#videoPlayer")),n("#videoPlayer").removeClass("fullscreenVideo").removeClass("idlePlayer"),n(".hiddenOnIdle").removeClass("inactive"),n("video").remove(),document.querySelector(".mediaButton.infoButton").classList.remove("active"),document.querySelector(".videoControls .nowPlayingInfo").classList.add("hide"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"))},o.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),n("#videoPlayer").removeClass("fullscreenVideo")},o.isFullScreen=function(){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1},o.showSubtitleMenu=function(){var e=o.currentMediaSource.MediaStreams.filter(function(e){return"Subtitle"==e.Type}),t=o.currentSubtitleStreamIndex;null==t&&(t=-1),e.unshift({Index:-1,Language:Globalize.translate("ButtonOff")});var i=e.map(function(e){var n=[];n.push(e.Language||Globalize.translate("LabelUnknownLanguage")),e.Codec&&n.push(e.Codec);var i=n.join(" - ");e.IsDefault&&(i+=" (D)"),e.IsForced&&(i+=" (F)"),e.External&&(i+=" (EXT)");var o={name:e.DisplayTitle||i,id:e.Index};return e.Index==t&&(o.selected=!0),o});require(["actionsheet"],function(e){e.show({items:i,enableHistory:!1,positionTo:n(".videoSubtitleButton")[0],callback:function(e){var n=parseInt(e);n!=t&&o.onSubtitleOptionSelected(n)}})})},o.showQualityFlyout=function(){require(["qualityoptions","actionsheet"],function(t,i){var a=o.getCurrentSrc(o.currentMediaRenderer).toLowerCase(),r=-1!=a.indexOf("static=true"),l=o.currentMediaSource.MediaStreams.filter(function(e){return"Video"==e.Type})[0],s=l?l.Width:null,d=t.getVideoQualityOptions(e.maxStreamingBitrate(),s);r&&(d[0].name="Direct");var u=d.map(function(e){var t={name:e.name,id:e.bitrate};return e.selected&&(t.selected=!0),t}),c=d.filter(function(e){return e.selected});c=c.length?c[0].bitrate:null,i.show({items:u,enableHistory:!1,positionTo:n(".videoQualityButton")[0],callback:function(e){var t=parseInt(e);t!=c&&o.onQualityOptionSelected(t)}})})},o.showAudioTracksFlyout=function(){var e=o.currentMediaSource.MediaStreams.filter(function(e){return"Audio"==e.Type}),t=getParameterByName("AudioStreamIndex",o.getCurrentSrc(o.currentMediaRenderer)),i=e.map(function(e){var n=[];n.push(e.Language||Globalize.translate("LabelUnknownLanguage")),e.Codec&&n.push(e.Codec),e.Profile&&n.push(e.Profile),e.BitRate&&n.push(Math.floor(e.BitRate/1e3)+" kbps"),e.Channels&&n.push(e.Channels+" ch");var i=n.join(" - ");e.IsDefault&&(i+=" (D)");var o={name:e.DisplayTitle||i,id:e.Index};return e.Index==t&&(o.selected=!0),o});require(["actionsheet"],function(e){e.show({items:i,enableHistory:!1,positionTo:n(".videoAudioButton")[0],callback:function(e){var n=parseInt(e);n!=t&&o.onAudioOptionSelected(n)}})})},o.setAudioStreamIndex=function(e){o.changeStream(o.getCurrentTicks(),{AudioStreamIndex:e})},o.setSubtitleStreamIndex=function(e){if(!o.currentMediaRenderer.supportsTextTracks())return o.changeStream(o.getCurrentTicks(),{SubtitleStreamIndex:e}),void(o.currentSubtitleStreamIndex=e);var t=o.getCurrentSubtitleStream(),n=o.getSubtitleStream(e);if(t||n){var i=-1;t&&!n?"External"!=t.DeliveryMethod&&o.changeStream(o.getCurrentTicks(),{SubtitleStreamIndex:-1}):!t&&n?"External"==n.DeliveryMethod?i=e:o.changeStream(o.getCurrentTicks(),{SubtitleStreamIndex:e}):t&&n&&("External"==n.DeliveryMethod?(i=e,"External"!=t.DeliveryMethod&&o.changeStream(o.getCurrentTicks(),{SubtitleStreamIndex:-1})):o.changeStream(o.getCurrentTicks(),{SubtitleStreamIndex:e})),o.setCurrentTrackElement(i),o.currentSubtitleStreamIndex=e}},o.setCurrentTrackElement=function(e){o.currentMediaRenderer.setCurrentTrackElement(e)},o.updateTextStreamUrls=function(e){o.currentMediaRenderer.updateTextStreamUrls(e)},o.updateNowPlayingInfo=function(e){if(!e)throw new Error("item cannot be null");var t=n("#videoPlayer"),i=o.getPlayerStateInternal(o.currentMediaRenderer,e.CurrentProgram||e,o.currentMediaSource),r="",l=400,s=300;i.NowPlayingItem.PrimaryImageTag?r=ApiClient.getScaledImageUrl(i.NowPlayingItem.PrimaryImageItemId,{type:"Primary",width:l,tag:i.NowPlayingItem.PrimaryImageTag}):i.NowPlayingItem.PrimaryImageTag?r=ApiClient.getScaledImageUrl(i.NowPlayingItem.PrimaryImageItemId,{type:"Primary",width:l,tag:i.NowPlayingItem.PrimaryImageTag}):i.NowPlayingItem.BackdropImageTag?r=ApiClient.getScaledImageUrl(i.NowPlayingItem.BackdropItemId,{type:"Backdrop",height:s,tag:i.NowPlayingItem.BackdropImageTag,index:0}):i.NowPlayingItem.ThumbImageTag&&(r=ApiClient.getScaledImageUrl(i.NowPlayingItem.ThumbImageItemId,{type:"Thumb",height:s,tag:i.NowPlayingItem.ThumbImageTag})),n(".nowPlayingImage",t).html(r?'<img src="'+r+'" />':""),i.NowPlayingItem.LogoItemId?(r=ApiClient.getScaledImageUrl(i.NowPlayingItem.LogoItemId,{type:"Logo",height:42,tag:i.NowPlayingItem.LogoImageTag}),n(".videoTopControlsLogo",t).html('<img src="'+r+'" />')):n(".videoTopControlsLogo",t).html("");var d=n(".nowPlayingTabs",t).html(a(e.CurrentProgram||e)).lazyChildren();n(".nowPlayingTabButton",d).on("click",function(){n(this).hasClass("selectedNowPlayingTabButton")||(n(".selectedNowPlayingTabButton").removeClass("selectedNowPlayingTabButton"),n(this).addClass("selectedNowPlayingTabButton"),n(".nowPlayingTab").hide(),n("."+this.getAttribute("data-tab")).show().trigger("scroll"))}),n(".chapterCard",d).on("click",function(){o.seek(parseInt(this.getAttribute("data-position")))})},n.fn.lazyChildren=function(){for(var e=0,t=this.length;t>e;e++)ImageLoader.lazyChildren(this[e]);return this},o.onAudioOptionSelected=function(e){o.setAudioStreamIndex(e)},o.onSubtitleOptionSelected=function(e){o.setSubtitleStreamIndex(e)},o.onQualityOptionSelected=function(t){e.maxStreamingBitrate(t),e.enableAutomaticBitrateDetection(!1),o.changeStream(o.getCurrentTicks(),{Bitrate:t})},o.toggleInfo=function(){var e=document.querySelector(".mediaButton.infoButton"),t=document.querySelector(".videoControls .nowPlayingInfo");e.classList.contains("active")?(e.classList.remove("active"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"),d(t)):(e.classList.add("active"),document.querySelector(".videoControls").classList.remove("hiddenOnIdle"),t.classList.remove("hide"),s(t))},o.toggleGuide=function(){var e=document.querySelector(".mediaButton.guideButton"),t=document.querySelector(".videoControls .guide");e.classList.contains("active")?(e.classList.remove("active"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"),d(t)):(e.classList.add("active"),document.querySelector(".videoControls").classList.remove("hiddenOnIdle"),t.classList.remove("hide"),s(t),o.guideInstance||require(["tvguide"],function(e){o.guideInstance=new e({element:t,enablePaging:!1})}))};var z,D,G={};o.cleanup=function(e){F&&F.html("--:--"),I(e)},o.playVideo=function(e,t,n,i){requirejs(["videorenderer","css!css/nowplayingbar.css","css!css/mediaplayer-video.css","paper-slider"],function(){c(),o.createStreamInfo("Video",e,t,n).then(function(a){var r=-1!=a.url.toLowerCase().indexOf(".m3u8");if(!t.RunTimeTicks&&r){Dashboard.showLoadingMsg();var l=a.url.replace("master.m3u8","live.m3u8");ApiClient.ajax({type:"GET",url:l}).then(function(){Dashboard.hideLoadingMsg(),a.url=l,setTimeout(function(){o.playVideoInternal(e,t,n,a,i)},2e3)},function(){Dashboard.hideLoadingMsg()})}else o.playVideoInternal(e,t,n,a,i)})})},o.playVideoInternal=function(e,t,i,a,r){o.startTimeTicksOffset=a.startTimeTicksOffset;var l=t.MediaStreams||[],s=l.filter(function(e){return"Subtitle"==e.Type}),d=document.querySelector("#videoPlayer");T(d);var u=n(".videoControls",d);n("#video-playButton",u).hide(),n("#video-pauseButton",u).show(),n(".videoTrackControl").addClass("hide");n("#videoElement",d);n(".videoQualityButton",u).show(),l.filter(function(e){return"Audio"==e.Type}).length?n(".videoAudioButton").show():n(".videoAudioButton").hide(),s.length?n(".videoSubtitleButton").show():n(".videoSubtitleButton").hide();var c=new VideoRenderer({poster:o.getPosterUrl(e)}),m=!c.enableCustomVideoControls();m||AppInfo.isNativeApp?n("#video-fullscreenButton",u).hide():n("#video-fullscreenButton",u).show(),AppInfo.hasPhysicalVolumeButtons?(n(V).addClass("hide"),n(".muteButton",u).addClass("hide"),n(".unmuteButton",u).addClass("hide")):(n(V).removeClass("hide"),n(".muteButton",u).removeClass("hide"),n(".unmuteButton",u).removeClass("hide")),m?u.addClass("hide"):u.removeClass("hide"),A=o.getSavedVolume(),c.volume(A),V.value=100*A,v(A),S(c),o.currentSubtitleStreamIndex=t.DefaultSubtitleStreamIndex,n(document.body).addClass("bodyWithPopupOpen"),o.currentMediaRenderer=c,o.currentDurationTicks=o.currentMediaSource.RunTimeTicks,o.updateNowPlayingInfo(e),c.init().then(function(){o.onBeforePlaybackStart(c,e,t),o.setSrcIntoRenderer(c,a,e,o.currentMediaSource),o.streamInfo=a,r&&r()})},o.updatePlaylistUi=function(){if(z){var e=o.currentPlaylistIndex(null),t=o.playlist.length,i=!1;if(o.currentMediaRenderer&&o.currentMediaRenderer.enableCustomVideoControls&&(i=o.currentMediaRenderer.enableCustomVideoControls()),2>t)return void n(".videoTrackControl").addClass("hide");var a=i?".videoAdvancedControls":".videoControls";a=document.querySelector(a);var r=a.getElementsByClassName("previousTrackButton")[0],l=a.getElementsByClassName("nextTrackButton")[0];0===e?r.setAttribute("disabled","disabled"):r.removeAttribute("disabled"),e+1>=t?l.setAttribute("disabled","disabled"):l.removeAttribute("disabled"),n(r).removeClass("hide"),n(l).removeClass("hide")}}}o(MediaPlayer)});