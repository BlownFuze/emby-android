define(["appSettings","datetime","jQuery","scrollStyles","paper-icon-button-light"],function(e,t,n){function i(i){function o(e){var n="";n+='<div class="nowPlayingTabButtons">',n+='<a href="#" class="nowPlayingTabButton selectedNowPlayingTabButton" data-tab="tabInfo">'+Globalize.translate("TabInfo")+"</a>",e.Chapters&&e.Chapters.length&&(n+='<a href="#" class="nowPlayingTabButton" data-tab="tabScenes">'+Globalize.translate("TabScenes")+"</a>"),e.People&&e.People.length&&(n+='<a href="#" class="nowPlayingTabButton" data-tab="tabCast">'+Globalize.translate("TabCast")+"</a>"),n+="</div>",n+='<div class="tabInfo nowPlayingTab">';var i=MediaController.getNowPlayingNameHtml(e,!1);i='<div class="videoNowPlayingName">'+i+"</div>";var o=LibraryBrowser.getMiscInfoHtml(e);o&&(i+='<div class="videoNowPlayingRating">'+o+"</div>");var a=LibraryBrowser.getRatingHtml(e);if(a&&(i+='<div class="videoNowPlayingRating">'+a+"</div>"),e.Overview&&(i+='<div class="videoNowPlayingOverview">'+e.Overview+"</div>"),n+=i,n+="</div>",e.Chapters&&e.Chapters.length){n+='<div class="tabScenes nowPlayingTab smoothScrollX" style="display:none;white-space:nowrap;margin-bottom:2em;">';var r=0;n+=e.Chapters.map(function(n){var i=240,o='<a class="card backdropCard chapterCard" href="#" style="margin-right:1em;width:'+i+'px;" data-position="'+n.StartPositionTicks+'">';if(o+='<div class="cardBox">',o+='<div class="cardScalable">',o+='<div class="cardPadder"></div>',o+='<div class="cardContent">',n.ImageTag){var a=ApiClient.getScaledImageUrl(e.Id,{width:i,tag:n.ImageTag,type:"Chapter",index:r});o+='<div class="cardImage lazy" data-src="'+a+'"></div>'}else o+='<div class="cardImage" style="background:#444;"></div>';return o+='<div class="cardFooter">',n.Name&&(o+='<div class="cardText">'+n.Name+"</div>"),o+='<div class="cardText">'+t.getDisplayRunningTime(n.StartPositionTicks)+"</div>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+="</a>",r++,o}).join(""),n+="</div>"}return e.People&&e.People.length&&(n+='<div class="tabCast nowPlayingTab smoothScrollX" style="display:none;white-space:nowrap;">',n+=e.People.map(function(e){var t,n='<div class="tileItem smallPosterTileItem" style="width:300px;">',i=150;e.PrimaryImageTag?(t=ApiClient.getScaledImageUrl(e.Id,{height:i,tag:e.PrimaryImageTag,type:"primary",minScale:2}),n+='<div class="tileImage lazy" data-src="'+t+'" style="height:'+i+'px;"></div>'):(t="css/images/items/list/person.png",n+='<div class="tileImage" style="background-image:url(\''+t+"');height:"+i+'px;"></div>'),n+='<div class="tileContent">',n+="<p>"+e.Name+"</p>";var o=e.Role?Globalize.translate("ValueAsRole",e.Role):e.Type;"GuestStar"==o&&(o=Globalize.translate("ValueGuestStar")),o=o||"";var a=40;return o.length>a&&(o=o.substring(0,a-3)+"..."),n+="<p>"+o+"</p>",n+="</div>",n+="</div>"}).join(""),n+="</div>"),n}function a(){return i.currentMediaSource&&i.currentMediaSource.RunTimeTicks?i.currentMediaSource.RunTimeTicks:i.currentMediaRenderer?i.getCurrentTicks(i.currentMediaRenderer):null}function r(){var e=parseInt(this.value),t=e/100*a();i.changeStream(Math.floor(t))}function l(e){var t=[{transform:"translate3d(0, 100%, 0)",offset:0},{transform:"translate3d(0, 0, 0)",offset:1}],n={duration:300,iterations:1};e.animate&&e.animate(t,n)}function s(e){var t=[{transform:"translate3d(0, 0, 0)",offset:0},{transform:"translate3d(0, 100%, 0)",offset:1}],n={duration:300,iterations:1},i=function(){e.classList.add("hide")};e.animate?e.animate(t,n).onfinish=i:i()}function d(){var e="";e+='<div id="videoPlayer" class="hide">',e+='<div id="videoElement">',e+='<div id="play" class="status"></div>',e+='<div id="pause" class="status"></div>',e+="</div>",e+='<div class="videoTopControls hiddenOnIdle">',e+='<div class="videoTopControlsLogo"></div>',e+='<div class="videoAdvancedControls">',e+='<button is="paper-icon-button-light" class="previousTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.previousTrack();"><iron-icon icon="skip-previous"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="nextTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.nextTrack();"><iron-icon icon="skip-next"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoAudioButton" onclick="MediaPlayer.showAudioTracksFlyout();"><iron-icon icon="audiotrack"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoSubtitleButton" onclick="MediaPlayer.showSubtitleMenu();"><iron-icon icon="closed-caption"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton videoQualityButton" onclick="MediaPlayer.showQualityFlyout();"><iron-icon icon="settings"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton" onclick="MediaPlayer.stop();"><iron-icon icon="close"></iron-icon></button>',e+="</div>",e+="</div>",e+='<div class="videoControls hiddenOnIdle">',e+='<div class="nowPlayingInfo hide">',e+='<div class="nowPlayingImage"></div>',e+='<div class="nowPlayingTabs"></div>',e+="</div>",e+='<div class="guide hide">',e+="</div>",e+='<div class="videoControlButtons">',e+='<button is="paper-icon-button-light" class="previousTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.previousTrack();"></iron-icon></button>',e+='<button is="paper-icon-button-light" id="video-playButton" class="mediaButton unpauseButton" onclick="MediaPlayer.unpause();"><iron-icon icon="play-arrow"></iron-icon></button>',e+='<button is="paper-icon-button-light" id="video-pauseButton" class="mediaButton pauseButton" onclick="MediaPlayer.pause();"><iron-icon icon="pause"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="nextTrackButton mediaButton videoTrackControl hide" onclick="MediaPlayer.nextTrack();"><iron-icon icon="skip-next"></iron-icon></button>',e+='<paper-slider pin step=".1" min="0" max="100" value="0" class="videoPositionSlider" style="display:inline-block;margin-right:2em;"></paper-slider>',e+='<div class="currentTime">--:--</div>',e+='<button is="paper-icon-button-light" class="muteButton mediaButton" onclick="MediaPlayer.mute();"><iron-icon icon="volume-up"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="unmuteButton mediaButton" onclick="MediaPlayer.unMute();"><iron-icon icon="volume-off"></iron-icon></button>',e+='<paper-slider pin step="1" min="0" max="100" value="0" class="videoVolumeSlider" style="width:100px;vertical-align:middle;margin-left:-1em;margin-right:2em;display:inline-block;"></paper-slider>',e+='<button is="paper-icon-button-light" class="mediaButton castButton" onclick="MediaController.showPlayerSelection(this, false);" style="height:32px;width:32px;"><iron-icon icon="cast"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton fullscreenButton" onclick="MediaPlayer.toggleFullscreen();" id="video-fullscreenButton"><iron-icon icon="fullscreen"></iron-icon></button>',e+='<button is="paper-icon-button-light" class="mediaButton infoButton" onclick="MediaPlayer.toggleInfo();"><iron-icon icon="info"></iron-icon></button>',e+="</div>",e+="</div>",e+="</div>";var t=document.createElement("div");t.innerHTML=e,document.body.appendChild(t)}function u(){if(!V){V=!0,d();var e=n("#videoPlayer");R=n(".muteButton",e),q=n(".unmuteButton",e),N=n(".currentTime",e),A=n(".videoPositionSlider",e).on("change",r)[0],A._setPinValue=function(e){var n=a();if(!i.currentMediaSource||!n)return void(this.pinValue="--:--");var o=n;o/=100,o*=e,this.pinValue=t.getDisplayRunningTime(o)},O=n(".videoVolumeSlider",e).on("change",function(){var e=this.value;m(e),i.setVolume(e)})[0]}}function c(){z&&window.clearTimeout(z),1==F&&(n(".hiddenOnIdle").removeClass("inactive"),n("#videoPlayer").removeClass("idlePlayer")),F=!1,z=window.setTimeout(function(){F=!0,n(".hiddenOnIdle").addClass("inactive"),n("#videoPlayer").addClass("idlePlayer")},3500)}function m(e){e?(R.show(),q.hide()):(R.hide(),q.show())}function v(e){var t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t?t.call(e):g()}function g(){var e=n("#videoPlayer");e.addClass("fullscreenVideo")}function p(){var e=n("#videoPlayer");e.removeClass("fullscreenVideo")}function f(){i.stop()}function h(){i.isFullScreen()?(g(),F=!0):p()}function y(e){(e.clientX!=D.x||e.clientY!=D.y)&&(D.x=e.clientX,D.y=e.clientY,c())}function b(e){Events.on(e,"playing",T),Events.on(e,"playing",P),Events.on(e,"volumechange",w),Events.on(e,"pause",k),Events.on(e,"timeupdate",B),Events.on(e,"error",x),Events.on(e,"click",M),Events.on(e,"dblclick",E);var t=!0;if(t){var i=document.querySelector(".itemVideo");i&&(i.addEventListener("keydown",c),i.addEventListener("scroll",c),i.addEventListener("mousedown",c),c())}n(document).on("webkitfullscreenchange",h),n(document).on("mozfullscreenchange",h),n(document).on("msfullscreenchange",h),n(document).on("fullscreenchange",h),n(window).one("popstate",f),t&&n(document.body).on("mousemove",y)}function S(e){Events.off(e,"playing",T),Events.off(e,"playing",P),Events.off(e,"volumechange",w),Events.off(e,"pause",k),Events.off(e,"timeupdate",B),Events.off(e,"error",x),Events.off(e,"click",M),Events.off(e,"dblclick",E),n(document).off("webkitfullscreenchange",h),n(document).off("mozfullscreenchange",h),n(document).off("msfullscreenchange",h),n(document).off("fullscreenchange",h),n(window).off("popstate",f),n(document.body).off("mousemove",y);var t=document.querySelector(".itemVideo");t&&(t.removeEventListener("keydown",c),t.removeEventListener("scroll",c),t.removeEventListener("mousedown",c))}function I(e){if(!e.classList.contains("hide")){var t=function(){e.classList.add("hide")};t()}}function C(e){e.classList.contains("hide")&&(e.classList.remove("hide"),browserInfo.animate&&!browserInfo.mobile&&requestAnimationFrame(function(){var t=[{transform:"scale3d(.2, .2, .2)  ",opacity:".6",offset:0},{transform:"none",opacity:"1",offset:1}],n={duration:200,iterations:1,easing:"ease-out"};e.animate(t,n)}))}function T(){Events.off(this,"playing",T),Events.on(this,"ended",i.onPlaybackStopped),Events.on(this,"ended",i.playNextAfterEnded),i.onPlaybackStart(this,i.currentItem,i.currentMediaSource)}function P(){var e=document.querySelector("#videoPlayer .videoControls"),t=document.querySelector("#videoPlayer #videoElement");n("#video-playButton",e).hide(),n("#video-pauseButton",e).show(),n("#play",t).show().addClass("fadeOut"),setTimeout(function(){n("#play",t).hide().removeClass("fadeOut")},300)}function w(){m(this.volume())}function k(){var e=document.querySelector("#videoPlayer .videoControls"),t=document.querySelector("#videoPlayer #videoElement");n("#video-playButton",e).show(),n("#video-pauseButton",e).hide(),n("#pause",t).show().addClass("fadeOut"),setTimeout(function(){n("#pause",t).hide().removeClass("fadeOut")},300)}function B(){A.dragging||i.setCurrentTime(i.getCurrentTicks(this),A,N)}function x(){var e=Globalize.translate("MessageErrorPlayingVideo"),t=i.currentItem;t&&"TvChannel"==t.Type&&(e+="<p>",e+=Globalize.translate("MessageEnsureOpenTuner"),e+="</p>"),Dashboard.alert({title:Globalize.translate("HeaderVideoError"),message:e});var n=i.currentMediaRenderer;n&&i.onPlaybackStopped.call(n),i.nextTrack()}function M(){browserInfo.mobile||(this.paused()?i.unpause():i.pause())}function E(){browserInfo.mobile||i.toggleFullscreen()}var L,A,N,F=!0,R=null,q=null,O=null;i.currentSubtitleStreamIndex=null,i.getCurrentSubtitleStream=function(){return i.getSubtitleStream(i.currentSubtitleStreamIndex)},i.getSubtitleStream=function(e){return i.currentMediaSource.MediaStreams.filter(function(t){return"Subtitle"==t.Type&&t.Index==e})[0]},i.toggleFullscreen=function(){i.isFullScreen()?i.exitFullScreen():v(document.body)},i.resetEnhancements=function(){V&&(i.isFullScreen()&&i.exitFullScreen(),I(document.querySelector("#videoPlayer")),n("#videoPlayer").removeClass("fullscreenVideo").removeClass("idlePlayer"),n(".hiddenOnIdle").removeClass("inactive"),n("video").remove(),document.querySelector(".mediaButton.infoButton").classList.remove("active"),document.querySelector(".videoControls .nowPlayingInfo").classList.add("hide"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"))},i.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),n("#videoPlayer").removeClass("fullscreenVideo")},i.isFullScreen=function(){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1},i.showSubtitleMenu=function(){var e=i.currentMediaSource.MediaStreams.filter(function(e){return"Subtitle"==e.Type}),t=i.currentSubtitleStreamIndex;null==t&&(t=-1),e.unshift({Index:-1,Language:Globalize.translate("ButtonOff")});var o=e.map(function(e){var n=[];n.push(e.Language||Globalize.translate("LabelUnknownLanguage")),e.Codec&&n.push(e.Codec);var i=n.join(" - ");e.IsDefault&&(i+=" (D)"),e.IsForced&&(i+=" (F)"),e.External&&(i+=" (EXT)");var o={name:i,id:e.Index};return e.Index==t&&(o.selected=!0),o});require(["actionsheet"],function(e){e.show({items:o,enableHistory:!1,positionTo:n(".videoSubtitleButton")[0],callback:function(e){var n=parseInt(e);n!=t&&i.onSubtitleOptionSelected(n)}})})},i.showQualityFlyout=function(){require(["qualityoptions","actionsheet"],function(t,o){var a=i.getCurrentSrc(i.currentMediaRenderer).toLowerCase(),r=-1!=a.indexOf("static=true"),l=i.currentMediaSource.MediaStreams.filter(function(e){return"Video"==e.Type})[0],s=l?l.Width:null,d=t.getVideoQualityOptions(e.maxStreamingBitrate(),s);r&&(d[0].name="Direct");var u=d.map(function(e){var t={name:e.name,id:e.bitrate};return e.selected&&(t.selected=!0),t}),c=d.filter(function(e){return e.selected});c=c.length?c[0].bitrate:null,o.show({items:u,enableHistory:!1,positionTo:n(".videoQualityButton")[0],callback:function(e){var t=parseInt(e);t!=c&&i.onQualityOptionSelected(t)}})})},i.showAudioTracksFlyout=function(){var e=i.currentMediaSource.MediaStreams.filter(function(e){return"Audio"==e.Type}),t=getParameterByName("AudioStreamIndex",i.getCurrentSrc(i.currentMediaRenderer)),o=e.map(function(e){var n=[];n.push(e.Language||Globalize.translate("LabelUnknownLanguage")),e.Codec&&n.push(e.Codec),e.Profile&&n.push(e.Profile),e.BitRate&&n.push(Math.floor(e.BitRate/1e3)+" kbps"),e.Channels&&n.push(e.Channels+" ch");var i=n.join(" - ");e.IsDefault&&(i+=" (D)");var o={name:i,id:e.Index};return e.Index==t&&(o.selected=!0),o});require(["actionsheet"],function(e){e.show({items:o,enableHistory:!1,positionTo:n(".videoAudioButton")[0],callback:function(e){var n=parseInt(e);n!=t&&i.onAudioOptionSelected(n)}})})},i.setAudioStreamIndex=function(e){i.changeStream(i.getCurrentTicks(),{AudioStreamIndex:e})},i.setSubtitleStreamIndex=function(e){if(!i.currentMediaRenderer.supportsTextTracks())return i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:e}),void(i.currentSubtitleStreamIndex=e);var t=i.getCurrentSubtitleStream(),n=i.getSubtitleStream(e);if(t||n){var o=-1;t&&!n?"External"!=t.DeliveryMethod&&i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:-1}):!t&&n?"External"==n.DeliveryMethod?o=e:i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:e}):t&&n&&("External"==n.DeliveryMethod?(o=e,"External"!=t.DeliveryMethod&&i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:-1})):i.changeStream(i.getCurrentTicks(),{SubtitleStreamIndex:e})),i.setCurrentTrackElement(o),i.currentSubtitleStreamIndex=e}},i.setCurrentTrackElement=function(e){i.currentMediaRenderer.setCurrentTrackElement(e)},i.updateTextStreamUrls=function(e){i.currentMediaRenderer.updateTextStreamUrls(e)},i.updateNowPlayingInfo=function(e){if(!e)throw new Error("item cannot be null");var t=n("#videoPlayer"),a=i.getPlayerStateInternal(i.currentMediaRenderer,e.CurrentProgram||e,i.currentMediaSource),r="",l=400,s=300;a.NowPlayingItem.PrimaryImageTag?r=ApiClient.getScaledImageUrl(a.NowPlayingItem.PrimaryImageItemId,{type:"Primary",width:l,tag:a.NowPlayingItem.PrimaryImageTag}):a.NowPlayingItem.PrimaryImageTag?r=ApiClient.getScaledImageUrl(a.NowPlayingItem.PrimaryImageItemId,{type:"Primary",width:l,tag:a.NowPlayingItem.PrimaryImageTag}):a.NowPlayingItem.BackdropImageTag?r=ApiClient.getScaledImageUrl(a.NowPlayingItem.BackdropItemId,{type:"Backdrop",height:s,tag:a.NowPlayingItem.BackdropImageTag,index:0}):a.NowPlayingItem.ThumbImageTag&&(r=ApiClient.getScaledImageUrl(a.NowPlayingItem.ThumbImageItemId,{type:"Thumb",height:s,tag:a.NowPlayingItem.ThumbImageTag})),n(".nowPlayingImage",t).html(r?'<img src="'+r+'" />':""),a.NowPlayingItem.LogoItemId?(r=ApiClient.getScaledImageUrl(a.NowPlayingItem.LogoItemId,{type:"Logo",height:42,tag:a.NowPlayingItem.LogoImageTag}),n(".videoTopControlsLogo",t).html('<img src="'+r+'" />')):n(".videoTopControlsLogo",t).html("");var d=n(".nowPlayingTabs",t).html(o(e.CurrentProgram||e)).lazyChildren();n(".nowPlayingTabButton",d).on("click",function(){n(this).hasClass("selectedNowPlayingTabButton")||(n(".selectedNowPlayingTabButton").removeClass("selectedNowPlayingTabButton"),n(this).addClass("selectedNowPlayingTabButton"),n(".nowPlayingTab").hide(),n("."+this.getAttribute("data-tab")).show().trigger("scroll"))}),n(".chapterCard",d).on("click",function(){i.seek(parseInt(this.getAttribute("data-position")))})},n.fn.lazyChildren=function(){for(var e=0,t=this.length;t>e;e++)ImageLoader.lazyChildren(this[e]);return this},i.onAudioOptionSelected=function(e){i.setAudioStreamIndex(e)},i.onSubtitleOptionSelected=function(e){i.setSubtitleStreamIndex(e)},i.onQualityOptionSelected=function(t){e.maxStreamingBitrate(t),e.enableAutomaticBitrateDetection(!1),i.changeStream(i.getCurrentTicks(),{Bitrate:t})},i.toggleInfo=function(){var e=document.querySelector(".mediaButton.infoButton"),t=document.querySelector(".videoControls .nowPlayingInfo");e.classList.contains("active")?(e.classList.remove("active"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"),s(t)):(e.classList.add("active"),document.querySelector(".videoControls").classList.remove("hiddenOnIdle"),t.classList.remove("hide"),l(t))},i.toggleGuide=function(){var e=document.querySelector(".mediaButton.guideButton"),t=document.querySelector(".videoControls .guide");e.classList.contains("active")?(e.classList.remove("active"),document.querySelector(".videoControls").classList.add("hiddenOnIdle"),s(t)):(e.classList.add("active"),document.querySelector(".videoControls").classList.remove("hiddenOnIdle"),t.classList.remove("hide"),l(t),i.guideInstance||require(["tvguide"],function(e){i.guideInstance=new e({element:t,enablePaging:!1})}))};var V,z,D={};i.cleanup=function(e){N&&N.html("--:--"),S(e)},i.playVideo=function(e,t,n,o){requirejs(["videorenderer","css!css/nowplayingbar.css","css!css/mediaplayer-video.css","paper-slider"],function(){u(),i.createStreamInfo("Video",e,t,n).then(function(a){var r=-1!=a.url.toLowerCase().indexOf(".m3u8");if(!t.RunTimeTicks&&r){Dashboard.showLoadingMsg();var l=a.url.replace("master.m3u8","live.m3u8");ApiClient.ajax({type:"GET",url:l}).then(function(){Dashboard.hideLoadingMsg(),a.url=l,setTimeout(function(){i.playVideoInternal(e,t,n,a,o)},2e3)},function(){Dashboard.hideLoadingMsg()})}else i.playVideoInternal(e,t,n,a,o)})})},i.playVideoInternal=function(e,t,o,a,r){i.startTimeTicksOffset=a.startTimeTicksOffset;var l=t.MediaStreams||[],s=l.filter(function(e){return"Subtitle"==e.Type}),d=document.querySelector("#videoPlayer");C(d);var u=n(".videoControls",d);n("#video-playButton",u).hide(),n("#video-pauseButton",u).show(),n(".videoTrackControl").addClass("hide");n("#videoElement",d);n(".videoQualityButton",u).show(),l.filter(function(e){return"Audio"==e.Type}).length?n(".videoAudioButton").show():n(".videoAudioButton").hide(),s.length?n(".videoSubtitleButton").show():n(".videoSubtitleButton").hide();var c=new VideoRenderer({poster:i.getPosterUrl(e)}),v=!c.enableCustomVideoControls();v||AppInfo.isNativeApp?n("#video-fullscreenButton",u).hide():n("#video-fullscreenButton",u).show(),AppInfo.hasPhysicalVolumeButtons?(n(O).addClass("hide"),n(".muteButton",u).addClass("hide"),n(".unmuteButton",u).addClass("hide")):(n(O).removeClass("hide"),n(".muteButton",u).removeClass("hide"),n(".unmuteButton",u).removeClass("hide")),v?u.addClass("hide"):u.removeClass("hide"),L=i.getSavedVolume(),c.volume(L),O.value=100*L,m(L),b(c),i.currentSubtitleStreamIndex=t.DefaultSubtitleStreamIndex,n(document.body).addClass("bodyWithPopupOpen"),i.currentMediaRenderer=c,i.currentDurationTicks=i.currentMediaSource.RunTimeTicks,i.updateNowPlayingInfo(e),c.init().then(function(){i.onBeforePlaybackStart(c,e,t),i.setSrcIntoRenderer(c,a,e,i.currentMediaSource),i.streamInfo=a,r&&r()})},i.updatePlaylistUi=function(){if(V){var e=i.currentPlaylistIndex(null),t=i.playlist.length,o=!1;if(i.currentMediaRenderer&&i.currentMediaRenderer.enableCustomVideoControls&&(o=i.currentMediaRenderer.enableCustomVideoControls()),2>t)return void n(".videoTrackControl").addClass("hide");var a=o?".videoAdvancedControls":".videoControls";a=document.querySelector(a);var r=a.getElementsByClassName("previousTrackButton")[0],l=a.getElementsByClassName("nextTrackButton")[0];0===e?r.setAttribute("disabled","disabled"):r.removeAttribute("disabled"),e+1>=t?l.setAttribute("disabled","disabled"):l.removeAttribute("disabled"),n(r).removeClass("hide"),n(l).removeClass("hide")}}}i(MediaPlayer)});