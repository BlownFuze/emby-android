define(["datetime","cardBuilder","emby-itemscontainer","scrollStyles"],function(e,t){function r(){Dashboard.showLoadingMsg();var e={Limit:40,Fields:"AirTime,UserData",UserId:Dashboard.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",EnableTotalRecordCount:!1};return ApiClient.getJSON(ApiClient.getUrl("Shows/Upcoming",e))}function a(e,t){t.then(function(t){var r=t.Items;e.querySelector(".noItemsMessage").style.display=r.length?"none":"block";var a=e.querySelector("#upcomingItems");o(a,r),Dashboard.hideLoadingMsg()})}function n(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function i(){return n()?"overflowBackdrop":"backdrop"}function o(r,a){var o,s,l=[],c="",d=[];for(o=0,s=a.length;s>o;o++){var m=a[o],h="";if(m.PremiereDate)try{var u=e.parseISO8601Date(m.PremiereDate,!0);h=u.getDate()==(new Date).getDate()-1?Globalize.translate("Yesterday"):LibraryBrowser.getFutureDateText(u,!0)}catch(g){}h!=c?(d.length&&l.push({name:c,items:d}),c=h,d=[m]):d.push(m)}var p="";for(o=0,s=l.length;s>o;o++){var b=l[o];p+='<div class="homePageSection">',p+='<h1 class="listHeader">'+b.name+"</h1>",p+=n()?'<div is="emby-itemscontainer" class="itemsContainer hiddenScrollX">':'<div is="emby-itemscontainer" class="itemsContainer vertical-wrap">',p+=t.getCardsHtml({items:b.items,showLocationTypeIndicator:!1,shape:i(),showTitle:!0,preferThumb:!0,lazy:!0,showDetailsMenu:!0,centerText:!0,context:"home-upcoming",overlayMoreButton:!0,showParentTitle:!0}),p+="</div>",p+="</div>"}r.innerHTML=p,ImageLoader.lazyChildren(r)}return function(e){var t,n=this;n.preRender=function(){t=r()},n.renderTab=function(){Dashboard.showLoadingMsg(),a(e,t)}}});