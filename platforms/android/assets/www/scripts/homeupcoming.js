define(["jQuery"],function(){function e(e){Dashboard.showLoadingMsg();var t=AppInfo.hasLowImageBandwidth&&!r()?24:40,a={Limit:t,Fields:"AirTime,UserData,SeriesStudio,SyncInfo",UserId:Dashboard.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};ApiClient.getJSON(ApiClient.getUrl("Shows/Upcoming",a)).then(function(r){var t=r.Items;e.querySelector(".noItemsMessage").style.display=t.length?"none":"block";var a=e.querySelector("#upcomingItems");o(a,t),Dashboard.hideLoadingMsg(),LibraryBrowser.setLastRefreshed(e)})}function r(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function t(){return r()?"overflowBackdrop":"backdrop"}function o(e,o){var a,n,i=[],s="",d=[];for(a=0,n=o.length;n>a;a++){var l=o[a],m="";if(l.PremiereDate)try{m=LibraryBrowser.getFutureDateText(parseISO8601Date(l.PremiereDate,{toLocal:!0}),!0)}catch(c){}m!=s?(d.length&&i.push({name:s,items:d}),s=m,d=[l]):d.push(l)}var h="";for(a=0,n=i.length;n>a;a++){var u=i[a];h+='<div class="homePageSection">',h+='<h1 class="listHeader">'+u.name+"</h1>",h+=r()?'<div class="itemsContainer hiddenScrollX">':'<div class="itemsContainer">',h+=LibraryBrowser.getPosterViewHtml({items:u.items,showLocationTypeIndicator:!1,shape:t(),showTitle:!0,showPremiereDate:!0,preferThumb:!0,lazy:!0,showDetailsMenu:!0,centerText:!0,context:"home-upcoming",overlayMoreButton:!0}),h+="</div>",h+="</div>"}e.innerHTML=h,ImageLoader.lazyChildren(e)}window.HomePage.renderUpcoming=function(r,t){LibraryBrowser.needsRefresh(t)&&e(t)}});