define(["datetime","emby-itemscontainer","scrollStyles"],function(e){function t(){Dashboard.showLoadingMsg();var e={Limit:40,Fields:"AirTime,UserData,SyncInfo",UserId:Dashboard.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",EnableTotalRecordCount:!1};return ApiClient.getJSON(ApiClient.getUrl("Shows/Upcoming",e))}function r(e,t){t.then(function(t){var r=t.Items;e.querySelector(".noItemsMessage").style.display=r.length?"none":"block";var n=e.querySelector("#upcomingItems");i(n,r),Dashboard.hideLoadingMsg()})}function n(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function a(){return n()?"overflowBackdrop":"backdrop"}function i(t,r){var i,o,s=[],l="",c=[];for(i=0,o=r.length;o>i;i++){var m=r[i],d="";if(m.PremiereDate)try{var h=e.parseISO8601Date(m.PremiereDate,!0);d=h.getDate()==(new Date).getDate()-1?Globalize.translate("Yesterday"):LibraryBrowser.getFutureDateText(h,!0)}catch(u){}d!=l?(c.length&&s.push({name:l,items:c}),l=d,c=[m]):c.push(m)}var g="";for(i=0,o=s.length;o>i;i++){var p=s[i];g+='<div class="homePageSection">',g+='<h1 class="listHeader">'+p.name+"</h1>",g+=n()?'<div is="emby-itemscontainer" class="itemsContainer hiddenScrollX">':'<div is="emby-itemscontainer" class="itemsContainer">',g+=LibraryBrowser.getPosterViewHtml({items:p.items,showLocationTypeIndicator:!1,shape:a(),showTitle:!0,preferThumb:!0,lazy:!0,showDetailsMenu:!0,centerText:!0,context:"home-upcoming",overlayMoreButton:!0}),g+="</div>",g+="</div>"}t.innerHTML=g,ImageLoader.lazyChildren(t)}return function(e){var n,a=this;a.preRender=function(){n=t()},a.renderTab=function(){Dashboard.showLoadingMsg(),r(e,n)}}});