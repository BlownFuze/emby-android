var SupporterKeyPage={onPageShow:function(){SupporterKeyPage.load(this)},load:function(e){Dashboard.showLoadingMsg(),ApiClient.getPluginSecurityInfo().then(function(a){$("#txtSupporterKey",e).val(a.SupporterKey),a.SupporterKey&&!a.IsMBSupporter?(e.querySelector("#txtSupporterKey").classList.add("invalidEntry"),$(".notSupporter",e).show()):(e.querySelector("#txtSupporterKey").classList.remove("invalidEntry"),$(".notSupporter",e).hide()),Dashboard.hideLoadingMsg()})},updateSupporterKey:function(){Dashboard.showLoadingMsg();var e=this,a=$("#txtSupporterKey",e).val(),r={SupporterKey:a};return ApiClient.updatePluginSecurityInfo(r).then(function(){Dashboard.resetPluginSecurityInfo(),Dashboard.hideLoadingMsg(),Dashboard.alert(a?{message:Globalize.translate("MessageKeyUpdated"),title:Globalize.translate("HeaderConfirmation")}:{message:Globalize.translate("MessageKeyRemoved"),title:Globalize.translate("HeaderConfirmation")});var r=$(e).parents(".page")[0];SupporterKeyPage.load(r)}),!1},linkSupporterKeys:function(){Dashboard.showLoadingMsg();var e=this,a=$("#txtNewEmail",e).val(),r=$("#txtNewKey",e).val(),t=$("#txtOldKey",e).val(),o={email:a,newkey:r,oldkey:t},s="https://mb3admin.com/admin/service/supporter/linkKeys";return $.post(s,o).then(function(e){var a=JSON.parse(e);Dashboard.hideLoadingMsg(),Dashboard.alert(a.Success?Globalize.translate("MessageKeysLinked"):a.ErrorMessage)}),!1},retrieveSupporterKey:function(){Dashboard.showLoadingMsg();var e=this,a=$("#txtEmail",e).val(),r="https://mb3admin.com/admin/service/supporter/retrievekey?email="+a;return $.post(r).then(function(e){var r=JSON.parse(e);Dashboard.hideLoadingMsg(),Dashboard.alert(r.Success?Globalize.translate("MessageKeyEmailedTo").replace("{0}",a):r.ErrorMessage)}),!1}};$(document).on("pageshow","#supporterKeyPage",SupporterKeyPage.onPageShow);