define(["jQuery"],function(t){function e(){Dashboard.showLoadingMsg();var e=this;return ApiClient.getServerConfiguration().then(function(r){r.HttpServerPortNumber=t("#txtPortNumber",e).val(),r.PublicPort=t("#txtPublicPort",e).val(),r.PublicHttpsPort=t("#txtPublicHttpsPort",e).val(),r.EnableHttps=t("#chkEnableHttps",e).checked(),r.HttpsPortNumber=t("#txtHttpsPort",e).val(),r.EnableUPnP=t("#chkEnableUpnp",e).checked(),r.WanDdns=t("#txtDdns",e).val(),r.CertificatePath=t("#txtCertificatePath",e).val(),ApiClient.updateServerConfiguration(r).then(Dashboard.processServerConfigurationUpdateResult)}),!1}function r(){return[{href:"dashboardhosting.html",name:Globalize.translate("TabHosting")},{href:"serversecurity.html",name:Globalize.translate("TabSecurity")}]}return function(a){function n(e,r){t("#txtPortNumber",e).val(r.HttpServerPortNumber),t("#txtPublicPort",e).val(r.PublicPort),t("#txtPublicHttpsPort",e).val(r.PublicHttpsPort);var a=e.querySelector("#chkEnableHttps");a.checked=r.EnableHttps,t("#txtHttpsPort",e).val(r.HttpsPortNumber),t("#txtDdns",e).val(r.WanDdns||"");var n=e.querySelector("#txtCertificatePath");n.value=r.CertificatePath||"",t("#chkEnableUpnp",e).checked(r.EnableUPnP),i.call(n),Dashboard.hideLoadingMsg()}function i(){this.value?a.querySelector("#txtDdns").setAttribute("required","required"):a.querySelector("#txtDdns").removeAttribute("required")}t("#btnSelectCertPath",a).on("click.selectDirectory",function(){require(["directorybrowser"],function(e){var r=new e;r.show({includeFiles:!0,includeDirectories:!0,callback:function(e){e&&t("#txtCertificatePath",a).val(e),r.close()},header:Globalize.translate("HeaderSelectCertificatePath")})})}),t(".dashboardHostingForm").off("submit",e).on("submit",e),a.querySelector("#txtCertificatePath").addEventListener("change",i),a.addEventListener("viewshow",function(){LibraryMenu.setTabs("adminadvanced",0,r),Dashboard.showLoadingMsg(),ApiClient.getServerConfiguration().then(function(t){n(a,t)})})}});