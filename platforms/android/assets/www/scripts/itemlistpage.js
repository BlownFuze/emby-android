!function(e){function t(e){var t=i(e),a=m[t];return a||(a=m[t]={query:{SortBy:"SortName",SortOrder:"Ascending",Fields:"DateCreated,PrimaryImageAspectRatio,MediaSourceCount,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()}},a.query.Filters="",a.query.NameStartsWithOrGreater="",a.view=LibraryBrowser.getSavedView(t)||LibraryBrowser.getDefaultItemsView("Poster","Poster"),a.query.ParentId=r(e,"parentId"),LibraryBrowser.loadSavedQueryValues(t,a.query)),a}function r(e,t){return e.pageParams||(e.pageParams={}),e.pageParams[t]||(e.pageParams[t]=getParameterByName(t)),e.pageParams[t]}function a(e){return t(e).query}function i(e){return e.savedQueryKey||(e.savedQueryKey=LibraryBrowser.getSavedQueryKey("items")),e.savedQueryKey}function n(l){Dashboard.showLoadingMsg();var m=a(l),d=Dashboard.getCurrentUserId(),c=m.ParentId?ApiClient.getItem(d,m.ParentId):ApiClient.getRootFolder(d),y=ApiClient.getItems(d,m);Promise.all([c,y]).then(function(a){var d=a[0];u=d;var c=a[1];window.scrollTo(0,0);var y=t(l).view,g="",b=LibraryBrowser.getQueryPagingHtml({startIndex:m.StartIndex,limit:m.Limit,totalRecordCount:c.TotalRecordCount,showLimit:!1,addLayoutButton:!0,currentLayout:y,sortButton:!0,layouts:"Poster,PosterCard,Thumb",filterButton:!0});l.querySelector(".listTopPaging").innerHTML=b,s(l);var p=r(l,"context"),h={items:c.Items,shape:"auto",centerText:!0,lazy:!0,coverImage:"PhotoAlbum"==d.Type};"Backdrop"==y?(h.shape="backdrop",h.showTitle=!0,h.preferBackdrop=!0,g=LibraryBrowser.getPosterViewHtml(h)):"Poster"==y?(h.showTitle="photos"==p?"auto":!0,h.overlayText="photos"==p,g=LibraryBrowser.getPosterViewHtml(h)):"PosterCard"==y?(h.showTitle=!0,h.showYear=!0,h.cardLayout=!0,h.centerText=!1,g=LibraryBrowser.getPosterViewHtml(h)):"Thumb"==y&&(h.preferThumb=!0,h.shape="backdrop",g=LibraryBrowser.getPosterViewHtml(h));var P=l.querySelector("#items");P.innerHTML=g+b,ImageLoader.lazyChildren(P),e(".btnFilter",l).on("click",function(){o(l)}),e(".btnNextPage",l).on("click",function(){m.StartIndex+=m.Limit,n(l)}),e(".btnPreviousPage",l).on("click",function(){m.StartIndex-=m.Limit,n(l)}),e(".btnChangeLayout",l).on("layoutchange",function(e,r){t(l).view=r,LibraryBrowser.saveViewSetting(i(l),r),n(l)}),e(".btnSort",l).on("click",function(){LibraryBrowser.showSortMenu({items:[{name:Globalize.translate("OptionNameSort"),id:"SortName"},{name:Globalize.translate("OptionCommunityRating"),id:"CommunityRating,SortName"},{name:Globalize.translate("OptionCriticRating"),id:"CriticRating,SortName"},{name:Globalize.translate("OptionDateAdded"),id:"DateCreated,SortName"},{name:Globalize.translate("OptionDatePlayed"),id:"DatePlayed,SortName"},{name:Globalize.translate("OptionParentalRating"),id:"OfficialRating,SortName"},{name:Globalize.translate("OptionPlayCount"),id:"PlayCount,SortName"},{name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate,SortName"},{name:Globalize.translate("OptionRuntime"),id:"Runtime,SortName"}],callback:function(){n(l)},query:m})}),LibraryBrowser.saveQueryValues(r(l,"parentId"),m);var f=d.Name;null!=d.IndexNumber&&(f=d.IndexNumber+" - "+f),null!=d.ParentIndexNumber&&(f=d.ParentIndexNumber+"."+f),LibraryMenu.setTitle(f),l.dispatchEvent(new CustomEvent("displayingitem",{detail:{item:d},bubbles:!0})),LibraryBrowser.setLastRefreshed(l),Dashboard.hideLoadingMsg()})}function o(e){require(["components/filterdialog/filterdialog"],function(t){var r=new t({query:a(e)});Events.on(r,"filterchange",function(){n(e)}),r.show()})}function s(t){var r=a(t);e(".alphabetPicker",t).alphaValue(r.NameStartsWithOrGreater)}function l(){var t=e(this).parents(".page")[0],r=a(t),i=LibraryBrowser.getListItemInfo(this);return"Photo"==i.mediaType?(require(["scripts/photos"],function(){Photos.startSlideshow(t,r,i.id)}),!1):void 0}var u,m={};pageIdOn("pageinit","itemListPage",function(){var t=this;e(".alphabetPicker",this).on("alphaselect",function(e,r){var i=a(t);i.NameStartsWithOrGreater=r,i.StartIndex=0,n(t)}).on("alphaclear",function(){var e=a(t);e.NameStartsWithOrGreater="",n(t)}),e(t).on("click",".mediaItem",l)}),pageIdOn("pagebeforeshow","itemListPage",function(){var e=this;n(e),s(e),LibraryMenu.setBackButtonVisible(r(e,"context"))}),pageIdOn("pagebeforehide","itemListPage",function(){u=null})}(jQuery,document);