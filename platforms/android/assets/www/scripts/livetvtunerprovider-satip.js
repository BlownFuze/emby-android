define(["jQuery"],function(){function e(e,t){e.querySelector(".txtDevicePath").value="",t&&ApiClient.getNamedConfiguration("livetv").then(function(r){var n=r.TunerHosts.filter(function(e){return e.Id==t})[0];e.querySelector(".txtDevicePath").value=n.Url||"",e.querySelector(".txtM3uUrl").value=n.M3UUrl||"",e.querySelector(".chkEnabled").checked=n.IsEnabled})}function t(e){Dashboard.showLoadingMsg();var t=getParameterByName("id");if(t)ApiClient.getNamedConfiguration("livetv").then(function(i){var o=i.TunerHosts.filter(function(e){return e.Id==t})[0];r(e,o),n(e,o)});else{var i={Type:"satip"};r(e,i),n(e,i)}}function r(e,t){t.Url=e.querySelector(".txtDevicePath").value,t.M3UUrl=e.querySelector(".txtM3uUrl").value,t.IsEnabled=e.querySelector(".chkEnabled").checked}function n(e,t){ApiClient.ajax({type:"POST",url:ApiClient.getUrl("LiveTv/TunerHosts"),data:JSON.stringify(t),contentType:"application/json"}).then(function(){Dashboard.processServerConfigurationUpdateResult(),Dashboard.navigate("livetvstatus.html")},function(){Dashboard.hideLoadingMsg(),Dashboard.alert({message:Globalize.translate("ErrorSavingTvProvider")})})}function i(e){ApiClient.getJSON(ApiClient.getUrl("LiveTv/TunerHosts/Satip/IniMappings")).then(function(t){var r=t.map(function(e){return'<option value="'+e.Value+'">'+e.Name+"</option>"}).join("");r='<option value="">'+Globalize.translate("OptionNone")+"</option>"+r,e.querySelector(".selectSourceA").innerHTML=r,e.querySelector(".selectSourceB").innerHTML=r,e.querySelector(".selectSourceC").innerHTML=r,e.querySelector(".selectSourceD").innerHTML=r})}return function(r,n){function o(e){var t=e.target,n=t.value;n?r.querySelector(".fldSourceB").classList.remove("hide"):r.querySelector(".fldSourceB").classList.add("hide"),"diseqc1"==n?(r.querySelector(".fldSourceC").classList.remove("hide"),r.querySelector(".fldSourceD").classList.remove("hide")):(r.querySelector(".fldSourceC").classList.add("hide"),r.querySelector(".fldSourceD").classList.add("hide"))}r.querySelector("form").addEventListener("submit",function(e){return t(r),e.preventDefault(),!1}),r.querySelector(".selectDiseqC").addEventListener("change",o),i(r),r.addEventListener("viewshow",function(){var t=n.id;e(r,t)})}});