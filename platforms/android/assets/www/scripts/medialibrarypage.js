!function(){function e(){Dashboard.alert({message:Globalize.translate("HeaderChangeFolderTypeHelp"),title:Globalize.translate("HeaderChangeFolderType")})}function a(e){require(["medialibrarycreator"],function(a){(new a).show({collectionTypeOptions:c(),refresh:s(e)}).then(function(a){a&&r(e)})})}function i(e,a){require(["medialibraryeditor"],function(i){(new i).show({refresh:s(e),library:a}).then(function(a){a&&r(e)})})}function t(e,a){var i=Globalize.translate("MessageAreYouSureYouWishToRemoveMediaFolder");a.Locations.length&&(i+="<br/><br/>"+Globalize.translate("MessageTheFollowingLocationWillBeRemovedFromLibrary")+"<br/><br/>",i+=a.Locations.join("<br/>")),Dashboard.confirm(i,Globalize.translate("HeaderRemoveMediaFolder"),function(i){if(i){var t=s(e);ApiClient.removeVirtualFolder(a.Name,t).then(function(){r(e)})}})}function o(e,a){require(["prompt"],function(i){i({title:Globalize.translate("LabelNewName"),callback:function(i){if(i&&i!=a.Name){var t=s(e);ApiClient.renameVirtualFolder(a.Name,i,t).then(function(){r(e)})}}})})}function n(a,n,r){var s=$(n).parents(".card")[0],l=parseInt(s.getAttribute("data-index")),c=r[l],d=[];d.push({name:Globalize.translate("ButtonChangeContentType"),id:"changetype",ironIcon:"videocam"}),d.push({name:Globalize.translate("ButtonManageFolders"),id:"edit",ironIcon:"folder-open"}),d.push({name:Globalize.translate("ButtonRemove"),id:"delete",ironIcon:"remove"}),d.push({name:Globalize.translate("ButtonRename"),id:"rename",ironIcon:"mode-edit"}),require(["actionsheet"],function(r){r.show({items:d,positionTo:n,callback:function(n){switch(n){case"changetype":e(a,c);break;case"edit":i(a,c);break;case"rename":o(a,c);break;case"delete":t(a,c)}}})})}function r(e){Dashboard.showLoadingMsg(),ApiClient.getVirtualFolders().then(function(a){l(e,a)})}function s(e){return $(e).is("#mediaLibraryPage")}function l(e,i){var t="";i.push({Name:Globalize.translate("ButtonAddMediaLibrary"),icon:"add-circle",Locations:[],showType:!1,showLocations:!1,showMenu:!1,showNameWithIcon:!0});for(var o=0,s=i.length;s>o;o++){var l=i[o];t+=u(e,l,o)}var c=e.querySelector("#divVirtualFolders");c.innerHTML=t,$(".btnCardMenu",c).on("click",function(){n(e,this,i)}),$(".addLibrary",c).on("click",function(){a(e)}),$(".editLibrary",c).on("click",function(){var a=$(this).parents(".card")[0],t=parseInt(a.getAttribute("data-index")),o=i[t];o.ItemId&&require(["components/imageeditor/imageeditor"],function(a){a.show(o.ItemId,{theme:"a"}).then(function(a){a&&r(e)})})}),Dashboard.hideLoadingMsg()}function c(){return[{name:"",value:""},{name:Globalize.translate("FolderTypeMovies"),value:"movies"},{name:Globalize.translate("FolderTypeMusic"),value:"music"},{name:Globalize.translate("FolderTypeTvShows"),value:"tvshows"},{name:Globalize.translate("FolderTypeBooks"),value:"books",message:Globalize.translate("MessageBookPluginRequired")},{name:Globalize.translate("FolderTypeGames"),value:"games",message:Globalize.translate("MessageGamePluginRequired")},{name:Globalize.translate("FolderTypeHomeVideos"),value:"homevideos"},{name:Globalize.translate("FolderTypeMusicVideos"),value:"musicvideos"},{name:Globalize.translate("FolderTypePhotos"),value:"photos"},{name:Globalize.translate("FolderTypeUnset"),value:"mixed",message:Globalize.translate("MessageUnsetContentHelp")}]}function d(e){switch(e){case"movies":return"local-movies";case"music":return"library-music";case"photos":return"photo";case"livetv":return"live-tv";case"tvshows":return"live-tv";case"games":return"folder";case"trailers":return"local-movies";case"homevideos":return"video-library";case"musicvideos":return"video-library";case"books":return"folder";case"channels":return"folder";case"playlists":return"folder";default:return"folder"}}function u(e,a,i){var t="",o="";e.classList.contains("wizardPage")&&(o+="min-width:33.3%;"),t+='<div class="card backdropCard" style="'+o+'" data-index="'+i+'">',t+='<div class="cardBox visualCardBox">',t+='<div class="cardScalable">',t+='<div class="cardPadder"></div>',t+='<div class="cardContent">';var n="";a.PrimaryImageItemId&&(n=ApiClient.getScaledImageUrl(a.PrimaryImageItemId,{type:"Primary"})),n?t+='<div class="cardImage editLibrary" style="cursor:pointer;background-image:url(\''+n+"');\"></div>":a.showNameWithIcon||(t+='<div class="cardImage editLibrary iconCardImage" style="cursor:pointer;">',t+='<iron-icon icon="'+(a.icon||d(a.CollectionType))+'"></iron-icon>',t+="</div>"),t+="</div>",t+="</div>",!n&&a.showNameWithIcon&&(t+='<div class="cardImage iconCardImage addLibrary" style="position:absolute;top:0;left:0;right:0;bottom:0;font-size:140%;cursor:pointer;">',t+="<div>",t+='<iron-icon icon="'+(a.icon||d(a.CollectionType))+'" style="width:45%;height:45%;color:#888;"></iron-icon>',a.showNameWithIcon&&(t+='<div style="margin:1.5em 0;position:width:100%;font-weight:500;color:#444;">',t+=a.Name,t+="</div>"),t+="</div>",t+="</div>"),t+='<div class="cardFooter">',a.showMenu!==!1&&(t+='<div class="cardText" style="text-align:right; float:right;padding-top:5px;">',t+='<paper-icon-button icon="'+AppInfo.moreIcon+'" class="btnCardMenu"></paper-icon-button>',t+="</div>"),t+="<div class='cardText'>",t+=a.showNameWithIcon?"&nbsp;":a.Name,t+="</div>";var r=c().filter(function(e){return e.value==a.CollectionType})[0];return r=r?r.name:Globalize.translate("FolderTypeUnset"),t+="<div class='cardText'>",t+=a.showType===!1?"&nbsp;":r,t+="</div>",a.showLocations===!1?(t+="<div class='cardText'>",t+="&nbsp;",t+="</div>"):a.Locations.length?1==a.Locations.length?(t+="<div class='cardText'>",t+=a.Locations[0],t+="</div>"):(t+="<div class='cardText'>",t+=Globalize.translate("NumLocationsValue",a.Locations.length),t+="</div>"):(t+="<div class='cardText' style='color:#cc3333;'>",t+=Globalize.translate("NumLocationsValue",a.Locations.length),t+="</div>"),t+="</div>",t+="</div>",t+="</div>"}pageClassOn("pageinit","mediaLibraryPage",function(){var e=this;$("#selectCollectionType",e).on("change",function(){var a=this.selectedIndex;if(-1!=a){var i=this.options[a].innerHTML.replace("*","").replace("&amp;","&"),t=this.value;$("#txtValue",e).val(i);var o=c().filter(function(e){return e.value==t})[0];$(".collectionTypeFieldDescription",e).html(o.message||"")}})}),pageClassOn("pageshow","mediaLibraryPage",function(){var e=this;r(e)})}();var WizardLibraryPage={next:function(){Dashboard.showLoadingMsg();var e=ApiClient;e.ajax({type:"POST",url:e.getUrl("System/Configuration/MetadataPlugins/Autoset")}).then(function(){Dashboard.hideLoadingMsg(),Dashboard.navigate("wizardsettings.html")})}};!function(e){pageIdOn("pageshow","mediaLibraryPage",function(){var a=this;e(".btnRefresh",a).taskButton({mode:"on",progressElem:a.querySelector(".refreshProgress"),taskKey:"RefreshLibrary"})}),pageIdOn("pagebeforehide","mediaLibraryPage",function(){var a=this;e(".btnRefresh",a).taskButton({mode:"off"})})}(jQuery,document,window);