!function(e,a,t,i){function r(){var e=getParameterByName("id");if(e)return ApiClient.getItem(Dashboard.getCurrentUserId(),e);var a=getParameterByName("genre");if(a)return ApiClient.getGenre(a,Dashboard.getCurrentUserId());if(a=getParameterByName("musicgenre"))return ApiClient.getMusicGenre(a,Dashboard.getCurrentUserId());if(a=getParameterByName("gamegenre"))return ApiClient.getGameGenre(a,Dashboard.getCurrentUserId());if(a=getParameterByName("musicartist"))return ApiClient.getArtist(a,Dashboard.getCurrentUserId());throw new Error("Invalid request")}function n(e){Dashboard.showLoadingMsg(),r().then(function(a){s(e,a),i.scrollTo(0,0)})}function s(a,i){ra=i;var r=m(i);u(a,i,r),t.renderName(i,e(".itemName",a),!1,r),t.renderParentName(i,e(".parentName",a),r),LibraryMenu.setTitle(i.SeriesName||i.Name),Dashboard.getCurrentUser().then(function(n){l(a,i,n),p(a,i,r,n),h(a,i,r);var s=!1;"MusicArtist"==i.Type||"MusicAlbum"==i.Type||"Playlist"==i.Type||"BoxSet"==i.Type||"Audio"==i.Type?(e("#itemBackdrop",a).addClass("noBackdrop").css("background-image","none"),Backdrops.setBackdrops(a,[i])):s=t.renderDetailPageBackdrop(a,i);var o=s&&a.classList.contains("noSecondaryNavPage");LibraryMenu.setTransparentMenu(o);var d=!1;if("Program"==i.Type){var c=new Date;c>=parseISO8601Date(i.StartDate,{toLocal:!0})&&c<parseISO8601Date(i.EndDate,{toLocal:!0})?(e(".btnPlay",a).removeClass("hide"),d=!0):e(".btnPlay",a).addClass("hide")}else MediaController.canPlay(i)?(e(".btnPlay",a).removeClass("hide"),d=!0):e(".btnPlay",a).addClass("hide");i.LocalTrailerCount&&"Full"==i.PlayAccess?e(".btnPlayTrailer",a).removeClass("hide"):e(".btnPlayTrailer",a).addClass("hide"),SyncManager.isAvailable(i,n)?e(".btnSync",a).removeClass("hide"):e(".btnSync",a).addClass("hide"),"Program"==i.Type&&i.TimerId?e(".btnCancelRecording",a).removeClass("hide"):e(".btnCancelRecording",a).addClass("hide"),"Program"!=i.Type||i.TimerId||i.SeriesTimerId?(e(".btnRecord",a).addClass("hide"),e(".btnFloatingRecord",a).addClass("hide")):d?(e(".btnRecord",a).removeClass("hide"),e(".btnFloatingRecord",a).addClass("hide")):(e(".btnRecord",a).addClass("hide"),e(".btnFloatingRecord",a).removeClass("hide")),!i.LocalTrailerCount&&i.RemoteTrailers.length&&"Full"==i.PlayAccess?e(".btnPlayExternalTrailer",a).removeClass("hide").attr("href",i.RemoteTrailers[0].Url):e(".btnPlayExternalTrailer",a).addClass("hide").attr("href","#");var m=(i.MediaSources||[]).filter(function(e){return"Grouping"==e.Type});if(n.Policy.IsAdministrator&&m.length?e(".splitVersionContainer",a).show():e(".splitVersionContainer",a).hide(),t.getMoreCommands(i,n).length>0?e(".btnMoreCommands",a).removeClass("hide"):e(".btnMoreCommands",a).addClass("hide"),n.Policy.IsAdministrator?e(".chapterSettingsButton",a).show():e(".chapterSettingsButton",a).hide(),LiveTvHelpers.renderOriginalAirDate(e(".airDate",a),i),"Person"==i.Type&&i.PremiereDate)try{var u=parseISO8601Date(i.PremiereDate,{toLocal:!0}).toDateString();e("#itemBirthday",a).show().html(Globalize.translate("BirthDateValue").replace("{0}",u))}catch(g){e("#itemBirthday",a).hide()}else e("#itemBirthday",a).hide();if("Person"==i.Type&&i.EndDate)try{var v=parseISO8601Date(i.EndDate,{toLocal:!0}).toDateString();e("#itemDeathDate",a).show().html(Globalize.translate("DeathDateValue").replace("{0}",v))}catch(g){e("#itemBirthday",a).hide()}if("Person"==i.Type&&i.ProductionLocations&&i.ProductionLocations.length){var y='<a class="textlink" target="_blank" href="https://maps.google.com/maps?q='+i.ProductionLocations[0]+'">'+i.ProductionLocations[0]+"</a>";e("#itemBirthLocation",a).show().html(Globalize.translate("BirthPlaceValue").replace("{0}",y)).trigger("create")}else e("#itemBirthLocation",a).hide()}),"Offline"==i.LocationType?e(".offlineIndicator",a).show():e(".offlineIndicator",a).hide();var n=!1;if("Virtual"==i.LocationType&&"Episode"==i.Type)try{i.PremiereDate&&(new Date).getTime()>=parseISO8601Date(i.PremiereDate,{toLocal:!0}).getTime()&&(n=!0)}catch(s){}n?e(".missingIndicator",a).show():e(".missingIndicator",a).hide(),c(a,i),e(a).trigger("displayingitem",[{item:i,context:r}]),Dashboard.hideLoadingMsg()}function l(e,a,i){t.renderDetailImage(e.querySelector(".detailImageContainer"),a,i.Policy.IsAdministrator&&"Photo"!=a.MediaType)}function o(e,a){t.refreshDetailImageUserData(e.querySelector(".detailImageContainer"),a)}function d(a,t){var i=t,r=e(e.mobile.activePage)[0];if("UserDataChanged"===i.MessageType&&ra&&i.Data.UserId==Dashboard.getCurrentUserId()){var n=ra.UserData.Key,s=i.Data.UserDataList.filter(function(e){return e.Key==n})[0];s&&(ra.UserData=s,Dashboard.getCurrentUser().then(function(e){o(r,ra,e)}))}}function c(a,t){e("#peopleHeader",a).html("Audio"==t.Type||"MusicAlbum"==t.Type||"Book"==t.MediaType||"Photo"==t.MediaType?Globalize.translate("HeaderPeople"):Globalize.translate("HeaderCastAndCrew"))}function m(){return getParameterByName("context")}function u(a,t,i){e(".itemTabs",a).hide(),"tv"==i?(e(a).removeClass("noSecondaryNavPage"),e("#tvShowsTabs",a).show(),LibraryMenu.setMenuButtonVisible(!0)):(e(a).addClass("noSecondaryNavPage"),LibraryMenu.setBackButtonVisible(!0),LibraryMenu.setMenuButtonVisible(!1))}function p(a,t,i,r){e(".collectionItems",a).empty(),"TvChannel"==t.Type?(e("#childrenCollapsible",a).removeClass("hide"),G(a,t,r)):"Playlist"==t.Type?(e("#childrenCollapsible",a).removeClass("hide"),z(a,t,r)):"Studio"==t.Type||"Person"==t.Type||"Genre"==t.Type||"MusicGenre"==t.Type||"GameGenre"==t.Type||"MusicArtist"==t.Type?(e("#childrenCollapsible",a).removeClass("hide"),L(a,t,r)):t.IsFolder?("BoxSet"==t.Type?e("#childrenCollapsible",a).addClass("hide"):e("#childrenCollapsible",a).removeClass("hide"),D(a,t,r,i)):e("#childrenCollapsible",a).addClass("hide"),t.MediaSources&&t.MediaSources.length&&j(a,t);var n=t.Chapters||[];n.length&&AppInfo.enableDetailPageChapters?(e("#scenesCollapsible",a).show(),O(a,t,r,3)):e("#scenesCollapsible",a).hide(),t.SpecialFeatureCount&&0!=t.SpecialFeatureCount&&"Series"!=t.Type?(e("#specialsCollapsible",a).removeClass("hide"),K(a,t,r,6)):e("#specialsCollapsible",a).addClass("hide"),t.People&&t.People.length?(e("#castCollapsible",a).show(),_(a,t,i,b()?null:6)):e("#castCollapsible",a).hide(),t.PartCount&&t.PartCount>1?(e("#additionalPartsCollapsible",a).removeClass("hide"),q(a,t,r)):e("#additionalPartsCollapsible",a).addClass("hide"),e("#themeSongsCollapsible",a).hide(),e("#themeVideosCollapsible",a).hide(),"MusicAlbum"==t.Type?E(a,t,r):e("#musicVideosCollapsible",a).hide(),V(a,t,r),b()?F(a,t):F(a,t,1)}function h(a,i,r,n){S(a,i,r),f(a,i,r),i.Taglines&&i.Taglines.length?e(".tagline",a).html(i.Taglines[0]).show():e(".tagline",a).hide();var s=a.querySelector(".topOverview"),l=a.querySelector(".bottomOverview"),o=screen.availHeight<800||screen.availWidth<600;"MusicAlbum"==i.Type||"MusicArtist"==i.Type||"Season"==i.Type&&o?(t.renderOverview([l],i),s.classList.add("hide"),l.classList.remove("hide")):(t.renderOverview([s],i),s.classList.remove("hide"),l.classList.add("hide")),e(".itemCommunityRating",a).html(t.getRatingHtml(i)),t.renderAwardSummary(e("#awardSummary",a),i),e(".itemMiscInfo",a).html(t.getMiscInfoHtml(i)),t.renderGenres(e(".itemGenres",a),i,null,n),t.renderStudios(e(".itemStudios",a),i,n),B(a,i),t.renderLinks(a.querySelector(".itemExternalLinks"),i),e(".criticRatingScore",a).html((i.CriticRating||"0")+"%"),i.CriticRatingSummary?(e("#criticRatingSummary",a).show(),e(".criticRatingSummaryText",a).html(i.CriticRatingSummary)):e("#criticRatingSummary",a).hide(),P(a,i),M(a,i,n),i.Players?e("#players",a).show().html(i.Players+" Player"):e("#players",a).hide(),i.ArtistItems&&i.ArtistItems.length&&"MusicAlbum"!=i.Type?e(".artist",a).show().html(y(i.ArtistItems,r)).trigger("create"):e(".artist",a).hide(),i.MediaSources&&i.MediaSources.length&&i.Path?e(".audioVideoMediaInfo",a).removeClass("hide"):e(".audioVideoMediaInfo",a).addClass("hide"),"Photo"==i.MediaType?(e(".photoInfo",a).removeClass("hide"),g(a,i)):e(".photoInfo",a).addClass("hide"),v(a,i)}function g(a,t){var i="",r=[];if(t.CameraMake&&r.push(X(Globalize.translate("MediaInfoCameraMake"),t.CameraMake)),t.CameraModel&&r.push(X(Globalize.translate("MediaInfoCameraModel"),t.CameraModel)),t.Altitude&&r.push(X(Globalize.translate("MediaInfoAltitude"),t.Altitude.toFixed(1))),t.Aperture&&r.push(X(Globalize.translate("MediaInfoAperture"),"F"+t.Aperture.toFixed(1))),t.ExposureTime){var n=1/t.ExposureTime;r.push(X(Globalize.translate("MediaInfoExposureTime"),"1/"+n+" s"))}t.FocalLength&&r.push(X(Globalize.translate("MediaInfoFocalLength"),t.FocalLength.toFixed(1)+" mm")),t.ImageOrientation&&r.push(X(Globalize.translate("MediaInfoOrientation"),t.ImageOrientation)),t.IsoSpeedRating&&r.push(X(Globalize.translate("MediaInfoIsoSpeedRating"),t.IsoSpeedRating)),t.Latitude&&r.push(X(Globalize.translate("MediaInfoLatitude"),t.Latitude.toFixed(1))),t.Longitude&&r.push(X(Globalize.translate("MediaInfoLongitude"),t.Longitude.toFixed(1))),t.ShutterSpeed&&r.push(X(Globalize.translate("MediaInfoShutterSpeed"),t.ShutterSpeed)),t.Software&&r.push(X(Globalize.translate("MediaInfoSoftware"),t.Software)),i+=r.join("<br/>"),e(".photoInfoContent",a).html(i).trigger("create")}function v(a){var t=e(".tabDetails",a)[0],i=t.textContent||t.innerText||"";i.trim()?e(".detailsSection",a).removeClass("hide"):e(".detailsSection",a).addClass("hide")}function y(e){for(var a=[],t=0,i=e.length;i>t;t++){var r=e[t];a.push('<a class="textlink" href="itemdetails.html?id='+r.Id+'">'+r.Name+"</a>")}return a=a.join(" / "),1==e.length?Globalize.translate("ValueArtist",a):e.length>1?Globalize.translate("ValueArtists",a):a}function f(a,t,i){if(e(".lnkSibling",a).addClass("hide"),"Episode"==t.Type||"Season"==t.Type||"Audio"==t.Type||"Photo"==t.Type){var r;r="Season"==t.Type?ApiClient.getSeasons(t.SeriesId,{userId:Dashboard.getCurrentUserId(),AdjacentTo:t.Id}):"Episode"==t.Type&&t.SeasonId?ApiClient.getEpisodes(t.SeriesId,{seasonId:t.SeasonId,userId:Dashboard.getCurrentUserId(),AdjacentTo:t.Id}):ApiClient.getItems(Dashboard.getCurrentUserId(),{AdjacentTo:t.Id,ParentId:t.ParentId,SortBy:"SortName"}),i=i||"",r.then(function(r){for(var n=!1,s=0,l=r.Items.length;l>s;s++){var o=r.Items[s];o.Id==t.Id?n=!0:n?e(".lnkNextItem",a).removeClass("hide").attr("href","itemdetails.html?id="+o.Id+"&context="+i):e(".lnkPreviousItem",a).removeClass("hide").attr("href","itemdetails.html?id="+o.Id+"&context="+i)}})}}function b(){return browserInfo.mobile&&AppInfo.enableAppLayouts&&screen.availWidth<=1e3}function I(){return b()?"overflowPortrait":"detailPagePortrait"}function C(){return b()?"overflowSquare":"detailPageSquare"}function T(){return b()?"overflowBackdrop":"detailPage169"}function S(a,r,n){if("Movie"!=r.Type&&"Trailer"!=r.Type&&"Series"!=r.Type&&"Program"!=r.Type&&"Recording"!=r.Type&&"Game"!=r.Type&&"MusicAlbum"!=r.Type&&"MusicArtist"!=r.Type&&"ChannelVideoItem"!=r.Type)return void e("#similarCollapsible",a).hide();e("#similarCollapsible",a).show();var s="MusicAlbum"==r.Type||"MusicArtist"==r.Type?C():I(),l=e(i).width(),o=e(i).height(),d={userId:Dashboard.getCurrentUserId(),limit:l>800&&"detailPagePortrait"==s?5:4,fields:"PrimaryImageAspectRatio,UserData,SyncInfo"};l>=800&&o>=1e3&&(d.limit*=2),b()&&(d.limit=12),ApiClient.getSimilarItems(r.Id,d).then(function(i){if(!i.Items.length)return void e("#similarCollapsible",a).hide();var l=e("#similarCollapsible",a).show();e(".similiarHeader",l).html(Globalize.translate("HeaderIfYouLikeCheckTheseOut",r.Name));var o="";o+=b()?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">',o+=t.getPosterViewHtml({items:i.Items,shape:s,showParentTitle:"MusicAlbum"==r.Type,centerText:!0,showTitle:"MusicAlbum"==r.Type||"Game"==r.Type||"MusicArtist"==r.Type,borderless:"Game"==r.Type,context:n,lazy:!0,showDetailsMenu:!0,coverImage:"MusicAlbum"==r.Type||"MusicArtist"==r.Type,overlayPlayButton:!0}),o+="</div>",e("#similarContent",a).html(o).lazyChildren().createCardMenus()})}function M(a,t,i){if("Series"!=t.Type)return void e("#seriesAirTime",a).hide();var r="";t.AirDays&&t.AirDays.length&&(r+=7==t.AirDays.length?"daily":t.AirDays.map(function(e){return e+"s"}).join(",")),t.AirTime&&(r+=" at "+t.AirTime),t.Studios.length&&(r+=i?" on "+t.Studios[0].Name:' on <a class="textlink" href="itemdetails.html?id='+t.Studios[0].Id+'">'+t.Studios[0].Name+"</a>"),r?(r=("Ended"==t.Status?"Aired ":"Airs ")+r,e("#seriesAirTime",a).show().html(r).trigger("create")):e("#seriesAirTime",a).hide()}function P(a,t){if(t.Tags&&t.Tags.length){var i="";i+="<p>"+Globalize.translate("HeaderTags")+"</p>";for(var r=0,n=t.Tags.length;n>r;r++)i+='<div class="itemTag">'+t.Tags[r]+"</div>";e(".itemTags",a).show().html(i)}else e(".itemTags",a).hide()}function A(a,t){return t=e.extend({},t),function(e,i,r){return t.StartIndex=e,t.Limit=i,t.Fields=r,ApiClient.getEpisodes(a,t)}}function w(a){return a=e.extend({},a),function(e,t,i){return a.StartIndex=e,a.Limit=t,a.Fields=i,ApiClient.getItems(Dashboard.getCurrentUserId(),a)}}function D(a,i,r,n){na=null;var s="ItemCounts,AudioInfo,PrimaryImageAspectRatio,SyncInfo",l={ParentId:i.Id,Fields:s};"BoxSet"!==i.Type&&(l.SortBy="SortName");var o;"Series"==i.Type?o=ApiClient.getSeasons(i.Id,{userId:r.Id,Fields:s}):"Season"==i.Type?(o=ApiClient.getEpisodes(i.SeriesId,{seasonId:i.Id,userId:r.Id,Fields:s}),na=A(i.SeriesId,{seasonId:i.Id,userId:r.Id})):"MusicAlbum"==i.Type&&(na=w(l)),o=o||ApiClient.getItems(Dashboard.getCurrentUserId(),l),o.then(function(s){var l="",o=!1;"MusicAlbum"==i.Type?l=t.getListViewHtml({items:s.Items,smallIcon:!0,showIndex:!0,index:"disc",showIndexNumber:!0,playFromHere:!0,defaultAction:"playallfromhere",lazy:!0}):"Series"==i.Type?(o=b(),l=t.getPosterViewHtml({items:s.Items,shape:I(),showTitle:!0,centerText:!0,lazy:!0})):"Season"==i.Type?l=t.getPosterViewHtml({items:s.Items,shape:"detailPage169",showTitle:!0,displayAsSpecial:"Season"==i.Type&&i.IndexNumber,playFromHere:!0,overlayText:!0,lazy:!0,showDetailsMenu:!0,overlayMoreButton:AppInfo.enableAppLayouts}):"GameSystem"==i.Type&&(l=t.getPosterViewHtml({items:s.Items,shape:"auto",showTitle:!0,centerText:!0,lazy:!0,showDetailsMenu:!0}));var d=a.querySelector(".childrenItemsContainer");if(d.innerHTML=l,ImageLoader.lazyChildren(d),o?d.classList.add("hiddenScrollX"):d.classList.remove("hiddenScrollX"),e(d).createCardMenus(),"BoxSet"==i.Type){var c=[{name:Globalize.translate("HeaderMovies"),type:"Movie"},{name:Globalize.translate("HeaderSeries"),type:"Series"},{name:Globalize.translate("HeaderAlbums"),type:"MusicAlbum"},{name:Globalize.translate("HeaderGames"),type:"Game"},{name:Globalize.translate("HeaderBooks"),type:"Book"}];R(a,i,c,s.Items,r,n)}}),a.querySelector("#childrenTitle").innerHTML=Globalize.translate("Season"==i.Type?"HeaderEpisodes":"Series"==i.Type?"HeaderSeasons":"MusicAlbum"==i.Type?"HeaderTracks":"GameSystem"==i.Type?"HeaderGames":"HeaderItems"),"MusicAlbum"==i.Type?e(".childrenSectionHeader",a).hide():e(".childrenSectionHeader",a).show()}function L(e,a){require("scripts/itembynamedetailpage".split(","),function(){i.ItemsByName.renderItems(e,a)})}function z(e,a){require("scripts/playlistedit".split(","),function(){PlaylistViewer.render(e,a)})}function G(e,a){require("scripts/livetvcomponents,scripts/livetvchannel,livetvcss".split(","),function(){LiveTvChannelPage.renderPrograms(e,a.Id)})}function R(a,t,i,r,n){a.querySelector(".collectionItems").innerHTML="";for(var s=0,l=i.length;l>s;s++){var o=i[s],d=r.filter(function(e){return e.Type==o.type});d.length&&x(a,t,o,d,n)}var c={name:Globalize.translate("HeaderOtherItems")},m=r.filter(function(e){return!i.filter(function(a){return a.type==e.Type}).length});m.length&&x(a,t,c,m,n),r.length||x(a,t,{name:Globalize.translate("HeaderItems")},r,n),e(".collectionItems .itemsContainer",a).createCardMenus()}function x(a,i,r,n,s,l){var o="";o+='<div class="detailSection">',o+="<h1>",o+="<span>"+r.name+"</span>",o+="</h1>",o+='<div class="detailSectionContent itemsContainer">';var d="MusicAlbum"==r.type?"detailPageSquare":"detailPagePortrait";o+=t.getPosterViewHtml({items:n,shape:d,showTitle:!0,centerText:!0,context:l,lazy:!0,showDetailsMenu:!0,overlayMoreButton:!0,showAddToCollection:!1,showRemoveFromCollection:!0}),o+="</div>",o+="</div>";var c=a.querySelector(".collectionItems");e(c).append(o),ImageLoader.lazyChildren(c),e(c).off("removefromcollection").on("removefromcollection",function(e,t){k(a,i,[t],s,l)})}function k(e,a,t,i,r){Dashboard.showLoadingMsg();var n=ApiClient.getUrl("Collections/"+a.Id+"/Items",{Ids:t.join(",")});ApiClient.ajax({type:"DELETE",url:n}).then(function(){D(e,a,i,r),Dashboard.hideLoadingMsg()})}function B(a,i){e(".userDataIcons",a).html(t.getUserDataIconsHtml(i,!0,"fab"))}function F(a,t,i){if("Movie"!=t.Type&&"Trailer"!=t.Type&&"MusicVideo"!=t.Type)return void e("#criticReviewsCollapsible",a).hide();var r={};i&&(r.limit=i),ApiClient.getCriticReviews(t.Id,r).then(function(r){r.TotalRecordCount||t.CriticRatingSummary||t.AwardSummary?(e("#criticReviewsCollapsible",a).show(),H(a,r,i)):e("#criticReviewsCollapsible",a).hide()})}function H(e,a,t){for(var i="",r=a.Items,n=0,s=r.length;s>n;n++){var l=r[n];i+='<div class="paperList criticReviewPaperList">',i+='<paper-icon-item style="padding-top:.5em;padding-bottom:.5em;">',null!=l.Score||null!=l.Likes&&(i+=l.Likes?"<paper-fab mini style=\"background-color:transparent;background-image:url('css/images/fresh.png');background-repeat:no-repeat;background-position:center center;background-size: cover;\" item-icon></paper-fab>":"<paper-fab mini style=\"background-color:transparent;background-image:url('css/images/rotten.png');background-repeat:no-repeat;background-position:center center;background-size: cover;\" item-icon></paper-fab>"),i+="<paper-item-body three-line>",i+='<div style="white-space:normal;">'+l.Caption+"</div>";var o=[];if(l.ReviewerName&&o.push(l.ReviewerName),l.Publisher&&o.push(l.Publisher),i+="<div secondary>"+o.join(", ")+".",l.Date)try{var d=parseISO8601Date(l.Date,{toLocal:!0}).toLocaleDateString();i+='<span class="reviewDate">'+d+"</span>"}catch(c){}i+="</div>",l.Url&&(i+='<div secondary><a class="textlink" href="'+l.Url+'" target="_blank">'+Globalize.translate("ButtonFullReview")+"</a></div>"),i+="</paper-item-body>",i+="</paper-icon-item>",i+="</div>"}t&&a.TotalRecordCount>t&&(i+='<p style="margin: 0;"><paper-button raised class="more moreCriticReviews">'+Globalize.translate("ButtonMore")+"</paper-button></p>");var m=e.querySelector("#criticReviewsContent");m.innerHTML=i,b()?m.classList.add("hiddenScrollX"):m.classList.remove("hiddenScrollX")}function V(e,a){ApiClient.getThemeMedia(Dashboard.getCurrentUserId(),a.Id,!0).then(function(t){var i=t.ThemeSongsResult.OwnerId==a.Id?t.ThemeSongsResult.Items:[],r=t.ThemeVideosResult.OwnerId==a.Id?t.ThemeVideosResult.Items:[];N(e,i),U(e,r),e.dispatchEvent(new CustomEvent("thememediadownload",{detail:{themeMediaResult:t},bubbles:!0}))})}function N(a,i){if(i.length){e("#themeSongsCollapsible",a).show();var r=t.getListViewHtml({items:i,smallIcon:!0});a.querySelector("#themeSongsContent").innerHTML=r}else e("#themeSongsCollapsible",a).hide()}function U(a,t,i){t.length?(e("#themeVideosCollapsible",a).show(),e("#themeVideosContent",a).html(Y(t,i)).lazyChildren()):e("#themeVideosCollapsible",a).hide()}function E(a,t,i){ApiClient.getItems(i.Id,{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"MusicVideo",Recursive:!0,Fields:"DateCreated,SyncInfo",Albums:t.Name}).then(function(t){t.Items.length?(e("#musicVideosCollapsible",a).show(),e("#musicVideosContent",a).html(Y(t.Items,i)).lazyChildren()):e("#musicVideosCollapsible",a).hide()})}function q(a,t,i){ApiClient.getAdditionalVideoParts(i.Id,t.Id).then(function(t){t.Items.length?(e("#additionalPartsCollapsible",a).show(),e("#additionalPartsContent",a).html(Y(t.Items,i)).lazyChildren()):e("#additionalPartsCollapsible",a).hide()})}function O(e,a,i,r,n){var s="",l=a.Chapters||[],o=t.getPosterViewInfo().backdropWidth;b()?(s+='<div class="hiddenScrollX itemsContainer">',r=null):s+='<div class="itemsContainer">';for(var d=0,c=l.length;c>d&&!(r&&d>=r);d++){var m=l[d],u=m.Name||"Chapter "+d,p="Full"!=a.PlayAccess||n?"":' onclick="ItemDetailPage.play('+m.StartPositionTicks+');"';s+='<a class="card '+T()+'Card" href="#play-Chapter-'+d+'"'+p+">",s+='<div class="cardBox">',s+='<div class="cardScalable">';var h;h=m.ImageTag?ApiClient.getScaledImageUrl(a.Id,{maxWidth:o,tag:m.ImageTag,type:"Chapter",index:d}):"css/images/items/list/chapter.png",s+='<div class="cardPadder"></div>',s+='<div class="cardContent">',s+='<div class="cardImage lazy" data-src="'+h+'"></div>',s+='<div class="cardFooter">',s+='<div class="cardText">'+u+"</div>",s+='<div class="cardText">',s+=Dashboard.getDisplayTime(m.StartPositionTicks),s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</a>"}s+="</div>",r&&l.length>r&&(s+='<p style="margin: 0;"><paper-button raised class="more moreScenes">'+Globalize.translate("ButtonMore")+"</paper-button></p>");var g=e.querySelector("#scenesContent");g.innerHTML=s,ImageLoader.lazyChildren(g)}function j(e,a){var t=a.MediaSources.map(function(e){return W(a,e)}).join('<div style="border-top:1px solid #444;margin: 1em 0;"></div>');a.MediaSources.length>1&&(t="<br/>"+t);var i=e.querySelector("#mediaInfoContent");i.innerHTML=t}function W(e,a){var t="";a.Name&&e.MediaSources.length>1&&(t+='<div><span class="mediaInfoAttribute">'+a.Name+"</span></div><br/>");for(var i=0,r=a.MediaStreams.length;r>i;i++){var n=a.MediaStreams[i];if("Data"!=n.Type){t+='<div class="mediaInfoStream">';var s=Globalize.translate("MediaInfoStreamType"+n.Type);t+='<div class="mediaInfoStreamType">'+s+"</div>";var l=[];n.Language&&"Video"!=n.Type&&l.push(X(Globalize.translate("MediaInfoLanguage"),n.Language)),n.Codec&&l.push(X(Globalize.translate("MediaInfoCodec"),n.Codec.toUpperCase())),n.CodecTag&&l.push(X(Globalize.translate("MediaInfoCodecTag"),n.CodecTag)),n.Profile&&l.push(X(Globalize.translate("MediaInfoProfile"),n.Profile)),n.Level&&l.push(X(Globalize.translate("MediaInfoLevel"),n.Level)),(n.Width||n.Height)&&l.push(X(Globalize.translate("MediaInfoResolution"),n.Width+"x"+n.Height)),n.AspectRatio&&"mjpeg"!=n.Codec&&l.push(X(Globalize.translate("MediaInfoAspectRatio"),n.AspectRatio)),"Video"==n.Type&&(null!=n.IsAnamorphic&&l.push(X(Globalize.translate("MediaInfoAnamorphic"),n.IsAnamorphic?"Yes":"No")),l.push(X(Globalize.translate("MediaInfoInterlaced"),n.IsInterlaced?"Yes":"No"))),(n.AverageFrameRate||n.RealFrameRate)&&l.push(X(Globalize.translate("MediaInfoFramerate"),n.AverageFrameRate||n.RealFrameRate)),n.ChannelLayout&&l.push(X(Globalize.translate("MediaInfoLayout"),n.ChannelLayout)),n.Channels&&l.push(X(Globalize.translate("MediaInfoChannels"),n.Channels+" ch")),n.BitRate&&"mjpeg"!=n.Codec&&l.push(X(Globalize.translate("MediaInfoBitrate"),parseInt(n.BitRate/1024)+" kbps")),n.SampleRate&&l.push(X(Globalize.translate("MediaInfoSampleRate"),n.SampleRate+" khz")),n.BitDepth&&l.push(X(Globalize.translate("MediaInfoBitDepth"),n.BitDepth+" bit")),n.PixelFormat&&l.push(X(Globalize.translate("MediaInfoPixelFormat"),n.PixelFormat)),n.RefFrames&&l.push(X(Globalize.translate("MediaInfoRefFrames"),n.RefFrames)),n.KeyFrames,"Video"!=n.Type&&l.push(X(Globalize.translate("MediaInfoDefault"),n.IsDefault?"Yes":"No")),"Subtitle"==n.Type&&(l.push(X(Globalize.translate("MediaInfoForced"),n.IsForced?"Yes":"No")),l.push(X(Globalize.translate("MediaInfoExternal"),n.IsExternal?"Yes":"No"))),"Video"==n.Type&&a.Timestamp&&l.push(X(Globalize.translate("MediaInfoTimestamp"),a.Timestamp)),null!=n.IsCabac&&l.push(X(Globalize.translate("CABAC"),n.IsCabac?"Yes":"No")),t+=l.join("<br/>"),t+="</div>"}}if(a.Container&&(t+='<div><span class="mediaInfoLabel">'+Globalize.translate("MediaInfoContainer")+'</span><span class="mediaInfoAttribute">'+a.Container+"</span></div>"),a.Formats&&a.Formats.length,a.Path&&"Http"!=a.Protocol&&(t+='<div style="max-width:600px;overflow:hidden;"><span class="mediaInfoLabel">'+Globalize.translate("MediaInfoPath")+'</span><span class="mediaInfoAttribute">'+a.Path+"</span></div>"),a.Size){var o=(a.Size/1048576).toFixed(0);t+='<div><span class="mediaInfoLabel">'+Globalize.translate("MediaInfoSize")+'</span><span class="mediaInfoAttribute">'+o+" MB</span></div>"}return t}function X(e,a){return'<span class="mediaInfoLabel">'+e+'</span><span class="mediaInfoAttribute">'+a+"</span>"}function Y(e,a,i,r){for(var n="",s=t.getPosterViewInfo().backdropWidth,l=0,o=e.length;o>l&&!(i&&l>=i);l++){var d=e[l],c="card detailPage169Card",m="itemdetails.html?id="+d.Id,u="Full"==d.PlayAccess?" onclick=\"MediaController.play('"+d.Id+"'); return false;\"":"";n+='<a class="'+c+'" href="'+m+'"'+u+">",n+='<div class="cardBox">',n+='<div class="cardScalable">';var p,h=d.ImageTags||{};p=h.Primary?ApiClient.getScaledImageUrl(d.Id,{maxWidth:s,tag:h.Primary,type:"primary"}):"css/images/items/detail/video.png",n+='<div class="cardPadder"></div>',n+='<div class="cardContent">',n+='<div class="cardImage lazy" data-src="'+p+'"></div>',n+='<div class="cardFooter">',n+='<div class="cardText">'+d.Name+"</div>",n+='<div class="cardText">',n+=""!=d.RunTimeTicks?Dashboard.getDisplayTime(d.RunTimeTicks):"&nbsp;",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</a>"}return i&&e.length>i&&(n+='<p style="margin: 0;padding-left:5px;"><paper-button raised class="more '+r+'">'+Globalize.translate("ButtonMore")+"</paper-button></p>"),n}function K(e,a,t,i){ApiClient.getSpecialFeatures(t.Id,a.Id).then(function(a){var r=e.querySelector("#specialsContent");r.innerHTML=Y(a,t,i,"moreSpecials"),ImageLoader.lazyChildren(r)})}function _(e,a,t,i,r){if(b())return void Q(e,a,t,r);for(var n="",s=a.People||[],l=0,o=s.length;o>l&&!(i&&l>=i);l++){var d=s[l],c=r?"#":"itemdetails.html?id="+d.Id;n+='<a class="tileItem smallPosterTileItem" href="'+c+'">';var m,u=!0;d.PrimaryImageTag?m=ApiClient.getScaledImageUrl(d.Id,{maxWidth:100,tag:d.PrimaryImageTag,type:"primary",minScale:2}):(m="css/images/items/list/person.png",u=!1),n+=u?'<div class="tileImage lazy" data-src="'+m+'"></div>':'<div class="tileImage" style="background-image:url(\''+m+"');\"></div>",n+='<div class="tileContent">',n+="<p>"+d.Name+"</p>";var p=d.Role?Globalize.translate("ValueAsRole",d.Role):d.Type;"GuestStar"==p&&(p=Globalize.translate("ValueGuestStar")),p=p||"";var h=40;p.length>h&&(p=p.substring(0,h-3)+"..."),n+="<p>"+p+"</p>",n+="</div>",n+="</a>"}i&&s.length>i&&(n+='<p style="margin: 0;padding-left:5px;"><paper-button raised class="more morePeople">'+Globalize.translate("ButtonMore")+"</paper-button></p>");var g=e.querySelector("#castContent");g.innerHTML=n,ImageLoader.lazyChildren(g)}function Q(e,a,t,i){var r="";r+=b()?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">';var n=a.People||[];n=n.filter(function(e){return e.PrimaryImageTag}),n.length||(n=a.People||[]);for(var s=0,l=n.length;l>s;s++){var o=n[s],d=i?"#":"itemdetails.html?id="+o.Id;r+='<div class="card '+I()+'Card">',r+='<div class="cardBox">',r+='<div class="cardScalable">';var c,m=!0;o.PrimaryImageTag?c=ApiClient.getScaledImageUrl(o.Id,{maxWidth:100,tag:o.PrimaryImageTag,type:"primary",minScale:2}):(c="css/images/items/list/person.png",m=!1),r+='<div class="cardPadder"></div>',r+='<a class="cardContent" href="'+d+'">',r+=m?'<div class="cardImage coveredCardImage lazy" data-src="'+c+'"></div>':'<div class="cardImage coveredCardImage" style="background-image:url(\''+c+"');\"></div>",r+="</div>",r+="</a>",r+="</div>",r+='<div class="cardFooter outerCardFooter">',r+='<div class="cardText">'+o.Name+"</div>",r+='<div class="cardText">';var u=o.Role?Globalize.translate("ValueAsRole",o.Role):o.Type;"GuestStar"==u&&(u=Globalize.translate("ValueGuestStar")),u=u||"";var p=40;u.length>p&&(u=u.substring(0,p-3)+"..."),r+=u,r+="</div>",r+="</div>",r+="</div>"}r+="</div>";var h=e.querySelector("#castContent");h.innerHTML=r,ImageLoader.lazyChildren(h)}function J(e){MediaController.play({items:[ra],startPositionTicks:e})}function Z(e){var a=getParameterByName("id");Dashboard.confirm("Are you sure you wish to split the media sources into separate items?","Split Media Apart",function(t){t&&(Dashboard.showLoadingMsg(),ApiClient.ajax({type:"DELETE",url:ApiClient.getUrl("Videos/"+a+"/AlternateSources")}).then(function(){Dashboard.hideLoadingMsg(),n(e)}))})}function $(){ApiClient.getLocalTrailers(Dashboard.getCurrentUserId(),ra.Id).then(function(e){MediaController.play({items:e})})}function ea(e,a){ra&&ra.Id==a&&Dashboard.navigate("Recording"==ra.Type?"livetv.html":"index.html")}function aa(e){if("Program"==ra.Type)return void ApiClient.getLiveTvChannel(ra.ChannelId,Dashboard.getCurrentUserId()).then(function(e){t.showPlayMenu(null,e.Id,e.Type,!1,e.MediaType,(e.UserData||{}).PlaybackPositionTicks)});var a=ra.UserData||{},i=ra.MediaType;("MusicArtist"==ra.Type||"MusicAlbum"==ra.Type)&&(i="Audio"),t.showPlayMenu(e,ra.Id,ra.Type,ra.IsFolder,i,a.PlaybackPositionTicks)}function ta(e,a){Dashboard.confirm(Globalize.translate("MessageConfirmRecordingCancellation"),Globalize.translate("HeaderConfirmRecordingCancellation"),function(t){t&&(Dashboard.showLoadingMsg(),ApiClient.cancelLiveTvTimer(a).then(function(){Dashboard.alert(Globalize.translate("MessageRecordingCancelled")),n(e)}))})}function ia(){var e=this;e.play=J,e.setInitialCollapsibleState=p,e.renderDetails=h,e.renderCriticReviews=F,e.renderCast=_,e.renderScenes=O,e.renderMediaSources=j}var ra;e.fn.lazyChildren=function(){for(var e=0,a=this.length;a>e;e++)ImageLoader.lazyChildren(this[e]);return this};var na=null;pageIdOn("pageinit","itemDetailPage",function(){var a=this;e(".btnPlay",a).on("click",function(){aa(this)}),e(".btnPlayTrailer",a).on("click",function(){$(a)}),e(".btnSplitVersions",a).on("click",function(){Z(a)}),e(".btnSync",a).on("click",function(){SyncManager.showMenu({items:[ra]})}),e(".btnRecord,.btnFloatingRecord",a).on("click",function(){var e=getParameterByName("id");Dashboard.navigate("livetvnewrecording.html?programid="+e)}),e(".btnCancelRecording",a).on("click",function(){ta(a,ra.TimerId)}),e(".btnMoreCommands",a).on("click",function(){var e=this;Dashboard.getCurrentUser().then(function(a){t.showMoreCommands(e,ra.Id,t.getMoreCommands(ra,a))})}),e(".childrenItemsContainer",a).on("playallfromhere",function(e,a){t.playAllFromHere(na,a)}).on("queueallfromhere",function(e,a){t.queueAllFromHere(na,a)}),e(a).on("click",".moreScenes",function(){Dashboard.getCurrentUser().then(function(e){O(a,ra,e)})}).on("click",".morePeople",function(){_(a,ra,m(ra))}).on("click",".moreSpecials",function(){Dashboard.getCurrentUser().then(function(e){K(a,ra,e)})}).on("click",".moreCriticReviews",function(){F(a,ra)})}),pageIdOn("pagebeforeshow","itemDetailPage",function(){var e=this;n(e),Events.on(ApiClient,"websocketmessage",d),Events.on(t,"itemdeleting",ea)}),pageIdOn("pagebeforehide","itemDetailPage",function(){Events.off(t,"itemdeleting",ea),ra=null;Events.off(ApiClient,"websocketmessage",d),LibraryMenu.setTransparentMenu(!1)}),i.ItemDetailPage=new ia}(jQuery,document,LibraryBrowser,window);