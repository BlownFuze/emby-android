define(["jQuery"],function(e){function a(a,n,t){e("#chkEnableServer",a).checked(n.EnableServer),e("#chkBlastAliveMessages",a).checked(n.BlastAliveMessages),e("#txtBlastInterval",a).val(n.BlastAliveMessageIntervalSeconds),e("#chkEnableMovieFolders",a).checked(n.EnableMovieFolders);var s=t.map(function(e){return'<option value="'+e.Id+'">'+e.Name+"</option>"}).join("");e("#selectUser",a).html(s).val(n.DefaultUserId||""),Dashboard.hideLoadingMsg()}function n(){Dashboard.showLoadingMsg();var a=this;return ApiClient.getNamedConfiguration("dlna").then(function(n){n.EnableServer=e("#chkEnableServer",a).checked(),n.BlastAliveMessages=e("#chkBlastAliveMessages",a).checked(),n.BlastAliveMessageIntervalSeconds=e("#txtBlastInterval",a).val(),n.DefaultUserId=e("#selectUser",a).val(),n.EnableMovieFolders=e("#chkEnableMovieFolders",a).checked(),ApiClient.updateNamedConfiguration("dlna",n).then(Dashboard.processServerConfigurationUpdateResult)}),!1}e(document).on("pageinit","#dlnaServerSettingsPage",function(){e(".dlnaServerSettingsForm").off("submit",n).on("submit",n)}).on("pageshow","#dlnaServerSettingsPage",function(){Dashboard.showLoadingMsg();var e=this,n=ApiClient.getNamedConfiguration("dlna"),t=ApiClient.getUsers();Promise.all([n,t]).then(function(n){a(e,n[0],n[1])})})});