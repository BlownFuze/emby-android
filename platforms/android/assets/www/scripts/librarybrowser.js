define(["playlistManager","appSettings","appStorage","apphost","jQuery","scrollStyles"],function(e,a,t,r,i){var n=function(n,s,o){function l(e){return e.replace(/&/g,"&amp;").replace(u,function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return"&#"+(1024*(a-55296)+(t-56320)+65536)+";"}).replace(m,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(e){if(e){if(e=e.toLowerCase(),-1!=e.indexOf("portrait"))return 2/3;if(-1!=e.indexOf("backdrop"))return 16/9;if(-1!=e.indexOf("square"))return 1}return null}var u=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,m=/([^\#-~| |!])/g,c="pagesize_v4",p={getDefaultPageSize:function(e,a){return 100},getDefaultItemsView:function(e,a){return browserInfo.mobile?a:e},getSavedQueryKey:function(e){return n.location.href.split("#")[0]+(e||"")},loadSavedQueryValues:function(e,a){var r=t.getItem(e+"_"+Dashboard.getCurrentUserId());return r?(r=JSON.parse(r),Object.assign(a,r)):a},saveQueryValues:function(e,a){var r={};a.SortBy&&(r.SortBy=a.SortBy),a.SortOrder&&(r.SortOrder=a.SortOrder);try{t.setItem(e+"_"+Dashboard.getCurrentUserId(),JSON.stringify(r))}catch(i){}},saveViewSetting:function(e,a){try{t.setItem(e+"_"+Dashboard.getCurrentUserId()+"_view",a)}catch(r){}},getSavedView:function(e){var a=t.getItem(e+"_"+Dashboard.getCurrentUserId()+"_view");return a},getSavedViewSetting:function(e){return new Promise(function(a){var t=LibraryBrowser.getSavedView(e);a(t)})},needsRefresh:function(e){var a=parseInt(e.getAttribute("data-lastrefresh")||"0");if(!a)return!0;var t,r=(new Date).getTime();return t=AppInfo.isNativeApp?3e5:browserInfo.ipad||browserInfo.iphone||browserInfo.android?1e4:3e4,t>r-a?!1:!0},setLastRefreshed:function(e){e.setAttribute("data-lastrefresh",(new Date).getTime()),e.classList.add("hasrefreshtime")},enableFullPaperTabs:function(){return browserInfo.animate&&!browserInfo.mobile,AppInfo.isNativeApp},allowSwipe:function(e){function a(e){return"PAPER-SLIDER"==e.tagName?!1:e.classList?!e.classList.contains("hiddenScrollX")&&!e.classList.contains("smoothScrollX"):!0}for(var t=e;null!=t;){if(!a(t))return!1;t=t.parentNode}return!0},getTabsAnimationConfig:function(e){return browserInfo.mobile,{entry:{name:"fade-in-animation",node:e,timing:{duration:160,easing:"ease-out"}},exit:{name:"fade-out-animation",node:e,timing:{duration:200,easing:"ease-out"}}}},selectedTab:function(e,a){if(null==a)return e.selectedTabIndex;for(var t=e.querySelectorAll(".pageTabContent"),r=0,i=t.length;i>r;r++)r==a?t[r].classList.remove("hide"):t[r].classList.add("hide");e.selectedTabIndex=a,e.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:a}}))},configureSwipeTabs:function(e,a,t){var r=t.querySelectorAll(".pageTabContent").length;require(["hammer"],function(e){var i=new e(t);i.get("swipe").set({direction:e.DIRECTION_HORIZONTAL}),i.on("swipeleft",function(e){if(LibraryBrowser.allowSwipe(e.target)){var i=parseInt(LibraryBrowser.selectedTab(t)||"0");r-1>i&&a.selectNext()}}),i.on("swiperight",function(e){if(LibraryBrowser.allowSwipe(e.target)){var r=parseInt(LibraryBrowser.selectedTab(t)||"0");r>0&&a.selectPrevious()}})})},navigateOnLibraryTabSelect:function(){return!LibraryBrowser.enableFullPaperTabs()},configurePaperLibraryTabs:function(e,a,t){browserInfo.chrome&&(a.noink=!0);var r=e.querySelector(".libraryViewNav");if(LibraryBrowser.enableFullPaperTabs())browserInfo.safari?(a.noSlide=!0,a.noBar=!0):LibraryBrowser.configureSwipeTabs(e,a,t),r&&(r.classList.add("paperLibraryViewNav"),r.classList.remove("libraryViewNavWithMinHeight"));else{a.noSlide=!0,a.noBar=!0;var i=e.querySelector(".legacyTabs");i&&t.addEventListener("tabchange",function(e){for(var a=e.detail.selectedTabIndex,t=i.querySelectorAll("a"),r=0,n=t.length;n>r;r++)r==a?t[r].classList.add("ui-btn-active"):t[r].classList.remove("ui-btn-active")}),r&&r.classList.remove("libraryViewNavWithMinHeight")}e.addEventListener("viewbeforeshow",LibraryBrowser.onTabbedpagebeforeshow),LibraryBrowser.navigateOnLibraryTabSelect()||a.addEventListener("iron-select",function(){LibraryBrowser.selectedTab(t,this.selected)})},onTabbedpagebeforeshow:function(e){var a=e.target,t=0,r=!1;a.getAttribute("data-firstload")||(t=300,r=!0,a.setAttribute("data-firstload","1")),t?setTimeout(function(){LibraryBrowser.onTabbedpagebeforeshowInternal(a,e,r)},t):LibraryBrowser.onTabbedpagebeforeshowInternal(a,e,r)},onTabbedpagebeforeshowInternal:function(e,a,t){var r=e.querySelector(".pageTabsContainer");if(t){var i=parseInt(getParameterByName("tab")||"0");if(LibraryBrowser.enableFullPaperTabs()){var n=e.querySelector("paper-tabs");if(n.selected)return;n.selected=i}else LibraryBrowser.selectedTab(r,i)}else{if(LibraryBrowser.enableFullPaperTabs()&&!a.detail.isRestored&&LibraryBrowser.selectedTab(r))return void(e.querySelector("paper-tabs").selected=0);r.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:LibraryBrowser.selectedTab(r)}}))}},showTab:function(e,a){if(!LibraryBrowser.enableFullPaperTabs())return a&&(e=replaceQueryString(e,"tab",a)),void Dashboard.navigate(e);var t=function(){if(s.removeEventListener("pagebeforeshow",t),-1!=n.location.href.toLowerCase().indexOf(e.toLowerCase())){var r=this.querySelector(".pageTabsContainer");if(r){var i=this.querySelector("paper-tabs"),o=browserInfo.chrome?0:100;setTimeout(function(){var e=i.noSlide;i.noSlide=!0,i.selected=a,i.noSlide=e},o)}}};-1!=n.location.href.toLowerCase().indexOf(e.toLowerCase())?t.call(i.mobile.activePage):(pageClassOn("pagebeforeshow","page",t),Dashboard.navigate(e))},canShare:function(e,a){return a.Policy.EnablePublicSharing},getDateParamValue:function(e){function a(e){return 10>e?"0"+e:e}var t=e;return""+t.getFullYear()+a(t.getMonth()+1)+a(t.getDate())+a(t.getHours())+a(t.getMinutes())+a(t.getSeconds())},playAllFromHere:function(e,a){e(a,100,"MediaSources,Chapters").then(function(e){MediaController.play({items:e.Items})})},queueAllFromHere:function(e,a){fn(a,100,"MediaSources,Chapters").then(function(e){MediaController.queue({items:e.Items})})},getItemCountsHtml:function(e,a){var t,r=[];if("Playlist"==a.Type){if(t="",a.CumulativeRunTimeTicks){var i=a.CumulativeRunTimeTicks/6e8;i=i||1,t+=Globalize.translate("ValueMinutes",Math.round(i))}else t+=Globalize.translate("ValueMinutes",0);r.push(t)}else"movies"==e.context?(a.MovieCount&&(t=1==a.MovieCount?Globalize.translate("ValueOneMovie"):Globalize.translate("ValueMovieCount",a.MovieCount),r.push(t)),a.TrailerCount&&(t=1==a.TrailerCount?Globalize.translate("ValueOneTrailer"):Globalize.translate("ValueTrailerCount",a.TrailerCount),r.push(t))):"tv"==e.context?(a.SeriesCount&&(t=1==a.SeriesCount?Globalize.translate("ValueOneSeries"):Globalize.translate("ValueSeriesCount",a.SeriesCount),r.push(t)),a.EpisodeCount&&(t=1==a.EpisodeCount?Globalize.translate("ValueOneEpisode"):Globalize.translate("ValueEpisodeCount",a.EpisodeCount),r.push(t))):"games"==e.context?a.GameCount&&(t=1==a.GameCount?Globalize.translate("ValueOneGame"):Globalize.translate("ValueGameCount",a.GameCount),r.push(t)):"music"==e.context&&(a.AlbumCount&&(t=1==a.AlbumCount?Globalize.translate("ValueOneAlbum"):Globalize.translate("ValueAlbumCount",a.AlbumCount),r.push(t)),a.SongCount&&(t=1==a.SongCount?Globalize.translate("ValueOneSong"):Globalize.translate("ValueSongCount",a.SongCount),r.push(t)),a.MusicVideoCount&&(t=1==a.MusicVideoCount?Globalize.translate("ValueOneMusicVideo"):Globalize.translate("ValueMusicVideoCount",a.MusicVideoCount),r.push(t)));return r.join(" â€¢ ")},getArtistLinksHtml:function(e,a){for(var t=[],r=0,i=e.length;i>r;r++){var n=e[r],s=a?' class="'+a+'"':"";t.push("<a"+s+' href="itemdetails.html?id='+n.Id+'">'+n.Name+"</a>")}return t=t.join(" / ")},playInExternalPlayer:function(e){Dashboard.loadExternalPlayer().then(function(){ExternalPlayer.showMenu(e)})},showPlayMenu:function(e,t,r,i,n,s){var o=AppInfo.supportsExternalPlayers&&a.enableExternalPlayers();if(!(s||"Audio"==n||i||o&&"Video"==n))return void MediaController.play(t);var l=[];s&&l.push({name:Globalize.translate("ButtonResume"),id:"resume",ironIcon:"play-arrow"}),l.push({name:Globalize.translate("ButtonPlay"),id:"play",ironIcon:"play-arrow"}),!i&&o&&"Audio"!=n&&l.push({name:Globalize.translate("ButtonPlayExternalPlayer"),id:"externalplayer",ironIcon:"airplay"}),MediaController.canQueueMediaType(n,r)&&l.push({name:Globalize.translate("ButtonQueue"),id:"queue",ironIcon:"playlist-add"}),("Audio"==r||"MusicAlbum"==r||"MusicArtist"==r||"MusicGenre"==r)&&l.push({name:Globalize.translate("ButtonInstantMix"),id:"instantmix",ironIcon:"shuffle"}),(i||"MusicArtist"==r||"MusicGenre"==r)&&l.push({name:Globalize.translate("ButtonShuffle"),id:"shuffle",ironIcon:"shuffle"}),require(["actionsheet"],function(a){a.show({items:l,positionTo:e,callback:function(e){switch(e){case"play":MediaController.play(t);break;case"externalplayer":LibraryBrowser.playInExternalPlayer(t);break;case"resume":MediaController.play({ids:[t],startPositionTicks:s});break;case"queue":MediaController.queue(t);break;case"instantmix":MediaController.instantMix(t);break;case"shuffle":MediaController.shuffle(t)}}})})},supportsEditing:function(e){return"UserRootFolder"==e||"UserView"==e?!1:!0},getMoreCommands:function(a,t){var i=[];return LibraryBrowser.supportsAddingToCollection(a)&&i.push("addtocollection"),e.supportsPlaylists(a)&&i.push("playlist"),"BoxSet"==a.Type||"Playlist"==a.Type?i.push("delete"):a.CanDelete&&i.push("delete"),t.Policy.IsAdministrator&&(LibraryBrowser.supportsEditing(a.Type)&&i.push("edit"),"Video"==a.MediaType&&"TvChannel"!=a.Type&&"Program"!=a.Type&&"Virtual"!=a.LocationType&&i.push("editsubtitles"),i.push("editimages")),t.Policy.IsAdministrator&&i.push("refresh"),LibraryBrowser.enableSync(a,t)&&i.push("sync"),a.CanDownload&&r.supports("filedownload")&&i.push("download"),LibraryBrowser.canShare(a,t)&&i.push("share"),("Movie"==a.Type||"Trailer"==a.Type||"Series"==a.Type||"Game"==a.Type||"BoxSet"==a.Type||"Person"==a.Type||"Book"==a.Type||"MusicAlbum"==a.Type||"MusicArtist"==a.Type)&&t.Policy.IsAdministrator&&i.push("identify"),i},refreshItem:function(e){ApiClient.refreshItem(e,{Recursive:!0,ImageRefreshMode:"FullRefresh",MetadataRefreshMode:"FullRefresh",ReplaceAllImages:!1,ReplaceAllMetadata:!0}),require(["toast"],function(e){e(Globalize.translate("MessageRefreshQueued"))})},deleteItems:function(e){return new Promise(function(a,t){var r=Globalize.translate("ConfirmDeleteItem"),i=Globalize.translate("HeaderDeleteItem");e.length>1&&(r=Globalize.translate("ConfirmDeleteItems"),i=Globalize.translate("HeaderDeleteItems")),require(["confirm"],function(n){n(r,i).then(function(){e.map(function(e){ApiClient.deleteItem(e),Events.trigger(LibraryBrowser,"itemdeleting",[e])});a()},t)})})},editImages:function(e){require(["components/imageeditor/imageeditor"],function(a){a.show(e)})},editSubtitles:function(e){require(["components/subtitleeditor/subtitleeditor"],function(a){a.show(e)})},editMetadata:function(e){require(["components/metadataeditor/metadataeditor"],function(a){a.show(e)})},showMoreCommands:function(e,a,t){var r=[];-1!=t.indexOf("addtocollection")&&r.push({name:Globalize.translate("ButtonAddToCollection"),id:"addtocollection",ironIcon:"add"}),-1!=t.indexOf("playlist")&&r.push({name:Globalize.translate("ButtonAddToPlaylist"),id:"playlist",ironIcon:"playlist-add"}),-1!=t.indexOf("delete")&&r.push({name:Globalize.translate("ButtonDelete"),id:"delete",ironIcon:"delete"}),-1!=t.indexOf("download")&&r.push({name:Globalize.translate("ButtonDownload"),id:"download",ironIcon:"file-download"}),-1!=t.indexOf("edit")&&r.push({name:Globalize.translate("ButtonEdit"),id:"edit",ironIcon:"mode-edit"}),-1!=t.indexOf("editimages")&&r.push({name:Globalize.translate("ButtonEditImages"),id:"editimages",ironIcon:"photo"}),-1!=t.indexOf("editsubtitles")&&r.push({name:Globalize.translate("ButtonEditSubtitles"),id:"editsubtitles",ironIcon:"closed-caption"}),-1!=t.indexOf("identify")&&r.push({name:Globalize.translate("ButtonIdentify"),id:"identify",ironIcon:"info"}),-1!=t.indexOf("refresh")&&r.push({name:Globalize.translate("ButtonRefresh"),id:"refresh",ironIcon:"refresh"}),-1!=t.indexOf("share")&&r.push({name:Globalize.translate("ButtonShare"),id:"share",ironIcon:"share"});var i=ApiClient.serverInfo().Id;require(["actionsheet"],function(t){t.show({items:r,positionTo:e,callback:function(e){switch(e){case"share":require(["sharingmanager"],function(e){e.showMenu({serverId:i,itemId:a})});break;case"addtocollection":require(["collectioneditor"],function(e){(new e).show([a])});break;case"playlist":require(["playlistManager"],function(e){e.showPanel([a])});break;case"delete":LibraryBrowser.deleteItems([a]);break;case"download":require(["fileDownloader"],function(e){var t=ApiClient.getUrl("Items/"+a+"/Download",{api_key:ApiClient.accessToken()});e.download([{url:t,itemId:a,serverId:i}])});break;case"edit":LibraryBrowser.editMetadata(a);break;case"editsubtitles":LibraryBrowser.editSubtitles(a);break;case"editimages":LibraryBrowser.editImages(a);break;case"identify":LibraryBrowser.identifyItem(a);break;case"refresh":ApiClient.refreshItem(a,{Recursive:!0,ImageRefreshMode:"FullRefresh",MetadataRefreshMode:"FullRefresh",ReplaceAllImages:!1,ReplaceAllMetadata:!0}),require(["toast"],function(e){e(Globalize.translate("MessageRefreshQueued"))})}}})})},identifyItem:function(e){require(["components/itemidentifier/itemidentifier"],function(a){a.show(e)})},getHref:function(e,a,t){var r=LibraryBrowser.getHrefInternal(e,a);return"tv"==a&&(t||(t=LibraryMenu.getTopParentId()),t&&(r+=-1==r.indexOf("?")?"?topParentId=":"&topParentId=",r+=t)),r},getHrefInternal:function(e,a){if(!e)throw new Error("item cannot be null");if(e.url)return e.url;var t=e.Id||e.ItemId;if("livetv"==e.CollectionType)return"livetv.html";if("channels"==e.CollectionType)return"channels.html";if("folders"!=a){if("movies"==e.CollectionType)return"movies.html?topParentId="+e.Id;if("boxsets"==e.CollectionType)return"collections.html?topParentId="+e.Id;if("tvshows"==e.CollectionType)return"tv.html?topParentId="+e.Id;if("music"==e.CollectionType)return"music.html?topParentId="+e.Id;if("games"==e.CollectionType)return"gamesrecommended.html?topParentId="+e.Id;if("playlists"==e.CollectionType)return"playlists.html?topParentId="+e.Id;if("photos"==e.CollectionType)return"photos.html?topParentId="+e.Id}else if(e.IsFolder)return t?"itemlist.html?parentId="+t:"#";if("CollectionFolder"==e.Type)return"itemlist.html?topParentId="+e.Id+"&parentId="+e.Id;if("PhotoAlbum"==e.Type)return"itemlist.html?context=photos&parentId="+t;if("Playlist"==e.Type)return"itemdetails.html?id="+t;if("TvChannel"==e.Type)return"itemdetails.html?id="+t;if("Channel"==e.Type)return"channelitems.html?id="+t;if(e.IsFolder&&"Channel"==e.SourceType||"ChannelFolderItem"==e.Type)return"channelitems.html?id="+e.ChannelId+"&folderId="+e.Id;if("Program"==e.Type)return"itemdetails.html?id="+t;if("BoxSet"==e.Type)return"itemdetails.html?id="+t;if("MusicAlbum"==e.Type)return"itemdetails.html?id="+t;if("GameSystem"==e.Type)return"itemdetails.html?id="+t;if("Genre"==e.Type)return"itemdetails.html?id="+t;if("MusicGenre"==e.Type)return"itemdetails.html?id="+t;if("GameGenre"==e.Type)return"itemdetails.html?id="+t;if("Studio"==e.Type)return"itemdetails.html?id="+t;if("Person"==e.Type)return"itemdetails.html?id="+t;if("Recording"==e.Type)return"itemdetails.html?id="+t;if("MusicArtist"==e.Type)return"itemdetails.html?id="+t;var r=a?"&context="+a:"";return"Series"==e.Type||"Season"==e.Type||"Episode"==e.Type?"itemdetails.html?id="+t+r:e.IsFolder?t?"itemlist.html?parentId="+t:"#":"itemdetails.html?id="+t},getImageUrl:function(e,a,t,r){return r=r||{},r.type=a,r.index=t,r.tag="Backdrop"==a?e.BackdropImageTags[t]:"Screenshot"==a?e.ScreenshotImageTags[t]:"Primary"==a?e.PrimaryImageTag||e.ImageTags[a]:e.ImageTags[a],ApiClient.getScaledImageUrl(e.Id||e.ItemId,r)},getListViewIndex:function(e,a){if("disc"==a.index)return null==e.ParentIndexNumber?"":Globalize.translate("ValueDiscNumber",e.ParentIndexNumber);var t,r,i=(a.sortBy||"").toLowerCase();return 0==i.indexOf("sortname")?"Episode"==e.Type?"":(r=(e.SortName||e.Name||"?")[0].toUpperCase(),t=r.charCodeAt(0),65>t||t>90?"#":r.toUpperCase()):0==i.indexOf("officialrating")?e.OfficialRating||Globalize.translate("HeaderUnrated"):0==i.indexOf("communityrating")?null==e.CommunityRating?Globalize.translate("HeaderUnrated"):Math.floor(e.CommunityRating):0==i.indexOf("criticrating")?null==e.CriticRating?Globalize.translate("HeaderUnrated"):Math.floor(e.CriticRating):0==i.indexOf("metascore")?null==e.Metascore?Globalize.translate("HeaderUnrated"):Math.floor(e.Metascore):0==i.indexOf("albumartist")&&e.AlbumArtist?(r=e.AlbumArtist[0].toUpperCase(),t=r.charCodeAt(0),65>t||t>90?"#":r.toUpperCase()):""},getUserDataCssClass:function(e){return e?"libraryItemUserData"+e.replace(new RegExp(" ","g"),""):""},getListViewHtml:function(e){require(["paper-icon-item","paper-item-body"]);var a="";e.title&&(a+="<h1>",a+=e.title,a+="</h1>"),a+='<div class="paperList itemsListview">';var t=0,r="";return a+=e.items.map(function(i){var n="";if(e.showIndex!==!1){var s=LibraryBrowser.getListViewIndex(i,e);s!=r&&(a+="</div>",n+=0==t?"<h1>":'<h1 style="margin-top:2em;">',n+=s,n+="</h1>",n+='<div class="paperList itemsListview">',r=s)}var o=LibraryBrowser.getItemDataAttributes(i,e,t),l="listItem",d=LibraryBrowser.getHref(i,e.context);n+='<paper-icon-item class="'+l+'"'+o+' data-itemid="'+i.Id+'" data-playlistitemid="'+(i.PlaylistItemId||"")+'" data-href="'+d+'" data-icon="false">';var u,m=e.smallIcon?70:80,c="Episode"==i.Type||"Game"==i.Type||e.smallIcon?2:1.5;i.ImageTags.Primary?u=ApiClient.getScaledImageUrl(i.Id,{maxWidth:m,tag:i.ImageTags.Primary,type:"Primary",index:0,minScale:c}):i.AlbumId&&i.AlbumPrimaryImageTag?u=ApiClient.getScaledImageUrl(i.AlbumId,{type:"Primary",maxWidth:m,tag:i.AlbumPrimaryImageTag,minScale:c}):i.AlbumId&&i.SeriesPrimaryImageTag?u=ApiClient.getScaledImageUrl(i.SeriesId,{type:"Primary",maxWidth:m,tag:i.SeriesPrimaryImageTag,minScale:c}):i.ParentPrimaryImageTag&&(u=ApiClient.getImageUrl(i.ParentPrimaryImageItemId,{type:"Primary",maxWidth:m,tag:i.ParentPrimaryImageTag,minScale:c})),n+=u?e.smallIcon?'<div class="listviewImage lazy small" data-src="'+u+'" item-icon></div>':'<div class="listviewImage lazy" data-src="'+u+'" item-icon></div>':e.smallIcon?'<div class="listviewImage small" item-icon></div>':'<div class="listviewImage" item-icon></div>';var p=[];"Episode"==i.Type?p.push(i.SeriesName||"&nbsp;"):"MusicAlbum"==i.Type&&p.push(i.AlbumArtist||"&nbsp;");var g=LibraryBrowser.getPosterViewDisplayName(i);e.showIndexNumber&&null!=i.IndexNumber&&(g=i.IndexNumber+". "+g),p.push(g),"Audio"==i.Type&&p.push(i.ArtistItems.map(function(e){return e.Name}).join(", ")||"&nbsp;"),"Game"==i.Type?p.push(i.GameSystem||"&nbsp;"):"MusicGenre"==i.Type?p.push("&nbsp;"):"MusicArtist"==i.Type?p.push("&nbsp;"):"TvChannel"==i.Type?i.CurrentProgram&&p.push(LibraryBrowser.getPosterViewDisplayName(i.CurrentProgram)):p.push(LibraryBrowser.getMiscInfoHtml(i)),n+=p.length>2?"<paper-item-body three-line>":"<paper-item-body two-line>";var h=e.defaultAction;("play"==h||"playallfromhere"==h)&&"Full"!=i.PlayAccess&&(h=null);var b=h?' data-action="'+h+'" class="itemWithAction mediaItem clearLink"':' class="mediaItem clearLink"';n+="<a"+b+' href="'+d+'">';for(var y=0,I=p.length;I>y;y++)n+=0==y?"<div>":"<div secondary>",n+=p[y]||"&nbsp;",n+="</div>";return n+="</a>",n+="</paper-item-body>",n+='<paper-icon-button icon="'+AppInfo.moreIcon+'" class="listviewMenuButton"></paper-icon-button>',n+='<span class="listViewUserDataButtons">',n+=LibraryBrowser.getUserDataIconsHtml(i),n+="</span>",n+="</paper-icon-item>",t++,n}).join(""),a+="</div>"},getItemDataAttributesList:function(e,a,t){var r=[],i=LibraryBrowser.getItemCommands(e,a);return r.push({name:"itemid",value:e.Id}),r.push({name:"commands",value:i.join(",")}),a.context&&r.push({name:"context",value:a.context||""}),e.IsFolder&&r.push({name:"isfolder",value:e.IsFolder}),r.push({name:"itemtype",value:e.Type}),e.MediaType&&r.push({name:"mediatype",value:e.MediaType||""}),e.UserData.PlaybackPositionTicks&&r.push({name:"positionticks",value:e.UserData.PlaybackPositionTicks||0}),r.push({name:"playaccess",value:e.PlayAccess||""}),r.push({name:"locationtype",value:e.LocationType||""}),r.push({name:"index",value:t}),e.AlbumId&&r.push({name:"albumid",value:e.AlbumId}),e.ChannelId&&r.push({name:"channelid",value:e.ChannelId}),e.ArtistItems&&e.ArtistItems.length&&r.push({name:"artistid",value:e.ArtistItems[0].Id}),r},getItemDataAttributes:function(e,a,t){var r=LibraryBrowser.getItemDataAttributesList(e,a,t).map(function(e){return"data-"+e.name+'="'+e.value+'"'}),i=r.join(" ");return i&&(i=" "+i),i},supportsAddingToCollection:function(e){var a=["Person","Genre","MusicGenre","Studio","GameGenre","BoxSet","Playlist","UserView","CollectionFolder","Audio","Episode","TvChannel","Program","MusicAlbum"];return!e.CollectionType&&-1==a.indexOf(e.Type)&&"Photo"!=e.MediaType},enableSync:function(e,a){return AppInfo.isNativeApp&&!Dashboard.capabilities().SupportsSync?!1:a&&!a.Policy.EnableSync?!1:e.SupportsSync},getItemCommands:function(a,t){var r=[];return LibraryBrowser.supportsEditing(a.Type)&&r.push("edit"),a.LocalTrailerCount&&r.push("trailer"),("Audio"==a.MediaType||"MusicAlbum"==a.Type||"MusicArtist"==a.Type||"MusicGenre"==a.Type||"music"==a.CollectionType)&&r.push("instantmix"),(a.IsFolder||"MusicArtist"==a.Type||"MusicGenre"==a.Type)&&r.push("shuffle"),e.supportsPlaylists(a)&&r.push(t.showRemoveFromPlaylist?"removefromplaylist":"playlist"),t.showAddToCollection!==!1&&LibraryBrowser.supportsAddingToCollection(a)&&r.push("addtocollection"),t.showRemoveFromCollection&&r.push("removefromcollection"),t.playFromHere&&(r.push("playfromhere"),r.push("queuefromhere")),a.CanDelete&&r.push("delete"),LibraryBrowser.enableSync(a)&&r.push("sync"),"Program"!=a.Type||a.TimerId||a.SeriesTimerId||r.push("record"),"Video"==a.MediaType&&"TvChannel"!=a.Type&&"Program"!=a.Type&&"Virtual"!=a.LocationType&&r.push("editsubtitles"),r.push("editimages"),r},shapes:["square","portrait","banner","smallBackdrop","homePageSmallBackdrop","backdrop","overflowBackdrop","overflowPortrait","overflowSquare"],getPostersPerRow:function(e){function a(a){switch(a){case"portrait":return e>=2200?10:e>=2100?9:e>=1600?8:e>=1400?7:e>=1200?6:e>=800?5:e>=640?4:3;case"square":return e>=2100?9:e>=1800?8:e>=1400?7:e>=1200?6:e>=900?5:e>=700?4:e>=500?3:2;case"banner":return e>=2200?4:e>=1200?3:e>=800?2:1;case"backdrop":return e>=2500?6:e>=2100?5:e>=1200?4:e>=770?3:e>=420?2:1}var r=i('<div class="card '+a+'Card"><div class="cardBox"><div class="cardImage"></div></div></div>').appendTo(s.body),n=i(".cardImage",r).innerWidth();(!n||isNaN(n))&&(t=!1,n=Math.min(400,e/2));var o=e/n;return r.remove(),Math.floor(o)}for(var t=!0,r={},n=0,o=LibraryBrowser.shapes.length;o>n;n++){var l=LibraryBrowser.shapes[n];r[l]=a(l)}return r.cache=t,r},posterSizes:[],getPosterViewInfo:function(){for(var e=n.innerWidth,a=LibraryBrowser.posterSizes,t=0,r=a.length;r>t;t++)if(a[t].screenWidth==e)return a[t];var i=LibraryBrowser.getPosterViewInfoInternal(e);return i.screenWidth=e,i.cache&&a.push(i),i},getPosterViewInfoInternal:function(e){var a=LibraryBrowser.getPostersPerRow(e),t={};t.screenWidth=e,AppInfo.hasLowImageBandwidth?AppInfo.isNativeApp||(e*=.7):e*=1.2;for(var r=100,i=0,n=LibraryBrowser.shapes.length;n>i;i++){var s=LibraryBrowser.shapes[i],o=e/a[s];browserInfo.mobile||(o=Math.round(o/r)*r),t[s+"Width"]=Math.round(o)}return t.cache=a.cache,t},setPosterViewData:function(e){var a=e.items;e.shape=e.shape||"portrait";var t=LibraryBrowser.getAveragePrimaryImageAspectRatio(a),r=t&&Math.abs(t-1.777777778)<.3,i=t&&Math.abs(t-1)<.33||t&&Math.abs(t-1.3333334)<.01;("auto"==e.shape||"autohome"==e.shape)&&(r?e.shape="auto"==e.shape?"backdrop":"backdrop":i?(e.coverImage=!0,e.shape="square"):t&&t>1.9?(e.shape="banner",e.coverImage=!0):e.shape=t&&Math.abs(t-.6666667)<.2?"auto"==e.shape?"portrait":"portrait":e.defaultShape||("auto"==e.shape?"square":"square"));var n=LibraryBrowser.getPosterViewInfo(),s=n.backdropWidth,o=n.portraitWidth,l=n.squareWidth,u=n.bannerWidth;r?o=s:i&&(o=l),"overflowBackdrop"==e.shape?s=n.overflowBackdropWidth:"overflowPortrait"==e.shape?o=n.overflowPortraitWidth:"overflowSquare"==e.shape?l=n.overflowSquareWidth:"smallBackdrop"==e.shape?s=n.smallBackdropWidth:"homePageSmallBackdrop"==e.shape?(s=n.homePageSmallBackdropWidth,o=n.homePageSmallBackdropWidth):"detailPagePortrait"==e.shape?o=200:"detailPageSquare"==e.shape?(o=240,l=240):"detailPage169"==e.shape&&(o=320,s=320),e.uiAspect=d(e.shape),e.primaryImageAspectRatio=t,e.posterWidth=o,e.thumbWidth=s,e.bannerWidth=u,e.squareSize=l},getPosterViewHtml:function(e){LibraryBrowser.setPosterViewData(e);var a,t=e.items;e.shape=e.shape||"portrait";for(var r,i,n="",s=e.thumbWidth,o=e.posterWidth,l=e.squareSize,d=e.bannerWidth,u=e.uiAspect,m=0,c=t.length;c>m;m++){var p=t[m];if(i=null,r=LibraryBrowser.getAveragePrimaryImageAspectRatio([p]),e.showStartDateIndex){if(p.StartDate)try{i=LibraryBrowser.getFutureDateText(parseISO8601Date(p.StartDate,{toLocal:!0}),!0)}catch(g){}var h=i||Globalize.translate("HeaderUnknownDate");h!=a&&(n+='<h1 class="timelineHeader" style="text-align:center;">'+h+"</h1>",a=h)}else if(e.timeline){var b=p.ProductionYear||Globalize.translate("HeaderUnknownYear");b!=a&&(n+='<h1 class="timelineHeader">'+b+"</h1>",a=b)}n+=LibraryBrowser.getPosterViewItemHtml(p,m,e,r,s,o,l,d,u)}return n},getPosterViewItemHtml:function(e,a,t,r,i,n,s,o,l){var d,u="",m=null,c=null,p=null,g=!1,h=t.enableImageEnhancers!==!1,b="card";t.fullWidthOnMobile&&(b+=" fullWidthCardOnMobile");var y="auto"==t.showTitle?!0:t.showTitle;"PhotoAlbum"==e.Type&&(y=!0);var I=t.coverImage;t.autoThumb&&e.ImageTags&&e.ImageTags.Primary&&e.PrimaryImageAspectRatio&&e.PrimaryImageAspectRatio>=1.34?(c=n,p=r?Math.round(n/r):null,m=ApiClient.getImageUrl(e.Id,{type:"Primary",maxHeight:p,maxWidth:c,tag:e.ImageTags.Primary,enableImageEnhancers:h}),r&&l&&Math.abs(r-l)<=.2&&(I=!0)):t.autoThumb&&e.ImageTags&&e.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(e.Id,{type:"Thumb",maxWidth:i,tag:e.ImageTags.Thumb,enableImageEnhancers:h}):t.preferBackdrop&&e.BackdropImageTags&&e.BackdropImageTags.length?m=ApiClient.getScaledImageUrl(e.Id,{type:"Backdrop",maxWidth:i,tag:e.BackdropImageTags[0],enableImageEnhancers:h}):t.preferThumb&&e.ImageTags&&e.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(e.Id,{type:"Thumb",maxWidth:i,tag:e.ImageTags.Thumb,enableImageEnhancers:h}):t.preferBanner&&e.ImageTags&&e.ImageTags.Banner?m=ApiClient.getScaledImageUrl(e.Id,{type:"Banner",maxWidth:o,tag:e.ImageTags.Banner,enableImageEnhancers:h}):t.preferThumb&&e.SeriesThumbImageTag&&t.inheritThumb!==!1?m=ApiClient.getScaledImageUrl(e.SeriesId,{type:"Thumb",maxWidth:i,tag:e.SeriesThumbImageTag,enableImageEnhancers:h}):t.preferThumb&&e.ParentThumbItemId&&t.inheritThumb!==!1?m=ApiClient.getThumbImageUrl(e.ParentThumbItemId,{type:"Thumb",maxWidth:i,enableImageEnhancers:h}):t.preferThumb&&e.BackdropImageTags&&e.BackdropImageTags.length?(m=ApiClient.getScaledImageUrl(e.Id,{type:"Backdrop",maxWidth:i,tag:e.BackdropImageTags[0],enableImageEnhancers:h}),g=!0):e.ImageTags&&e.ImageTags.Primary?(c=n,p=r?Math.round(n/r):null,m=ApiClient.getImageUrl(e.Id,{type:"Primary",maxHeight:p,maxWidth:c,tag:e.ImageTags.Primary,enableImageEnhancers:h}),r&&l&&Math.abs(r-l)<=.2&&(I=!0)):e.ParentPrimaryImageTag?m=ApiClient.getImageUrl(e.ParentPrimaryImageItemId,{type:"Primary",maxWidth:n,tag:e.ParentPrimaryImageTag,enableImageEnhancers:h}):e.AlbumId&&e.AlbumPrimaryImageTag?(p=s,c=r?Math.round(p*r):null,m=ApiClient.getScaledImageUrl(e.AlbumId,{type:"Primary",maxHeight:p,maxWidth:c,tag:e.AlbumPrimaryImageTag,enableImageEnhancers:h}),r&&l&&Math.abs(r-l)<=.2&&(I=!0)):"Season"==e.Type&&e.ImageTags&&e.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(e.Id,{type:"Thumb",maxWidth:i,tag:e.ImageTags.Thumb,enableImageEnhancers:h}):e.BackdropImageTags&&e.BackdropImageTags.length?m=ApiClient.getScaledImageUrl(e.Id,{type:"Backdrop",maxWidth:i,tag:e.BackdropImageTags[0],enableImageEnhancers:h}):e.ImageTags&&e.ImageTags.Thumb?m=ApiClient.getScaledImageUrl(e.Id,{type:"Thumb",maxWidth:i,tag:e.ImageTags.Thumb,enableImageEnhancers:h}):e.SeriesThumbImageTag?m=ApiClient.getScaledImageUrl(e.SeriesId,{type:"Thumb",maxWidth:i,tag:e.SeriesThumbImageTag,enableImageEnhancers:h}):e.ParentThumbItemId?m=ApiClient.getThumbImageUrl(e,{type:"Thumb",maxWidth:i,enableImageEnhancers:h}):"Audio"==e.MediaType||"MusicAlbum"==e.Type||"MusicArtist"==e.Type?(e.Name&&y&&(d="library-music"),b+=" defaultBackground"):"Recording"==e.Type||"Program"==e.Type||"TvChannel"==e.Type?(e.Name&&y&&(d="folder-open"),b+=" defaultBackground"):"Video"==e.MediaType||"Season"==e.Type||"Series"==e.Type?(e.Name&&y&&(d="videocam"),b+=" defaultBackground"):"Person"==e.Type?(e.Name&&y&&(d="person"),b+=" defaultBackground"):(e.Name&&y&&(d="folder-open"),b+=" defaultBackground"),d=e.icon||d,b+=" "+t.shape+"Card";var f=e.MediaSourceCount||1,v=t.linkItem===!1?"#":LibraryBrowser.getHref(e,t.context);t.showChildCountIndicator&&e.ChildCount&&t.showLatestItemsPopup!==!1&&(b+=" groupedCard"),!y&&!t.showItemCounts||t.overlayText||(b+=" bottomPaddedCard");var T=LibraryBrowser.getItemDataAttributes(e,t,a),w=t.defaultAction;("play"==w||"playallfromhere"==w)&&"Full"!=e.PlayAccess&&(w=null);var P=w?' data-action="'+w+'"':"";u+="<div"+T+' class="'+b+'">';var C="";m&&!t.lazy&&(C+="background-image:url('"+m+"');");var S="cardImage";d&&(S+=" iconCardImage"),I&&(S+=" coveredCardImage",("Photo"==e.MediaType||"PhotoAlbum"==e.Type||"Folder"==e.Type||"Program"==e.Type||"Recording"==e.Type)&&(S+=" noScale")),t.centerImage&&(S+=" centeredCardImage");var L="";t.lazy&&m&&(S+=" lazy",L=' data-src="'+m+'"');var B="cardBox";t.cardLayout&&(B+=" visualCardBox"),u+='<div class="'+B+'">',u+='<div class="cardScalable">',u+='<div class="cardPadder"></div>';var A="cardContent";A+=" mediaItem",t.defaultAction&&(A+=" itemWithAction");var x=t.transition!==!1&&AppInfo.enableSectionTransitions?' data-transition="slide"':"",k=e.onclick?' onclick="'+e.onclick+'"':"";u+="<a"+k+x+' class="'+A+'" href="'+v+'"'+P+">",u+='<div class="'+S+'" style="'+C+'"'+L+">",d&&(u+='<iron-icon icon="'+d+'"></iron-icon>'),u+="</div>","Virtual"==e.LocationType||"Offline"==e.LocationType?t.showLocationTypeIndicator!==!1&&(u+=LibraryBrowser.getOfflineIndicatorHtml(e)):t.showUnplayedIndicator!==!1?u+=LibraryBrowser.getPlayedIndicatorHtml(e):t.showChildCountIndicator&&(u+=LibraryBrowser.getGroupCountIndicator(e)),u+=LibraryBrowser.getSyncIndicator(e),f>1&&(u+='<div class="mediaSourceIndicator">'+f+"</div>");var D=t.showProgress===!1||e.IsFolder?"":LibraryBrowser.getItemProgressBarHtml("Recording"==e.Type?e:e.UserData),M=!1;if(t.overlayText||g&&!y){var U=D?"cardFooter fullCardFooter":"cardFooter";u+=LibraryBrowser.getCardFooterText(e,t,y,m,g,U,D),M=!0}else D&&(u+='<div class="cardFooter fullCardFooter lightCardFooter">',u+="<div class='cardProgress cardText'>",u+=D,u+="</div>",u+="</div>",D="");return u+="</a>",!t.overlayPlayButton||e.IsPlaceHolder||"Virtual"==e.LocationType&&e.MediaType&&"Program"!=e.Type||"Person"==e.Type||(u+='<div class="cardOverlayButtonContainer"><paper-icon-button icon="play-arrow" class="cardOverlayPlayButton" onclick="return false;"></paper-icon-button></div>'),t.overlayMoreButton&&(u+='<div class="cardOverlayButtonContainer"><paper-icon-button icon="'+AppInfo.moreIcon+'" class="cardOverlayMoreButton" onclick="return false;"></paper-icon-button></div>'),u+="</div>",t.overlayText||M||(u+=LibraryBrowser.getCardFooterText(e,t,y,m,g,"cardFooter outerCardFooter",D)),u+="</div>",u+="</div>"},getCardFooterText:function(e,a,t,r,i,n,s){var o="";a.cardLayout&&(o+='<div class="cardButtonContainer">',o+='<paper-icon-button icon="'+AppInfo.moreIcon+'" class="listviewMenuButton btnCardOptions"></paper-icon-button>',o+="</div>");var d="auto"!=a.showTitle||e.IsFolder||"Photo"!=e.MediaType?LibraryBrowser.getPosterViewDisplayName(e,a.displayAsSpecial):"";
r||t||(o+="<div class='cardDefaultText'>",o+=l(d),o+="</div>");var u=a.centerText?"cardText cardTextCentered":"cardText",m=[];if(a.showParentTitle&&m.push(e.EpisodeTitle?e.Name:e.SeriesName||e.Album||e.AlbumArtist||e.GameSystem||""),(t||i)&&m.push(l(d)),a.showItemCounts){var c=LibraryBrowser.getItemCountsHtml(a,e);m.push(c)}if(a.textLines)for(var p=a.textLines(e),g=0,h=p.length;h>g;g++)m.push(p[g]);if(a.showSongCount){var b="";e.SongCount&&(b=1==e.SongCount?Globalize.translate("ValueOneSong"):Globalize.translate("ValueSongCount",e.SongCount)),m.push(b)}if(a.showPremiereDate)if(e.PremiereDate)try{m.push(LibraryBrowser.getPremiereDateText(e))}catch(y){m.push("")}else m.push("");if(a.showYear&&m.push(e.ProductionYear||""),a.showSeriesYear&&m.push("Continuing"==e.Status?Globalize.translate("ValueSeriesYearToPresent",e.ProductionYear||""):e.ProductionYear||""),a.showProgramAirInfo){var I=parseISO8601Date(e.StartDate,{toLocal:!0}),f=e.StartDate?I.toLocaleString():"";m.push(f||"&nbsp;"),m.push(e.ChannelName||"&nbsp;")}return o+=LibraryBrowser.getCardTextLines(m,u,!a.overlayText),a.overlayText&&s&&(o+="<div class='cardText cardProgress'>",o+=s,o+="</div>"),o&&(o='<div class="'+n+'">'+o,o+="</div>"),o},getListItemInfo:function(e){for(var a=e;!a.getAttribute("data-itemid");)a=a.parentNode;var t=a.getAttribute("data-itemid"),r=a.getAttribute("data-index"),i=a.getAttribute("data-mediatype");return{id:t,index:r,mediaType:i,context:a.getAttribute("data-context")}},getCardTextLines:function(e,a,t){var r,i,n="",s=0;for(r=0,i=e.length;i>r;r++){var o=e[r];o&&(n+="<div class='"+a+"'>",n+=o,n+="</div>",s++)}if(t)for(;i>s;)n+="<div class='"+a+"'>&nbsp;</div>",s++;return n},getFutureDateText:function(e){var a=[];a[0]=Globalize.translate("OptionSunday"),a[1]=Globalize.translate("OptionMonday"),a[2]=Globalize.translate("OptionTuesday"),a[3]=Globalize.translate("OptionWednesday"),a[4]=Globalize.translate("OptionThursday"),a[5]=Globalize.translate("OptionFriday"),a[6]=Globalize.translate("OptionSaturday");var t=a[e.getDay()];return e=e.toLocaleDateString(),-1==e.toLowerCase().indexOf(t.toLowerCase())?t+" "+e:e},getPremiereDateText:function(e,a){if(!a){var t="";return e.AirTime&&(t+=e.AirTime),e.SeriesStudio&&(t+=t?" on "+e.SeriesStudio:e.SeriesStudio),t}var r=LibraryBrowser.getFutureDateText(a);return e.AirTime&&(r+=" at "+e.AirTime),e.SeriesStudio&&(r+=" on "+e.SeriesStudio),r},getPosterViewDisplayName:function(e,a,t){if(!e)throw new Error("null item passed into getPosterViewDisplayName");var r=e.EpisodeTitle||e.Name||"";if("TvChannel"==e.Type)return e.Number?e.Number+" "+r:r;if(a&&"Episode"==e.Type&&0==e.ParentIndexNumber)r=Globalize.translate("ValueSpecialEpisodeName",r);else if("Episode"==e.Type&&null!=e.IndexNumber&&null!=e.ParentIndexNumber){var i=e.IndexNumber,n="E"+i;t!==!1&&(n="S"+e.ParentIndexNumber+", "+n),e.IndexNumberEnd&&(i=e.IndexNumberEnd,n+="-"+i),r=n+" - "+r}return r},getOfflineIndicatorHtml:function(e){if("Offline"==e.LocationType)return'<div class="posterRibbon offlinePosterRibbon">'+Globalize.translate("HeaderOffline")+"</div>";if("Episode"==e.Type){try{var a=parseISO8601Date(e.PremiereDate,{toLocal:!0});if(e.PremiereDate&&(new Date).getTime()<a.getTime())return'<div class="posterRibbon unairedPosterRibbon">'+Globalize.translate("HeaderUnaired")+"</div>"}catch(t){}return'<div class="posterRibbon missingPosterRibbon">'+Globalize.translate("HeaderMissing")+"</div>"}return""},getPlayedIndicatorHtml:function(e){if("Series"==e.Type||"Season"==e.Type||"BoxSet"==e.Type||"Video"==e.MediaType||"Game"==e.MediaType||"Book"==e.MediaType){if(e.UserData.UnplayedItemCount)return'<div class="playedIndicator">'+e.UserData.UnplayedItemCount+"</div>";if("TvChannel"!=e.Type&&(e.UserData.PlayedPercentage&&e.UserData.PlayedPercentage>=100||e.UserData&&e.UserData.Played))return'<div class="playedIndicator"><iron-icon icon="check"></iron-icon></div>'}return""},getGroupCountIndicator:function(e){return e.ChildCount?'<div class="playedIndicator">'+e.ChildCount+"</div>":""},getSyncIndicator:function(e){if("Synced"==e.SyncStatus)return'<div class="syncIndicator"><iron-icon icon="sync"></iron-icon></div>';var a=e.SyncPercent;return a?'<div class="syncIndicator"><iron-icon icon="sync"></iron-icon></div>':"Queued"==e.SyncStatus||"Converting"==e.SyncStatus||"ReadyToTransfer"==e.SyncStatus||"Transferring"==e.SyncStatus?'<div class="syncIndicator"><iron-icon icon="sync"></iron-icon></div>':""},getAveragePrimaryImageAspectRatio:function(e){for(var a=[],t=0,r=e.length;r>t;t++){var i=e[t].PrimaryImageAspectRatio||0;i&&(a[a.length]=i)}if(!a.length)return null;a.sort(function(e,a){return e-a});var n,s=Math.floor(a.length/2);return n=a.length%2?a[s]:(a[s-1]+a[s])/2,Math.abs(.66666666667-n)<=.15?.66666666667:Math.abs(1.777777778-n)<=.2?1.777777778:Math.abs(1-n)<=.15?1:Math.abs(1.33333333333-n)<=.15?1.33333333333:n},metroColors:["#6FBD45","#4BB3DD","#4164A5","#E12026","#800080","#E1B222","#008040","#0094FF","#FF00C7","#FF870F","#7F0037"],getRandomMetroColor:function(){var e=Math.floor(Math.random()*(LibraryBrowser.metroColors.length-1));return LibraryBrowser.metroColors[e]},getMetroColor:function(e){if(e){for(var a=String(e.substr(0,1).charCodeAt()),t=0,r=0;r<a.length;r++)t+=parseInt(a.charAt(r));var i=String(t).substr(-1);return LibraryBrowser.metroColors[i]}return LibraryBrowser.getRandomMetroColor()},renderName:function(e,a,t,r){var i=LibraryBrowser.getPosterViewDisplayName(e,!1,!1);Dashboard.setPageTitle(i),a.html(t?'<a class="detailPageParentLink" href="'+LibraryBrowser.getHref(e,r)+'">'+i+"</a>":i)},renderParentName:function(e,a,t){var r=[],i=t?"&context="+t:"";e.AlbumArtists?r.push(LibraryBrowser.getArtistLinksHtml(e.AlbumArtists,"detailPageParentLink")):e.ArtistItems&&e.ArtistItems.length&&"MusicVideo"==e.Type?r.push(LibraryBrowser.getArtistLinksHtml(e.ArtistItems,"detailPageParentLink")):e.SeriesName&&"Episode"==e.Type&&r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.SeriesId+i+'">'+e.SeriesName+"</a>"),e.SeriesName&&"Season"==e.Type?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.SeriesId+i+'">'+e.SeriesName+"</a>"):null!=e.ParentIndexNumber&&"Episode"==e.Type?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.SeasonId+i+'">'+e.SeasonName+"</a>"):e.Album&&"Audio"==e.Type&&(e.AlbumId||e.ParentId)?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+(e.AlbumId||e.ParentId)+i+'">'+e.Album+"</a>"):e.Album&&"MusicVideo"==e.Type&&e.AlbumId?r.push('<a class="detailPageParentLink" href="itemdetails.html?id='+e.AlbumId+i+'">'+e.Album+"</a>"):e.Album?r.push(e.Album):"Program"==e.Type&&e.EpisodeTitle&&r.push(e.Name),r.length?a.show().html(r.join(" - ")):a.hide()},renderLinks:function(e,a){var t=[];if(a.HomePageUrl&&t.push('<a class="textlink" href="'+a.HomePageUrl+'" target="_blank">'+Globalize.translate("ButtonWebsite")+"</a>"),a.ExternalUrls)for(var r=0,i=a.ExternalUrls.length;i>r;r++){var n=a.ExternalUrls[r];t.push('<a class="textlink" href="'+n.Url+'" target="_blank">'+n.Name+"</a>")}if(t.length){var s=t.join("&nbsp;&nbsp;/&nbsp;&nbsp;");s=Globalize.translate("ValueLinks",s),e.innerHTML=s,e.classList.remove("hide")}else e.classList.add("hide")},showLayoutMenu:function(e,a,t){var r=!0;t||(r=!1,t=e.getAttribute("data-layouts"),t=t?t.split(","):["List","Poster","PosterCard","Thumb","ThumbCard"]);var i=t.map(function(e){return{name:Globalize.translate("Option"+e),id:e,selected:a==e}});require(["actionsheet"],function(a){a.show({items:i,positionTo:e,callback:function(a){r?e.dispatchEvent(new CustomEvent("layoutchange",{detail:{viewStyle:a},bubbles:!0,cancelable:!1})):require(["jQuery"],function(t){t(e).trigger("layoutchange",[a])})}})})},getQueryPagingHtml:function(e){var a=e.startIndex,r=e.limit,i=e.totalRecordCount;if(r&&e.updatePageSizeSetting!==!1)try{t.setItem(e.pageSizeKey||c,r)}catch(n){}var s="",o=Math.min(a+r,i),l=i>20||i>r;if(s+='<div class="listPaging">',l){s+='<span style="vertical-align:middle;">';var d=i?a+1:0;s+=d+"-"+o+" of "+i,s+="</span>"}if((l||e.viewButton||e.filterButton||e.sortButton||e.addLayoutButton)&&(s+='<div style="display:inline-block;margin-left:10px;">',l&&(s+='<paper-icon-button class="btnPreviousPage" icon="arrow-back" '+(a?"":"disabled")+"></paper-icon-button>",s+='<paper-icon-button class="btnNextPage" icon="arrow-forward" '+(a+r>=i?"disabled":"")+"></paper-icon-button>"),e.addLayoutButton&&(s+='<paper-icon-button title="'+Globalize.translate("ButtonSelectView")+'" class="btnChangeLayout" data-layouts="'+(e.layouts||"")+'" onclick="LibraryBrowser.showLayoutMenu(this, \''+(e.currentLayout||"")+'\');" icon="view-comfy"></paper-icon-button>'),e.sortButton&&(s+='<paper-icon-button class="btnSort" title="'+Globalize.translate("ButtonSort")+'" icon="sort-by-alpha"></paper-icon-button>'),e.filterButton&&(s+='<paper-icon-button class="btnFilter" title="'+Globalize.translate("ButtonFilter")+'" icon="filter-list"></paper-icon-button>'),s+="</div>",l&&e.showLimit)){var u="selectPageSize",m=e.pageSizes||[20,50,100,200,300,400,500],p=m.map(function(e){return r==e?'<option value="'+e+'" selected="selected">'+e+"</option>":'<option value="'+e+'">'+e+"</option>"}).join("");s+='<div class="pageSizeContainer"><label class="labelPageSize" for="'+u+'">'+Globalize.translate("LabelLimit")+'</label><select style="width:auto;" class="selectPageSize" id="'+u+'" data-inline="true" data-mini="true">'+p+"</select></div>"}return s+="</div>"},showSortMenu:function(e){require(["dialogHelper","paper-radio-button","paper-radio-group"],function(a){var t=a.createDialog({removeOnClose:!0,modal:!1,entryAnimationDuration:160,exitAnimationDuration:200});t.classList.add("ui-body-a"),t.classList.add("background-theme-a");var r="";r+='<div style="margin:0;padding:1.25em 1.5em 1.5em;">',r+='<h2 style="margin:0 0 .5em;">',r+=Globalize.translate("HeaderSortBy"),r+="</h2>",r+='<paper-radio-group class="groupSortBy" selected="'+(e.query.SortBy||"").replace(",","_")+'">';for(var i=0,n=e.items.length;n>i;i++){var o=e.items[i];r+='<paper-radio-button class="menuSortBy" style="display:block;" data-id="'+o.id+'" name="'+o.id.replace(",","_")+'">'+o.name+"</paper-radio-button>"}r+="</paper-radio-group>",r+='<h2 style="margin: 1em 0 .5em;">',r+=Globalize.translate("HeaderSortOrder"),r+="</h2>",r+='<paper-radio-group class="groupSortOrder" selected="'+(e.query.SortOrder||"Ascending")+'">',r+='<paper-radio-button name="Ascending" style="display:block;"  class="menuSortOrder block">'+Globalize.translate("OptionAscending")+"</paper-radio-button>",r+='<paper-radio-button name="Descending" style="display:block;"  class="menuSortOrder block">'+Globalize.translate("OptionDescending")+"</paper-radio-button>",r+="</paper-radio-group>",r+="</div>",t.innerHTML=r,s.body.appendChild(t);var l=browserInfo.animate?0:100;setTimeout(function(){a.open(t)},l),t.querySelector(".groupSortBy").addEventListener("iron-select",function(){var a=this.selected.replace("_",","),t=e.query.SortBy!=a;e.query.SortBy=a,e.query.StartIndex=0,e.callback&&t&&e.callback()}),t.querySelector(".groupSortOrder").addEventListener("iron-select",function(){var a=this.selected,t=e.query.SortOrder!=a;e.query.SortOrder=a,e.query.StartIndex=0,e.callback&&t&&e.callback()})})},getRatingHtml:function(e){var a="";return e.CommunityRating&&(a+="<div class='starRating' title='"+e.CommunityRating+"'></div>",a+='<div class="starRatingValue">',a+=e.CommunityRating.toFixed(1),a+="</div>"),null!=e.CriticRating&&(a+=e.CriticRating>=60?'<div class="fresh rottentomatoesicon" title="Rotten Tomatoes"></div>':'<div class="rotten rottentomatoesicon" title="Rotten Tomatoes"></div>',a+='<div class="criticRating" title="Rotten Tomatoes">'+e.CriticRating+"%</div>"),a},getItemProgressBarHtml:function(e){if("Recording"==e.Type&&e.CompletionPercentage)return'<progress class="itemProgressBar recordingProgressBar" min="0" max="100" value="'+e.CompletionPercentage+'"></progress>';var a=e.PlayedPercentage;return a&&100>a?'<progress class="itemProgressBar" min="0" max="100" value="'+a+'"></progress>':null},getUserDataButtonHtml:function(e,a,t,r,i,n){var s="fab"==n?"paper-fab":"paper-icon-button";return"<"+s+' title="'+i+'" data-itemid="'+a+'" icon="'+r+'" class="'+t+'" onclick="LibraryBrowser.'+e+'(this);return false;"></'+s+">"},getUserDataIconsHtml:function(e,a,t){var r="",i=e.UserData||{},n=e.Id;if(a!==!1){var s=Globalize.translate("TooltipPlayed");("Video"==e.MediaType||"Series"==e.Type||"Season"==e.Type||"BoxSet"==e.Type||"Playlist"==e.Type)&&"TvChannel"!=e.Type&&(r+=i.Played?LibraryBrowser.getUserDataButtonHtml("markPlayed",n,"btnUserItemRating btnUserItemRatingOn","check",s,t):LibraryBrowser.getUserDataButtonHtml("markPlayed",n,"btnUserItemRating","check",s,t))}var o=Globalize.translate("TooltipLike"),l=Globalize.translate("TooltipDislike");"undefined"==typeof i.Likes?(r+=LibraryBrowser.getUserDataButtonHtml("markDislike",n,"btnUserItemRating","thumb-down",l,t),r+=LibraryBrowser.getUserDataButtonHtml("markLike",n,"btnUserItemRating","thumb-up",o,t)):i.Likes?(r+=LibraryBrowser.getUserDataButtonHtml("markDislike",n,"btnUserItemRating","thumb-down",l,t),r+=LibraryBrowser.getUserDataButtonHtml("markLike",n,"btnUserItemRating btnUserItemRatingOn","thumb-up",o,t)):(r+=LibraryBrowser.getUserDataButtonHtml("markDislike",n,"btnUserItemRating btnUserItemRatingOn","thumb-down",l,t),r+=LibraryBrowser.getUserDataButtonHtml("markLike",n,"btnUserItemRating","thumb-up",o,t));var d=Globalize.translate("TooltipFavorite");return r+=i.IsFavorite?LibraryBrowser.getUserDataButtonHtml("markFavorite",n,"btnUserItemRating btnUserItemRatingOn","favorite",d,t):LibraryBrowser.getUserDataButtonHtml("markFavorite",n,"btnUserItemRating","favorite",d,t)},markPlayed:function(e){var a=e.getAttribute("data-itemid"),t=!e.classList.contains("btnUserItemRatingOn");t?(ApiClient.markPlayed(Dashboard.getCurrentUserId(),a),e.classList.add("btnUserItemRatingOn")):(ApiClient.markUnplayed(Dashboard.getCurrentUserId(),a),e.classList.remove("btnUserItemRatingOn"))},markFavorite:function(e){require(["jQuery"],function(a){var t=e.getAttribute("data-itemid"),r=a(e),i=!r.hasClass("btnUserItemRatingOn");ApiClient.updateFavoriteStatus(Dashboard.getCurrentUserId(),t,i),i?r.addClass("btnUserItemRatingOn"):r.removeClass("btnUserItemRatingOn")})},markLike:function(e){require(["jQuery"],function(a){var t=e.getAttribute("data-itemid"),r=a(e);r.hasClass("btnUserItemRatingOn")?(ApiClient.clearUserItemRating(Dashboard.getCurrentUserId(),t),r.removeClass("btnUserItemRatingOn")):(ApiClient.updateUserItemRating(Dashboard.getCurrentUserId(),t,!0),r.addClass("btnUserItemRatingOn")),r.prev().removeClass("btnUserItemRatingOn")})},markDislike:function(e){require(["jQuery"],function(a){var t=e.getAttribute("data-itemid"),r=a(e);r.hasClass("btnUserItemRatingOn")?(ApiClient.clearUserItemRating(Dashboard.getCurrentUserId(),t),r.removeClass("btnUserItemRatingOn")):(ApiClient.updateUserItemRating(Dashboard.getCurrentUserId(),t,!1),r.addClass("btnUserItemRatingOn")),r.next().removeClass("btnUserItemRatingOn")})},renderDetailImage:function(e,a,t,r){var i=a.ImageTags||{};a.PrimaryImageTag&&(i.Primary=a.PrimaryImageTag);var n,s="",o="portrait",l=360,d=!1;r&&i.Thumb?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Thumb",maxHeight:l,tag:a.ImageTags.Thumb}),o="thumb"):i.Primary?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Primary",maxHeight:l,tag:a.ImageTags.Primary}),d=!0):a.BackdropImageTags&&a.BackdropImageTags.length?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Backdrop",maxHeight:l,tag:a.BackdropImageTags[0]}),o="thumb"):i.Thumb?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Thumb",maxHeight:l,tag:a.ImageTags.Thumb}),o="thumb"):i.Disc?(n=ApiClient.getScaledImageUrl(a.Id,{type:"Disc",maxHeight:l,tag:a.ImageTags.Disc}),o="square"):a.AlbumId&&a.AlbumPrimaryImageTag?(n=ApiClient.getScaledImageUrl(a.AlbumId,{type:"Primary",maxHeight:l,tag:a.AlbumPrimaryImageTag}),o="square"):"Audio"==a.MediaType||"MusicAlbum"==a.Type||"MusicGenre"==a.Type?(n="css/images/items/detail/audio.png",o="square"):"Game"==a.MediaType||"GameGenre"==a.Type?(n="css/images/items/detail/game.png",o="square"):"Person"==a.Type?(n="css/images/items/detail/person.png",o="square"):"Genre"==a.Type||"Studio"==a.Type?(n="css/images/items/detail/video.png",o="square"):"TvChannel"==a.Type?(n="css/images/items/detail/tv.png",o="square"):(n="css/images/items/detail/video.png",o="square"),s+='<div style="position:relative;">',t&&(s+="<a onclick='LibraryBrowser.editImages(\""+a.Id+"\");' class='itemDetailGalleryLink' href='#'>"),d&&a.PrimaryImageAspectRatio&&(a.PrimaryImageAspectRatio>=1.48?o="thumb":a.PrimaryImageAspectRatio>=.85&&a.PrimaryImageAspectRatio<=1.34&&(o="square")),s+="<img class='itemDetailImage lazy' src='css/images/empty.png' />",t&&(s+="</a>");var u=a.IsFolder||!a.UserData?"":LibraryBrowser.getItemProgressBarHtml("Recording"==a.Type?a:a.UserData);s+='<div class="detailImageProgressContainer">',u&&(s+=u),s+="</div>",s+="</div>",e.innerHTML=s,"thumb"==o?(e.classList.add("thumbDetailImageContainer"),e.classList.remove("portraitDetailImageContainer"),e.classList.remove("squareDetailImageContainer")):"square"==o?(e.classList.remove("thumbDetailImageContainer"),e.classList.remove("portraitDetailImageContainer"),e.classList.add("squareDetailImageContainer")):(e.classList.remove("thumbDetailImageContainer"),e.classList.add("portraitDetailImageContainer"),e.classList.remove("squareDetailImageContainer"));var m=e.querySelector("img");m.onload=function(){-1==m.src.indexOf("empty.png")&&m.classList.add("loaded")},ImageLoader.lazyImage(m,n)},refreshDetailImageUserData:function(e,a){var t=a.IsFolder||!a.UserData?"":LibraryBrowser.getItemProgressBarHtml("Recording"==a.Type?a:a.UserData),r=e.querySelector(".detailImageProgressContainer");r.innerHTML=t||""},getDisplayTime:function(e){if("string"===(typeof e).toString().toLowerCase())try{e=parseISO8601Date(e,{toLocal:!0})}catch(a){return e}var t,r=e.toLocaleTimeString().toLowerCase(),i=e.getHours(),n=e.getMinutes();if(-1!=r.indexOf("am")||-1!=r.indexOf("pm")){var s=i>11?"pm":"am";i=i%12||12,t=i,n&&(t+=":",10>n&&(t+="0"),t+=n),t+=s}else t=i+":",10>n&&(t+="0"),t+=n;return t},getMiscInfoHtml:function(e){var a,t,r=[];if(e.IsSeries&&!e.IsRepeat&&(require(["livetvcss"]),r.push('<span class="newTvProgram">'+Globalize.translate("AttributeNew")+"</span>")),e.IsLive&&r.push('<span class="liveTvProgram">'+Globalize.translate("AttributeLive")+"</span>"),e.ChannelId&&e.ChannelName&&("Program"==e.Type||"Recording"==e.Type)&&r.push('<a class="textlink" href="itemdetails.html?id='+e.ChannelId+'">'+e.ChannelName+"</a>"),("Episode"==e.Type||"Photo"==e.MediaType)&&e.PremiereDate)try{t=parseISO8601Date(e.PremiereDate,{toLocal:!0}),a=t.toLocaleDateString(),r.push(a)}catch(i){}if(e.StartDate)try{t=parseISO8601Date(e.StartDate,{toLocal:!0}),a=t.toLocaleDateString(),r.push(a),"Recording"!=e.Type&&(a=LibraryBrowser.getDisplayTime(t),r.push(a))}catch(i){}if(e.ProductionYear&&"Series"==e.Type)if("Continuing"==e.Status)r.push(Globalize.translate("ValueSeriesYearToPresent",e.ProductionYear));else if(e.ProductionYear){if(a=e.ProductionYear,e.EndDate)try{var n=parseISO8601Date(e.EndDate,{toLocal:!0}).getFullYear();n!=e.ProductionYear&&(a+="-"+parseISO8601Date(e.EndDate,{toLocal:!0}).getFullYear())}catch(i){}r.push(a)}if("Series"!=e.Type&&"Episode"!=e.Type&&"Photo"!=e.MediaType)if(e.ProductionYear)r.push(e.ProductionYear);else if(e.PremiereDate)try{a=parseISO8601Date(e.PremiereDate,{toLocal:!0}).getFullYear(),r.push(a)}catch(i){}var s;if(e.RunTimeTicks&&"Series"!=e.Type&&("Audio"==e.Type?r.push(Dashboard.getDisplayTime(e.RunTimeTicks)):(s=e.RunTimeTicks/6e8,s=s||1,r.push(Math.round(s)+"min"))),e.CumulativeRunTimeTicks&&"Series"!=e.Type&&"Season"!=e.Type&&r.push(Dashboard.getDisplayTime(e.CumulativeRunTimeTicks)),e.OfficialRating&&"Season"!==e.Type&&"Episode"!==e.Type&&r.push(e.OfficialRating),e.IsHD&&r.push(Globalize.translate("LabelHDProgram")),e.Video3DFormat&&r.push("3D"),"Photo"==e.MediaType&&e.Width&&e.Height&&r.push(e.Width+"x"+e.Height),e.SeriesTimerId){var o="";o+='<a href="livetvseriestimer.html?id='+e.SeriesTimerId+'" title="'+Globalize.translate("ButtonViewSeriesRecording")+'">',o+='<div class="timerCircle seriesTimerCircle"></div>',o+='<div class="timerCircle seriesTimerCircle"></div>',o+='<div class="timerCircle seriesTimerCircle"></div>',o+="</a>",r.push(o),require(["livetvcss"])}else if(e.TimerId){var o="";o+='<a href="livetvtimer.html?id='+e.TimerId+'">',o+='<div class="timerCircle"></div>',o+="</a>",r.push(o),require(["livetvcss"])}return r.join("&nbsp;&nbsp;&nbsp;&nbsp;")},renderOverview:function(e,a){for(var t=0,r=e.length;r>t;t++){var i=e[t],n=a.Overview||"";if(n){i.innerHTML=n,i.classList.remove("empty");for(var s=i.querySelectorAll("a"),o=0,l=s.length;l>o;o++)s[o].setAttribute("target","_blank")}else i.innerHTML="",i.classList.add("empty")}},renderStudios:function(e,a,t){if(a.Studios&&a.Studios.length&&"Series"!=a.Type){for(var r="",i=0,n=a.Studios.length;n>i;i++)i>0&&(r+="&nbsp;&nbsp;/&nbsp;&nbsp;"),r+=t?a.Studios[i].Name:'<a class="textlink" href="itemdetails.html?id='+a.Studios[i].Id+'">'+a.Studios[i].Name+"</a>";var s=a.Studios.length>1?"ValueStudios":"ValueStudio";r=Globalize.translate(s,r),e.show().html(r).trigger("create")}else e.hide()},renderGenres:function(e,a,t,r){for(var i="",n=a.Genres||[],s=0,o=n.length;o>s&&!(t&&s>=t);s++){s>0&&(i+="<span>&nbsp;&nbsp;/&nbsp;&nbsp;</span>");var l="Audio"==a.Type||"MusicArtist"==a.Type||"MusicAlbum"==a.Type?"musicgenre":"genre";"Game"==a.MediaType&&(l="gamegenre"),i+=r?n[s]:'<a class="textlink" href="itemdetails.html?'+l+"="+ApiClient.encodeName(n[s])+'">'+n[s]+"</a>"}e.html(i).trigger("create")},renderPremiereDate:function(e,a){if(a.PremiereDate)try{var t=parseISO8601Date(a.PremiereDate,{toLocal:!0}),r=(new Date).getTime()>t.getTime()?"ValuePremiered":"ValuePremieres";e.show().html(Globalize.translate(r,t.toLocaleDateString()))}catch(i){e.hide()}else e.hide()},renderAwardSummary:function(e,a){a.AwardSummary?e.show().html(Globalize.translate("ValueAwards",a.AwardSummary)):e.hide()},renderDetailPageBackdrop:function(e,a){var t,r=o.availWidth,i=!1,n=e.querySelector("#itemBackdrop");return a.BackdropImageTags&&a.BackdropImageTags.length?(t=ApiClient.getScaledImageUrl(a.Id,{type:"Backdrop",index:0,maxWidth:r,tag:a.BackdropImageTags[0]}),n.classList.add("noFade"),n.classList.remove("noBackdrop"),ImageLoader.lazyImage(n,t),i=!0):a.ParentBackdropItemId&&a.ParentBackdropImageTags&&a.ParentBackdropImageTags.length?(t=ApiClient.getScaledImageUrl(a.ParentBackdropItemId,{type:"Backdrop",index:0,tag:a.ParentBackdropImageTags[0],maxWidth:r}),n.classList.add("noFade"),n.classList.remove("noBackdrop"),ImageLoader.lazyImage(n,t),i=!0):(n.classList.add("noBackdrop"),n.style.backgroundImage=""),i}};return s.documentElement.classList.add(p.enableFullPaperTabs()?"fullPaperLibraryTabs":"basicPaperLibraryTabs"),p}(window,document,screen);return window.LibraryBrowser=n,n});