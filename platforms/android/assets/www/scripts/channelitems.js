!function(e){function t(){var e=a(),t=u[e];return t||(t=u[e]={query:{SortBy:"",SortOrder:"Ascending",Fields:"PrimaryImageAspectRatio,SyncInfo",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()}},LibraryBrowser.loadSavedQueryValues(e,t.query)),t}function n(){return t().query}function a(){return LibraryBrowser.getSavedQueryKey("movies")}function r(a){var r=getParameterByName("id");ApiClient.getJSON(ApiClient.getUrl("Channels/"+r+"/Features")).then(function(r){r.CanFilter?e(".filterControls",a).show():e(".filterControls",a).hide(),r.SupportsSortOrderToggle?e(".sortOrderToggle",a).show():e(".sortOrderToggle",a).hide();var o=r.MaxPageSize,l=n();o&&(l.Limit=Math.min(o,l.Limit||o)),t().sortFields=r.DefaultSortFields,i(a)})}function i(t){Dashboard.showLoadingMsg();var a=getParameterByName("id"),r=getParameterByName("folderId"),u=n();u.UserId=Dashboard.getCurrentUserId(),r?ApiClient.getItem(u.UserId,r).then(function(e){LibraryMenu.setTitle(e.Name)}):ApiClient.getItem(u.UserId,a).then(function(e){LibraryMenu.setTitle(e.Name)}),u.folderId=r,ApiClient.getJSON(ApiClient.getUrl("Channels/"+a+"/Items",u)).then(function(n){window.scrollTo(0,0);var a="",r=LibraryBrowser.getQueryPagingHtml({startIndex:u.StartIndex,limit:u.Limit,totalRecordCount:n.TotalRecordCount,showLimit:!1,updatePageSizeSetting:!1,sortButton:!0,filterButton:!0});t.querySelector(".listTopPaging").innerHTML=r,s(t),a=LibraryBrowser.getPosterViewHtml({items:n.Items,shape:"auto",defaultShape:"square",context:"channels",showTitle:!0,coverImage:!0,showYear:!0,lazy:!0,centerText:!0});var d=t.querySelector("#items");d.innerHTML=a+r,ImageLoader.lazyChildren(d),e(".btnNextPage",t).on("click",function(){u.StartIndex+=u.Limit,i(t)}),e(".btnPreviousPage",t).on("click",function(){u.StartIndex-=u.Limit,i(t)}),e(".btnFilter",t).on("click",function(){o(t)}),e(".btnSort",t).on("click",function(){l(t)}),Dashboard.hideLoadingMsg()},function(){Dashboard.hideLoadingMsg()})}function o(e){require(["components/filterdialog/filterdialog"],function(t){var a=new t({query:n()});Events.on(a,"filterchange",function(){i(e)}),a.show()})}function l(e){var a=t().sortFields,r=[];r.push({name:Globalize.translate("OptionDefaultSort"),id:""}),-1!=a.indexOf("Name")&&r.push({name:Globalize.translate("OptionNameSort"),id:"SortName"}),-1!=a.indexOf("CommunityRating")&&r.push({name:Globalize.translate("OptionCommunityRating"),id:"CommunityRating"}),-1!=a.indexOf("DateCreated")&&r.push({name:Globalize.translate("OptionDateAdded"),id:"DateCreated"}),-1!=a.indexOf("PlayCount")&&r.push({name:Globalize.translate("OptionPlayCount"),id:"PlayCount"}),-1!=a.indexOf("PremiereDate")&&r.push({name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate"}),-1!=a.indexOf("Runtime")&&r.push({name:Globalize.translate("OptionRuntime"),id:"Runtime"}),LibraryBrowser.showSortMenu({items:r,callback:function(){i(e)},query:n()})}function s(t){var a=n();e(".alphabetPicker",t).alphaValue(a.NameStartsWith)}var u={};pageIdOn("pageinit","channelItemsPage",function(){var t=this;e(".alphabetPicker",this).on("alphaselect",function(e,a){var r=n();r.NameStartsWithOrGreater=a,r.StartIndex=0,i(t)}).on("alphaclear",function(){var e=n();e.NameStartsWithOrGreater="",i(t)})}),pageIdOn("pagebeforeshow","channelItemsPage",function(){var e=this;r(e),s(e)})}(jQuery,document);