!function(e){function t(){var e=a(),t=o[e];return t||(t=o[e]={query:{SortBy:"SortName",SortOrder:"Ascending",Recursive:!0,Fields:"PrimaryImageAspectRatio,SortName,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()}},t.query.ParentId=LibraryMenu.getTopParentId(),LibraryBrowser.loadSavedQueryValues(e,t.query)),t.query}function a(){return LibraryBrowser.getSavedQueryKey("trailers")}function r(n,o){Dashboard.showLoadingMsg();var l=t();l.UserId=Dashboard.getCurrentUserId(),ApiClient.getJSON(ApiClient.getUrl("Trailers",l)).then(function(t){window.scrollTo(0,0),t.Items.length?e(".noItemsMessage",n).hide():e(".noItemsMessage",n).show();var s="",d=LibraryBrowser.getQueryPagingHtml({startIndex:l.StartIndex,limit:l.Limit,totalRecordCount:t.TotalRecordCount,viewButton:!0,viewIcon:"filter-list",sortButton:!0,showLimit:!1,viewPanelClass:"trailerViewPanel",updatePageSizeSetting:!1});n.querySelector(".listTopPaging").innerHTML=d,i(n,o),s=LibraryBrowser.getPosterViewHtml({items:t.Items,shape:"portrait",lazy:!0,showDetailsMenu:!0,overlayPlayButton:!0});var u=n.querySelector(".itemsContainer");u.innerHTML=s+d,ImageLoader.lazyChildren(u),e(".btnNextPage",n).on("click",function(){l.StartIndex+=l.Limit,r(n,o)}),e(".btnPreviousPage",n).on("click",function(){l.StartIndex-=l.Limit,r(n,o)}),e(".btnSort",n).on("click",function(){LibraryBrowser.showSortMenu({items:[{name:Globalize.translate("OptionNameSort"),id:"SortName"},{name:Globalize.translate("OptionImdbRating"),id:"CommunityRating,SortName"},{name:Globalize.translate("OptionDateAdded"),id:"DateCreated,SortName"},{name:Globalize.translate("OptionDatePlayed"),id:"DatePlayed,SortName"},{name:Globalize.translate("OptionParentalRating"),id:"OfficialRating,SortName"},{name:Globalize.translate("OptionPlayCount"),id:"PlayCount,SortName"},{name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate,SortName"}],callback:function(){r(n,o)},query:l})}),LibraryBrowser.saveQueryValues(a(),l),Dashboard.hideLoadingMsg()})}function i(a,r){var i=t();e(".chkStandardFilter",r).each(function(){var e=","+(i.Filters||""),t=this.getAttribute("data-filter");this.checked=-1!=e.indexOf(","+t)}),e(".alphabetPicker",a).alphaValue(i.NameStartsWithOrGreater)}function n(a,i,n){e(".chkStandardFilter",n).on("change",function(){var e=t(),a=this.getAttribute("data-filter"),o=e.Filters||"";o=(","+o).replace(","+a,"").substring(1),this.checked&&(o=o?o+","+a:a),e.StartIndex=0,e.Filters=o,r(i,n)}),e(".alphabetPicker",i).on("alphaselect",function(e,a){var o=t();o.NameStartsWithOrGreater=a,o.StartIndex=0,r(i,n)}).on("alphaclear",function(){var e=t();e.NameStartsWithOrGreater="",r(i,n)}),e(".itemsContainer",i).on("needsrefresh",function(){r(i,n)})}var o={};window.MoviesPage.initTrailerTab=function(e,t){var a=e.querySelector(".trailerViewPanel");n(e,t,a)},window.MoviesPage.renderTrailerTab=function(e,t){if(LibraryBrowser.needsRefresh(t)){var a=e.querySelector(".trailerViewPanel");r(t,a),i(t,a)}}}(jQuery,document);