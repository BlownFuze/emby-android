!function(e){function t(){var e=a(),t=l[e];return t||(t=l[e]={query:{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Movie",Recursive:!0,Fields:"PrimaryImageAspectRatio,SortName,MediaSourceCount,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()},view:LibraryBrowser.getSavedView(e)||LibraryBrowser.getDefaultItemsView("Poster","Poster")},t.query.ParentId=LibraryMenu.getTopParentId(),LibraryBrowser.loadSavedQueryValues(e,t.query)),t}function r(){return t().query}function a(){return LibraryBrowser.getSavedQueryKey("movies")}function i(o,s){Dashboard.showLoadingMsg();var l=Dashboard.getCurrentUserId(),d=r(),c=t().view;ApiClient.getItems(l,d).then(function(l){window.scrollTo(0,0);var u="",h=LibraryBrowser.getQueryPagingHtml({startIndex:d.StartIndex,limit:d.Limit,totalRecordCount:l.TotalRecordCount,viewButton:!0,showLimit:!1,viewPanelClass:"movieViewPanel",updatePageSizeSetting:!1,addLayoutButton:!0,viewIcon:"filter-list",sortButton:!0,currentLayout:c,layouts:"Banner,List,Poster,PosterCard,Thumb,ThumbCard,Timeline"});o.querySelector(".listTopPaging").innerHTML=h,n(o),"Thumb"==c?u=LibraryBrowser.getPosterViewHtml({items:l.Items,shape:"backdrop",preferThumb:!0,lazy:!0,showDetailsMenu:!0}):"ThumbCard"==c?u=LibraryBrowser.getPosterViewHtml({items:l.Items,shape:"backdrop",preferThumb:!0,lazy:!0,showTitle:!0,cardLayout:!0,showYear:!0,showDetailsMenu:!0}):"Banner"==c?u=LibraryBrowser.getPosterViewHtml({items:l.Items,shape:"banner",preferBanner:!0,lazy:!0,showDetailsMenu:!0}):"List"==c?u=LibraryBrowser.getListViewHtml({items:l.Items,sortBy:d.SortBy}):"Poster"==c?u=LibraryBrowser.getPosterViewHtml({items:l.Items,shape:"portrait",centerText:!0,lazy:!0,showDetailsMenu:!0}):"PosterCard"==c?u=LibraryBrowser.getPosterViewHtml({items:l.Items,shape:"portrait",showTitle:!0,showYear:!0,lazy:!0,cardLayout:!0,showDetailsMenu:!0}):"Timeline"==c&&(u=LibraryBrowser.getPosterViewHtml({items:l.Items,shape:"portrait",showTitle:!0,timeline:!0,centerText:!0,lazy:!0,showDetailsMenu:!0}));var m=o.querySelector(".itemsContainer");m.innerHTML=u+h,ImageLoader.lazyChildren(m),e(".btnNextPage",o).on("click",function(){d.StartIndex+=d.Limit,i(o,s)}),e(".btnPreviousPage",o).on("click",function(){d.StartIndex-=d.Limit,i(o,s)}),e(".btnChangeLayout",o).on("layoutchange",function(e,n){"Timeline"==n&&(r().SortBy="ProductionYear,PremiereDate,SortName",r().SortOrder="Descending"),t().view=n,LibraryBrowser.saveViewSetting(a(),n),i(o,s)}),e(".btnSort",o).on("click",function(){LibraryBrowser.showSortMenu({items:[{name:Globalize.translate("OptionNameSort"),id:"SortName"},{name:Globalize.translate("OptionBudget"),id:"Budget,SortName"},{name:Globalize.translate("OptionImdbRating"),id:"CommunityRating,SortName"},{name:Globalize.translate("OptionCriticRating"),id:"CriticRating,SortName"},{name:Globalize.translate("OptionDateAdded"),id:"DateCreated,SortName"},{name:Globalize.translate("OptionDatePlayed"),id:"DatePlayed,SortName"},{name:Globalize.translate("OptionMetascore"),id:"Metascore,SortName"},{name:Globalize.translate("OptionParentalRating"),id:"OfficialRating,SortName"},{name:Globalize.translate("OptionPlayCount"),id:"PlayCount,SortName"},{name:Globalize.translate("OptionReleaseDate"),id:"PremiereDate,SortName"},{name:Globalize.translate("OptionRevenue"),id:"Revenue,SortName"},{name:Globalize.translate("OptionRuntime"),id:"Runtime,SortName"},{name:Globalize.translate("OptionVideoBitrate"),id:"VideoBitRate,SortName"}],callback:function(){i(o,s)},query:d})}),LibraryBrowser.saveQueryValues(a(),d),LibraryBrowser.setLastRefreshed(o),Dashboard.hideLoadingMsg()})}function n(t,a){var i=r();e(".chkStandardFilter",a).each(function(){var e=","+(i.Filters||""),t=this.getAttribute("data-filter");this.checked=-1!=e.indexOf(","+t)}),e(".chkVideoTypeFilter",a).each(function(){var e=","+(i.VideoTypes||""),t=this.getAttribute("data-filter");this.checked=-1!=e.indexOf(","+t)}),e(".chk3DFilter",a).checked(1==i.Is3D),e(".chkHDFilter",a).checked(1==i.IsHD),e(".chkSDFilter",a).checked(0==i.IsHD),e(".alphabetPicker",t).alphaValue(i.NameStartsWithOrGreater)}function o(e,a){if(!t().filtersLoaded){t().filtersLoaded=!0;var n=r();QueryFilters.loadFilters(a,Dashboard.getCurrentUserId(),n,function(){i(e,a)})}}function s(t,a){e(a).on("panelopen",function(){o(t,a)}),e(".chkStandardFilter",a).on("change",function(){var e=r(),n=this.getAttribute("data-filter"),o=e.Filters||"";o=(","+o).replace(","+n,"").substring(1),this.checked&&(o=o?o+","+n:n),e.StartIndex=0,e.Filters=o,i(t,a)}),e(".chkVideoTypeFilter",a).on("change",function(){var e=r(),n=this.getAttribute("data-filter"),o=e.VideoTypes||"";o=(","+o).replace(","+n,"").substring(1),this.checked&&(o=o?o+","+n:n),e.StartIndex=0,e.VideoTypes=o,i(t,a)}),e(".chk3DFilter",a).on("change",function(){var e=r();e.StartIndex=0,e.Is3D=this.checked?!0:null,i(t,a)}),e(".chkHDFilter",a).on("change",function(){var e=r();e.StartIndex=0,e.IsHD=this.checked?!0:null,i(t,a)}),e(".chkSDFilter",a).on("change",function(){var e=r();e.StartIndex=0,e.IsHD=this.checked?!1:null,i(t,a)}),e(".alphabetPicker",t).on("alphaselect",function(e,n){var o=r();o.NameStartsWithOrGreater=n,o.StartIndex=0,i(t,a)}).on("alphaclear",function(){var e=r();e.NameStartsWithOrGreater="",i(t,a)}),e(".radioBasicFilters",a).on("change",function(){this.checked?(e(".basicFilters",a).show(),e(".advancedFilters",a).hide()):e(".basicFilters",a).hide()}),e(".radioAdvancedFilters",a).on("change",function(){this.checked?(e(".advancedFilters",a).show(),e(".basicFilters",a).hide()):e(".advancedFilters",a).hide()}),e(".itemsContainer",t).on("needsrefresh",function(){i(t,a)})}var l={};window.MoviesPage.initMoviesTab=function(e,t){var r=e.querySelector(".movieViewPanel");s(t,r)},window.MoviesPage.renderMoviesTab=function(e,t){if(LibraryBrowser.needsRefresh(t)){var r=e.querySelector(".movieViewPanel");i(t,r),n(t,r)}}}(jQuery,document);