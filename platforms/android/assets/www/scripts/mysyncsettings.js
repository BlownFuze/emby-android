define(["appSettings"],function(e){function t(t){t.querySelector("#txtSyncPath").value=e.syncPath()||"",t.querySelector("#chkWifi").checked=e.syncOnlyOnWifi();var r=e.cameraUploadServers();t.querySelector(".uploadServerList").innerHTML=ConnectionManager.getSavedServers().map(function(e){var t=-1==r.indexOf(e.Id)?"":" checked",n='<label><input type="checkbox" is="emby-checkbox"'+t+' class="chkUploadServer" data-id="'+e.Id+'"/><span>'+e.Name+"</span></label>";return n}).join(""),Dashboard.hideLoadingMsg()}function r(t){var r=t.querySelector("#txtSyncPath").value;e.syncPath(r),e.syncOnlyOnWifi(t.querySelector("#chkWifi").checked);for(var n=t.querySelectorAll(".chkUploadServer"),a=[],i=0,c=n.length;c>i;i++)n[i].checked&&a.push(n[i].getAttribute("data-id"));e.cameraUploadServers(a),Dashboard.hideLoadingMsg(),require(["toast"],function(e){e(Globalize.translate("SettingsSaved"))}),(a.length||r)&&window.MainActivity&&MainActivity.authorizeStorage()}return function(e){e.querySelector("form").addEventListener("submit",function(t){Dashboard.showLoadingMsg();var n=getParameterByName("userId")||Dashboard.getCurrentUserId();return ApiClient.getUser(n).then(function(t){r(e,t)}),t.preventDefault(),!1}),e.querySelector("#btnSelectSyncPath").addEventListener("click",function(){require(["nativedirectorychooser"],function(){NativeDirectoryChooser.chooseDirectory().then(function(t){t&&(e.querySelector("#txtSyncPath").value=t)})})}),e.addEventListener("viewshow",function(){var e=this;Dashboard.showLoadingMsg();var r=getParameterByName("userId")||Dashboard.getCurrentUserId();ApiClient.getUser(r).then(function(r){t(e,r)}),AppInfo.supportsSyncPathSetting?e.querySelector(".fldSyncPath").classList.remove("hide"):e.querySelector(".fldSyncPath").classList.add("hide")})}});