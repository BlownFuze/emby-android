define(["jQuery"],function(e){function t(t,a,n){var o='<option value="" selected="selected"></option>';o+=n.map(function(e){return'<option value="'+e.Id+'">'+e.Name+"</option>"}).join(""),e("#selectUser",t).html(o).val(a.UserId||""),e("#selectReleaseDateFormat",t).val(a.ReleaseDateFormat),t.querySelector("#chkSaveImagePaths").checked=a.SaveImagePathsInNfo,t.querySelector("#chkEnablePathSubstitution").checked=a.EnablePathSubstitution,t.querySelector("#chkEnableExtraThumbs").checked=a.EnableExtraThumbsDuplication,Dashboard.hideLoadingMsg()}function a(){Dashboard.showLoadingMsg();var t=this;return ApiClient.getNamedConfiguration(n).then(function(a){a.UserId=e("#selectUser",t).val()||null,a.ReleaseDateFormat=e("#selectReleaseDateFormat",t).val(),a.SaveImagePathsInNfo=t.querySelector("#chkSaveImagePaths").checked,a.EnablePathSubstitution=t.querySelector("#chkEnablePathSubstitution").checked,a.EnableExtraThumbsDuplication=t.querySelector("#chkEnableExtraThumbs").checked,ApiClient.updateNamedConfiguration(n,a).then(Dashboard.processServerConfigurationUpdateResult)}),!1}var n="xbmcmetadata";e(document).on("pageinit","#metadataNfoPage",function(){e(".metadataNfoForm").off("submit",a).on("submit",a)}).on("pageshow","#metadataNfoPage",function(){Dashboard.showLoadingMsg();var e=this,a=ApiClient.getUsers(),o=ApiClient.getNamedConfiguration(n);Promise.all([a,o]).then(function(a){t(e,a[1],a[0])})})});