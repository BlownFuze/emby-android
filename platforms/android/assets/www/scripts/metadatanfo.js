!function(e,t){function a(t,a,o){var n='<option value="" selected="selected"></option>';n+=o.map(function(e){return'<option value="'+e.Id+'">'+e.Name+"</option>"}).join(""),e("#selectUser",t).html(n).val(a.UserId||""),e("#selectReleaseDateFormat",t).val(a.ReleaseDateFormat),t.querySelector("#chkSaveImagePaths").checked=a.SaveImagePathsInNfo,t.querySelector("#chkEnablePathSubstitution").checked=a.EnablePathSubstitution,t.querySelector("#chkEnableExtraThumbs").checked=a.EnableExtraThumbsDuplication,Dashboard.hideLoadingMsg()}function o(){Dashboard.showLoadingMsg();var t=this;return ApiClient.getNamedConfiguration(n).then(function(a){a.UserId=e("#selectUser",t).val()||null,a.ReleaseDateFormat=e("#selectReleaseDateFormat",t).val(),a.SaveImagePathsInNfo=t.querySelector("#chkSaveImagePaths").checked,a.EnablePathSubstitution=t.querySelector("#chkEnablePathSubstitution").checked,a.EnableExtraThumbsDuplication=t.querySelector("#chkEnableExtraThumbs").checked,ApiClient.updateNamedConfiguration(n,a).then(Dashboard.processServerConfigurationUpdateResult)}),!1}var n="xbmcmetadata";e(t).on("pageinit","#metadataNfoPage",function(){e(".metadataNfoForm").off("submit",o).on("submit",o)}).on("pageshow","#metadataNfoPage",function(){Dashboard.showLoadingMsg();var e=this,t=ApiClient.getUsers(),o=ApiClient.getNamedConfiguration(n);Promise.all([t,o]).then(function(t){a(e,t[1],t[0])})})}(jQuery,document,window);