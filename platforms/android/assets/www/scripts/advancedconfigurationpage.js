define(["jQuery"],function(e){function a(a,t,n){var o=n.OperatingSystem.toLowerCase();-1!=o.indexOf("windows")?e("#windowsStartupDescription",a).show():e("#windowsStartupDescription",a).hide(),n.SupportsAutoRunAtStartup?e("#fldRunAtStartup",a).show():e("#fldRunAtStartup",a).hide(),n.CanSelfUpdate?(e(".fldAutomaticUpdates",a).show(),e(".lnlAutomaticUpdateLevel",a).html(Globalize.translate("LabelAutomaticUpdateLevel"))):(e(".fldAutomaticUpdates",a).hide(),e(".lnlAutomaticUpdateLevel",a).html(Globalize.translate("LabelAutomaticUpdateLevelForPlugins"))),e("#chkEnableAutomaticServerUpdates",a).checked(t.EnableAutoUpdate),e("#chkEnableAutomaticRestart",a).checked(t.EnableAutomaticRestart),e("#chkUsageData",a).checked(t.EnableAnonymousUsageReporting),n.CanSelfRestart?e("#fldEnableAutomaticRestart",a).show():e("#fldEnableAutomaticRestart",a).hide(),e("#selectAutomaticUpdateLevel",a).val(t.SystemUpdateLevel).trigger("change"),e("#chkDebugLog",a).checked(t.EnableDebugLevelLogging),e("#chkRunAtStartup",a).checked(t.RunAtStartup),e("#chkEnableDashboardResponseCache",a).checked(t.EnableDashboardResponseCaching),e("#chkEnableMinification",a).checked(t.EnableDashboardResourceMinification),e("#txtDashboardSourcePath",a).val(t.DashboardSourcePath).trigger("change"),Dashboard.hideLoadingMsg()}function t(){Dashboard.showLoadingMsg();var a=this;return ApiClient.getServerConfiguration().then(function(t){t.EnableDebugLevelLogging=e("#chkDebugLog",a).checked(),t.RunAtStartup=e("#chkRunAtStartup",a).checked(),t.SystemUpdateLevel=e("#selectAutomaticUpdateLevel",a).val(),t.EnableAutomaticRestart=e("#chkEnableAutomaticRestart",a).checked(),t.EnableAutoUpdate=e("#chkEnableAutomaticServerUpdates",a).checked(),t.EnableAnonymousUsageReporting=e("#chkUsageData",a).checked(),t.EnableDashboardResourceMinification=e("#chkEnableMinification",a).checked(),t.EnableDashboardResponseCaching=e("#chkEnableDashboardResponseCache",a).checked(),t.DashboardSourcePath=e("#txtDashboardSourcePath",a).val(),ApiClient.updateServerConfiguration(t).then(Dashboard.processServerConfigurationUpdateResult)}),!1}e(document).on("pageshow","#advancedConfigurationPage",function(){Dashboard.showLoadingMsg();var e=this,t=ApiClient.getServerConfiguration(),n=ApiClient.getSystemInfo();Promise.all([t,n]).then(function(t){a(e,t[0],t[1])})}).on("pageinit","#advancedConfigurationPage",function(){var a=this;e("#selectAutomaticUpdateLevel",a).on("change",function(){"Dev"==this.value?e("#devBuildWarning",a).show():e("#devBuildWarning",a).hide()}),e("#btnSelectDashboardSourcePath",a).on("click.selectDirectory",function(){require(["directorybrowser"],function(t){var n=new t;n.show({callback:function(t){t&&e("#txtDashboardSourcePath",a).val(t),n.close()}})})}),e(".advancedConfigurationForm").off("submit",t).on("submit",t)})});