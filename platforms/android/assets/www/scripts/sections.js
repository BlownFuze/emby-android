!function(e){function a(a){var t=e.Deferred();return ApiClient.getUserViews({},a).then(function(a){for(var r=a.Items,i=[],n=0,s=r.length;s>n;n++){var l=r[n];if(!(AppInfo.isNativeApp&&browserInfo.safari&&"livetv"==l.CollectionType||(i.push(l),"livetv"!=l.CollectionType))){l.ImageTags={},l.icon="live-tv",l.onclick="LibraryBrowser.showTab('livetv.html', 0);event.preventDefault();event.stopPropagation();return false;";var o=e.extend({},l);o.Name=Globalize.translate("ButtonGuide"),o.ImageTags={},o.icon="dvr",o.url="livetv.html?tab=1",o.onclick="LibraryBrowser.showTab('livetv.html', 1);event.preventDefault();event.stopPropagation();return false;",i.push(o);var d=e.extend({},l);d.Name=Globalize.translate("ButtonRecordedTv"),d.ImageTags={},d.icon="video-library",d.url="livetv.html?tab=3",d.onclick="LibraryBrowser.showTab('livetv.html', 3);event.preventDefault();event.stopPropagation();return false;",i.push(d)}}t.resolveWith(null,[i])}),t.promise()}function t(){return browserInfo.mobile&&AppInfo.enableAppLayouts}function r(){return t()?"overflowBackdrop":"backdrop"}function i(){return t()?"overflowPortrait":"portrait"}function n(){return t()?"overflowSquare":"square"}function s(e){for(var a="",t=0,r=e.length;r>t;t++){var i,n=e[t],s="rgba(82, 181, 75, 0.9)";switch(n.CollectionType){case"movies":i="local-movies",s="rgba(176, 94, 81, 0.9)";break;case"music":i="library-music",s="rgba(217, 145, 67, 0.9)";break;case"photos":i="photo",s="rgba(127, 0, 0, 0.9)";break;case"livetv":i="live-tv",s="rgba(217, 145, 67, 0.9)";break;case"tvshows":i="live-tv",s="rgba(77, 88, 164, 0.9)";break;case"games":i="folder",s="rgba(183, 202, 72, 0.9)";break;case"trailers":i="local-movies",s="rgba(176, 94, 81, 0.9)";break;case"homevideos":i="video-library",s="rgba(110, 52, 32, 0.9)";break;case"musicvideos":i="video-library",s="rgba(143, 54, 168, 0.9)";break;case"books":i="folder";break;case"channels":i="folder",s="rgba(51, 136, 204, 0.9)";break;case"playlists":i="folder";break;default:i="folder"}var l="card smallBackdropCard buttonCard";n.CollectionType&&(l+=" "+n.CollectionType+"buttonCard");var o=n.url||LibraryBrowser.getHref(n),d=n.onclick?' onclick="'+n.onclick+'"':"";i=n.icon||i,a+="<a"+d+' data-itemid="'+n.Id+'" class="'+l+'" href="'+o+'">',a+='<div class="cardBox" style="background-color:'+s+';margin:4px;border-radius:4px;">',a+="<div class='cardText' style='padding:8px 10px;color:#fff;font-size:14px;'>",a+='<iron-icon icon="'+i+'"></iron-icon>',a+='<span style="margin-left:.7em;">'+n.Name+"</span>",a+="</div>",a+="</div>",a+="</a>"}return a}function l(e,t,r){return a(t).then(function(a){var t="<br/>";r&&(t+='<h1 class="listHeader">'+Globalize.translate("HeaderMyMedia")+"</h1>"),t+="<div>",t+=s(a),t+="</div>",e.innerHTML=t,u(e)})}function o(a,t){var r=AppInfo.hasLowImageBandwidth?16:20,i={Limit:r,Fields:"PrimaryImageAspectRatio,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb"};return ApiClient.getJSON(ApiClient.getUrl("Users/"+t.Id+"/Items/Latest",i)).then(function(t){var r="",i=!1;t.length&&(r+="<div>",r+='<h1 class="listHeader">'+Globalize.translate("HeaderLatestMedia")+"</h1>",r+="</div>",r+='<div class="itemsContainer">',r+=LibraryBrowser.getPosterViewHtml({items:t,preferThumb:!0,shape:"backdrop",showUnplayedIndicator:!1,showChildCountIndicator:!0,lazy:!0,cardLayout:i,showTitle:i,showYear:i,showDetailsMenu:!0,context:"home"}),r+="</div>"),a.innerHTML=r,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}function d(a,r){var n={Limit:12,Fields:"PrimaryImageAspectRatio,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",IncludeItemTypes:"Movie"};return ApiClient.getJSON(ApiClient.getUrl("Users/"+r.Id+"/Items/Latest",n)).then(function(r){var n="",s=t();r.length&&(n+='<h1 class="listHeader">'+Globalize.translate("HeaderLatestMovies")+"</h1>",n+=s?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">',n+=LibraryBrowser.getPosterViewHtml({items:r,shape:i(),showUnplayedIndicator:!1,showChildCountIndicator:!0,lazy:!0,context:"home",centerText:!0}),n+="</div>"),a.innerHTML=n,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}function c(a,i){var n={Limit:12,Fields:"PrimaryImageAspectRatio,SyncInfo",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",IncludeItemTypes:"Episode"};return ApiClient.getJSON(ApiClient.getUrl("Users/"+i.Id+"/Items/Latest",n)).then(function(i){var n="",s=t();i.length&&(n+='<h1 class="listHeader">'+Globalize.translate("HeaderLatestEpisodes")+"</h1>",n+=s?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">',n+=LibraryBrowser.getPosterViewHtml({items:i,preferThumb:!0,shape:r(),showUnplayedIndicator:!1,showChildCountIndicator:!0,lazy:!0,context:"home"}),n+="</div>"),a.innerHTML=n,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}function m(a,t){var r=e(window).width(),i={Limit:r>=2400?10:r>=1600?10:r>=1440?8:r>=800?7:6,Fields:"PrimaryImageAspectRatio,SyncInfo",Filters:"IsUnplayed",UserId:t};return ApiClient.getJSON(ApiClient.getUrl("Channels/Items/Latest",i)).then(function(t){var r="";t.Items.length&&(r+='<h1 class="listHeader">'+Globalize.translate("HeaderLatestChannelMedia")+"</h1>",r+='<div class="itemsContainer">',r+=LibraryBrowser.getPosterViewHtml({items:t.Items,preferThumb:!0,shape:"auto",showTitle:!0,centerText:!0,lazy:!0,showDetailsMenu:!0}),r+="</div>"),a.innerHTML=r,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}function h(r,i,n,l,o,d){return a(i.Id).then(function(a){var i="";if(i+=o?'<div class="hiddenSectionOnMobile">':"<div>",a.length){var l=e(window).width();i+="<div>",i+='<h1 class="listHeader">'+Globalize.translate("HeaderMyMedia")+"</h1>",i+="</div>";var c=t()&&browserInfo.safari&&l>800;i+=c?'<div class="hiddenScrollX itemsContainer homeTopViews">':'<div class="itemsContainer homeTopViews">',i+=LibraryBrowser.getPosterViewHtml({items:a,shape:c?"overflowBackdrop":n,showTitle:d,centerText:!0,lazy:!0,autoThumb:!0,transition:!1}),i+="</div>"}i+="</div>",o&&(i+='<div class="hiddenSectionOnNonMobile" style="margin-top:1em;">',i+=s(a),i+="</div>"),r.innerHTML=i,ImageLoader.lazyChildren(r),e(r).createCardMenus({showDetailsMenu:!1}),u(r)})}function v(a,i){var n=e(window).width(),s={SortBy:"DatePlayed",SortOrder:"Descending",MediaTypes:"Video",Filters:"IsResumable",Limit:n>=1920?10:n>=1600?8:n>=1200?9:6,Recursive:!0,Fields:"PrimaryImageAspectRatio,SyncInfo",CollapseBoxSetItems:!1,ExcludeLocationTypes:"Virtual",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};return ApiClient.getItems(i,s).then(function(i){var n="";i.Items.length&&(n+='<h1 class="listHeader">'+Globalize.translate("HeaderResume")+"</h1>",n+=t()?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">',n+=LibraryBrowser.getPosterViewHtml({items:i.Items,preferThumb:!0,shape:r(),overlayText:!1,showTitle:!0,showParentTitle:!0,lazy:!0,showDetailsMenu:!0,overlayPlayButton:!0,context:"home",centerText:!0}),n+="</div>"),a.innerHTML=n,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}function p(a,i){var n={Limit:20,Fields:"PrimaryImageAspectRatio,SeriesInfo,DateCreated,SyncInfo",UserId:i,ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb"};ApiClient.getNextUpEpisodes(n).then(function(i){var n="";i.Items.length&&(n+='<h1 class="listHeader">'+Globalize.translate("HeaderNextUp")+"</h1>",n+=t()?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">',n+=LibraryBrowser.getPosterViewHtml({items:i.Items,preferThumb:!0,shape:r(),overlayText:!1,showTitle:!0,showParentTitle:!0,lazy:!0,overlayPlayButton:!0,context:"home",centerText:!0}),n+="</div>"),a.innerHTML=n,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}function u(a){e("a",a).on("click",function(){var a=this;this.classList.contains("card")||(a=e(this).parents(".card")[0]);var t=e(".cardText",a),r=t.text();LibraryMenu.setTitle(r)})}function y(a,t,r){return r=e.extend(r||{},{UserId:t,SupportsLatestItems:!0}),ApiClient.getJSON(ApiClient.getUrl("Channels",r)).then(function(e){var t=e.Items,r=t.map(function(e){return'<div id="channel'+e.Id+'"></div>'}).join("");a.innerHTML=r;for(var i=0,n=t.length;n>i;i++){var s=t[i];b(a,s,i)}})}function b(a,t){var r=e(window).width(),i={Limit:r>=1600?10:r>=1440?5:r>=800?6:6,Fields:"PrimaryImageAspectRatio,SyncInfo",Filters:"IsUnplayed",UserId:Dashboard.getCurrentUserId(),ChannelIds:t.Id};ApiClient.getJSON(ApiClient.getUrl("Channels/Items/Latest",i)).then(function(r){var i="";if(r.Items.length){i+='<div class="homePageSection">',i+="<div>";var n=Globalize.translate("HeaderLatestFromChannel").replace("{0}",t.Name);i+='<h1 style="display:inline-block; vertical-align:middle;" class="listHeader">'+n+"</h1>",i+='<a href="channelitems.html?id='+t.Id+'" class="clearLink" style="margin-left:2em;"><paper-button raised class="more mini"><span>'+Globalize.translate("ButtonMore")+"</span></paper-button></a>",i+="</div>",i+='<div class="itemsContainer">',i+=LibraryBrowser.getPosterViewHtml({items:r.Items,shape:"autohome",defaultShape:"square",showTitle:!0,centerText:!0,lazy:!0,showDetailsMenu:!0,overlayPlayButton:!0}),i+="</div>",i+="</div>"}var s=a.querySelector("#channel"+t.Id);s.innerHTML=i,ImageLoader.lazyChildren(s),e(s).createCardMenus()})}function g(a,r,i){return ApiClient.getLiveTvRecordings({userId:r,limit:5,IsInProgress:!1}).then(function(r){var s="";if(r.Items.length){var l=0!==i?"listHeader":"listHeader";s+="<div>",s+='<h1 style="display:inline-block; vertical-align:middle;" class="'+l+'">'+Globalize.translate("HeaderLatestTvRecordings")+"</h1>",s+='<a href="livetv.html?tab=3" onclick="LibraryManager.showTab(\'livetv.html\',3);" class="clearLink" style="margin-left:2em;"><paper-button raised class="more mini"><span>'+Globalize.translate("ButtonMore")+"</span></paper-button></a>",s+="</div>"}s+=t()?'<div class="hiddenScrollX itemsContainer">':'<div class="itemsContainer">',s+=LibraryBrowser.getPosterViewHtml({items:r.Items,shape:n(),showTitle:!0,showParentTitle:!0,coverImage:!0,lazy:!0,showDetailsMenu:!0,centerText:!0}),s+="</div>",a.innerHTML=s,ImageLoader.lazyChildren(a),e(a).createCardMenus()})}window.Sections={loadRecentlyAdded:o,loadLatestChannelMedia:m,loadLibraryTiles:h,loadResume:v,loadNextUp:p,loadLatestChannelItems:y,loadLatestLiveTvRecordings:g,loadlibraryButtons:l,loadLatestMovies:d,loadLatestEpisodes:c}}(jQuery,document);