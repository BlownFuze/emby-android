function pageClassOn(e,a,o){document.addEventListener(e,function(e){var n=e.target;n.classList.contains(a)&&o.call(n,e)})}function pageIdOn(e,a,o){document.addEventListener(e,function(e){var n=e.target;n.id==a&&o.call(n,e)})}!function(){function e(){document.removeEventListener("click",e),window.Notification&&Notification.requestPermission()}document.addEventListener("click",e)}();var Dashboard={filterHtml:function(e){e=e.replace("<!--","");var a=e.lastIndexOf("-->");return-1!=a&&(e=e.substring(0,a)+e.substring(a+3)),Globalize.translateDocument(e,"html")},isConnectMode:function(){if(AppInfo.isNativeApp)return!0;var e=window.location.href.toLowerCase();return-1!=e.indexOf("mediabrowser.tv")||-1!=e.indexOf("emby.media")},isRunningInCordova:function(){return"cordova"==window.appMode},onRequestFail:function(e,a){if(401==a.status){var o=a.url.toLowerCase();return-1!=o.indexOf("emby.media")||-1!=o.indexOf("mb3admin.com")?void Dashboard.hideLoadingMsg():-1!=o.indexOf("/sync")?void Dashboard.hideLoadingMsg():void(-1!=o.indexOf("/password")||-1!=o.indexOf("/authenticate")||$($.mobile.activePage).is(".standalonePage")||("ParentalControl"==a.errorCode?Dashboard.alert({message:Globalize.translate("MessageLoggedOutParentalControl"),callback:function(){Dashboard.logout(!1)}}):Dashboard.logout(!1)))}},onPopupOpen:function(){Dashboard.popupCount=(Dashboard.popupCount||0)+1,document.body.classList.add("bodyWithPopupOpen")},onPopupClose:function(){Dashboard.popupCount=(Dashboard.popupCount||1)-1,Dashboard.popupCount||document.body.classList.remove("bodyWithPopupOpen")},getCurrentUser:function(){return window.ApiClient.getCurrentUser()},serverAddress:function(){if(Dashboard.isConnectMode()){var e=window.ApiClient;return e?e.serverAddress():null}var a=window.location.href.toLowerCase(),o=a.indexOf("/web");if(-1==o&&(o=a.indexOf("/dashboard")),-1!=o)return a.substring(0,o);var n=window.location,i=n.protocol+"//"+n.hostname;return n.port&&(i+=":"+n.port),i},getCurrentUserId:function(){var e=window.ApiClient;return e?e.getCurrentUserId():null},onServerChanged:function(e,a,o){o=o||window.ApiClient,window.ApiClient=o},logout:function(e){function a(){var e;Dashboard.isConnectMode()?(e="connectlogin.html",window.ApiClient=null):e="login.html",Dashboard.navigate(e)}e===!1?a():ConnectionManager.logout().then(a)},importCss:function(e){var a=e;if(e+="?v="+window.dashboardVersion,Dashboard.importedCss||(Dashboard.importedCss=[]),-1==Dashboard.importedCss.indexOf(e))if(Dashboard.importedCss.push(e),document.createStyleSheet)document.createStyleSheet(e);else{var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("data-url",a),o.setAttribute("type","text/css"),o.setAttribute("href",e),document.head.appendChild(o)}},removeStylesheet:function(e){var a=document.querySelector("link[data-url='"+e+"']");a&&a.parentNode.removeChild(a)},updateSystemInfo:function(e){Dashboard.lastSystemInfo=e,Dashboard.ensureWebSocket(),Dashboard.initialServerVersion||(Dashboard.initialServerVersion=e.Version),e.HasPendingRestart?(Dashboard.hideDashboardVersionWarning(),Dashboard.getCurrentUser().then(function(a){a.Policy.IsAdministrator&&Dashboard.showServerRestartWarning(e)})):(Dashboard.hideServerRestartWarning(),Dashboard.initialServerVersion!=e.Version&&Dashboard.showDashboardRefreshNotification()),Dashboard.showInProgressInstallations(e.InProgressInstallations)},showInProgressInstallations:function(e){e=e||[];for(var a=0,o=e.length;o>a;a++){var n=e[a],i=n.PercentComplete||0;100>i&&Dashboard.showPackageInstallNotification(n,"progress")}e.length?Dashboard.ensureInstallRefreshInterval():Dashboard.stopInstallRefreshInterval()},ensureInstallRefreshInterval:function(){Dashboard.installRefreshInterval||(ApiClient.isWebSocketOpen()&&ApiClient.sendWebSocketMessage("SystemInfoStart","0,500"),Dashboard.installRefreshInterval=1)},stopInstallRefreshInterval:function(){Dashboard.installRefreshInterval&&(ApiClient.isWebSocketOpen()&&ApiClient.sendWebSocketMessage("SystemInfoStop"),Dashboard.installRefreshInterval=null)},cancelInstallation:function(e){ApiClient.cancelPackageInstallation(e).then(Dashboard.refreshSystemInfoFromServer,Dashboard.refreshSystemInfoFromServer)},showServerRestartWarning:function(e){var a='<span style="margin-right: 1em;">'+Globalize.translate("MessagePleaseRestart")+"</span>";e.CanSelfRestart&&(a+='<paper-button raised class="submit mini" onclick="this.disabled=\'disabled\';Dashboard.restartServer();"><iron-icon icon="refresh"></iron-icon><span>'+Globalize.translate("ButtonRestart")+"</span></paper-button>"),Dashboard.showFooterNotification({id:"serverRestartWarning",html:a,forceShow:!0,allowHide:!1})},hideServerRestartWarning:function(){var e=document.getElementById("serverRestartWarning");e&&e.parentNode.removeChild(e)},showDashboardRefreshNotification:function(){var e='<span style="margin-right: 1em;">'+Globalize.translate("MessagePleaseRefreshPage")+"</span>";e+='<paper-button raised class="submit mini" onclick="this.disabled=\'disabled\';Dashboard.reloadPage();"><iron-icon icon="refresh"></iron-icon><span>'+Globalize.translate("ButtonRefresh")+"</span></paper-button>",Dashboard.showFooterNotification({id:"dashboardVersionWarning",html:e,forceShow:!0,allowHide:!1})},reloadPage:function(){var e,a=window.location.href.toLowerCase();e=-1!=a.indexOf("configurationpage")?"dashboard.html":window.location.href,window.location.href=e},hideDashboardVersionWarning:function(){var e=document.getElementById("dashboardVersionWarning");e&&e.parentNode.removeChild(e)},showFooterNotification:function(e){if(AppInfo.enableFooterNotifications){var a=!e.id;if(e.id=e.id||"notification"+(new Date).getTime()+parseInt(Math.random()),!document.querySelector(".footer")){var o='<div id="footer" class="footer" data-theme="b" class="ui-bar-b">';o+='<div id="footerNotifications"></div>',o+="</div>",$(document.body).append(o)}var n=$(".footer").css("top","initial").show(),i=$("#footerNotifications",n),t=$("#"+e.id,i);t.length||(t=$('<p id="'+e.id+'" class="footerNotification"></p>').appendTo(i));var r=a?'jQuery("#'+e.id+'").trigger("notification.remove").remove();':'jQuery("#'+e.id+'").trigger("notification.hide").hide();';e.allowHide!==!1&&(e.html+="<span style='margin-left: 1em;'><paper-button class='submit' onclick='"+r+"'>"+Globalize.translate("ButtonHide")+"</paper-button></span>"),e.forceShow&&t.slideDown(400),t.html(e.html).trigger("create"),e.timeout&&setTimeout(function(){a?t.trigger("notification.remove").remove():t.trigger("notification.hide").hide()},e.timeout),n.on("notification.remove notification.hide",function(){setTimeout(function(){i.html()||n.slideUp()},50)})}},getConfigurationPageUrl:function(e){return"ConfigurationPage?name="+encodeURIComponent(e)},navigate:function(e,a,o){if(!e)throw new Error("url cannot be null or empty");var n=getWindowLocationSearch();a&&n&&(e+=n);var i={};o&&(i.transition=o),$.mobile.changePage(e,i)},showLoadingMsg:function(){var e=document.querySelector(".docspinner");e?e.active=!0:(e=document.createElement("paper-spinner"),e.classList.add("docspinner"),document.body.appendChild(e),e.active=!0)},hideLoadingMsg:function(){var e=document.querySelector(".docspinner");e&&(e.active=!1)},getModalLoadingMsg:function(){var e=document.querySelector(".modalLoading");return e||(e=document.createElement("modalLoading"),e.classList.add("modalLoading"),e.classList.add("hide"),document.body.appendChild(e)),e},showModalLoadingMsg:function(){Dashboard.getModalLoadingMsg().classList.remove("hide"),Dashboard.showLoadingMsg()},hideModalLoadingMsg:function(){Dashboard.getModalLoadingMsg().classList.add("hide"),Dashboard.hideLoadingMsg()},processPluginConfigurationUpdateResult:function(){Dashboard.hideLoadingMsg(),Dashboard.alert(Globalize.translate("MessageSettingsSaved"))},processServerConfigurationUpdateResult:function(){Dashboard.hideLoadingMsg(),Dashboard.alert(Globalize.translate("MessageSettingsSaved"))},alert:function(e){if("string"==typeof e){var a=e;Dashboard.toastId=Dashboard.toastId||0;var o="toast"+Dashboard.toastId++,n=document.createElement("paper-toast");return n.setAttribute("text",a),n.id=o,document.body.appendChild(n),void setTimeout(function(){n.show(),setTimeout(function(){n.parentNode.removeChild(n)},5e3)},300)}navigator.notification&&navigator.notification.alert&&-1==e.message.indexOf("<")?navigator.notification.alert(e.message,e.callback||function(){},e.title||Globalize.translate("HeaderAlert")):Dashboard.confirmInternal(e.message,e.title||Globalize.translate("HeaderAlert"),!1,e.callback)},dialog:function(e){var a=e.title,o=e.message,n=e.buttons,i=e.callback;navigator.notification&&navigator.notification.confirm&&-1==o.indexOf("<")?navigator.notification.confirm(o,function(e){i(e)},a,n.join(",")):Dashboard.dialogInternal(o,a,n,i)},dialogInternal:function(e,a,o,n){var i="paperdlg"+(new Date).getTime(),t='<paper-dialog id="'+i+'" role="alertdialog" entry-animation="fade-in-animation" exit-animation="fade-out-animation" with-backdrop>';t+="<h2>"+a+"</h2>",t+="<div>"+e+"</div>",t+='<div class="buttons">';var r=0;t+=o.map(function(e){var a=' data-index="'+r+'"';return r++,'<paper-button class="dialogButton"'+a+" dialog-dismiss>"+e+"</paper-button>"}).join(""),t+="</div>",t+="</paper-dialog>",$(document.body).append(t),setTimeout(function(){var e=document.getElementById(i);$(".dialogButton",e).on("click",function(){n&&n(parseInt(this.getAttribute("data-index")))}),e.addEventListener("iron-overlay-closed",function(){e.parentNode.removeChild(e)}),e.open()},300)},confirm:function(e,a,o){if(navigator.notification&&navigator.notification.confirm&&-1==e.indexOf("<")){var n=[Globalize.translate("ButtonOk"),Globalize.translate("ButtonCancel")];navigator.notification.confirm(e,function(e){o(1==e)},a||Globalize.translate("HeaderConfirm"),n.join(","))}else Dashboard.confirmInternal(e,a,!0,o)},confirmInternal:function(e,a,o,n){var i="paperdlg"+(new Date).getTime(),t='<paper-dialog id="'+i+'" role="alertdialog" entry-animation="fade-in-animation" exit-animation="fade-out-animation" with-backdrop>';t+="<h2>"+a+"</h2>",t+="<div>"+e+"</div>",t+='<div class="buttons">',t+='<paper-button class="btnConfirm" dialog-confirm autofocus>'+Globalize.translate("ButtonOk")+"</paper-button>",o&&(t+="<paper-button dialog-dismiss>"+Globalize.translate("ButtonCancel")+"</paper-button>"),t+="</div>",t+="</paper-dialog>",$(document.body).append(t),setTimeout(function(){var e=document.getElementById(i);e.addEventListener("iron-overlay-closed",function(){var a=e.closingReason.confirmed;e.parentNode.removeChild(e),n&&n(a)}),e.open()},300)},refreshSystemInfoFromServer:function(){var e=ApiClient;e&&e.accessToken()&&(AppInfo.enableFooterNotifications?e.getSystemInfo().then(function(e){Dashboard.updateSystemInfo(e)}):Dashboard.ensureWebSocket())},restartServer:function(){Dashboard.suppressAjaxErrors=!0,Dashboard.showLoadingMsg(),ApiClient.restartServer().then(function(){setTimeout(function(){Dashboard.reloadPageWhenServerAvailable()},250)},function(){Dashboard.suppressAjaxErrors=!1})},reloadPageWhenServerAvailable:function(e){ApiClient.getJSON(ApiClient.getUrl("System/Info")).then(function(a){a.HasPendingRestart?Dashboard.retryReload(e):Dashboard.reloadPage()},function(){Dashboard.retryReload(e)})},retryReload:function(e){setTimeout(function(){e=e||0,e++,10>e?Dashboard.reloadPageWhenServerAvailable(e):Dashboard.suppressAjaxErrors=!1},500)},showUserFlyout:function(){require(["jqmpanel"],function(){var e='<div data-role="panel" data-position="right" data-display="overlay" id="userFlyout" data-position-fixed="true" data-theme="a">';e+='<h3 class="userHeader">',e+="</h3>",e+="<form>",e+='<p class="preferencesContainer"></p>',e+='<p><button data-mini="true" type="button" onclick="Dashboard.logout();" data-icon="lock">'+Globalize.translate("ButtonSignOut")+"</button></p>",e+="</form>",e+="</div>",$(document.body).append(e);var a=document.querySelector("#userFlyout");ImageLoader.lazyChildren(a),$(a).panel({}).panel("open").on("panelclose",function(){$(this).off("panelclose").remove()}),ConnectionManager.user(window.ApiClient).then(function(e){Dashboard.updateUserFlyout(a,e)})})},updateUserFlyout:function(e,a){var o="",n=48;if(a.imageUrl&&AppInfo.enableUserImage){var i=a.imageUrl;a.supportsImageParams&&(i+="&width="+n*Math.max(window.devicePixelRatio||1,2)),o+="<div style=\"background-image:url('"+i+"');width:"+n+"px;height:"+n+'px;background-size:contain;background-repeat:no-repeat;background-position:center center;border-radius:1000px;vertical-align:middle;margin-right:.8em;display:inline-block;"></div>'}o+=a.name;var t=e.querySelector(".userHeader");t.innerHTML=o,ImageLoader.lazyChildren(t),o="",a.localUser&&a.localUser.Policy.EnableUserPreferenceAccess&&(o+='<p><a data-mini="true" data-role="button" href="mypreferencesmenu.html?userId='+a.localUser.Id+'" data-icon="gear">'+Globalize.translate("ButtonSettings")+"</button></a>"),$(".preferencesContainer",e).html(o).trigger("create")},getPluginSecurityInfo:function(){var e=ApiClient;if(!e){var a=$.Deferred();return a.reject(),a.promise()}if(!Dashboard.getPluginSecurityInfoPromise){var a=$.Deferred();e.ajax({type:"GET",url:e.getUrl("Plugins/SecurityInfo"),dataType:"json",error:function(){}}).then(function(e){a.resolveWith(null,[e])}),Dashboard.getPluginSecurityInfoPromise=a}return Dashboard.getPluginSecurityInfoPromise},resetPluginSecurityInfo:function(){Dashboard.getPluginSecurityInfoPromise=null},ensureHeader:function(e){e.classList.contains("standalonePage")&&!e.classList.contains("noHeaderPage")&&Dashboard.renderHeader(e)},renderHeader:function(e){var a=e.querySelector(".header");if(!a){var o="";o+='<div class="header">',o+='<a class="logo" href="index.html" style="text-decoration:none;font-size: 22px;">',e.classList.contains("standalonePage")&&(o+='<img class="imgLogoIcon" src="css/images/mblogoicon.png" />',o+='<span class="logoLibraryMenuButtonText">EMBY</span>'),o+="</a>",o+="</div>",$(e).prepend(o)}},getToolsMenuHtml:function(e){var a,o,n,i=Dashboard.getToolsMenuLinks(e),t="";for(a=0,o=i.length;o>a;a++)if(n=i[a],n.divider&&(t+="<div class='sidebarDivider'></div>"),n.href){var r=n.color?' style="color:'+n.color+'"':"";t+=n.selected?'<a class="sidebarLink selectedSidebarLink" href="'+n.href+'">':'<a class="sidebarLink" href="'+n.href+'">';var s=n.icon;s&&(t+='<iron-icon icon="'+s+'" class="sidebarLinkIcon"'+r+"></iron-icon>"),t+='<span class="sidebarLinkText">',t+=n.name,t+="</span>",t+="</a>"}else t+='<div class="sidebarHeader">',t+=n.name,t+="</div>";return t},ensureToolsMenu:function(e){var a=e.querySelector(".toolsSidebar");if(!a){var o='<div class="content-secondary toolsSidebar">';o+='<div class="sidebarLinks">',o+=Dashboard.getToolsMenuHtml(e),o+="</div>",o+="</div>",$(".content-primary",e).before(o),Events.trigger(e,"create")}},getToolsMenuLinks:function(e){var a=e,o=e.classList.contains("appServicesPage"),n=getParameterByName("context");return[{name:Globalize.translate("TabServer"),href:"dashboard.html",selected:e.classList.contains("dashboardHomePage"),icon:"dashboard",color:"#38c"},{name:Globalize.translate("TabDevices"),href:"devices.html",selected:e.classList.contains("devicesPage"),icon:"tablet",color:"#ECA403"},{name:Globalize.translate("TabUsers"),href:"userprofiles.html",selected:e.classList.contains("userProfilesPage"),icon:"people",color:"#679C34"},{name:Globalize.translate("TabLibrary"),divider:!0,href:"library.html",selected:e.classList.contains("librarySectionPage"),icon:"video-library"},{name:Globalize.translate("TabMetadata"),href:"metadata.html",selected:e.classList.contains("metadataConfigurationPage"),icon:"insert-drive-file"},{name:Globalize.translate("TabPlayback"),href:"playbackconfiguration.html",selected:e.classList.contains("playbackConfigurationPage"),icon:"play-circle-filled"},{name:Globalize.translate("TabSync"),href:"syncactivity.html",selected:e.classList.contains("syncConfigurationPage")||o&&"sync"==n,icon:"sync"},{divider:!0,name:Globalize.translate("TabExtras")},{name:Globalize.translate("TabAutoOrganize"),href:"autoorganizelog.html",selected:e.classList.contains("organizePage"),icon:"folder",color:"#01C0DD"},{name:Globalize.translate("TabDLNA"),href:"dlnasettings.html",selected:e.classList.contains("dlnaPage"),icon:"tv",color:"#E5342E"},{name:Globalize.translate("TabLiveTV"),href:"livetvstatus.html",selected:e.classList.contains("liveTvSettingsPage")||o&&"livetv"==n,icon:"live-tv",color:"#293AAE"},{name:Globalize.translate("TabNotifications"),href:"notificationsettings.html",selected:e.classList.contains("notificationConfigurationPage"),icon:"notifications",color:"brown"},{name:Globalize.translate("TabPlugins"),href:"plugins.html",selected:e.classList.contains("pluginConfigurationPage"),icon:"add-shopping-cart",color:"#9D22B1"},{divider:!0,name:Globalize.translate("TabExpert")},{name:Globalize.translate("TabAdvanced"),href:"advanced.html",selected:e.classList.contains("advancedConfigurationPage"),icon:"settings",color:"#F16834"},{name:Globalize.translate("TabScheduledTasks"),href:"scheduledtasks.html",selected:e.classList.contains("scheduledTasksConfigurationPage"),icon:"schedule",color:"#38c"},{name:Globalize.translate("TabHelp"),divider:!0,href:"support.html",selected:"supportPage"==a.id||"logPage"==a.id||"supporterPage"==a.id||"supporterKeyPage"==a.id||"aboutPage"==a.id,icon:"help",color:"#679C34"}]},ensureWebSocket:function(){!ApiClient.isWebSocketOpenOrConnecting()&&ApiClient.isWebSocketSupported()&&(ApiClient.openWebSocket(),Dashboard.isConnectMode()||ApiClient.reportCapabilities(Dashboard.capabilities()))},processGeneralCommand:function(e){switch(e.Name){case"GoHome":Dashboard.navigate("index.html");break;case"GoToSettings":Dashboard.navigate("dashboard.html");break;case"DisplayContent":Dashboard.onBrowseCommand(e.Arguments);break;case"GoToSearch":Search.showSearchPanel();break;case"DisplayMessage":var a=e.Arguments;a.TimeoutMs?Dashboard.showFooterNotification({html:"<div><b>"+a.Header+"</b></div>"+a.Text,timeout:a.TimeoutMs}):Dashboard.alert({title:a.Header,message:a.Text});break;case"VolumeUp":case"VolumeDown":case"Mute":case"Unmute":case"ToggleMute":case"SetVolume":case"SetAudioStreamIndex":case"SetSubtitleStreamIndex":case"ToggleFullscreen":case"SetRepeatMode":break;default:Logger.log("Unrecognized command: "+e.Name)}},onWebSocketMessageReceived:function(e,a){var o=a;if("LibraryChanged"===o.MessageType)Dashboard.processLibraryUpdateNotification(o.Data);else if("ServerShuttingDown"===o.MessageType)Dashboard.hideServerRestartWarning();else if("ServerRestarting"===o.MessageType)Dashboard.hideServerRestartWarning();else if("SystemInfo"===o.MessageType)Dashboard.updateSystemInfo(o.Data);else if("RestartRequired"===o.MessageType)Dashboard.updateSystemInfo(o.Data);else if("PackageInstallationCompleted"===o.MessageType)Dashboard.getCurrentUser().then(function(e){e.Policy.IsAdministrator&&(Dashboard.showPackageInstallNotification(o.Data,"completed"),Dashboard.refreshSystemInfoFromServer())});else if("PackageInstallationFailed"===o.MessageType)Dashboard.getCurrentUser().then(function(e){e.Policy.IsAdministrator&&(Dashboard.showPackageInstallNotification(o.Data,"failed"),Dashboard.refreshSystemInfoFromServer())});else if("PackageInstallationCancelled"===o.MessageType)Dashboard.getCurrentUser().then(function(e){e.Policy.IsAdministrator&&(Dashboard.showPackageInstallNotification(o.Data,"cancelled"),Dashboard.refreshSystemInfoFromServer())});else if("PackageInstalling"===o.MessaapiclientcgeType)Dashboard.getCurrentUser().then(function(e){e.Policy.IsAdministrator&&(Dashboard.showPackageInstallNotification(o.Data,"progress"),Dashboard.refreshSystemInfoFromServer())});else if("GeneralCommand"===o.MessageType){o.Data}},onBrowseCommand:function(e){var a,o=(e.ItemType||"").toLowerCase();return"genre"==o?a="itemdetails.html?id="+e.ItemId:"musicgenre"==o?a="itemdetails.html?id="+e.ItemId:"gamegenre"==o?a="itemdetails.html?id="+e.ItemId:"studio"==o?a="itemdetails.html?id="+e.ItemId:"person"==o?a="itemdetails.html?id="+e.ItemId:"musicartist"==o&&(a="itemdetails.html?id="+e.ItemId),a?void Dashboard.navigate(a):void ApiClient.getItem(Dashboard.getCurrentUserId(),e.ItemId).then(function(e){Dashboard.navigate(LibraryBrowser.getHref(e,null,""))})},showPackageInstallNotification:function(e,a){var o="";if("completed"==a?o+='<img src="css/images/notifications/done.png" class="notificationIcon" />':"cancelled"==a?o+='<img src="css/images/notifications/info.png" class="notificationIcon" />':"failed"==a?o+='<img src="css/images/notifications/error.png" class="notificationIcon" />':"progress"==a&&(o+='<img src="css/images/notifications/download.png" class="notificationIcon" />'),o+='<span style="margin-right: 1em;">',"completed"==a?o+=Globalize.translate("LabelPackageInstallCompleted").replace("{0}",e.Name+" "+e.Version):"cancelled"==a?o+=Globalize.translate("LabelPackageInstallCancelled").replace("{0}",e.Name+" "+e.Version):"failed"==a?o+=Globalize.translate("LabelPackageInstallFailed").replace("{0}",e.Name+" "+e.Version):"progress"==a&&(o+=Globalize.translate("LabelInstallingPackage").replace("{0}",e.Name+" "+e.Version)),o+="</span>","progress"==a){var n=Math.round(e.PercentComplete||0);o+='<progress style="margin-right: 1em;" max="100" value="'+n+'" title="'+n+'%">',o+=""+n+"%",o+="</progress>",100>n&&(o+="<paper-button raised class=\"cancelDark mini\" onclick=\"this.disabled='disabled';Dashboard.cancelInstallation('"+e.Id+'\');"><iron-icon icon="cancel"></iron-icon><span>'+Globalize.translate("ButtonCancel")+"</span></paper-button>")}var i=0;"cancelled"==a&&(i=2e3);var t="progress"!=a,r="progress"!=a&&"cancelled"!=a;Dashboard.showFooterNotification({html:o,id:e.Id,timeout:i,forceShow:t,allowHide:r})},processLibraryUpdateNotification:function(e){var a=e.ItemsAdded;a.length&&!AppInfo.isNativeApp&&window.Notification&&ApiClient.getItems(Dashboard.getCurrentUserId(),{Recursive:!0,Limit:3,Filters:"IsNotFolder",SortBy:"DateCreated",SortOrder:"Descending",ImageTypes:"Primary",Ids:a.join(",")}).then(function(e){for(var a=e.Items,o=0,n=Math.min(a.length,2);n>o;o++){var i=a[o],t={title:"New "+i.Type,body:i.Name,timeout:5e3,vibrate:!0},r=i.ImageTags||{};if(r.Primary&&(t.icon=ApiClient.getScaledImageUrl(i.Id,{width:60,tag:r.Primary,type:"Primary"})),"granted"===Notification.permission){var s=new Notification(t.title,t);s.show&&s.show(),t.timeout&&setTimeout(function(){s.close?s.close():s.cancel&&s.cancel()},t.timeout)}WebNotifications.show(t)}})},ensurePageTitle:function(e){if(e.classList.contains("type-interior")){var a=e;if(!a.querySelector(".pageTitle")){var o=a.querySelector(".content-primary");o||(o=a.getElementsByClassName("ui-content")[0]);var n=a.getAttribute("data-helpurl"),i="<div>";i+='<h1 class="pageTitle" style="display:inline-block;">'+(document.title||"&nbsp;")+"</h1>",n&&(i+='<a href="'+n+'" target="_blank" class="clearLink" style="margin-top:-10px;display:inline-block;vertical-align:middle;margin-left:1em;"><paper-button raised class="secondary mini"><iron-icon icon="info"></iron-icon><span>'+Globalize.translate("ButtonHelp")+"</span></paper-button></a>"),i+="</div>",$(o).prepend(i)}}},setPageTitle:function(e){var a=$.mobile.activePage;if(a){var o=$(a)[0].querySelector(".pageTitle");o&&(o.innerHTML=e)}e&&(document.title=e)},getDisplayTime:function(e){var a=36e9,o=6e8,n=1e7,i=[],t=e/a;t=Math.floor(t),t&&i.push(t),e-=t*a;var r=e/o;r=Math.floor(r),e-=r*o,10>r&&t&&(r="0"+r),i.push(r);var s=e/n;return s=Math.floor(s),10>s&&(s="0"+s),i.push(s),i.join(":")},getSupportedRemoteCommands:function(){return["GoHome","GoToSettings","VolumeUp","VolumeDown","Mute","Unmute","ToggleMute","SetVolume","SetAudioStreamIndex","SetSubtitleStreamIndex","DisplayContent","GoToSearch","DisplayMessage","SetRepeatMode"]},isServerlessPage:function(){var e=window.location.href.toLowerCase();return-1!=e.indexOf("connectlogin.html")||-1!=e.indexOf("selectserver.html")||-1!=e.indexOf("login.html")||-1!=e.indexOf("forgotpassword.html")||-1!=e.indexOf("forgotpasswordpin.html")},capabilities:function(){var e={PlayableMediaTypes:["Audio","Video"],SupportedCommands:Dashboard.getSupportedRemoteCommands(),SupportsPersistentIdentifier:Dashboard.isRunningInCordova(),SupportsMediaControl:!0,SupportedLiveMediaTypes:["Audio","Video"]};return Dashboard.isRunningInCordova()&&!browserInfo.safari&&(e.SupportsOfflineAccess=!0,e.SupportsSync=!0,e.SupportsContentUploading=!0),e},getDefaultImageQuality:function(e){var a=90,o="backdrop"==e.toLowerCase();return o&&(a-=10),AppInfo.hasLowImageBandwidth&&(a-=AppInfo.isNativeApp?10:40),a},normalizeImageOptions:function(e){AppInfo.hasLowImageBandwidth&&(e.enableImageEnhancers=!1),AppInfo.forcedImageFormat&&"Logo"!=e.type&&(e.format=AppInfo.forcedImageFormat,e.backgroundColor="#1c1c1c")},ready:function(e){Dashboard.initPromise.then(e)},loadExternalPlayer:function(){var e=DeferredBuilder.Deferred();return require(["scripts/externalplayer.js"],function(){Dashboard.isRunningInCordova()?require(["cordova/externalplayer.js"],function(){e.resolve()}):e.resolve()}),e.promise()},exitOnBack:function(){return $($.mobile.activePage).is("#indexPage")},exit:function(){Dashboard.logout()}},AppInfo={};!function(){function e(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}function a(){e()&&(AppInfo.isTouchPreferred=!0);var a=Dashboard.isRunningInCordova();AppInfo.enableDetailPageChapters=!0,AppInfo.enableDetailsMenuImages=!0,AppInfo.enableMovieHomeSuggestions=!0,AppInfo.enableNavDrawer=!0,AppInfo.enableSearchInTopMenu=!0,AppInfo.enableHomeFavorites=!0,AppInfo.enableNowPlayingBar=!0,AppInfo.enableHomeTabs=!0,AppInfo.enableNowPlayingPageBottomTabs=!0,AppInfo.enableAppStorePolicy=a;var o=browserInfo.ipad||browserInfo.iphone,n=browserInfo.android,i=browserInfo.mobile;o&&(AppInfo.hasLowImageBandwidth=!0,a?(AppInfo.enableNavDrawer=!1,AppInfo.enableSearchInTopMenu=!1,AppInfo.enableHomeFavorites=!1,AppInfo.enableHomeTabs=!1,AppInfo.enableNowPlayingPageBottomTabs=!1,-1!=navigator.userAgent.toString().toLowerCase().indexOf("iphone")&&(AppInfo.enableNowPlayingBar=!1)):(AppInfo.enableDetailPageChapters=!1,AppInfo.enableDetailsMenuImages=!1,AppInfo.enableMovieHomeSuggestions=!1,AppInfo.cardMargin="largeCardMargin",AppInfo.forcedImageFormat="jpg")),AppInfo.hasLowImageBandwidth||(AppInfo.enableStudioTabs=!0,AppInfo.enableTvEpisodesTab=!0,AppInfo.enableMovieTrailersTab=!0),AppInfo.supportsExternalPlayers=!0,a?(AppInfo.enableAppLayouts=!0,AppInfo.supportsExternalPlayerMenu=!0,AppInfo.isNativeApp=!0,o&&(AppInfo.supportsExternalPlayers=!1)):(AppInfo.enableFooterNotifications=!0,AppInfo.enableSupporterMembership=!0,n||o||(AppInfo.enableAppLayouts=!0)),AppInfo.enableHeadRoom=!o,AppInfo.supportsDownloading=!(AppInfo.isNativeApp&&o),AppInfo.enableUserImage=!0,AppInfo.hasPhysicalVolumeButtons=a||i,AppInfo.enableBackButton=o&&(window.navigator.standalone||AppInfo.isNativeApp),AppInfo.supportsSyncPathSetting=a&&n,AppInfo.supportsUserDisplayLanguageSetting=Dashboard.isConnectMode()&&!a,AppInfo.directPlayAudioContainers=[],AppInfo.directPlayVideoContainers=[],AppInfo.moreIcon=a&&o?"more-horiz":"more-vert"}function o(e){e.enableAppStorePolicy=AppInfo.enableAppStorePolicy,e.getDefaultImageQuality=Dashboard.getDefaultImageQuality,e.normalizeImageOptions=Dashboard.normalizeImageOptions,$(e).off("websocketmessage",Dashboard.onWebSocketMessageReceived).off("requestfail",Dashboard.onRequestFail),$(e).on("websocketmessage",Dashboard.onWebSocketMessageReceived).on("requestfail",Dashboard.onRequestFail)}function n(e){var a=Dashboard.isConnectMode()?null:"servercredentials4",n=new MediaBrowser.CredentialProvider(a);return window.ConnectionManager=new MediaBrowser.ConnectionManager(Logger,n,AppInfo.appName,AppInfo.appVersion,AppInfo.deviceName,AppInfo.deviceId,e),-1!=window.location.href.toLowerCase().indexOf("wizardstart.html")&&window.ConnectionManager.clearData(),Events.on(ConnectionManager,"apiclientcreated",function(e,a){o(a)}),new Promise(function(e){if(Dashboard.isConnectMode()){var a=ConnectionManager.getLastUsedServer();if(!Dashboard.isServerlessPage()&&a&&a.UserId&&a.AccessToken)return void ConnectionManager.connectToServer(a).then(function(a){a.State==MediaBrowser.ConnectionState.SignedIn&&(window.ApiClient=a.ApiClient),e()});e()}else{var o=new MediaBrowser.ApiClient(Logger,Dashboard.serverAddress(),AppInfo.appName,AppInfo.appVersion,AppInfo.deviceName,AppInfo.deviceId);o.enableAutomaticNetworking=!1,ConnectionManager.addApiClient(o),Dashboard.importCss(o.getUrl("Branding/Css")),window.ApiClient=o,e()}})}function i(){require(["bower_components/fastclick/lib/fastclick"],function(e){function a(e,a){for(;!e.classList||!e.classList.contains(a);)if(e=e.parentNode,!e)return null;return e}e.attach(document.body,{tapDelay:0}),document.body.addEventListener("touchstart",function(e){var o=a(e.target,"ui-panel-dismiss");o&&$(o).click()})})}function t(){var e=document.documentElement;AppInfo.isTouchPreferred&&e.classList.add("touch"),AppInfo.cardMargin&&e.classList.add(AppInfo.cardMargin),AppInfo.enableStudioTabs||e.classList.add("studioTabDisabled"),AppInfo.enableTvEpisodesTab||e.classList.add("tvEpisodesTabDisabled"),AppInfo.enableMovieTrailersTab||e.classList.add("movieTrailersTabDisabled"),AppInfo.enableSupporterMembership||e.classList.add("supporterMembershipDisabled"),AppInfo.isNativeApp&&e.classList.add("nativeApp"),AppInfo.enableHomeFavorites||e.classList.add("homeFavoritesDisabled")}function r(){var e=getParameterByName("theme");if(e)return void require(["themes/"+e+"/theme"]);var a=new Date,o=a.getMonth(),n=a.getDate();return 9==o&&n>=30?void require(["themes/halloween/theme"]):void 0}function s(){var e="v="+window.dashboardVersion,a={velocity:"bower_components/velocity/velocity.min",tvguide:"components/tvguide/tvguide",directorybrowser:"components/directorybrowser/directorybrowser",collectioneditor:"components/collectioneditor/collectioneditor",playlisteditor:"components/playlisteditor/playlisteditor",medialibrarycreator:"components/medialibrarycreator/medialibrarycreator",medialibraryeditor:"components/medialibraryeditor/medialibraryeditor",howler:"bower_components/howler.js/howler.min",sortable:"bower_components/Sortable/Sortable.min",isMobile:"bower_components/isMobile/isMobile.min",headroom:"bower_components/headroom.js/dist/headroom.min",masonry:"bower_components/masonry/dist/masonry.pkgd.min",humanedate:"components/humanedate",jQuery:"bower_components/jquery/dist/jquery.min"};a.prompt=Dashboard.isRunningInCordova()?"cordova/prompt":"components/prompt",requirejs.config({map:{"*":{css:"components/requirecss"}},urlArgs:e,paths:a}),define("cryptojs-sha1",["apiclient/sha1"]),define("cryptojs-md5",["apiclient/md5"])}function d(e,a){Dashboard.isRunningInCordova()&&browserInfo.android?define("appstorage",["cordova/android/appstorage"]):define("appstorage",[],function(){return appStorage}),Dashboard.isRunningInCordova()?(define("serverdiscovery",["cordova/serverdiscovery"]),define("wakeonlan",["cordova/wakeonlan"])):(define("serverdiscovery",["apiclient/serverdiscovery"]),define("wakeonlan",["apiclient/wakeonlan"])),Dashboard.isRunningInCordova()?define("localassetmanager",["cordova/localassetmanager"]):define("localassetmanager",["apiclient/localassetmanager"]),Dashboard.isRunningInCordova()&&browserInfo.android&&define("nativedirectorychooser",["cordova/android/nativedirectorychooser"]),Dashboard.isRunningInCordova()&&browserInfo.android?(define("audiorenderer",["cordova/android/vlcplayer"]),define("videorenderer",["cordova/android/vlcplayer"])):Dashboard.isRunningInCordova()&&browserInfo.safari?(define("audiorenderer",["cordova/ios/vlcplayer"]),define("videorenderer",["scripts/htmlmediarenderer"])):(define("audiorenderer",["scripts/htmlmediarenderer"]),define("videorenderer",["scripts/htmlmediarenderer"])),Dashboard.isRunningInCordova()&&browserInfo.android?define("localsync",["cordova/android/localsync"]):define("localsync",["scripts/localsync"]),define("connectservice",["apiclient/connectservice"]),define("livetvcss",[],function(){return Dashboard.importCss("css/livetv.css"),{}
}),define("detailtablecss",[],function(){return Dashboard.importCss("css/detailtable.css"),{}}),define("tileitemcss",["css!css/tileitem.css"]),Dashboard.isRunningInCordova()?define("actionsheet",["cordova/actionsheet"]):define("actionsheet",["scripts/actionsheet"]),define("sharingmanager",["scripts/sharingmanager"]),Dashboard.isRunningInCordova()?define("sharingwidget",["cordova/sharingwidget"]):define("sharingwidget",["scripts/sharingwidget"]),Dashboard.isRunningInCordova()&&browserInfo.safari?define("searchmenu",["cordova/searchmenu"]):define("searchmenu",["scripts/searchmenu"]),define("jqmicons",["css!thirdparty/jquerymobile-1.4.5/jquery.mobile.custom.icons.css"]),define("jqmtable",["thirdparty/jquerymobile-1.4.5/jqm.table","css!thirdparty/jquerymobile-1.4.5/jqm.table.css"]),define("jqmwidget",["thirdparty/jquerymobile-1.4.5/jqm.widget"]),define("jqmslider",["thirdparty/jquerymobile-1.4.5/jqm.slider","css!thirdparty/jquerymobile-1.4.5/jqm.slider.css"]),define("jqmpopup",["thirdparty/jquerymobile-1.4.5/jqm.popup","css!thirdparty/jquerymobile-1.4.5/jqm.popup.css"]),define("jqmlistview",["thirdparty/jquerymobile-1.4.5/jqm.listview","css!thirdparty/jquerymobile-1.4.5/jqm.listview.css"]),define("jqmcontrolgroup",["thirdparty/jquerymobile-1.4.5/jqm.controlgroup","css!thirdparty/jquerymobile-1.4.5/jqm.controlgroup.css"]),define("jqmcollapsible",["jqmicons","thirdparty/jquerymobile-1.4.5/jqm.collapsible","css!thirdparty/jquerymobile-1.4.5/jqm.collapsible.css"]),define("jqmcheckbox",["jqmicons","thirdparty/jquerymobile-1.4.5/jqm.checkbox","css!thirdparty/jquerymobile-1.4.5/jqm.checkbox.css"]),define("jqmpanel",["thirdparty/jquerymobile-1.4.5/jqm.panel","css!thirdparty/jquerymobile-1.4.5/jqm.panel.css"]),define("hammer",["bower_components/hammerjs/hammer.min"],function(e){return e}),define("swipebox",["bower_components/swipebox/src/js/jquery.swipebox.min","css!bower_components/swipebox/src/css/swipebox.min.css"]),define("contentuploader",["apiclient/sync/contentuploader"]),define("serversync",["apiclient/sync/serversync"]),define("multiserversync",["apiclient/sync/multiserversync"]),define("offlineusersync",["apiclient/sync/offlineusersync"]),define("mediasync",["apiclient/sync/mediasync"]),Dashboard.isRunningInCordova()?define("fileupload",["cordova/fileupload"]):define("fileupload",["apiclient/fileupload"]),define("buttonenabled",["components/buttonenabled"]);var o=[];window.fetch||o.push("bower_components/fetch/fetch"),o.push("scripts/mediacontroller"),o.push("scripts/globalize"),o.push("apiclient/events"),o.push("jQuery"),require(o,function(){for(var o in a)AppInfo[o]=a[o];l(e)})}function l(e){var a=document.querySelector(".mainDrawerPanel");a.classList.remove("mainDrawerPanelPreInit"),a.forceNarrow=!0;var o=screen.availWidth-50;o=Math.max(o,240),o=Math.min(o,310),a.drawerWidth=o+"px",browserInfo.safari&&(a.disableEdgeSwipe=!0);var i=[];AppInfo.isNativeApp&&browserInfo.android&&require(["cordova/android/logging"]),i.push("scripts/librarybrowser"),i.push("appstorage"),i.push("scripts/mediaplayer"),i.push("scripts/appsettings"),i.push("apiclient/apiclient"),i.push("apiclient/connectionmanager"),i.push("apiclient/deferred"),i.push("apiclient/credentials"),i.push("thirdparty/jquerymobile-1.4.5/jquery.mobile.custom.js"),require(i,function(){$.fn.checked=function(e){return e===!0||e===!1?$(this).each(function(){this.checked=e}):this.length&&this[0].checked},Dashboard.isRunningInCordova()&&browserInfo.android?(AppInfo.directPlayAudioContainers="aac,mp3,mpa,wav,wma,mp2,ogg,oga,webma,ape,opus".split(","),AppSettings.syncLosslessAudio()&&AppInfo.directPlayAudioContainers.push("flac"),AppInfo.directPlayVideoContainers="m4v,3gp,ts,mpegts,mov,xvid,vob,mkv,wmv,asf,ogm,ogv,m2v,avi,mpg,mpeg,mp4,webm".split(",")):Dashboard.isRunningInCordova()&&browserInfo.safari&&(AppInfo.directPlayAudioContainers="aac,mp3,mpa,wav,wma,mp2,ogg,oga,webma,ape,opus".split(","),AppSettings.syncLosslessAudio()&&AppInfo.directPlayAudioContainers.push("flac"));var a=Dashboard.capabilities();a.DeviceProfile=MediaPlayer.getDeviceProfile(Math.max(screen.height,screen.width));var o=n(a);Promise.all([Globalize.ensure(),o]).then(function(){document.title=Globalize.translateDocument(document.title,"html");var a=document.querySelector(".mainDrawerPanelContent");if(a){var o=a.innerHTML.substring(4);o=o.substring(0,o.length-3);var n,i="data-require=",t=o.indexOf(i);if(-1!=t){var r=o.substring(t+i.length+1);r=r.substring(0,r.indexOf('"')),n=r.split(",")}return n=n||[],-1!=o.indexOf("type-interior")&&(n.push("jqmpopup"),n.push("jqmlistview"),n.push("jqmcollapsible"),n.push("jqmcontrolgroup"),n.push("jqmcheckbox"),n.push("scripts/notifications")),void require(n,function(){$(a).html(Globalize.translateDocument(o,"html")),c(e)})}c(e)})})}function c(e){var a=[];AppInfo.isNativeApp&&browserInfo.android?a.push("css!devices/android/android.css"):AppInfo.isNativeApp&&browserInfo.safari?a.push("css!devices/ios/ios.css"):browserInfo.android||a.push("css!devices/android/android.css"),r(),browserInfo.safari&&browserInfo.mobile&&i(),Dashboard.isRunningInCordova()?(a.push("cordova/registrationservices"),a.push("cordova/back"),browserInfo.android&&a.push("cordova/android/androidcredentials")):a.push("scripts/registrationservices"),browserInfo.msie&&a.push("devices/ie/ie"),AppInfo.isNativeApp&&browserInfo.safari&&a.push("cordova/ios/tabbar"),a.push("scripts/search"),a.push("scripts/librarylist"),a.push("scripts/alphapicker"),a.push("thirdparty/jquery.unveil-custom.js"),a.push("scripts/playlistmanager"),a.push("scripts/sync"),a.push("scripts/backdrops"),a.push("scripts/librarymenu"),require(a,function(){$.mobile.filterHtml=Dashboard.filterHtml,$.mobile.initializePage(),e();var a=[];navigator.webkitPersistentStorage?a.push("components/imagestore"):Dashboard.isRunningInCordova()&&a.push("cordova/imagestore"),a.push("scripts/thememediaplayer"),a.push("scripts/remotecontrol"),a.push("css!css/notifications.css"),a.push("css!css/chromecast.css"),Dashboard.isRunningInCordova()?(a.push("cordova/connectsdk"),a.push(browserInfo.android?"cordova/android/mediasession":"cordova/volume"),browserInfo.safari&&(a.push("cordova/ios/orientation"),Dashboard.capabilities().SupportsSync&&a.push("cordova/ios/backgroundfetch"))):browserInfo.chrome&&a.push("scripts/chromecast"),AppInfo.enableNowPlayingBar&&a.push("scripts/nowplayingbar"),require(a)})}function p(){return new Promise(function(e){document.addEventListener("deviceready",function(){cordova.getAppVersion.getVersionNumber(function(a){var o=browserInfo.android?"Emby for Android Mobile":browserInfo.safari?"Emby for iOS":"Emby Mobile",n=device.model.replace(/[^\w\s]/gi,""),i=window.MainActivity?MainActivity.getLegacyDeviceId():null;i=i||device.uuid,e({deviceId:i,deviceName:n,appName:o,appVersion:a})})},!1)})}function u(){return new Promise(function(e){function a(a){e({deviceId:a,deviceName:o,appName:"Emby Web Client",appVersion:window.dashboardVersion})}var o;o=browserInfo.chrome?"Chrome":browserInfo.edge?"Edge":browserInfo.mozilla?"Firefox":browserInfo.msie?"Internet Explorer":"Web Browser",browserInfo.version&&(o+=" "+browserInfo.version),browserInfo.ipad?o+=" Ipad":browserInfo.iphone?o+=" Iphone":browserInfo.android&&(o+=" Android");var n=appStorage.getItem("_deviceId");n?a(n):require(["cryptojs-sha1"],function(){var e=[];e.push(navigator.userAgent),e.push(navigator.cpuClass||"");var o=CryptoJS.SHA1(e.join("|")).toString();appStorage.setItem("_deviceId",o),a(o)})})}function m(){return Dashboard.isRunningInCordova()?p():u()}function f(e){var a=function(e){e=e.toLowerCase();var a=/(edge)[ \/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(safari)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],o=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||[],n=a[1]||"";return-1!=e.indexOf("windows phone")||-1!=e.indexOf("iemobile")?n="msie":-1!=e.indexOf("like gecko")&&-1==e.indexOf("webkit")&&-1==e.indexOf("opera")&&-1==e.indexOf("chrome")&&-1==e.indexOf("safari")&&(n="msie"),{browser:n,version:a[2]||"0",platform:o[0]||""}},o=window.navigator.userAgent,n=a(o),i={};n.browser&&(i[n.browser]=!0,i.version=n.version),n.platform&&(i[n.platform]=!0),i.chrome||i.msie||i.edge||i.opera||-1==o.toLowerCase().indexOf("webkit")||(i.safari=!0),e.any&&(i.mobile=!0),i.animate=null!=document.documentElement.animate,window.browserInfo=i}s();var h=[];h.push("isMobile"),h.push("apiclient/logger"),h.push("apiclient/store"),h.push("scripts/extensions");var b="registerElement"in document&&"content"in document.createElement("template");b||h.push("bower_components/webcomponentsjs/webcomponents-lite.min.js"),window.Promise||h.push("bower_components/native-promise-only/lib/npo.src"),require(h,function(e){Dashboard.initPromise=new Promise(function(o){function n(){var e=document.createElement("link");e.rel="import",e.onload=function(){m().then(function(e){d(o,e)})},e.href="vulcanize-out.html?v="+window.dashboardVersion,document.head.appendChild(e)}f(e),a(),t(),b?n():document.addEventListener("WebComponentsReady",n)})})}(),pageClassOn("pagecreate","page",function(){var e=this,a=e.getAttribute("data-theme");if(!a){var o;o=e.classList.contains("libraryPage")?"b":"a",e.setAttribute("data-theme",o)}}),pageClassOn("pageshow","page",function(){var e=this,a=e.classList.contains("ui-page-theme-a")?"a":"b",o=document.documentElement;"a"==a?(o.classList.add("background-theme-a"),o.classList.remove("background-theme-b"),e.classList.add("ui-body-a"),e.classList.remove("ui-body-b")):(o.classList.add("background-theme-b"),o.classList.remove("background-theme-a"),e.classList.add("ui-body-b"),e.classList.remove("ui-body-a")),"a"==a||browserInfo.mobile?document.body.classList.remove("darkScrollbars"):document.body.classList.add("darkScrollbars"),Dashboard.ensurePageTitle(e);var n=window.ApiClient;if(n&&n.accessToken()&&Dashboard.getCurrentUserId()){var i=e.classList.contains("type-interior");i&&(Dashboard.ensureToolsMenu(e),Dashboard.getCurrentUser().then(function(e){e.Policy.IsAdministrator||Dashboard.logout()}))}else{var t=Dashboard.isConnectMode();if(t&&!Dashboard.isServerlessPage())return void Dashboard.logout();if(!(t||"loginPage"===this.id||e.classList.contains("forgotPasswordPage")||e.classList.contains("forgotPasswordPinPage")||e.classList.contains("wizardPage")||"publicSharedItemPage"===this.id))return Logger.log("Not logged into server. Redirecting to login."),void Dashboard.logout()}Dashboard.ensureHeader(e),n&&!n.isWebSocketOpen()&&Dashboard.refreshSystemInfoFromServer()}),window.addEventListener("beforeunload",function(){var e=window.ApiClient;if(e&&e.isWebSocketOpen()){var a=MediaController.getPlayers().filter(function(e){return e.isLocalPlayer&&e.isPlaying()});a.length||(Logger.log("Sending close web socket command"),e.closeWebSocket())}});