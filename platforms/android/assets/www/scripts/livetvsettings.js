define(["jQuery"],function(e){function i(i,n){e(".liveTvSettingsForm",i).show(),e(".noLiveTvServices",i).hide(),e("#selectGuideDays",i).val(n.GuideDays||""),e("#chkMovies",i).checked(n.EnableMovieProviders),e("#chkOrganize",i).checked(n.EnableAutoOrganize),e("#chkConvertRecordings",i).checked(n.EnableRecordingEncoding),e("#chkPreserveAudio",i).checked(n.EnableOriginalAudioWithEncodedRecordings||!1),e("#txtPrePaddingMinutes",i).val(n.PrePaddingSeconds/60),e("#txtPostPaddingMinutes",i).val(n.PostPaddingSeconds/60),i.querySelector("#txtRecordingPath").value=n.RecordingPath||"",i.querySelector("#txtMovieRecordingPath").value=n.MovieRecordingPath||"",i.querySelector("#txtSeriesRecordingPath").value=n.SeriesRecordingPath||"",i.querySelector("#chkEnableRecordingSubfolders").checked=n.EnableRecordingSubfolders||!1,Dashboard.hideLoadingMsg()}function n(){Dashboard.showLoadingMsg();var i=this;return ApiClient.getNamedConfiguration("livetv").then(function(n){n.GuideDays=e("#selectGuideDays",i).val()||null,n.EnableMovieProviders=e("#chkMovies",i).checked(),n.EnableAutoOrganize=e("#chkOrganize",i).checked(),n.EnableRecordingEncoding=e("#chkConvertRecordings",i).checked(),n.EnableOriginalAudioWithEncodedRecordings=e("#chkPreserveAudio",i).checked();var r=i.querySelector("#txtRecordingPath").value||null,o=i.querySelector("#txtMovieRecordingPath").value||null,c=i.querySelector("#txtSeriesRecordingPath").value||null,a=r!=n.RecordingPath||o!=n.MovieRecordingPath||c!=n.SeriesRecordingPath;n.RecordingPath=r,n.MovieRecordingPath=o,n.SeriesRecordingPath=c,n.PrePaddingSeconds=60*e("#txtPrePaddingMinutes",i).val(),n.PostPaddingSeconds=60*e("#txtPostPaddingMinutes",i).val(),n.EnableRecordingSubfolders=i.querySelector("#chkEnableRecordingSubfolders").checked,ApiClient.updateNamedConfiguration("livetv",n).then(function(){Dashboard.processServerConfigurationUpdateResult(),t(a)})}),!1}function t(e){var i="";e&&(i+=Globalize.translate("RecordingPathChangeMessage")),i&&require(["alert"],function(e){e(i)})}function r(){return[{href:"livetvstatus.html",name:Globalize.translate("TabDevices")},{href:"livetvsettings.html",name:Globalize.translate("TabSettings")},{href:"appservices.html?context=livetv",name:Globalize.translate("TabServices")}]}e(document).on("pageinit","#liveTvSettingsPage",function(){var i=this;e(".liveTvSettingsForm").off("submit",n).on("submit",n),e("#btnSelectRecordingPath",i).on("click.selectDirectory",function(){require(["directorybrowser"],function(n){var t=new n;t.show({callback:function(n){n&&e("#txtRecordingPath",i).val(n),t.close()}})})}),e("#btnSelectMovieRecordingPath",i).on("click.selectDirectory",function(){require(["directorybrowser"],function(n){var t=new n;t.show({callback:function(n){n&&e("#txtMovieRecordingPath",i).val(n),t.close()}})})}),e("#btnSelectSeriesRecordingPath",i).on("click.selectDirectory",function(){require(["directorybrowser"],function(n){var t=new n;t.show({callback:function(n){n&&e("#txtSeriesRecordingPath",i).val(n),t.close()}})})})}).on("pageshow","#liveTvSettingsPage",function(){LibraryMenu.setTabs("livetvadmin",1,r),Dashboard.showLoadingMsg();var e=this;ApiClient.getNamedConfiguration("livetv").then(function(n){i(e,n)}),e.querySelector(".btnSupporterForConverting a").href=AppInfo.enableSupporterMembership?"https://emby.media/premiere":"#"})});