!function(){function e(e){Dashboard.getPluginSecurityInfo().then(function(a){if(a.IsMBSupporter)e.resolve();else{var r=parseInt(appStorage.getItem(n)||"0");r?(new Date).getTime()-r>3456e5?t(e):e.resolve():(appStorage.setItem(n,(new Date).getTime()),e.resolve())}})}function a(){var e=[];return e.push({name:Globalize.translate("CoverArt"),icon:"photo",text:Globalize.translate("CoverArtFeatureDescription")}),e.push({name:Globalize.translate("HeaderFreeApps"),icon:"check",text:Globalize.translate("FreeAppsFeatureDescription")}),e.push(Dashboard.capabilities().SupportsSync?{name:Globalize.translate("HeaderMobileSync"),icon:"sync",text:Globalize.translate("MobileSyncFeatureDescription")}:AppInfo.isNativeApp?{name:Globalize.translate("HeaderCloudSync"),icon:"sync",text:Globalize.translate("CloudSyncFeatureDescription")}:{name:Globalize.translate("HeaderCinemaMode"),icon:"movie",text:Globalize.translate("CinemaModeFeatureDescription")}),e}function r(e){var a="";return a+="<paper-icon-item>",a+='<paper-fab mini style="background-color:#52B54B;" icon="'+e.icon+'" item-icon></paper-fab>',a+="<paper-item-body three-line>",a+='<a class="clearLink" href="https://emby.media/premiere" target="_blank">',a+="<div>",a+=e.name,a+="</div>",a+='<div secondary style="white-space:normal;">',a+=e.text,a+="</div>",a+="</a>",a+="</paper-item-body>",a+="</paper-icon-item>"}function t(e){require(["components/paperdialoghelper"],function(){var t=PaperDialogHelper.createDialog({}),i="";i+='<h2 class="dialogHeader">',i+='<paper-fab icon="arrow-back" mini class="btnCancelSupporterInfo"></paper-fab>',i+="</h2>",i+='<div class="readOnlyContent" style="margin:20px auto 0;color:#fff;padding:1em;">',i+="<h1>"+Globalize.translate("HeaderTryEmbyPremiere")+"</h1>",i+="<p>"+Globalize.translate("MessageDidYouKnowCinemaMode")+"</p>",i+="<p>"+Globalize.translate("MessageDidYouKnowCinemaMode2")+"</p>",i+="<br/>",i+="<h1>"+Globalize.translate("HeaderBenefitsEmbyPremiere")+"</h1>",i+='<div class="paperList">',i+=a().map(r).join(""),i+="</div>",i+="<br/>",i+='<a class="clearLink" href="http://emby.media/premiere" target="_blank"><paper-button raised class="submit block"><iron-icon icon="check"></iron-icon><span>'+Globalize.translate("ButtonBecomeSupporter")+"</span></paper-button></a>",i+='<paper-button raised class="subdued block btnCancelSupporterInfo" style="background:#444;"><iron-icon icon="close"></iron-icon><span>'+Globalize.translate("ButtonClosePlayVideo")+"</span></paper-button>",i+="</div>",t.innerHTML=i,document.body.appendChild(t),t.addEventListener("iron-overlay-closed",function(){appStorage.setItem(n,(new Date).getTime()),t.parentNode.removeChild(t),e.resolve()}),PaperDialogHelper.openWithHash(t,"premiere"),$(".btnCancelSupporterInfo").on("click",function(){PaperDialogHelper.close(t)})})}function i(e){Dashboard.getPluginSecurityInfo().then(function(a){return a.IsMBSupporter?void e.resolve():(Dashboard.showLoadingMsg(),void ApiClient.getRegistrationInfo("Sync").then(function(a){return Dashboard.hideLoadingMsg(),a.IsRegistered?void e.resolve():void Dashboard.alert({message:Globalize.translate("HeaderSyncRequiresSupporterMembership")+'<br/><p><a href="http://emby.media/premiere" target="_blank">'+Globalize.translate("ButtonLearnMore")+"</a></p>",title:Globalize.translate("HeaderSync"),callback:function(){e.reject()}})},function(){e.reject(),Dashboard.hideLoadingMsg(),Dashboard.alert({message:Globalize.translate("ErrorValidatingSupporterInfo")})}))})}var n="lastSupporterPlaybackMessage4";window.RegistrationServices={renderPluginInfo:function(e,a,r){if(a.isPremium){$(".premiumPackage",e).show();var t="";if(a.isRegistered)t+="<p style='color:green;'>",t+=Globalize.translate("MessageFeatureIncludedWithSupporter");else{var i=new Date(a.expDate).getTime(),n=(new Date).getTime();n>=i?(t+="<p style='color:red;'>",t+=Globalize.translate("MessageTrialExpired")):i>new Date(1970,1,1).getTime()&&(t+="<p style='color:blue;'>",t+=Globalize.translate("MessageTrialWillExpireIn").replace("{0}",Math.round(i-n)/864e5))}if(t+="</p>",$("#regStatus",e).html(t),r.IsMBSupporter)if($("#regInfo",e).html(a.regInfo||""),$(".premiumDescription",e).hide(),$(".supporterDescription",e).hide(),a.price>0){$(".premiumHasPrice",e).show(),$("#featureId",e).val(a.featureId),$("#featureName",e).val(a.name),$("#amount",e).val(a.price),$("#regPrice",e).html("<h3>"+Globalize.translate("ValuePriceUSD").replace("{0}","$"+a.price.toFixed(2))+"</h3>");var o="http://mb3admin.com/admin/service/user/getPayPalEmail?id="+a.owner;fetch(o,{mode:"no-cors"}).then(function(e){return e.json()}).then(function(a){a.payPalEmail?$("#payPalEmail",e).val(a.payPalEmail):$("#ppButton",e).hide()})}else $(".premiumHasPrice",e).hide();else a.price?($(".premiumDescription",e).show(),$(".supporterDescription",e).hide(),$("#regInfo",e).html("")):($(".premiumDescription",e).hide(),$(".supporterDescription",e).show(),$("#regInfo",e).html("")),$("#ppButton",e).hide()}else $(".premiumPackage",e).hide()},validateFeature:function(a){var r=DeferredBuilder.Deferred();return"playback"==a?e(r):"livetv"==a?r.resolve():"sync"==a?i(r):r.resolve(),r.promise()}}}();