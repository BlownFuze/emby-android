!function(t,e,a){t.RatingDialog=function(t){var e=this;e.show=function(t){require(["jqmpopup"],function(){e.showInternal(t)})},e.showInternal=function(e){e=e||{},e.header=e.header||Globalize.translate("HeaderRateAndReview");var i='<div data-role="popup" id="popupRatingDialog" class="popup" style="min-width:400px;">';i+='<div class="ui-bar-a" style="text-align: center; padding: 0 20px;">',i+="<h3>"+e.header+"</h3>",i+="</div>",i+='<div style="padding: 1em;">',i+="<form>",i+='<div style="margin:0;">',i+='<label for="txtRatingDialogRating" >'+Globalize.translate("LabelYourRating")+"</label>",i+='<input id="txtRatingDialogRating" name="rating" type="number" required="required" min=0 max=5 step=1 value='+e.rating+" />",i+='<label for="txtRatingDialogTitle" >'+Globalize.translate("LabelShortRatingDescription")+"</label>",i+='<input id="txtRatingDialogTitle" name="title" type="text" maxlength=160 />',i+='<label for="txtRatingDialogRecommend" >'+Globalize.translate("OptionIRecommendThisItem")+"</label>",i+='<input id="txtRatingDialogRecommend" name="recommend" type="checkbox" checked />',i+='<label for="txtRatingDialogReview" >'+Globalize.translate("LabelFullReview")+"</label>",i+='<textarea id="txtRatingDialogReview" name="review" rows=8 style="height:inherit" ></textarea>',i+="</div>",i+="<p>",i+='<button type="submit" data-theme="b" data-icon="check">'+Globalize.translate("ButtonOk")+"</button>",i+='<button type="button" data-icon="delete" onclick="$(this).parents(\'.popup\').popup(\'close\');">'+Globalize.translate("ButtonCancel")+"</button>",i+="</p>",i+='<p id="errorMsg" style="display:none; color:red; font-weight:bold">',i+="</p>",i+="</form>",i+="</div>",i+="</div>",a(t).append(i);var n=a("#popupRatingDialog").popup().trigger("create").on("popupafteropen",function(){a("#txtRatingDialogTitle",this).focus()}).popup("open").on("popupafterclose",function(){a("form",this).off("submit"),a(this).off("popupafterclose").remove()});a("form",n).on("submit",function(){if(e.callback){var t={id:e.id,rating:a("#txtRatingDialogRating",this).val(),title:a("#txtRatingDialogTitle",this).val(),recommend:a("#txtRatingDialogRecommend",this).checked(),review:a("#txtRatingDialogReview",this).val()};e.callback(t)}return!1})},e.close=function(){a("#popupRatingDialog",t).popup("close")}},t.RatingHelpers={ratePackage:function(t){var e=t.getAttribute("data-id"),i=t.getAttribute("data-rating"),n=new RatingDialog(a.mobile.activePage);n.show({header:Globalize.translate("HeaderRateAndReview"),id:e,rating:i,callback:function(t){n.close(),ApiClient.createPackageReview(t).then(function(){Dashboard.alert({message:Globalize.translate("MessageThankYouForYourReview"),title:Globalize.translate("HeaderThankYou")})})}})},getStoreRatingHtml:function(t,e,a,i){var n="<div style='margin-left: 5px; margin-right: 5px; display: inline-block; vertical-align:middle;'>";t||(t=0);for(var l=1;5>=l;l++){var o=i?t+" stars":"Rate "+l+(l>1?" stars":" star");n+=i?"":"<a href='#' data-id="+e+" data-name='"+a+"' data-rating="+l+" onclick='RatingHelpers.ratePackage(this);return false;' >",n+=l-1>=t?"<div class='storeStarRating emptyStarRating' title='"+o+"'></div>":l>t?"<div class='storeStarRating halfStarRating' title='"+o+"'></div>":"<div class='storeStarRating' title='"+o+"'></div>",n+=i?"":"</a>"}return n+="</div>"}}}(window,document,jQuery);