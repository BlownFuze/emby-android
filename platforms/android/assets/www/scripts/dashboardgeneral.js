!function(e,t){function a(t,a,r){Dashboard.lastSystemInfo&&Dashboard.setPageTitle(Dashboard.lastSystemInfo.ServerName),o(t),t.querySelector("#txtServerName").value=a.ServerName||"",t.querySelector("#txtCachePath").value=a.CachePath||"",e("#selectLocalizationLanguage",t).html(r.map(function(e){return'<option value="'+e.Value+'">'+e.Name+"</option>"})).val(a.UICulture),i=a.UICulture,Dashboard.hideLoadingMsg()}function o(){ApiClient.getSystemInfo().then(function(e){Dashboard.setPageTitle(e.ServerName)})}function r(){Dashboard.showLoadingMsg();var t=this,a=e(t).parents(".page");return ApiClient.getServerConfiguration().then(function(r){r.ServerName=t.querySelector("#txtServerName").value,r.UICulture=e("#selectLocalizationLanguage",t).val(),r.CachePath=t.querySelector("#txtCachePath").value,r.UICulture!=i&&Dashboard.showDashboardRefreshNotification(),ApiClient.updateServerConfiguration(r).then(function(){o(a),ApiClient.getNamedConfiguration(s).then(function(e){e.LoginDisclaimer=t.querySelector("#txtLoginDisclaimer").value,e.CustomCss=t.querySelector("#txtCustomCss").value;var a=n&&e.CustomCss!=n.CustomCss;ApiClient.updateNamedConfiguration(s,e).then(Dashboard.processServerConfigurationUpdateResult),a&&Dashboard.showDashboardRefreshNotification()})})}),!1}var n,i,s="branding";e(t).on("pageinit","#dashboardGeneralPage",function(){var t=this;e("#btnSelectCachePath",t).on("click.selectDirectory",function(){require(["directorybrowser"],function(e){var a=new e;a.show({callback:function(e){e&&(t.querySelector("#txtCachePath").value=e),a.close()},header:Globalize.translate("HeaderSelectServerCachePath"),instruction:Globalize.translate("HeaderSelectServerCachePathHelp")})})}),e(".dashboardGeneralForm").off("submit",r).on("submit",r)}).on("pageshow","#dashboardGeneralPage",function(){Dashboard.showLoadingMsg();var e=this,t=ApiClient.getServerConfiguration(),o=ApiClient.getJSON(ApiClient.getUrl("Localization/Options"));Promise.all([t,o]).then(function(t){a(e,t[0],t[1])}),ApiClient.getNamedConfiguration(s).then(function(t){n=t,e.querySelector("#txtLoginDisclaimer").value=t.LoginDisclaimer||"",e.querySelector("#txtCustomCss").value=t.CustomCss||""})})}(jQuery,document,window);