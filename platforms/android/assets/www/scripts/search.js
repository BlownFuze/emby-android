define(["libraryBrowser","scrollStyles"],function(e){function n(){y&&(clearTimeout(y),y=null)}function t(e){return"Audio"==e.Type?[[e.AlbumArtist,e.Album].join(" - ")]:"MusicAlbum"==e.Type?[e.AlbumArtist]:"MusicArtist"==e.Type?[Globalize.translate("LabelArtist")]:"Movie"==e.Type?[Globalize.translate("LabelMovie")]:"MusicVideo"==e.Type?[Globalize.translate("LabelMusicVideo")]:"Episode"==e.Type?[Globalize.translate("LabelEpisode")]:"Series"==e.Type?[Globalize.translate("Series")]:"BoxSet"==e.Type?[Globalize.translate("LabelCollection")]:e.ChannelName?[e.ChannelName]:[e.Type]}function a(){var e=this;e.showSearchPanel=function(){h()}}function i(n,a){a=a.map(function(e){return e.Id=e.ItemId,e.ImageTags={},e.UserData={},e.PrimaryImageTag&&(e.ImageTags.Primary=e.PrimaryImageTag),e});var i=e.getPosterViewHtml({items:a,shape:"auto",lazy:!0,overlayText:!1,showTitle:!0,centerImage:!0,centerText:!0,textLines:t,overlayPlayButton:!0}),o=n.querySelector(".itemsContainer");o.innerHTML=i,ImageLoader.lazyChildren(o)}function o(e,n){var t=y;Dashboard.showLoadingMsg(),ApiClient.getSearchHints({userId:Dashboard.getCurrentUserId(),searchTerm:(n||"").trim(),limit:30}).then(function(n){t==y&&i(e,n.SearchHints),Dashboard.hideLoadingMsg()},function(){Dashboard.hideLoadingMsg()})}function r(e,t){if(!t){var a=e.querySelector(".itemsContainer");return a&&(a.innerHTML=""),void n()}n(),y=setTimeout(function(){o(e,t)},300)}function s(n){var t=document.querySelector(".searchResultsOverlay");if(n&&!t){var a=document.createElement("div");a.className="searchResultsOverlay ui-body-b smoothScrollY background-theme-b",a.innerHTML='<div class="searchResultsContainer"><div class="itemsContainer"></div></div></div>',document.body.appendChild(a),e.createCardMenus(a),t=a}return t}function c(e){var n;e?(n=s(!0),b||u(n,1),b=!0,document.body.classList.add("bodyWithPopupOpen"),r(n,e)):(n=s(!1),n&&(r(n,""),b&&(l(n,1),b=!1),document.body.classList.remove("bodyWithPopupOpen")))}function u(e,n){var t=[{opacity:"0",offset:0},{opacity:"1",offset:1}],a={duration:200,iterations:n,fill:"both"};e.animate&&e.animate(t,a)}function l(e,n){var t=[{opacity:"1",offset:0},{opacity:"0",offset:1}],a={duration:600,iterations:n,fill:"both"},i=function(){e.parentNode.removeChild(e)};e.animate?e.animate(t,a).onfinish=i:i()}function d(){require(["searchmenu"],function(){Events.on(window.SearchMenu,"closed",m),Events.on(window.SearchMenu,"change",function(e,n){c(n)})})}function m(){c(""),f()}function h(){require(["searchmenu"],function(){window.SearchMenu.show()})}function f(){require(["searchmenu"],function(){window.SearchMenu.hide()})}var y;window.Search=new a;var b;document.addEventListener("pagebeforehide",m),document.addEventListener("headercreated",function(){d()})});