define(["historyManager","focusManager","browser","layoutManager","inputManager","paper-dialog","scale-up-animation","fade-out-animation","fade-in-animation","css!./paperdialoghelper.css"],function(e,t,o,n,i){function a(t,o,n){function a(){var e=c.originalUrl==window.location.href;(e||!t.opened)&&window.removeEventListener("popstate",a),e&&(c.closedByBack=!0,t.close())}function l(e){"back"==e.detail.command&&(i.off(t,l),c.closedByBack=!0,t.close(),e.preventDefault())}function s(){if(u&&document.body.classList.remove("noScroll"),window.removeEventListener("popstate",a),i.off(t,l),!c.closedByBack&&r(t)){var e=history.state||{};e.dialogId==o&&history.back()}d.focus(),"true"==t.getAttribute("data-removeonclose")&&t.parentNode.removeChild(t),setTimeout(function(){n({element:t,closedByBack:c.closedByBack})},1)}var c=this;c.originalUrl=window.location.href;var d=document.activeElement,u=!1;t.addEventListener("iron-overlay-closed",s),t.open(),"true"!=t.getAttribute("data-lockscroll")||document.body.classList.contains("noScroll")||(document.body.classList.add("noScroll"),u=!0),r(t)?(e.pushState({dialogId:o},"Dialog",o),window.addEventListener("popstate",a)):i.on(t,l)}function r(e){return"true"==e.getAttribute("data-history")}function l(e){return new Promise(function(t){new a(e,"dlg"+(new Date).getTime(),t)})}function s(e){e.opened&&(r(e)?history.back():e.close())}function c(e){t.autoFocus(e.target)}function d(e){return null!=e.lockScroll?e.lockScroll:"fullscreen"==e.size?!0:o.mobile}function u(t){t=t||{};var i=document.createElement("paper-dialog");i.setAttribute("with-backdrop","with-backdrop"),i.setAttribute("role","alertdialog"),d(t)&&i.setAttribute("data-lockscroll","true"),t.enableHistory!==!1&&e.enableNativeHistory()&&i.setAttribute("data-history","true"),t.modal!==!1&&i.setAttribute("modal","modal"),i.setAttribute("noAutoFocus","noAutoFocus");var a=o.animate&&!o.mobile?"scale-up-animation":"fade-in-animation";i.entryAnimation=t.entryAnimation||a,i.exitAnimation="fade-out-animation";var r=t.entryAnimationDuration||(t.size?240:300);return i.animationConfig={entry:{name:i.entryAnimation,node:i,timing:{duration:r,easing:"ease-out"}},exit:{name:i.exitAnimation,node:i,timing:{duration:t.exitAnimationDuration||400,easing:"ease-in"}}},o.animate||(i.animationConfig=null,i.entryAnimation=null,i.exitAnimation=null),i.classList.add("paperDialog"),i.classList.add("scrollY"),(n.tv||n.mobile)&&i.classList.add("hiddenScroll"),t.removeOnClose&&i.setAttribute("data-removeonclose","true"),t.size&&(i.classList.add("fixedSize"),i.classList.add(t.size)),t.autoFocus!==!1&&i.addEventListener("iron-overlay-opened",c),i}return{open:l,close:s,createDialog:u}});