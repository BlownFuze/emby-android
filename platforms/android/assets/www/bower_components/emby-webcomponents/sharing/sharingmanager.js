define(["connectionManager","sharingMenu","loading"],function(e,n,t){function r(e,n){var t=e.share.Id;n.ajax({type:"DELETE",url:n.getUrl("Social/Shares/"+t)})}function a(a){t.show();var i=a.itemId,u=e.getApiClient(a.serverId),o=u.getCurrentUserId();return u.getItem(o,i).then(function(){return u.ajax({type:"POST",url:u.getUrl("Social/Shares",{ItemId:i,UserId:o}),dataType:"json"}).then(function(e){var a={share:e};return t.hide(),n.showMenu(a).then(function(){},function(){r(a,u)})},function(){t.hide()})})}return{showMenu:a}});