define(["connectionManager","sharingMenu","loading"],function(e,n,t){function r(e,n){var t=e.share.Id;n.ajax({type:"DELETE",url:n.getUrl("Social/Shares/"+t)})}function a(a){t.show();var i=a.itemId,o=e.getApiClient(a.serverId),u=o.getCurrentUserId();return o.getItem(u,i).then(function(){return o.ajax({type:"POST",url:o.getUrl("Social/Shares",{ItemId:i,UserId:u}),dataType:"json"}).then(function(e){var a={share:e};t.hide(),n.showMenu(a).then(function(){},function(){r(a,o)})},function(){t.hide()})})}return{showMenu:a}});