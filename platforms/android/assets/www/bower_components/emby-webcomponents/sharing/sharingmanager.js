define(["connectionManager","sharingMenu","loading"],function(e,n,t){function r(e){}function i(e,n){var t=e.share.Id;n.ajax({type:"DELETE",url:n.getUrl("Social/Shares/"+t)})}function a(a){t.show();var o=a.itemId,u=a.apiClient||e.getApiClient(a.serverId),c=u.getCurrentUserId();return u.getItem(c,o).then(function(){return u.ajax({type:"POST",url:u.getUrl("Social/Shares",{ItemId:o,UserId:c}),dataType:"json"}).then(function(e){var a={share:e};t.hide(),n.showMenu(a,r,function(e){i(e,u)})},function(){t.hide()})})}return{showMenu:a}});