define(["itemHelper","dialogHelper","datetime","loading","focusManager","connectionManager","globalize","require","emby-checkbox","emby-input","emby-select","listViewStyle","emby-textarea","emby-button","paper-icon-button-light"],function(e,t,r,a,i,n,l,o){function u(){return j.classList.contains("dialog")}function s(){u()&&t.close(j)}function c(e,t){function r(){o(["toast"],function(e){e(l.translate("MessageItemSaved"))}),a.hide(),s(!0)}var i=D();i.updateItem(t).then(function(){var a=e.querySelector("#selectContentType").value||"";(_.ContentType||"")!=a?i.ajax({url:i.getUrl("Items/"+t.Id+"/ContentType",{ContentType:a}),type:"POST"}).then(function(){r()}):r()})}function d(e){var t=e.querySelectorAll(".chkAirDay:checked")||[];return Array.prototype.map.call(t,function(){return this.getAttribute("data-day")})}function y(e){return e.querySelector("#txtAlbumArtist").value.trim().split(";").filter(function(e){return e.length>0}).map(function(e){return{Name:e}})}function p(e){return e.querySelector("#txtArtist").value.trim().split(";").filter(function(e){return e.length>0}).map(function(e){return{Name:e}})}function v(e,t,a){var i=e.querySelector(t).value;if(!i)return null;if(J[a]){var n=r.parseISO8601Date(J[a],!0),l=n.toISOString().split("T");if(0==l[0].indexOf(i)){var o=l[1];i+="T"+o}}return i}function m(e){a.show();var t=this;try{var r={Id:J.Id,Name:t.querySelector("#txtName").value,OriginalTitle:t.querySelector("#txtOriginalName").value,ForcedSortName:t.querySelector("#txtSortName").value,DisplayMediaType:t.querySelector("#txtDisplayMediaType").value,CommunityRating:t.querySelector("#txtCommunityRating").value,VoteCount:t.querySelector("#txtCommunityVoteCount").value,HomePageUrl:t.querySelector("#txtHomePageUrl").value,Budget:t.querySelector("#txtBudget").value,Revenue:t.querySelector("#txtRevenue").value,CriticRating:t.querySelector("#txtCriticRating").value,CriticRatingSummary:t.querySelector("#txtCriticRatingSummary").value,IndexNumber:t.querySelector("#txtIndexNumber").value||null,AbsoluteEpisodeNumber:t.querySelector("#txtAbsoluteEpisodeNumber").value,DvdEpisodeNumber:t.querySelector("#txtDvdEpisodeNumber").value,DvdSeasonNumber:t.querySelector("#txtDvdSeasonNumber").value,AirsBeforeSeasonNumber:t.querySelector("#txtAirsBeforeSeason").value,AirsAfterSeasonNumber:t.querySelector("#txtAirsAfterSeason").value,AirsBeforeEpisodeNumber:t.querySelector("#txtAirsBeforeEpisode").value,ParentIndexNumber:t.querySelector("#txtParentIndexNumber").value||null,DisplayOrder:t.querySelector("#selectDisplayOrder").value,Players:t.querySelector("#txtPlayers").value,Album:t.querySelector("#txtAlbum").value,AlbumArtist:y(t),ArtistItems:p(t),Metascore:t.querySelector("#txtMetascore").value,AwardSummary:t.querySelector("#txtAwardSummary").value,Overview:t.querySelector("#txtOverview").value,ShortOverview:t.querySelector("#txtShortOverview").value,Status:t.querySelector("#selectStatus").value,AirDays:d(t),AirTime:t.querySelector("#txtAirTime").value,Genres:f(t.querySelector("#listGenres")),ProductionLocations:f(t.querySelector("#listCountries")),Tags:f(t.querySelector("#listTags")),Keywords:f(t.querySelector("#listKeywords")),Studios:f(t.querySelector("#listStudios")).map(function(e){return{Name:e}}),PremiereDate:v(t,"#txtPremiereDate","PremiereDate"),DateCreated:v(t,"#txtDateAdded","DateCreated"),EndDate:v(t,"#txtEndDate","EndDate"),ProductionYear:t.querySelector("#txtProductionYear").value,AspectRatio:t.querySelector("#txtOriginalAspectRatio").value,Video3DFormat:t.querySelector("#select3dFormat").value,OfficialRating:t.querySelector("#selectOfficialRating").value,CustomRating:t.querySelector("#selectCustomRating").value,People:J.People,LockData:t.querySelector("#chkLockData").checked,LockedFields:Array.prototype.filter.call(t.querySelectorAll(".selectLockedField"),function(e){return!e.checked}).map(function(e){return e.getAttribute("data-value")})};r.ProviderIds=Object.assign({},J.ProviderIds);var i=t.querySelectorAll(".txtExternalId");if(Array.prototype.map.call(i,function(e){var t=e.getAttribute("data-providerkey");r.ProviderIds[t]=e.value}),r.PreferredMetadataLanguage=t.querySelector("#selectLanguage").value,r.PreferredMetadataCountryCode=t.querySelector("#selectCountry").value,"Person"==J.Type){var n=t.querySelector("#txtPlaceOfBirth").value;r.ProductionLocations=n?[n]:[]}if("Series"==J.Type){var l=t.querySelector("#txtSeriesRuntime").value;r.RunTimeTicks=l?6e8*l:null}var o=t.querySelector("#txtTagline").value;r.Taglines=o?[o]:[],c(t,r)}catch(u){alert(u)}return e.preventDefault(),e.stopPropagation(),!1}function S(e,t){for(;!e.classList||!e.classList.contains(t);)if(e=e.parentNode,!e)return null;return e}function f(e){return Array.prototype.map.call(e.querySelectorAll(".textValue"),function(e){return e.textContent})}function b(e,t){o(["prompt"],function(r){r({label:"Value:"}).then(function(r){var a=S(e,"editableListviewContainer").querySelector(".paperList"),i=f(a);i.push(r),G(a,i,t)})})}function g(e){var t=S(e,"listItem");t.parentNode.removeChild(t)}function q(e,t,r){o(["personEditor"],function(a){a.show(t).then(function(t){var a=-1==r;a&&J.People.push(t),U(e,J.People)})})}function x(e,t){o(["itemContextMenu"],function(r){r.show({item:J,positionTo:t,edit:!1,editImages:!0,editSubtitles:!0,sync:!1,share:!1}).then(function(t){t.deleted?Emby.Page.goHome():t.updated&&z(e,J.Id,J.ServerId)})})}function T(e,t){var r=t;"LibraryChanged"===r.MessageType&&-1!=r.Data.ItemsUpdated.indexOf(J.Id)&&z(j,J.Id,J.ServerId)}function h(e,t){Events.on(t,"websocketmessage",T)}function A(e,t){Events.off(t,"websocketmessage",T)}function C(e){var t=S(e.target,"btnRemoveFromEditorList");if(t)return void g(t);var r=S(e.target,"btnAddTextItem");r&&b(r)}function D(){return n.getApiClient(J.ServerId)}function P(e,t){e.querySelector(".btnCancel").addEventListener("click",function(){s(!1)}),e.querySelector(".btnMore").addEventListener("click",function(t){D().getCurrentUser().then(function(r){x(e,t.target,r)})}),e.querySelector(".btnHeaderSave").addEventListener("click",function(){e.querySelector(".btnSave").click()}),e.querySelector("#chkLockData").addEventListener("click",function(e){e.target.checked?k(".providerSettingsContainer"):w(".providerSettingsContainer")}),e.removeEventListener("click",C),e.addEventListener("click",C);var r=e.querySelector("form");r.removeEventListener("submit",m),r.addEventListener("submit",m),e.querySelector("#btnAddPerson").addEventListener("click",function(){q(e,{},-1)}),u()&&h(e,t)}function L(e,t){var r=n.getApiClient(t);return e?r.getItem(r.getCurrentUserId(),e):r.getRootFolder(r.getCurrentUserId())}function N(e,t){var r=n.getApiClient(t);return e?r.getJSON(r.getUrl("Items/"+e+"/MetadataEditor")):Promise.resolve({})}function O(e,t){var r="";r+="<option value=''></option>";for(var a=0,i=t.length;i>a;a++){var n=t[a];r+="<option value='"+n.TwoLetterISORegionName+"'>"+n.DisplayName+"</option>"}e.innerHTML=r}function E(e,t){var r="";r+="<option value=''></option>";for(var a=0,i=t.length;i>a;a++){var n=t[a];r+="<option value='"+n.TwoLetterISOLanguageName+"'>"+n.DisplayName+"</option>"}e.innerHTML=r}function I(e,t){t.ContentTypeOptions.length?w("#fldContentType",e):k("#fldContentType",e);var r=t.ContentTypeOptions.map(function(e){return'<option value="'+e.Value+'">'+e.Name+"</option>"}).join(""),a=e.querySelector("#selectContentType");a.innerHTML=r,a.value=t.ContentType||""}function R(){var e=this.getAttribute("data-formatstring"),t=this.getAttribute("data-buttonclass");this.value?document.querySelector("."+t).setAttribute("href",e.replace("{0}",this.value)):document.querySelector("."+t).setAttribute("href","#")}function M(e,t,r){for(var a="",i=t.ProviderIds||{},n=0,o=r.length;o>n;n++){var u=r[n],s="txt1"+u.Key,c="btnOpen1"+u.Key,d=u.UrlFormatString||"",y=l.translate("LabelDynamicExternalId").replace("{0}",u.Name);a+='<div class="inputContainer">',a+='<div style="display: flex; align-items: center;">';var p=i[u.Key]||"";a+='<div style="flex-grow:1;">',a+='<input is="emby-input" class="txtExternalId" value="'+p+'" data-providerkey="'+u.Key+'" data-formatstring="'+d+'" data-buttonclass="'+c+'" id="'+s+'" label="'+y+'"/>',a+="</div>",d&&(a+='<a class="clearLink '+c+'" href="#" target="_blank" data-role="none" style="float: none; width: 1.75em"><button type="button" is="paper-icon-button-light" class="autoSize"><i class="md-icon">open_in_browser</i></button></a>'),a+="</div>",a+="</div>"}var v=e.querySelector(".externalIds",e);v.innerHTML=a;var m=v.querySelector(".txtExternalId")||[];Array.prototype.forEach.call(m,function(e){e.addEventListener("change",R.bind(e)),e.dispatchEvent(new Event("change"))})}function k(e,t,r){if(t=t||document,"string"==typeof e){var a=r?t.querySelectorAll(e):[t.querySelector(e)];Array.prototype.forEach.call(a,function(e){e&&e.classList.add("hide")})}else e.classList.add("hide")}function w(e,t,r){if(t=t||document,"string"==typeof e){var a=r?t.querySelectorAll(e):[t.querySelector(e)];Array.prototype.forEach.call(a,function(e){e&&e.classList.remove("hide")})}else e.classList.remove("hide")}function B(e,t){t.Path&&"Remote"!=t.LocationType?w("#fldPath",e):k("#fldPath",e),"Series"==t.Type||"Movie"==t.Type||"Trailer"==t.Type?w("#fldOriginalName",e):k("#fldOriginalName",e),"Series"==t.Type?w("#fldSeriesRuntime",e):k("#fldSeriesRuntime",e),"Series"==t.Type||"Person"==t.Type?w("#fldEndDate",e):k("#fldEndDate",e),"Movie"==t.Type||"Game"==t.MediaType||"Trailer"==t.MediaType||"MusicVideo"==t.Type?(w("#fldBudget",e),w("#fldRevenue",e)):(k("#fldBudget",e),k("#fldRevenue",e)),"MusicAlbum"==t.Type?w("#albumAssociationMessage",e):k("#albumAssociationMessage",e),"Game"==t.MediaType?w("#fldPlayers",e):k("#fldPlayers",e),"Movie"==t.Type||"Trailer"==t.Type?(w("#fldCriticRating",e),w("#fldCriticRatingSummary",e)):(k("#fldCriticRating",e),k("#fldCriticRatingSummary",e)),"Movie"==t.Type?w("#fldAwardSummary",e):k("#fldAwardSummary",e),"Movie"==t.Type||"Trailer"==t.Type?w("#fldMetascore",e):k("#fldMetascore",e),"Series"==t.Type?(w("#fldStatus",e),w("#fldAirDays",e),w("#fldAirTime",e)):(k("#fldStatus",e),k("#fldAirDays",e),k("#fldAirTime",e)),"Video"==t.MediaType&&"TvChannel"!=t.Type?w("#fld3dFormat",e):k("#fld3dFormat",e),"Audio"==t.Type?w("#fldAlbumArtist",e):k("#fldAlbumArtist",e),"Audio"==t.Type||"MusicVideo"==t.Type?(w("#fldArtist",e),w("#fldAlbum",e)):(k("#fldArtist",e),k("#fldAlbum",e)),"Episode"==t.Type?w("#collapsibleDvdEpisodeInfo",e):k("#collapsibleDvdEpisodeInfo",e),"Episode"==t.Type&&0==t.ParentIndexNumber?w("#collapsibleSpecialEpisodeInfo",e):k("#collapsibleSpecialEpisodeInfo",e),"Person"==t.Type||"Genre"==t.Type||"Studio"==t.Type||"GameGenre"==t.Type||"MusicGenre"==t.Type||"TvChannel"==t.Type?(k("#fldCommunityRating",e),k("#fldCommunityVoteCount",e),k("#genresCollapsible",e),k("#peopleCollapsible",e),k("#studiosCollapsible",e),"TvChannel"==t.Type?w("#fldOfficialRating",e):k("#fldOfficialRating",e),k("#fldCustomRating",e)):(w("#fldCommunityRating",e),w("#fldCommunityVoteCount",e),w("#genresCollapsible",e),w("#peopleCollapsible",e),w("#studiosCollapsible",e),w("#fldOfficialRating",e),w("#fldCustomRating",e)),"Movie"==t.Type||"Trailer"==t.Type||"MusicArtist"==t.Type?w("#countriesCollapsible",e):k("#countriesCollapsible",e),"TvChannel"==t.Type?(k("#tagsCollapsible",e),k("#metadataSettingsCollapsible",e),k("#fldPremiereDate",e),k("#fldDateAdded",e),k("#fldYear",e)):(w("#tagsCollapsible",e),w("#metadataSettingsCollapsible",e),w("#fldPremiereDate",e),w("#fldDateAdded",e),w("#fldYear",e)),"Movie"==t.Type||"Trailer"==t.Type||"BoxSet"==t.Type?w("#keywordsCollapsible",e):k("#keywordsCollapsible",e),"Video"==t.MediaType&&"TvChannel"!=t.Type?w("#fldSourceType",e):k("#fldSourceType",e),"Person"==t.Type?(e.querySelector("#txtProductionYear").label(l.translate("LabelBirthYear")),e.querySelector("#txtPremiereDate").label(l.translate("LabelBirthDate")),e.querySelector("#txtEndDate").label(l.translate("LabelDeathDate")),w("#fldPlaceOfBirth")):(e.querySelector("#txtProductionYear").label(l.translate("LabelYear")),e.querySelector("#txtPremiereDate").label(l.translate("LabelReleaseDate")),e.querySelector("#txtEndDate").label(l.translate("LabelEndDate")),k("#fldPlaceOfBirth")),"Video"==t.MediaType&&"TvChannel"!=t.Type?w("#fldOriginalAspectRatio"):k("#fldOriginalAspectRatio"),"Audio"==t.Type||"Episode"==t.Type||"Season"==t.Type?(w("#fldIndexNumber"),e.querySelector("#txtIndexNumber").label("Episode"==t.Type?l.translate("LabelEpisodeNumber"):"Season"==t.Type?l.translate("LabelSeasonNumber"):"Audio"==t.Type?l.translate("LabelTrackNumber"):l.translate("LabelNumber"))):k("#fldIndexNumber"),"Audio"==t.Type||"Episode"==t.Type?(w("#fldParentIndexNumber"),e.querySelector("#txtParentIndexNumber").label("Episode"==t.Type?l.translate("LabelSeasonNumber"):"Audio"==t.Type?l.translate("LabelDiscNumber"):l.translate("LabelParentNumber"))):k("#fldParentIndexNumber",e),"BoxSet"==t.Type?(w("#fldDisplayOrder",e),e.querySelector("#selectDisplayOrder").innerHTML='<option value="SortName">'+l.translate("OptionSortName")+'</option><option value="PremiereDate">'+l.translate("OptionReleaseDate")+"</option>"):(e.querySelector("#selectDisplayOrder").innerHTML="",k("#fldDisplayOrder",e));var r=e.querySelectorAll(".fldDisplaySetting"),a=Array.prototype.filter.call(r,function(e){return"none"!=e.style.display});a.length?w("#collapsibleDisplaySettings",e):k("#collapsibleDisplaySettings",e)}function H(e,t,a){var i=e.querySelector("#selectOfficialRating");V(a,i,t.OfficialRating),i.value=t.OfficialRating||"",i=e.querySelector("#selectCustomRating"),V(a,i,t.CustomRating),i.value=t.CustomRating||"";var n=e.querySelector("#selectStatus");F(n),n.value=t.Status||"",e.querySelector("#select3dFormat",e).value=t.Video3DFormat||"",Array.prototype.forEach.call(e.querySelectorAll(".chkAirDay",e),function(e){e.checked=-1!=(t.AirDays||[]).indexOf(e.getAttribute("data-day"))}),G(e.querySelector("#listCountries"),t.ProductionLocations||[]),G(e.querySelector("#listGenres"),t.Genres),U(e,t.People||[]),G(e.querySelector("#listStudios"),(t.Studios||[]).map(function(e){return e.Name||""})),G(e.querySelector("#listTags"),t.Tags),G(e.querySelector("#listKeywords"),t.Keywords);var l=t.LockData||!1,o=e.querySelector("#chkLockData");o.checked=l,o.checked?k(".providerSettingsContainer",e):w(".providerSettingsContainer",e),Y(e,t,t.LockedFields),e.querySelector("#txtPath").value=t.Path||"",e.querySelector("#txtName").value=t.Name||"",e.querySelector("#txtOriginalName").value=t.OriginalTitle||"",e.querySelector("#txtOverview").value=t.Overview||"",e.querySelector("#txtShortOverview").value=t.ShortOverview||"",e.querySelector("#txtTagline").value=t.Taglines&&t.Taglines.length?t.Taglines[0]:"",e.querySelector("#txtSortName").value=t.ForcedSortName||"",e.querySelector("#txtDisplayMediaType").value=t.DisplayMediaType||"",e.querySelector("#txtCommunityRating").value=t.CommunityRating||"",e.querySelector("#txtCommunityVoteCount").value=t.VoteCount||"",e.querySelector("#txtHomePageUrl").value=t.HomePageUrl||"",e.querySelector("#txtAwardSummary").value=t.AwardSummary||"",e.querySelector("#txtMetascore").value=t.Metascore||"",e.querySelector("#txtBudget").value=t.Budget||"",e.querySelector("#txtRevenue").value=t.Revenue||"",e.querySelector("#txtCriticRating").value=t.CriticRating||"",e.querySelector("#txtCriticRatingSummary").value=t.CriticRatingSummary||"",e.querySelector("#txtIndexNumber").value="IndexNumber"in t?t.IndexNumber:"",e.querySelector("#txtParentIndexNumber").value="ParentIndexNumber"in t?t.ParentIndexNumber:"",e.querySelector("#txtPlayers").value=t.Players||"",e.querySelector("#txtAbsoluteEpisodeNumber").value="AbsoluteEpisodeNumber"in t?t.AbsoluteEpisodeNumber:"",e.querySelector("#txtDvdEpisodeNumber").value="DvdEpisodeNumber"in t?t.DvdEpisodeNumber:"",e.querySelector("#txtDvdSeasonNumber").value="DvdSeasonNumber"in t?t.DvdSeasonNumber:"",e.querySelector("#txtAirsBeforeSeason").value="AirsBeforeSeasonNumber"in t?t.AirsBeforeSeasonNumber:"",e.querySelector("#txtAirsAfterSeason").value="AirsAfterSeasonNumber"in t?t.AirsAfterSeasonNumber:"",e.querySelector("#txtAirsBeforeEpisode").value="AirsBeforeEpisodeNumber"in t?t.AirsBeforeEpisodeNumber:"",e.querySelector("#txtAlbum").value=t.Album||"",e.querySelector("#txtAlbumArtist").value=(t.AlbumArtists||[]).map(function(e){return e.Name}).join(";"),e.querySelector("#selectDisplayOrder").value=t.DisplayOrder,e.querySelector("#txtArtist").value=(t.ArtistItems||[]).map(function(e){return e.Name}).join(";");var u;if(t.DateCreated)try{u=r.parseISO8601Date(t.DateCreated,!0),e.querySelector("#txtDateAdded").value=u.toISOString().slice(0,10)}catch(s){e.querySelector("#txtDateAdded").value=""}else e.querySelector("#txtDateAdded").value="";if(t.PremiereDate)try{u=r.parseISO8601Date(t.PremiereDate,!0),e.querySelector("#txtPremiereDate").value=u.toISOString().slice(0,10)}catch(s){e.querySelector("#txtPremiereDate").value=""}else e.querySelector("#txtPremiereDate").value="";if(t.EndDate)try{u=r.parseISO8601Date(t.EndDate,!0),e.querySelector("#txtEndDate").value=u.toISOString().slice(0,10)}catch(s){e.querySelector("#txtEndDate").value=""}else e.querySelector("#txtEndDate").value="";e.querySelector("#txtProductionYear").value=t.ProductionYear||"",e.querySelector("#txtAirTime").value=t.AirTime||"";var c=t.ProductionLocations&&t.ProductionLocations.length?t.ProductionLocations[0]:"";if(e.querySelector("#txtPlaceOfBirth").value=c,e.querySelector("#txtOriginalAspectRatio").value=t.AspectRatio||"",e.querySelector("#selectLanguage").value=t.PreferredMetadataLanguage||"",e.querySelector("#selectCountry").value=t.PreferredMetadataCountryCode||"",t.RunTimeTicks){var d=t.RunTimeTicks/6e8;e.querySelector("#txtSeriesRuntime").value=Math.round(d)}else e.querySelector("#txtSeriesRuntime",e).value=""}function V(e,t,r){var a="";a+="<option value=''></option>";var i,n,l,o=[],u=!1;for(i=0,n=e.length;n>i;i++)l=e[i],o.push({Name:l.Name,Value:l.Name}),l.Name==r&&(u=!0);for(r&&!u&&o.push({Name:r,Value:r}),i=0,n=o.length;n>i;i++)l=o[i],a+="<option value='"+l.Value+"'>"+l.Name+"</option>";t.innerHTML=a}function F(e){var t="";t+="<option value=''></option>",t+="<option value='Continuing'>"+l.translate("OptionContinuing")+"</option>",t+="<option value='Ended'>"+l.translate("OptionEnded")+"</option>",e.innerHTML=t}function G(e,t,r){t=t||[],"undefined"==typeof r?t.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}):t=r(t);for(var a="",i=0;i<t.length;i++)a+='<div class="listItem">',a+='<button type="button" is="emby-button" data-index="'+i+'" class="fab autoSize mini"><i class="md-icon">live_tv</i></button>',a+='<div class="listItemBody">',a+='<div class="textValue">',a+=t[i],a+="</div>",a+="</div>",a+='<button type="button" is="paper-icon-button-light" data-index="'+i+'" class="btnRemoveFromEditorList autoSize"><i class="md-icon">delete</i></button>',a+="</div>";e.innerHTML=a}function U(e,t){for(var r="",a="",i=e.querySelector("#peopleList"),n=0,l=t.length;l>n;n++){var o=t[n];a+='<div class="listItem">',a+='<button type="button" is="emby-button" data-index="'+n+'" class="btnEditPerson fab autoSize mini"><i class="md-icon">person</i></button>',a+='<div class="listItemBody">',a+='<a class="btnEditPerson clearLink" href="#" data-index="'+n+'">',a+='<div class="textValue">',a+=o.Name||"",a+="</div>",o.Role&&o.Role!=r&&(a+='<div class="secondary">'+o.Role+"</div>"),a+="</a>",a+="</div>",a+='<button type="button" is="paper-icon-button-light" data-index="'+n+'" class="btnDeletePerson autoSize"><i class="md-icon">delete</i></button>',a+="</div>"}i.innerHTML=a;var u=i.querySelector(".btnDeletePerson");u&&u.addEventListener("click",function(){var t=parseInt(this.getAttribute("data-index"));J.People.splice(t,1),U(e,J.People)}.bind(u));var s=i.querySelector(".btnEditPerson");s&&s.addEventListener("click",function(){var t=parseInt(this.getAttribute("data-index"));q(e,J.People[t],t)}.bind(s))}function K(e,t){for(var r="",a=0;a<e.length;a++){var i=e[a],n=i.name,l=i.value||i.name,o=-1==t.indexOf(l)?" checked":"";r+="<label>",r+='<input type="checkbox" is="emby-checkbox" class="selectLockedField" data-value="'+l+'"'+o+"/>",r+="<span>"+n+"</span>",r+="</label>"}return r}function Y(e,t,r){var a=e.querySelector(".providerSettingsContainer");r=r||new Array;var i=[{name:l.translate("OptionName"),value:"Name"},{name:l.translate("OptionOverview"),value:"Overview"},{name:l.translate("OptionGenres"),value:"Genres"},{name:l.translate("OptionParentalRating"),value:"OfficialRating"},{name:l.translate("OptionPeople"),value:"Cast"}];i.push("Person"==t.Type?{name:l.translate("OptionBirthLocation"),value:"ProductionLocations"}:{name:l.translate("OptionProductionLocations"),value:"ProductionLocations"}),"Series"==t.Type&&i.push({name:l.translate("OptionRuntime"),value:"Runtime"}),i.push({name:l.translate("OptionStudios"),value:"Studios"}),i.push({name:l.translate("OptionTags"),value:"Tags"}),i.push({name:l.translate("OptionKeywords"),value:"Keywords"}),i.push({name:l.translate("OptionImages"),value:"Images"}),i.push({name:l.translate("OptionBackdrops"),value:"Backdrops"}),"Game"==t.Type&&i.push({name:l.translate("OptionScreenshots"),value:"Screenshots"});var n="";n+="<h1>"+l.translate("HeaderEnabledFields")+"</h1>",n+="<p>"+l.translate("HeaderEnabledFieldsHelp")+"</p>",n+=K(i,r),a.innerHTML=n}function z(e,t,r){a.show(),Promise.all([L(t,r),N(t,r)]).then(function(t){var r=t[0];_=t[1],J=r;var i=_.Cultures,n=_.Countries;I(e,_),M(e,r,_.ExternalIdInfos),E(e.querySelector("#selectLanguage"),i),O(e.querySelector("#selectCountry"),n),B(e,r),H(e,r,_.ParentalRatingOptions),"Video"==r.MediaType&&"Episode"!=r.Type?w("#fldShortOverview",e):k("#fldShortOverview",e),"Video"==r.MediaType&&"Episode"!=r.Type?w("#fldTagline",e):k("#fldTagline",e),a.hide()})}var j,_,J;return{show:function(e,r){return new Promise(function(i){a.show(),o(["text!./metadataeditor.template.html"],function(a){var o=t.createDialog({removeOnClose:!0,size:"medium"});o.classList.add("ui-body-b"),o.classList.add("background-theme-b"),o.classList.add("formDialog");var u="";u+=l.translateDocument(a),o.innerHTML=u,document.body.appendChild(o),t.open(o),o.addEventListener("close",function(){A(o,n.getApiClient(r)),i()}),j=o,P(o,n.getApiClient(r)),z(o,e,r)})})},embed:function(e,t,r){return new Promise(function(){a.show(),o(["text!./metadataeditor.template.html"],function(a){e.innerHTML=l.translateDocument(a),e.querySelector(".btnCancel").classList.add("hide"),j=e,P(e,n.getApiClient(r)),z(e,t,r),i.autoFocus(e)})})}}});