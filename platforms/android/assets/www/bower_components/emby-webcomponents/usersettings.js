define(["appSettings","apiClientResolver","events"],function(n,e,t){function r(){var n=e();return n?n.getCurrentUserId():null}var i=function(){var i=this;i.set=function(e,u){var a=r();if(!a)throw new Error("userId cannot be null");var o=i.get(e);n.set(e,u,a),o!=u&&t.trigger(i,"change",[e])},i.get=function(e){var t=r();if(!t)throw new Error("userId cannot be null");return n.get(e,t)},i.enableCinemaMode=function(n){return null!=n&&i.set("enableCinemaMode",n.toString()),n=i.get("enableCinemaMode"),n?"false"!=n:!0},i.language=function(n){return null!=n&&i.set("language",n.toString()),i.get("language")},i.skipBackLength=function(n){return null!=n&&i.set("skipBackLength",n.toString()),parseInt(i.get("skipBackLength")||"15000")},i.skipForwardLength=function(n){return null!=n&&i.set("skipForwardLength",n.toString()),parseInt(i.get("skipForwardLength")||"15000")},i.serverConfig=function(n){return n?e().updateUserConfiguration(r(),n):e().getUser(r()).then(function(n){return n.Configuration})}};return new i});