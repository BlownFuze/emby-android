define(["actionsheet","datetime","playbackManager","globalize","appSettings"],function(e,a,s,n,t){function r(r){var l=r.item,u=l.Type,o=l.MediaType,d=l.IsFolder,p=l.Id,c=(l.ServerId,l.UserData?l.UserData.PlaybackPositionTicks:null),m=i&&"Video"==o&&!d&&t.enableExternalPlayers();if(!c&&"Audio"!=o&&!d&&!m)return void s.play({items:[l]});var h=[];c?(h.push({name:n.translate("sharedcomponents#ResumeAt",a.getDisplayRunningTime(c)),id:"resume"}),h.push({name:n.translate("sharedcomponents#PlayFromBeginning"),id:"play"})):h.push({name:n.translate("sharedcomponents#Play"),id:"play"}),m&&h.push({name:n.translate("ButtonPlayExternalPlayer"),id:"externalplayer"}),s.canQueueMediaType(o)&&h.push({name:n.translate("sharedcomponents#Queue"),id:"queue"}),("Audio"==u||"MusicAlbum"==u||"MusicArtist"==u||"MusicGenre"==u)&&h.push({name:n.translate("sharedcomponents#InstantMix"),id:"instantmix"}),(d||"MusicArtist"==u||"MusicGenre"==u)&&h.push({name:n.translate("sharedcomponents#Shuffle"),id:"shuffle"}),e.show({items:h,positionTo:r.positionTo}).then(function(e){switch(e){case"play":s.play({ids:[p],serverId:l.ServerId});break;case"externalplayer":LibraryBrowser.playInExternalPlayer(p);break;case"resume":s.play({ids:[p],startPositionTicks:c,serverId:l.ServerId});break;case"queue":s.queue(l);break;case"instantmix":s.instantMix(l);break;case"shuffle":s.shuffle(l)}})}var i=null!=window.Dashboard;return{show:r}});