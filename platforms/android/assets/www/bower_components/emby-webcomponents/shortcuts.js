define(["playbackManager","inputManager","connectionManager","embyRouter"],function(t,e,n,i){function r(e,n){for(var i=e.parentNode.querySelectorAll(".itemAction[data-id]"),r=[],a=!1,o=0,s=i.length;s>o;o++)i[o]==e&&(a=!0),a&&r.push(i[o].getAttribute("data-id"));t.play({ids:r,serverId:n})}function a(t,e){var i=n.getApiClient(e),r=i.getCurrentUserId();return i.getItem(r,t).then(function(e){return i.getItems(r,{MediaTypes:"Photo",Filters:"IsNotFolder",ParentId:e.ParentId}).then(function(e){var n=e.Items,i=n.map(function(t){return t.Id}).indexOf(t);-1==i&&(i=0),require(["slideshow"],function(t){var e=new t({showTitle:!1,cover:!1,items:n,startIndex:i,interval:8e3,interactive:!0});e.show()})})})}function o(t){return"Photo"==t.Type?void a(t.Id,t.ServerId):void i.showItem(t)}function s(e,n){var i=e.getAttribute("data-id"),a=e.getAttribute("data-serverid"),s=e.getAttribute("data-type"),d="true"==e.getAttribute("data-isfolder");if("link"==n)o({Id:i,Type:s,IsFolder:d,ServerId:a});else if("instantmix"==n)t.instantMix(i,a);else if("play"==n){var u=parseInt(e.getAttribute("data-startpositionticks")||"0");t.play({ids:[i],startPositionTicks:u,serverId:a})}else"playallfromhere"==n&&r(e,a)}function d(t){var e=u(t.target,"itemAction");if(e){var n=e.getAttribute("data-action");n&&s(e,n)}}function u(t,e){for(;!t.classList||!t.classList.contains(e);)if(t=t.parentNode,!t)return null;return t}function c(t){var e=t.detail.command;if("play"==e){var n=u(t.target,"itemAction");n&&s(n,e)}}function l(t){t.addEventListener("click",d),e.on(t,c)}function f(t){t.removeEventListener("click",d),e.off(t,c)}return{on:l,off:f}});