define(["appSettings","apiClientResolver","events"],function(n,e,t){return function(r){function i(n){if(r)return r;var t=n||e();return t?t.getCurrentUserId():null}var u=this;u.set=function(e,r){var a=i();if(!a)throw new Error("userId cannot be null");var o=u.get(e);n.set(e,r,a),o!=r&&t.trigger(u,"change",[e])},u.get=function(e){var t=i();if(!t)throw new Error("userId cannot be null");return n.get(e,t)},u.enableCinemaMode=function(n){return null!=n&&u.set("enableCinemaMode",n.toString()),n=u.get("enableCinemaMode"),n?"false"!=n:!0},u.language=function(n){return null!=n&&u.set("language",n.toString()),u.get("language")},u.skipBackLength=function(n){return null!=n&&u.set("skipBackLength",n.toString()),parseInt(u.get("skipBackLength")||"15000")},u.skipForwardLength=function(n){return null!=n&&u.set("skipForwardLength",n.toString()),parseInt(u.get("skipForwardLength")||"15000")},u.serverConfig=function(n){var t=e();return n?t.updateUserConfiguration(i(t),n):t.getUser(i(t)).then(function(n){return n.Configuration})}}});