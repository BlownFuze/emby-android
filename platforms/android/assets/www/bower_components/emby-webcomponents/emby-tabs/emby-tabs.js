define(["dom","scroller","browser","registerElement","css!./emby-tabs","scrollStyles"],function(e,t,s){function a(e){return e.getBoundingClientRect?e.getBoundingClientRect():{top:0,left:0}}function n(e){var t=e.querySelector("."+v+"-selection-bar");return t||(t=document.createElement("div"),t.classList.add(v+"-selection-bar"),e.appendChild(t)),t}function r(e){var t=n(e);t.classList.add("hide"),t.classList.remove("emby-tab-button-selection-bar-active")}function i(e){var t=n(e);t.classList.remove("hide"),t.classList.add("emby-tab-button-selection-bar-active")}function l(e,t,s,a){var n=s?"translateX("+s+"px)":"none",r=t?"translateX("+t+"px)":"none";if(!a||!e.animate)return void(e.style.transform=n);e.style.transform=r;var i=[{transform:"translateX("+t+"px)",offset:0},{transform:n,offset:1}];e.animate(i,{duration:a,iterations:1,easing:"ease-out",fill:"forwards"})}function c(e,t,s,n){s&&r(s),r(t);var c=e.selectionBar;c&&(c.style.width=t.offsetWidth+"px",c.classList.remove("hide"));var o=a(e),d=e.currentOffset||0;s&&(d=e.scroller?e.scroller.getCenterPosition(s):a(s).left-o.left);var u;if(e.scroller)u=e.scroller.getCenterPosition(t);else{var b=a(t);u=b.left-o.left}var v=n?180:0;c&&l(c,d,u,v),e.currentOffset=u,t.classList.add(f),setTimeout(function(){i(t),c&&c.classList.add("hide")},v)}function o(t){var s=this,a=s.querySelector("."+f),n=e.parentWithClass(t.target,v);if(n&&n!=a){a&&a.classList.remove(f);var r=a?parseInt(a.getAttribute("data-index")):null;c(s,n,a,!0);var i=parseInt(n.getAttribute("data-index"));s.dispatchEvent(new CustomEvent("beforetabchange",{detail:{selectedTabIndex:i,previousIndex:r}})),setTimeout(function(){s.selectedTabIndex=i,s.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:i,previousIndex:r}}))},120),s.scroller&&s.scroller.toCenter(n,!1)}}function d(e){if(!e.scroller){var a=e.querySelector(".emby-tabs-slider");a?(e.scroller=new t(e,{horizontal:1,itemNav:0,mouseDragging:1,touchDragging:1,slidee:a,smart:!0,releaseSwing:!0,scrollBy:200,speed:120,elasticBounds:1,dragHandle:1,dynamicHandle:1,clickBar:1,hiddenScroll:!0,requireAnimation:!s.safari}),e.scroller.init()):e.classList.add("hiddenScrollX")}}function u(e){var t=e.querySelector(".emby-tabs-slider");if(t){var s=document.createElement("div");s.classList.add("emby-tabs-selection-bar"),t.appendChild(s),e.selectionBar=s}}var b=Object.create(HTMLDivElement.prototype),v="emby-tab-button",f=v+"-active";b.createdCallback=function(){this.classList.contains("emby-tabs")||(this.classList.add("emby-tabs"),e.addEventListener(this,"click",o,{passive:!0}),u(this))},b.attachedCallback=function(){d(this);var e=this.querySelector("."+f),t=e?parseInt(e.getAttribute("data-index")):0,s=this.querySelectorAll("."+v)[t];s&&c(this,s,e,!1)},b.detachedCallback=function(){this.scroller&&(this.scroller.destroy(),this.scroller=null),e.removeEventListener(this,"click",o,{passive:!0}),this.selectionBar=null},b.selectedIndex=function(e){var t=this;if(null==e)return t.selectedTabIndex||0;var s=t.selectedIndex();t.selectedTabIndex=e;var a=t.querySelectorAll("."+v);s==e?(t.dispatchEvent(new CustomEvent("beforetabchange",{detail:{selectedTabIndex:e}})),t.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:e}})),c(t,a[e],a[e],!1)):a[e].click()},b.triggerTabChange=function(){var e=this;e.dispatchEvent(new CustomEvent("beforetabchange",{detail:{selectedTabIndex:e.selectedIndex()}})),e.dispatchEvent(new CustomEvent("tabchange",{detail:{selectedTabIndex:e.selectedIndex()}}))},document.registerElement("emby-tabs",{prototype:b,"extends":"div"})});