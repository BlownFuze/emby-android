define(["layoutManager","browser","css!./emby-textarea","registerElement"],function(){function e(e,t){function i(){e.rows=1,r=a.getOffset(e),a.rows=e.rows||1,a.lineHeight=e.scrollHeight/a.rows-r/a.rows,a.maxAllowedHeight=a.lineHeight*t-r}function s(){if((!a.lineHeight||a.lineHeight<=0)&&i(),a.lineHeight<=0)return e.style.overflowY="scroll",e.style.height="auto",void(e.rows=3);var t=0,s=!1;e.scrollHeight-r>a.maxAllowedHeight?(e.style.overflowY="scroll",t=a.maxAllowedHeight):(e.style.overflowY="hidden",e.style.height="auto",t=e.scrollHeight,s=!0),e.style.height=t+"px"}var a=this;void 0===t&&(t=999),a.getOffset=function(e){for(var t=window.getComputedStyle(e,null),i=["paddingTop","paddingBottom"],s=0,a=0;a<i.length;a++)s+=parseInt(t[i[a]]);return s};var r;e.addEventListener("input",s),e.addEventListener("focus",s),e.addEventListener("valueset",s),s()}var t=Object.create(HTMLTextAreaElement.prototype),i=0,s=!1;if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var a=Object.getOwnPropertyDescriptor(HTMLTextAreaElement.prototype,"value");if(a&&a.configurable){var r=a.set;a.set=function(e){r.call(this,e),this.dispatchEvent(new CustomEvent("valueset",{bubbles:!1,cancelable:!1}))},Object.defineProperty(HTMLTextAreaElement.prototype,"value",a),s=!0}}t.createdCallback=function(){this.id||(this.id="embytextarea"+i,i++)},t.attachedCallback=function(){function t(){this.value?a.classList.remove("blank"):a.classList.add("blank")}if("true"!=this.getAttribute("data-embytextarea")){this.rows=1,this.setAttribute("data-embytextarea","true");var i=this.parentNode,a=this.ownerDocument.createElement("label");a.innerHTML=this.getAttribute("label")||"",a.classList.add("textareaLabel"),s&&"date"!=this.type||a.classList.add("nofloat"),a.htmlFor=this.id,i.insertBefore(a,this);var r=document.createElement("div");r.classList.add("emby-textarea-selectionbar"),i.insertBefore(r,this.nextSibling),this.addEventListener("focus",function(){t.call(this),a.classList.add("focused")}),this.addEventListener("blur",function(){t.call(this),a.classList.remove("focused")}),this.addEventListener("change",t),this.addEventListener("input",t),this.addEventListener("valueset",t),t.call(this),this.label=function(e){a.innerHTML=e},new e(this)}},document.registerElement("emby-textarea",{prototype:t,"extends":"textarea"})});