define(["paperdialoghelper","layoutManager","dialogText","paper-button","css!./actionsheet"],function(t,e,n){function o(t,e){for(;!t.classList||!t.classList.contains(e);)if(t=t.parentNode,!t)return null;return t}function i(t){var e=$(window).height();if(540>e)return null;var n=$(t.positionTo).offset();return n.top+=$(t.positionTo).innerHeight()/2,n.left+=$(t.positionTo).innerWidth()/2,n.top-=24,n.left-=24,n.top-=55*t.items.length/2,n.left-=80,n.top-=$(window).scrollTop(),n.left-=$(window).scrollLeft(),n.top=Math.min(n.top,e-300),n.left=Math.min(n.left,$(window).width()-300),n.top=Math.max(n.top,0),n.left=Math.max(n.left,0),n}function a(t){require(["scrollHelper"],function(e){e.centerFocus.on(t.querySelector(".actionSheetScroller"),!1)})}function l(l){var r={removeOnClose:!0,enableHistory:l.enableHistory},s=!1;e.tv?(r.size="fullscreen",s=!0,r.autoFocus=!0):(r.modal=!1,r.entryAnimationDuration=160,r.exitAnimationDuration=200,r.autoFocus=!1);var c=t.createDialog(r),u=l.positionTo?i(l):null;c.classList.add("actionSheet");var p="";p+='<div class="actionSheetContent">',l.title&&(e.tv?(p+='<h1 class="actionSheetTitle">',p+=l.title,p+="</h1>"):(p+='<h2 class="actionSheetTitle">',p+=l.title,p+="</h2>")),p+='<div class="actionSheetScroller">';var d=l.items.filter(function(t){return t.ironIcon}),f=d.length,h=l.title&&!d.length;h&&c.classList.add("centered");var m=!e.tv;m=!1;var v="paper-button";m&&(p+="<paper-menu>",v="paper-menu-item");for(var g=0,S=l.items.length;S>g;g++){var b=l.items[g],w=b.selected?" autoFocus":"";p+="<"+v+w+' noink class="actionSheetMenuItem" data-id="'+b.id+'" style="display:block;">',b.ironIcon?p+='<iron-icon class="actionSheetItemIcon" icon="'+b.ironIcon+'"></iron-icon>':f&&!h&&(p+='<iron-icon class="actionSheetItemIcon"></iron-icon>'),p+="<span>"+b.name+"</span>",p+="</"+v+">"}m&&(p+="</paper-menu>"),l.showCancel&&(p+='<div class="buttons">',p+="<paper-button dialog-dismiss>"+n.get("Cancel")+"</paper-button>",p+="</div>"),p+="</div>",c.innerHTML=p,u&&(c.style.position="fixed",c.style.left=u.left+"px",c.style.top=u.top+"px"),e.tv&&a(c),document.body.appendChild(c);var y="click";return new Promise(function(e){c.addEventListener(y,function(n){var i=o(n.target,"actionSheetMenuItem");if(i){var a=i.getAttribute("data-id");t.close(c),setTimeout(function(){l.callback&&l.callback(a),e(a)},100)}}),t.open(c)})}return{show:l}});