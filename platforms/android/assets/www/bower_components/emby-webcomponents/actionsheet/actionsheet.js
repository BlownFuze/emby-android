define(["paperdialoghelper","layoutManager","dialogText","paper-button","css!./actionsheet"],function(t,e,n){function o(t,e){for(;!t.classList||!t.classList.contains(e);)if(t=t.parentNode,!t)return null;return t}function i(t){var e=$(window).height();if(540>e)return null;var n=$(t.positionTo).offset();return n.top+=$(t.positionTo).innerHeight()/2,n.left+=$(t.positionTo).innerWidth()/2,n.top-=24,n.left-=24,n.top-=55*t.items.length/2,n.left-=80,n.top-=$(window).scrollTop(),n.left-=$(window).scrollLeft(),n.top=Math.min(n.top,e-300),n.left=Math.min(n.left,$(window).width()-300),n.top=Math.max(n.top,0),n.left=Math.max(n.left,0),n}function a(a){var l={removeOnClose:!0,enableHistory:a.enableHistory},s=!1;e.tv?(l.size="fullscreen",s=!0,l.autoFocus=!0):(l.modal=!1,l.entryAnimationDuration=160,l.exitAnimationDuration=200,l.autoFocus=!1);var r=t.createDialog(l),c=a.positionTo?i(a):null;r.classList.add("actionSheet");var p="";p+='<div class="actionSheetContent">',a.title&&(e.tv?(p+='<h1 class="actionSheetTitle">',p+=a.title,p+="</h1>"):(p+='<h2 class="actionSheetTitle">',p+=a.title,p+="</h2>")),p+='<div class="actionSheetScroller">';var u=a.items.filter(function(t){return t.ironIcon}),d=u.length,h=a.title&&!u.length;h&&r.classList.add("centered");var f=!e.tv;f=!1;var m="paper-button";f&&(p+="<paper-menu>",m="paper-menu-item");for(var v=0,g=a.items.length;g>v;v++){var b=a.items[v],w=b.selected?" autoFocus":"";p+="<"+m+w+' noink class="actionSheetMenuItem" data-id="'+b.id+'" style="display:block;">',b.ironIcon?p+='<iron-icon class="actionSheetItemIcon" icon="'+b.ironIcon+'"></iron-icon>':d&&!h&&(p+='<iron-icon class="actionSheetItemIcon"></iron-icon>'),p+="<span>"+b.name+"</span>",p+="</"+m+">"}f&&(p+="</paper-menu>"),a.showCancel&&(p+='<div class="buttons">',p+="<paper-button dialog-dismiss>"+n.get("Cancel")+"</paper-button>",p+="</div>"),p+="</div>",r.innerHTML=p,c&&(r.style.position="fixed",r.style.left=c.left+"px",r.style.top=c.top+"px"),document.body.appendChild(r);var y="click";return new Promise(function(e){r.addEventListener(y,function(n){var i=o(n.target,"actionSheetMenuItem");if(i){var l=i.getAttribute("data-id");t.close(r),setTimeout(function(){a.callback&&a.callback(l),e(l)},100)}}),t.open(r)})}return{show:a}});