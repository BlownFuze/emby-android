define([],function(){function e(e,i){i&&(e=t(e)),e=e.map(function(e){return e.Id}),e.length?MediaController.play({ids:e}):require(["toast"],function(e){e(Globalize.translate("MessageNoItemsFound"))})}function t(e){for(var t,i,r=e.length;0!==r;)i=Math.floor(Math.random()*r),r-=1,t=e[r],e[r]=e[i],e[i]=t;return e}return function(t){t.success=!1;var i={Limit:t.item.limit||100,UserId:t.userId,ExcludeLocationTypes:"Virtual"};return t.item.itemType&&(i.IncludeItemTypes=t.item.itemType),"nextup"===t.item.sourceid?(ApiClient.getNextUpEpisodes(i).then(function(i){e(i.Items,t.item.shuffle)}),void(t.success=!0)):(t.item.shuffle&&(t.item.sortBy=t.sortBy?"Random,"+t.item.sortBy:"Random"),i.SortBy=t.item.sortBy,i.SortOrder=t.item.sortOrder,i.Recursive=!0,-1!==t.item.filters.indexOf("unplayed")&&(i.IsPlayed=!1),-1!==t.item.filters.indexOf("played")&&(i.IsPlayed=!0),-1!==t.item.filters.indexOf("favorite")&&(i.Filters="IsFavorite"),ApiClient.getItems(Dashboard.getCurrentUserId(),i).then(function(i){e(i.Items,t.item.shuffle)}),void(t.success=!0))}});