!function(){function e(e){function n(){Events.trigger(a,"ended")}function i(){Events.trigger(a,"timeupdate")}function r(){Events.trigger(a,"volumechange")}function t(){Events.trigger(a,"playing")}function o(){Events.trigger(a,"pause")}function u(e,n,i){var r={QueueableMediaTypes:i.MediaType,ItemId:i.Id,NowPlayingItem:{},MediaSourceId:n.Id};n.RunTimeTicks&&(r.NowPlayingItem.RunTimeTicks=n.RunTimeTicks);var t=e.url,o=getParameterByName("AudioStreamIndex",t);return o&&(r.AudioStreamIndex=parseInt(o)),null!=MediaPlayer.currentSubtitleStreamIndex&&(r.SubtitleStreamIndex=MediaPlayer.currentSubtitleStreamIndex),r.PlayMethod=e.playMethod,r.LiveStreamId=n.LiveStreamId,r.PlaySessionId=getParameterByName("PlaySessionId",t),n.RunTimeTicks&&n.RunTimeTicks>0&&(r.CanSeek=!0),r}var a=this;a.enableProgressReporting="audio"==e.type;var d={};a.currentTime=function(e){return null!=e?void AndroidVlcPlayer.sendVlcCommand("setposition",e.toString()):d.currentTime},a.duration=function(){return d?d.duration:null},a.stop=function(){AndroidVlcPlayer.sendVlcCommand("stop",null)},a.pause=function(){AndroidVlcPlayer.sendVlcCommand("pause",null)},a.unpause=function(){AndroidVlcPlayer.sendVlcCommand("unpause",null)},a.volume=function(e){return d?null!=e?void AndroidVlcPlayer.sendVlcCommand("setvolume",(100*e).toString()):d.volume:void 0},a.setCurrentSrc=function(n,i,r){if(!n)return void a.destroy();var t=n.url,o=t.indexOf("#t="),l=0;if(-1!=o&&(l=t.substring(o+3),l=1e3*parseFloat(l),t=t.split("#")[0]),"audio"==e.type)AndroidVlcPlayer.playAudioVlc(t,JSON.stringify(i),JSON.stringify(r),e.poster);else{var s=u(n,r,i),c=ApiClient.serverAddress(),p=r.MediaStreams.filter(function(e){return"Video"==e.Type})[0],m=p?p.Width:null,y=p?p.Height:null,f=MediaPlayer.getVideoQualityOptions(m,y).map(function(e){return{Name:e.name,Value:e.bitrate+"-"+e.maxHeight}}),g=MediaPlayer.getDeviceProfile(),v=MediaController.playbackTimeLimitMs||0;AndroidVlcPlayer.playVideoVlc(t,l,i.Name,JSON.stringify(i),JSON.stringify(r),JSON.stringify(s),ApiClient.serverInfo().Id,c,ApiClient.appName(),ApiClient.appVersion(),ApiClient.deviceId(),ApiClient.deviceName(),ApiClient.getCurrentUserId(),ApiClient.accessToken(),JSON.stringify(g),JSON.stringify(f),v),d.currentSrc=t,a.report("playing",null,l,!1,100)}},a.currentSrc=function(){return d?d.currentSrc:void 0},a.paused=function(){return d?d.paused:!1},a.cleanup=function(e){e!==!1&&AndroidVlcPlayer.destroyVlc(),d={}},a.enableCustomVideoControls=function(){return!1},a.report=function(e,u,a,l,s){var c=d;c.duration=u,c.currentTime=a,c.paused=l,c.volume=(s||0)/100,"playbackstop"==e?n():"volumechange"==e?r():"positionchange"==e?i():"paused"==e?o():"unpaused"==e?t():"playing"==e&&t()},a.init=function(){var e=DeferredBuilder.Deferred();return e.resolve(),e.promise()},a.onActivityClosed=function(e,n,i){d.currentTime=i,e&&MediaPlayer.stop(!1),a.report("playbackstop",d.duration,i,!1,100)},window.AudioRenderer.Current=a,window.VideoRenderer.Current=a}window.AudioRenderer=function(n){return n=n||{},n.type="audio",new e(n)},window.VideoRenderer=function(n){return n=n||{},n.type="video",new e(n)}}();