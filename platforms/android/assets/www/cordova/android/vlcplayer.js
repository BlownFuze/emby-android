!function(){function e(e){function n(){Events.trigger(a,"ended")}function i(){Events.trigger(a,"timeupdate")}function t(){Events.trigger(a,"volumechange")}function r(){Events.trigger(a,"playing")}function o(){Events.trigger(a,"pause")}function u(e,n,i){var t={QueueableMediaTypes:i.MediaType,ItemId:i.Id,NowPlayingItem:{},MediaSourceId:n.Id};n.RunTimeTicks&&(t.NowPlayingItem.RunTimeTicks=n.RunTimeTicks);var r=e.url,o=getParameterByName("AudioStreamIndex",r);return o&&(t.AudioStreamIndex=parseInt(o)),null!=MediaPlayer.currentSubtitleStreamIndex&&(t.SubtitleStreamIndex=MediaPlayer.currentSubtitleStreamIndex),t.PlayMethod=e.playMethod,t.LiveStreamId=n.LiveStreamId,t.PlaySessionId=getParameterByName("PlaySessionId",r),n.RunTimeTicks&&n.RunTimeTicks>0&&(t.CanSeek=!0),t}var a=this;a.enableProgressReporting="audio"==e.type;var d={};a.currentTime=function(e){return null!=e?void AndroidVlcPlayer.sendVlcCommand("setposition",e.toString()):d.currentTime},a.duration=function(){return d?d.duration:null},a.stop=function(){AndroidVlcPlayer.sendVlcCommand("stop",null)},a.pause=function(){AndroidVlcPlayer.sendVlcCommand("pause",null)},a.unpause=function(){AndroidVlcPlayer.sendVlcCommand("unpause",null)},a.volume=function(e){return d?null!=e?void AndroidVlcPlayer.sendVlcCommand("setvolume",(100*e).toString()):d.volume:void 0},a.setCurrentSrc=function(n,i,t){if(!n)return void a.destroy();var r=n.url,o=r.indexOf("#t="),l=0;if(-1!=o&&(l=r.substring(o+3),l=1e3*parseFloat(l),r=r.split("#")[0]),"audio"==e.type)AndroidVlcPlayer.playAudioVlc(r,JSON.stringify(i),JSON.stringify(t),e.poster);else{{var c=u(n,t,i),s=ApiClient.serverAddress(),p=t.MediaStreams.filter(function(e){return"Video"==e.Type})[0],m=p?p.Width:null;p?p.Height:null}require(["qualityoptions"],function(e){var n=AppSettings.maxStreamingBitrate(),o=e.getVideoQualityOptions(n,m).map(function(e){return{Name:e.name,Value:e.bitrate+"-"+e.maxHeight}});MediaPlayer.getDeviceProfile().then(function(e){var n=MediaController.playbackTimeLimitMs||0;AndroidVlcPlayer.playVideoVlc(r,l,i.Name,JSON.stringify(i),JSON.stringify(t),JSON.stringify(c),ApiClient.serverInfo().Id,s,ApiClient.appName(),ApiClient.appVersion(),ApiClient.deviceId(),ApiClient.deviceName(),ApiClient.getCurrentUserId(),ApiClient.accessToken(),JSON.stringify(e),JSON.stringify(o),n),d.currentSrc=r,a.report("playing",null,l,!1,100)})})}},a.currentSrc=function(){return d?d.currentSrc:void 0},a.paused=function(){return d?d.paused:!1},a.cleanup=function(e){e!==!1&&AndroidVlcPlayer.destroyVlc(),d={}},a.enableCustomVideoControls=function(){return!1},a.report=function(e,u,a,l,c){var s=d;s.duration=u,s.currentTime=a,s.paused=l,s.volume=(c||0)/100,"playbackstop"==e?n():"volumechange"==e?t():"positionchange"==e?i():"paused"==e?o():"unpaused"==e?r():"playing"==e&&r()},a.init=function(){return new Promise(function(e){e()})},a.onActivityClosed=function(e,n,i){d.currentTime=i,e&&MediaPlayer.stop(!1),a.report("playbackstop",d.duration,i,!1,100)},window.AudioRenderer.Current=a,window.VideoRenderer.Current=a}window.VlcAudio&&(window.AudioRenderer=function(n){return n=n||{},n.type="audio",new e(n)}),window.VideoRenderer=function(n){return n=n||{},n.type="video",new e(n)}}();