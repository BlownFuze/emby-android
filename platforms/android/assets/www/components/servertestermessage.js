define(["appSettings"],function(e){function t(){return fetch("https://api.github.com/repos/MediaBrowser/Emby/releases",{method:"GET"}).then(function(e){return e.json()},function(){return[]}).then(function(e){for(var t={},n=0,a=e.length;a>n;n++){var r=e[n];if(r.prerelease&&(t.beta||"beta"!=r.target_commitish||(t.beta=r),t.dev||"dev"!=r.target_commitish||(t.dev=r)),t.beta&&t.dev)break}return t})}function n(e,t,n){return e.split(t).join(n)}function a(){t().then(function(e){require(["dialogHelper"],function(t){var a=t.createDialog({size:"small",removeOnClose:!0,autoFocus:!1});a.classList.add("ui-body-b"),a.classList.add("background-theme-b");var r="";r+='<div class="dialogHeader">',r+='<paper-icon-button icon="arrow-back" class="btnCancel" tabindex="-1"></paper-icon-button>',r+='<div class="dialogHeaderTitle">',r+="Emby",r+="</div>",r+="</div>",r+="<h1>Welcome Emby Tester!</h1>",r+="<p>If you're seeing this message, its because you're running a pre-release version of Emby Server. Thank you for being a part of the Emby pre-release testing process.</p>",r+='<p>Please take a moment to leave your testing feedback about this version in the <a target="_blank" href="https://emby.media/community">Emby Community.</a></p>',r+='<a target="_blank" href="https://emby.media/community" class="clearLink" style="display:block;"><paper-button raised class="accent block">Visit Emby Community</paper-button></a>',e.beta&&(r+='<h1 style="margin-bottom:0;margin-top:1.5em;">Beta Release Notes</h1>',r+='<div style="margin-top:0;">',r+=n(e.beta.body||"","*","<br/>"),r+="</div>"),e.dev&&(r+='<h1 style="margin-bottom:0;margin-top:1.5em;">Dev Release Notes</h1>',r+='<div style="margin-top:0;">',r+=n(e.dev.body||"","*","<br/>"),r+="</div>"),a.innerHTML=r,document.body.appendChild(a),t.open(a),a.querySelector(".btnCancel",a).addEventListener("click",function(){t.close(a)})})})}function r(e,t){e=e.split("."),t=t.split(".");for(var n=0,a=Math.max(e.length,t.length);a>n;n++){var r=parseInt(e[n]||"0"),i=parseInt(t[n]||"0");if(i>r)return-1;if(r>i)return 1}return 0}function i(t){var n="servertestermessagetime",i=parseInt(e.get(n)||"0");(new Date).getTime()-i<2592e5||(e.set(n,(new Date).getTime()),i&&t.getPublicSystemInfo().then(function(e){1==r(e.Version,"3.0.5931")&&a()}))}return{show:i}});