define(["browser","css!./navdrawer","scrollStyles"],function(t){return function(e){function n(t){e.target.classList.remove("transition"),e.target.classList.add("open"),v=Math.abs(t.velocity)}function a(t){v=Math.abs(t.velocity);var e=c.visible;e&&!y&&t.deltaX>0&&(M=!0),y||M||e&&!(Math.abs(t.deltaX)>=10)?M||(M=!0):(y=!0,k.addEventListener("scroll",s),c.showMask()),y&&(h=f+t.deltaX,c.changeMenuPos())}function o(t){e.target.classList.add("transition"),k.removeEventListener("scroll",s),y=!1,M=!1,f=t.deltaX,c.checkMenuState(t.deltaX,t.deltaY)}function i(t){if(!e.disableEdgeSwipe){var i=new t(e.edgeSwipeElement,null),s=!1;i.on("panstart panmove",function(t){if(s)a(t);else{var o=t.srcEvent,i=o.clientX;if(!i){var r=o.touches;r&&r.length&&(i=r[0].clientX)}i<=e.handleSize&&(s=!0,n(t))}}),i.on("panend pancancel",function(t){s&&(s=!1,o(t))}),c.edgeHammer=i}}function s(t){t.preventDefault(),t.stopPropagation()}function r(t){t&&(u=t(e.target,null)),c.initElements(t),t&&(c.touchStartMenu(),c.touchEndMenu(),c.eventStartMask(),c.eventEndMask(),i(t)),e.disableMask||c.clickMaskClose()}var c,l,d,p,u,h=0,f=0,m=0,g=0,v=0;e.target.classList.add("transition");var y,M,k=e.target.querySelector(".scrollContainer");k.classList.add("smoothScrollY");var b=function(){c=this,l={width:280,handleSize:30,disableMask:!1,maxMaskOpacity:.5},this.isVisible=!1,this.initialize()};return b.prototype.initElements=function(t){e.target.classList.add("touch-menu-la"),e.target.style.width=e.width+"px",e.target.style.left=-e.width+"px",e.disableMask||(d=document.createElement("div"),d.className="tmla-mask",document.body.appendChild(d),t&&(p=new t(d,null)))},b.prototype.touchStartMenu=function(){u.on("panstart",function(t){n(t)}),u.on("panmove",function(t){a(t)})},b.prototype.animateToPosition=function(t){requestAnimationFrame(function(){t?(e.target.style.transform="translate3d("+t+"px, 0, 0)",e.target.style.WebkitTransform="translate3d("+t+"px, 0, 0)",e.target.style.MozTransform="translate3d("+t+"px, 0, 0)"):(e.target.style.transform="none",e.target.style.WebkitTransform="none",e.target.style.MozTransform="none")})},b.prototype.changeMenuPos=function(){h<=e.width&&this.animateToPosition(h)},b.prototype.touchEndMenu=function(){u.on("panend pancancel",o)},b.prototype.clickMaskClose=function(){d.addEventListener("click",function(){c.close()})},b.prototype.checkMenuState=function(t,e){v>=1?t>=-80||Math.abs(e)>=70?c.open():c.close():h>=100?c.open():c.close()},b.prototype.open=function(){this.animateToPosition(e.width),f=e.width,this.isVisible=!0,e.target.classList.add("open"),c.showMask(),c.invoke(e.onChange)},b.prototype.close=function(){this.animateToPosition(0),f=0,c.isVisible=!1,e.target.classList.remove("open"),c.hideMask(),c.invoke(e.onChange)},b.prototype.toggle=function(){c.isVisible?c.close():c.open()},b.prototype.eventStartMask=function(){p.on("panstart panmove",function(t){t.center.x<=e.width&&c.isVisible&&(g++,1==g&&(m=t.deltaX),t.deltaX<0&&(y=!0,h=t.deltaX-m+e.width,c.changeMenuPos(),v=Math.abs(t.velocity)))})},b.prototype.eventEndMask=function(){p.on("panend pancancel",function(t){c.checkMenuState(t.deltaX),g=0})},b.prototype.showMask=function(){d.classList.add("backdrop")},b.prototype.hideMask=function(){d.classList.remove("backdrop")},b.prototype.invoke=function(t){t&&t.apply(c)},b.prototype.initialize=function(){e=Object.assign(l,e||{}),t.edge&&(e.disableEdgeSwipe=!0),t.touch?require(["hammer"],r):r()},new b}});