define(["browser","css!./navdrawer","scrollStyles"],function(t){return function(e){function n(t){e.target.classList.remove("transition"),e.target.classList.add("open"),M=Math.abs(t.velocity)}function o(t){M=Math.abs(t.velocity);var e=l.visible;e&&!g&&t.deltaX>0&&(k=!0),g||k||e&&!(Math.abs(t.deltaX)>=10)?k||(k=!0):(g=!0,y.addEventListener("scroll",s),l.showMask()),g&&(h=f+t.deltaX,l.changeMenuPos())}function a(t){e.target.classList.add("transition"),y.removeEventListener("scroll",s),g=!1,k=!1,f=t.deltaX,l.checkMenuState(t.deltaX,t.deltaY)}function i(t){if(!e.disableEdgeSwipe){var i=new t(e.edgeSwipeElement,null),s=!1;i.on("panstart panmove",function(t){if(s)o(t);else{var a=t.srcEvent,i=a.clientX;if(!i){var c=a.touches;c&&c.length&&(i=c[0].clientX)}i<=e.handleSize&&(s=!0,n(t))}}),i.on("panend pancancel",function(t){s&&(s=!1,a(t))}),l.edgeHammer=i}}function s(t){t.preventDefault(),t.stopPropagation()}function c(t){t&&(u=t(e.target,null)),l.initElements(t),t&&(l.touchStartMenu(),l.touchEndMenu(),l.eventStartMask(),l.eventEndMask(),i(t)),e.disableMask||l.clickMaskClose()}var l,r,d,p,u,h=0,f=0,v=0,m=0,M=0;e.target.classList.add("transition");var g,k,y=e.target.querySelector(".scrollContainer");y.classList.add("smoothScrollY");var b=function(){l=this,r={width:280,handleSize:30,disableMask:!1,maxMaskOpacity:.5},this.isVisible=!1,this.initialize()};return b.prototype.initElements=function(t){e.target.classList.add("touch-menu-la"),e.target.style.width=e.width+"px",e.target.style.left=-e.width+"px",e.disableMask||(d=document.createElement("div"),d.className="tmla-mask",document.body.appendChild(d),t&&(p=new t(d,null)))},b.prototype.touchStartMenu=function(){u.on("panstart",function(t){n(t)}),u.on("panmove",function(t){o(t)})},b.prototype.animateToPosition=function(t){requestAnimationFrame(function(){e.target.style.transform=t?"translate3d("+t+"px, 0, 0)":"none"})},b.prototype.changeMenuPos=function(){h<=e.width&&this.animateToPosition(h)},b.prototype.touchEndMenu=function(){u.on("panend pancancel",a)},b.prototype.clickMaskClose=function(){d.addEventListener("click",function(){l.close()})},b.prototype.checkMenuState=function(t,e){M>=1?t>=-80||Math.abs(e)>=70?l.open():l.close():h>=100?l.open():l.close()},b.prototype.open=function(){this.animateToPosition(e.width),f=e.width,this.isVisible=!0,e.target.classList.add("open"),l.showMask(),l.invoke(e.onChange)},b.prototype.close=function(){this.animateToPosition(0),f=0,l.isVisible=!1,e.target.classList.remove("open"),l.hideMask(),l.invoke(e.onChange)},b.prototype.toggle=function(){l.isVisible?l.close():l.open()},b.prototype.eventStartMask=function(){p.on("panstart panmove",function(t){t.center.x<=e.width&&l.isVisible&&(m++,1==m&&(v=t.deltaX),t.deltaX<0&&(g=!0,h=t.deltaX-v+e.width,l.changeMenuPos(),M=Math.abs(t.velocity)))})},b.prototype.eventEndMask=function(){p.on("panend pancancel",function(t){l.checkMenuState(t.deltaX),m=0})},b.prototype.showMask=function(){d.classList.add("backdrop")},b.prototype.hideMask=function(){d.classList.remove("backdrop")},b.prototype.invoke=function(t){t&&t.apply(l)},b.prototype.initialize=function(){e=Object.assign(r,e||{}),t.edge&&(e.disableEdgeSwipe=!0),t.touch?require(["hammer"],c):c()},new b}});