define(["browser","hammer","css!./navdrawer","scrollStyles"],function(t,e){return function(n){function a(t){n.target.classList.remove("transition"),n.target.classList.add("open"),y=Math.abs(t.velocity)}function o(t){y=Math.abs(t.velocity);var e=c.visible;e&&!M&&t.deltaX>0&&(g=!0),M||g||e&&!(Math.abs(t.deltaX)>=10)?g||(g=!0):(M=!0,k.addEventListener("scroll",r),c.showMask()),M&&(h=f+t.deltaX,c.changeMenuPos())}function i(t){n.target.classList.add("transition"),k.removeEventListener("scroll",r),M=!1,g=!1,f=t.deltaX,c.checkMenuState(t.deltaX,t.deltaY)}function s(){if(!n.disableEdgeSwipe){var t=new e(n.edgeSwipeElement,null),s=!1;t.on("panstart panmove",function(t){if(s)o(t);else{var e=t.srcEvent,i=e.clientX;if(!i){var r=e.touches;r&&r.length&&(i=r[0].clientX)}i<=n.handleSize&&(s=!0,a(t))}}),t.on("panend pancancel",function(t){s&&(s=!1,i(t))})}}function r(t){t.preventDefault(),t.stopPropagation()}var c,l,d,p,u,h=0,f=0,m=0,v=0,y=0;n.target.classList.add("transition");var M,g,k=n.target.querySelector(".scrollContainer");k.classList.add("smoothScrollY");var b=function(){c=this,l={width:280,handleSize:30,disableMask:!1,maxMaskOpacity:.5},this.isVisible=!1,this.initialize()};return b.prototype.initElements=function(){n.target.classList.add("touch-menu-la"),n.target.style.width=n.width+"px",n.target.style.left=-n.width+"px",n.disableMask||(d=document.createElement("div"),d.className="tmla-mask",document.body.appendChild(d),p=new e(d,null))},b.prototype.touchStartMenu=function(){u.on("panstart",function(t){a(t)}),u.on("panmove",function(t){o(t)})},b.prototype.animateToPosition=function(t){requestAnimationFrame(function(){t?(n.target.style.transform="translate3d("+t+"px, 0, 0)",n.target.style.WebkitTransform="translate3d("+t+"px, 0, 0)",n.target.style.MozTransform="translate3d("+t+"px, 0, 0)"):(n.target.style.transform="none",n.target.style.WebkitTransform="none",n.target.style.MozTransform="none")})},b.prototype.changeMenuPos=function(){h<=n.width&&this.animateToPosition(h)},b.prototype.touchEndMenu=function(){u.on("panend pancancel",i)},b.prototype.clickMaskClose=function(){d.addEventListener("click",function(){c.close()})},b.prototype.checkMenuState=function(t,e){y>=1?t>=-80||Math.abs(e)>=70?c.open():c.close():h>=100?c.open():c.close()},b.prototype.open=function(){this.animateToPosition(n.width),f=n.width,this.isVisible=!0,n.target.classList.add("open"),c.showMask(),c.invoke(n.onChange)},b.prototype.close=function(){this.animateToPosition(0),f=0,c.isVisible=!1,n.target.classList.remove("open"),c.hideMask(),c.invoke(n.onChange)},b.prototype.toggle=function(){c.isVisible?c.close():c.open()},b.prototype.eventStartMask=function(){p.on("panstart panmove",function(t){t.center.x<=n.width&&c.isVisible&&(v++,1==v&&(m=t.deltaX),t.deltaX<0&&(M=!0,h=t.deltaX-m+n.width,c.changeMenuPos(),y=Math.abs(t.velocity)))})},b.prototype.eventEndMask=function(){p.on("panend pancancel",function(t){c.checkMenuState(t.deltaX),v=0})},b.prototype.showMask=function(){d.classList.add("backdrop")},b.prototype.hideMask=function(){d.classList.remove("backdrop")},b.prototype.invoke=function(t){t&&t.apply(c)},b.prototype.initialize=function(){n=Object.assign(l,n||{}),t.edge&&(n.disableEdgeSwipe=!0),u=e(n.target,null),c.initElements(),c.touchStartMenu(),c.touchEndMenu(),c.eventStartMask(),c.eventEndMask(),n.disableMask||c.clickMaskClose(),s()},new b}});