define(["paperdialoghelper","jQuery","paper-fab","paper-item-body","paper-icon-item"],function(e,i){function a(e,i){var a=m.library,n=m.refresh;ApiClient.addMediaPath(a.Name,i,n).then(function(){p=!0,r(e)},function(){require(["toast"],function(e){e(Globalize.translate("ErrorAddingMediaPathToVirtualFolder"))})})}function n(){var e=this,a=parseInt(e.getAttribute("data-index")),n=m.library,t=n.Locations[a];require(["confirm"],function(a){a(Globalize.translate("MessageConfirmRemoveMediaLocation"),Globalize.translate("HeaderRemoveMediaLocation")).then(function(){var a=m.refresh;ApiClient.removeMediaPath(n.Name,t,a).then(function(){p=!0,r(i(e).parents(".editorContent")[0])},function(){require(["toast"],function(e){e(Globalize.translate("DefaultErrorMessage"))})})})})}function t(e,i){var a="";return a+='<paper-icon-item role="menuitem" class="lnkPath">',a+='<paper-fab mini style="background:#52B54B;" icon="folder" item-icon></paper-fab>',a+="<paper-item-body>",a+=e,a+="</paper-item-body>",a+='<paper-icon-button icon="remove-circle" class="btnRemovePath" data-index="'+i+'"></paper-icon-button>',a+="</paper-icon-item>"}function r(e){ApiClient.getVirtualFolders().then(function(i){var a=i.filter(function(e){return e.Name==m.library.Name})[0];a&&(m.library=a,o(e,m))})}function o(e,a){var r=a.library.Locations.map(t).join("");e.querySelector(".folderList").innerHTML=r,i(e.querySelectorAll(".btnRemovePath")).on("click",n)}function l(){var e=i(this).parents(".editorContent")[0];require(["directorybrowser"],function(i){var n=new i;n.show({callback:function(i){i&&a(e,i),n.close()}})})}function c(e,a){o(e,a),i(".btnAddFolder",e).on("click",l)}function d(){i(this).remove(),Dashboard.hideLoadingMsg(),u.resolveWith(null,[p])}function s(){var a=this;a.show=function(a){var n=jQuery.Deferred();m=a,u=n,p=!1;var t=new XMLHttpRequest;return t.open("GET","components/medialibraryeditor/medialibraryeditor.template.html",!0),t.onload=function(){var n=this.response,t=e.createDialog({size:"small",modal:!1});t.classList.add("ui-body-a"),t.classList.add("background-theme-a"),t.classList.add("popupEditor");var o="";o+='<h2 class="dialogHeader">',o+='<paper-fab icon="arrow-back" mini class="btnCloseDialog" tabindex="-1"></paper-fab>',o+='<div style="display:inline-block;margin-left:.6em;vertical-align:middle;">'+a.library.Name+"</div>",o+="</h2>",o+='<div class="editorContent" style="max-width:800px;margin:auto;">',o+=Globalize.translateDocument(n),o+="</div>",t.innerHTML=o,document.body.appendChild(t);var l=t.querySelector(".editorContent");c(l,a),i(t).on("iron-overlay-closed",d),e.open(t),i(".btnCloseDialog",t).on("click",function(){e.close(t)}),r(l)},t.send(),n.promise()}}var u,p,m;return s});