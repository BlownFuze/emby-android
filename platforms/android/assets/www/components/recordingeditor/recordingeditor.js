define(["dialogHelper","loading","jQuery","mediaInfo","paper-checkbox","paper-input","emby-collapsible","paper-button","paper-icon-button-light"],function(e,t,i,n){function a(e,a){var r=a.ProgramInfo||{};if(i(".itemName",e).html(a.Name),i(".itemEpisodeName",e).html(r.EpisodeTitle||""),LibraryBrowser.renderGenres(i(".itemGenres",e),r),LibraryBrowser.renderOverview(e.querySelectorAll(".itemOverview"),r),r.ImageTags&&r.ImageTags.Primary){var o=ApiClient.getScaledImageUrl(r.Id,{maxWidth:200,maxHeight:200,tag:r.ImageTags.Primary,type:"Primary"});i(".timerPageImageContainer",e).css("display","inline-block").html('<img src="'+o+'" style="max-width:200px;max-height:200px;" />')}else i(".timerPageImageContainer",e).hide();i(".itemMiscInfoPrimary",e).html(n.getPrimaryMediaInfoHtml(r)),i(".itemMiscInfoSecondary",e).html(n.getSecondaryMediaInfoHtml(r)),i("#txtPrePaddingMinutes",e).val(a.PrePaddingSeconds/60),i("#txtPostPaddingMinutes",e).val(a.PostPaddingSeconds/60),"New"==a.Status?i(".timerStatus",e).hide():i(".timerStatus",e).show().html("Status:&nbsp;&nbsp;&nbsp;"+a.Status),t.hide()}function r(t){u=t,e.close(c)}function o(e){t.show();var n=this;return ApiClient.getLiveTvTimer(m).then(function(e){e.PrePaddingSeconds=60*i("#txtPrePaddingMinutes",n).val(),e.PostPaddingSeconds=60*i("#txtPostPaddingMinutes",n).val(),ApiClient.updateLiveTvTimer(e).then(function(){t.hide(),require(["toast"],function(e){e(Globalize.translate("MessageRecordingSaved")),r(!0)})})}),e.preventDefault(),!1}function s(e){e.querySelector(".btnCancel").addEventListener("click",function(){r(!1)}),e.querySelector("form").addEventListener("submit",o),e.querySelector(".btnHeaderSave").addEventListener("click",function(){e.querySelector(".btnSave").click()})}function d(e,i){t.show(),m=i,ApiClient.getLiveTvTimer(i).then(function(i){a(e,i),t.hide()})}function l(i){return new Promise(function(n,a){u=!1,t.show();var r=new XMLHttpRequest;r.open("GET","components/recordingeditor/recordingeditor.template.html",!0),r.onload=function(){var t=this.response,r=e.createDialog({removeOnClose:!0,size:"small",autoFocus:!1});r.classList.add("ui-body-b"),r.classList.add("background-theme-b"),r.classList.add("formDialog");var o="";o+=Globalize.translateDocument(t),r.innerHTML=o,document.body.appendChild(r),e.open(r),c=r,r.addEventListener("close",function(){u?n():a()}),s(r),d(r,i)},r.send()})}var c,m,u=!1;return{show:l}});