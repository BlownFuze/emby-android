define(["jQuery","paper-checkbox","paper-button","paper-input","paper-item-body","paper-icon-item"],function(e){return function(t,n,r){function i(){Dashboard.showLoadingMsg(),ApiClient.getNamedConfiguration("livetv").then(function(e){var r=e.ListingProviders.filter(function(e){return e.Id==n})[0]||{};t.querySelector(".txtPath").value=r.Path||"",t.querySelector(".chkAllTuners").checked=r.EnableAllTuners,t.querySelector(".chkAllTuners").checked?t.querySelector(".selectTunersSection").classList.add("hide"):t.querySelector(".selectTunersSection").classList.remove("hide"),o(t,r,e.TunerHosts),Dashboard.hideLoadingMsg()})}function a(){Dashboard.showLoadingMsg();var i=n;ApiClient.getNamedConfiguration("livetv").then(function(n){var a=n.ListingProviders.filter(function(e){return e.Id==i})[0]||{};a.Type="xmltv",a.Path=t.querySelector(".txtPath").value,a.EnableAllTuners=t.querySelector(".chkAllTuners").checked,a.EnabledTuners=a.EnableAllTuners?[]:e(".chkTuner",t).get().filter(function(e){return e.checked}).map(function(e){return e.getAttribute("data-id")}),ApiClient.ajax({type:"POST",url:ApiClient.getUrl("LiveTv/ListingProviders",{ValidateListings:!0}),data:JSON.stringify(a),contentType:"application/json"}).then(function(){Dashboard.hideLoadingMsg(),r.showConfirmation!==!1&&Dashboard.processServerConfigurationUpdateResult(),Events.trigger(c,"submitted")},function(){Dashboard.hideLoadingMsg(),Dashboard.alert({message:Globalize.translate("ErrorAddingListingsToSchedulesDirect")})})})}function s(e){switch(e=e.toLowerCase()){case"m3u":return"M3U Playlist";case"hdhomerun":return"HDHomerun";case"satip":return"DVB";default:return"Unknown"}}function o(e,t,n){for(var r="",i=0,a=n.length;a>i;i++){var o=n[i];r+="<paper-icon-item>";var c=t.EnableAllTuners||[],u=t.EnableAllTuners||-1!=c.indexOf(o.Id),l=u?" checked":"";r+='<paper-checkbox data-id="'+o.Id+'" class="chkTuner" item-icon '+l+"></paper-checkbox>",r+="<paper-item-body two-line>",r+="<div>",r+=o.FriendlyName||s(o.Type),r+="</div>",r+="<div secondary>",r+=o.Url,r+="</div>",r+="</paper-item-body>",r+="</paper-icon-item>"}e.querySelector(".tunerList").innerHTML=r}var c=this;c.submit=function(){t.querySelector(".btnSubmitListingsContainer").click()},c.init=function(){r=r||{},r.showCancelButton!==!1?t.querySelector(".btnCancel").classList.remove("hide"):t.querySelector(".btnCancel").classList.add("hide"),r.showSubmitButton!==!1?t.querySelector(".btnSubmitListings").classList.remove("hide"):t.querySelector(".btnSubmitListings").classList.add("hide"),e("form",t).on("submit",function(){return a(),!1}),t.querySelector(".chkAllTuners").addEventListener("change",function(e){e.target.checked?t.querySelector(".selectTunersSection").classList.add("hide"):t.querySelector(".selectTunersSection").classList.remove("hide")}),i()}}});