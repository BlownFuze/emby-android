define([],function(){function e(){if(0==f.length)return Dashboard.alert({message:Globalize.translate("PleaseAddAtLeastOneFolder")}),!1;var e=this,t=$(e).parents("paper-dialog")[0],r=$("#txtValue",e).val(),n=$("#selectCollectionType",e).val();return"mixed"==n&&(n=null),ApiClient.addVirtualFolder(r,n,u.refresh,f).then(function(){p=!0,PaperDialogHelper.close(t)},function(){Dashboard.alert(Globalize.translate("ErrorAddingMediaPathToVirtualFolder"))}),!1}function t(e){return e.filter(function(e){return e.isSelectable!==!1}).map(function(e){return'<option value="'+e.value+'">'+e.name+"</option>"}).join("")}function r(r,a){$("#selectCollectionType",r).html(t(a)).val("").on("change",function(){if("mixed"!=this.value){var e=$(this).parents("paper-dialog")[0],t=this.selectedIndex;if(-1!=t){var r=this.options[t].innerHTML.replace("*","").replace("&amp;","&"),n=this.value;$("#txtValue",e).val(r);var i=a.filter(function(e){return e.value==n})[0];$(".collectionTypeFieldDescription",e).html(i.message||"")}}}),$(".btnAddFolder",r).on("click",n),$("form",r).off("submit",e).on("submit",e)}function n(){var e=$(this).parents(".editorContent")[0];require(["directorybrowser"],function(t){var r=new t;r.show({callback:function(t){t&&o(e,t),r.close()}})})}function a(e,t){var r="";return r+='<paper-icon-item role="menuitem" class="lnkPath">',r+='<paper-fab mini style="background:#52B54B;" icon="folder" item-icon></paper-fab>',r+="<paper-item-body>",r+=e,r+="</paper-item-body>",r+='<paper-icon-button icon="remove-circle" class="btnRemovePath" data-index="'+t+'"></paper-icon-button>',r+="</paper-icon-item>"}function i(e){var t=f.map(a).join(""),r=e.querySelector(".folderList");r.innerHTML=t,t?r.classList.remove("hide"):r.classList.add("hide"),$(e.querySelectorAll(".btnRemovePath")).on("click",l)}function o(e,t){0==f.filter(function(e){return e.toLowerCase()==t.toLowerCase()}).length&&(f.push(t),i(e))}function l(){var e=this,t=parseInt(e.getAttribute("data-index")),r=f[t];f=f.filter(function(e){return e.toLowerCase()!=r.toLowerCase()});var n=$(this).parents(".editorContent")[0];i(n)}function s(){$(this).remove(),Dashboard.hideLoadingMsg(),d.resolveWith(null,[p])}function c(){var e=this;e.show=function(e){var t=DeferredBuilder.Deferred();return u=e,d=t,p=!1,require(["components/paperdialoghelper"],function(){var t=new XMLHttpRequest;t.open("GET","components/medialibrarycreator/medialibrarycreator.template.html",!0),t.onload=function(){var t=this.response,n=PaperDialogHelper.createDialog({size:"small",theme:"a",modal:!1}),a="";a+='<h2 class="dialogHeader">',a+='<paper-fab icon="arrow-back" mini class="btnCloseDialog"></paper-fab>';var o=Globalize.translate("ButtonAddMediaLibrary");a+='<div style="display:inline-block;margin-left:.6em;vertical-align:middle;">'+o+"</div>",a+="</h2>",a+='<div class="editorContent" style="max-width:800px;margin:auto;">',a+=Globalize.translateDocument(t),a+="</div>",n.innerHTML=a,document.body.appendChild(n);var l=n.querySelector(".editorContent");r(l,e.collectionTypeOptions),$(n).on("iron-overlay-closed",s),PaperDialogHelper.openWithHash(n,"medialibrarycreator"),$(".btnCloseDialog",n).on("click",function(){PaperDialogHelper.close(n)}),f=[],i(l)},t.send()}),t.promise()}}var d,p,u,f=[];return c});